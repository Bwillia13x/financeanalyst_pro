const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/private-analysis-heavy-DbFWoyh2.js","assets/react-DbKEDq5F.js","assets/financial-engines-DJoNW2Bz.js","assets/animations-DmEkbmfl.js","assets/recharts-vendor-CMq9LHd_.js","assets/utils-vendor-DofaKlSJ.js","assets/vendor-DYwn_Zoo.js","assets/d3-vendor-C2v6EsNF.js","assets/private-analysis-CjCiuYvO.js","assets/ui-components-DUPitwH-.js","assets/ui-charts-CcCRCYtT.js","assets/react-router-CGJIHeCu.js"])))=>i.map(i=>d[i]);
import{H as e,B as t,_ as a}from"./ui-components-DUPitwH-.js";import{r as s,R as r,j as l,ag as i,ah as n,U as o,N as c,W as d,ai as m,I as h,aj as u,g,q as p,F as x,a0 as y,V as f,e as j}from"./react-DbKEDq5F.js";import{a as b}from"./financial-engines-DJoNW2Bz.js";import{S as v,c as w}from"./valuation-tools-CH5aoDQV.js";import{m as N}from"./animations-DmEkbmfl.js";import"./ui-charts-CcCRCYtT.js";import"./utils-vendor-DofaKlSJ.js";import"./react-router-CGJIHeCu.js";import"./vendor-DYwn_Zoo.js";import"./recharts-vendor-CMq9LHd_.js";import"./d3-vendor-C2v6EsNF.js";import"./seo-vendor-85CQXWAt.js";const C=(e,t="USD",a=!1)=>null==e||isNaN(e)?"N/A":new Intl.NumberFormat("en-US",{style:"currency",currency:t,notation:a?"compact":"standard",minimumFractionDigits:0,maximumFractionDigits:2}).format(e),R=(e,t=1)=>null==e||isNaN(e)?"N/A":`${(100*e).toFixed(t)}%`,D={periods:["Dec-22","Dec-23","Dec-24"],operationalMetrics:{squareFootage:2500,providers:3,scheduledHours:{0:6240,1:6240,2:6240},availableHours:{0:7800,1:7800,2:7800},utilization:{0:.8,1:.8,2:.8}},customerMetrics:{avgSpend:{0:625,1:640,2:650},treatmentsPerYear:{0:3.2,1:3.4,2:3.5},retentionRate:{0:.68,1:.7,2:.72},newCustomers:{0:420,1:435,2:450},totalActiveCustomers:{0:5700,1:5650,2:5730}},statements:{incomeStatement:{energyDevices:{0:317.82,1:270.15,2:245.84},injectables:{0:1123.65,1:1044.99,2:930.04},wellness:{0:567.67,1:652.82,2:763.79},weightloss:{0:617.21,1:635.73,2:718.37},retailSales:{0:322.79,1:331.66,2:334.98},surgery:{0:617.23,1:685.12,2:733.08},totalRevenue:{0:3566.37,1:3620.47,2:3726.1},energyDeviceSupplies:{0:22.25,1:14.14,2:23.73},injectablesCogs:{0:370.8,1:326.59,2:277.83},wellnessCogs:{0:188.24,1:204.2,2:268.78},weightlossCogs:{0:261.33,1:253.45,2:266.7},retailProducts:{0:157.91,1:169.91,2:129.7},surgicalSupplies:{0:77.15,1:103.45,2:136.35},totalCostOfGoodsSold:{0:1077.68,1:1071.74,2:1103.1},grossProfit:{0:2488.69,1:2548.72,2:2623},employeeBenefits:{0:39.55,1:36.14,2:31.43},payroll:{0:1217,1:1112,2:967},payrollTaxes:{0:51.84,1:47.37,2:41.19},totalSalariesBenefits:{0:1308.4,1:1195.51,2:1039.62},marketing:{0:499.29,1:253.43,2:37.26},automobile:{0:21.25,1:21.5,2:21.76},creditCardBankCharges:{0:111.27,1:96.67,2:92.78},donations:{0:1.25,1:1.25,2:1.25},computerTelephoneUtilities:{0:92.73,1:78.93,2:92.41},depreciation:{0:167.14,1:150.43,2:135.38},duesSubscriptions:{0:39.94,1:40.55,2:41.73},education:{0:23,1:26.18,2:24.63},equipmentRental:{0:17.62,1:0,2:0},insurance:{0:44.22,1:44.89,2:46.2},interestExpense:{0:220.14,1:212.17,2:194.81},travelMealsEntertainment:{0:12.66,1:15.45,2:11.67},rent:{0:199.13,1:205.1,2:211.25},officeExpenses:{0:74.89,1:76.03,2:78.25},professionalFees:{0:35.66,1:36.2,2:37.26},repairsMaintenance:{0:164.05,1:43.45,2:44.71},localTax:{0:35.66,1:36.2,2:37.26},stateTax:{0:78.46,1:79.65,2:81.97},totalOperatingExpense:{0:1838.38,1:1418.07,2:1190.6},operatingIncome:{0:-658.09,1:-64.86,2:392.78},gainOnAssetSale:{0:0,1:0,2:42.2},interestIncome:{0:4.89,1:0,2:9.46},otherExpenses:{0:0,1:6.13,2:5.33},totalOtherIncomeExpense:{0:4.89,1:6.13,2:56.99},incomeBeforeTax:{0:-653.21,1:-58.73,2:449.77},netIncome:{0:-653.21,1:-58.73,2:449.77}},balanceSheet:{assets:{},liabilities:{},equity:{}},cashFlow:{operating:{},investing:{},financing:{}}},assumptions:{marketingTarget:.1,ownerCompensationAddback:300,industryBenchmarks:{revenuePerSqFt:{min:800,target:1200,current:1490.44},revenuePerProvider:{min:300,target:400,current:1242.03},injectableMargin:{min:.75,target:.8,current:.7},ebitdaMargin:{min:.2,target:.25,current:.185},customerRetention:{min:.65,target:.75,current:.72}},riskFactors:{regulatoryRisk:"Medium",keyPersonDependency:"High",competitionDensity:"Medium",technologyObsolescence:"Medium",reimbursementRisk:"Low"}},models:{dcf:{discountRate:.12,terminalGrowthRate:.025,projectionYears:5,taxRate:.25},adjustments:{2024:{marketing:372.61,ownerAddback:300,adjustedOperatingIncome:357.43,adjustedEbitda:687.63,adjustmentRationale:["Marketing normalized to sustainable 10% of revenue","Owner compensation replaced with market-rate management","EBITDA calculation includes depreciation and interest add-backs","One-time gains excluded from operating performance"]}}}},S="1.0.0",M="financeanalyst_",E={dcfModel:{version:"1.0",required:["symbol","assumptions","projections","valuation"],structure:{symbol:"string",assumptions:"object",projections:"object",valuation:"object",metadata:"object"}},lboModel:{version:"1.0",required:["symbol","transaction","financing","returns"],structure:{symbol:"string",transaction:"object",financing:"object",returns:"object",metadata:"object"}},monteCarloResults:{version:"1.0",required:["modelType","iterations","results","statistics"],structure:{modelType:"string",iterations:"number",results:"array",statistics:"object",metadata:"object"}},userPreferences:{version:"1.0",required:["theme","layout"],structure:{theme:"string",layout:"object",notifications:"object",privacy:"object"}},marketData:{version:"1.0",required:["symbol","data","timestamp"],structure:{symbol:"string",data:"object",timestamp:"number",source:"string"}}},O=new class{constructor(){this.isAvailable=this.checkStorageAvailability(),this.compressionWorker=null,this.initializeCompression(),this.setupQuotaMonitoring()}checkStorageAvailability(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return b.log("ERROR","localStorage not available",{error:e.message}),!1}}initializeCompression(){"CompressionStream"in window?this.compressionAvailable=!0:this.compressionAvailable=!1}setupQuotaMonitoring(){"storage"in navigator&&"estimate"in navigator.storage&&this.monitorQuota()}async monitorQuota(){try{const e=await navigator.storage.estimate(),t=e.usage/e.quota;t>.8&&(b.log("WARN","Storage quota threshold exceeded",{usage:e.usage,quota:e.quota,ratio:t}),await this.performCleanup())}catch(e){b.log("ERROR","Failed to monitor storage quota",{error:e.message})}}generateKey(e,t){return`${M}${e}_${t}`}validateData(e,t){const a=E[t];if(!a)throw new Error(`Unknown schema type: ${t}`);for(const s of a.required)if(!(s in e))throw new Error(`Missing required field: ${s}`);for(const[s,r]of Object.entries(a.structure))if(s in e){const t=Array.isArray(e[s])?"array":typeof e[s];if(t!==r)throw new Error(`Invalid type for ${s}: expected ${r}, got ${t}`)}return!0}async compressData(e){const t=JSON.stringify(e);if(t.length<1024||!this.compressionAvailable)return{data:t,compressed:!1};try{return{data:await this.simpleCompress(t),compressed:!0}}catch(a){return b.log("WARN","Compression failed, storing uncompressed",{error:a.message}),{data:t,compressed:!1}}}async simpleCompress(e){return btoa(encodeURIComponent(e))}async decompressData(e,t){if(!t)return e;try{return decodeURIComponent(atob(e))}catch(a){throw b.log("ERROR","Decompression failed",{error:a.message}),new Error("Failed to decompress data")}}async setItem(e,t,a,s={}){if(!this.isAvailable)throw new Error("Storage not available");try{E[e]&&this.validateData(a,e);const r={version:S,schemaVersion:E[e]?.version||"1.0",timestamp:Date.now(),data:a,metadata:{type:e,identifier:t,size:JSON.stringify(a).length,...s.metadata}},{data:l,compressed:i}=await this.compressData(r),n={compressed:i,data:l},o=this.generateKey(e,t);return localStorage.setItem(o,JSON.stringify(n)),b.log("DEBUG","Data stored successfully",{key:o,type:e,identifier:t,compressed:i,size:l.length}),!0}catch(r){throw b.log("ERROR","Failed to store data",{type:e,identifier:t,error:r.message}),r}}async getItem(e,t){if(!this.isAvailable)return null;try{const a=this.generateKey(e,t),s=localStorage.getItem(a);if(!s)return null;const r=JSON.parse(s),l=await this.decompressData(r.data,r.compressed),i=JSON.parse(l);return i.version!==S&&b.log("WARN","Version mismatch detected",{stored:i.version,current:S}),b.log("DEBUG","Data retrieved successfully",{key:a,type:e,identifier:t,age:Date.now()-i.timestamp}),i.data}catch(a){return b.log("ERROR","Failed to retrieve data",{type:e,identifier:t,error:a.message}),null}}removeItem(e,t){if(!this.isAvailable)return!1;try{const a=this.generateKey(e,t);return localStorage.removeItem(a),b.log("DEBUG","Data removed successfully",{key:a,type:e,identifier:t}),!0}catch(a){return b.log("ERROR","Failed to remove data",{type:e,identifier:t,error:a.message}),!1}}listItems(e){if(!this.isAvailable)return[];const t=this.generateKey(e,""),a=[];for(let s=0;s<localStorage.length;s++){const e=localStorage.key(s);if(e&&e.startsWith(t)){const s=e.replace(t,"");a.push(s)}}return a}async performCleanup(){const e=Date.now()-2592e6;let t=0;for(let s=localStorage.length-1;s>=0;s--){const r=localStorage.key(s);if(r&&r.startsWith(M))try{const a=localStorage.getItem(r),s=JSON.parse(a),l=await this.decompressData(s.data,s.compressed);JSON.parse(l).timestamp<e&&(localStorage.removeItem(r),t++)}catch(a){localStorage.removeItem(r),t++}}return b.log("INFO","Storage cleanup completed",{cleanedCount:t}),t}async getStorageStats(){let e=0,t=0;const a={};for(let r=0;r<localStorage.length;r++){const s=localStorage.key(r);if(s&&s.startsWith(M)){e+=localStorage.getItem(s).length,t++;const r=s.split("_")[1];r&&(a[r]=(a[r]||0)+1)}}const s=await this.getQuotaInfo();return{totalSize:e,itemCount:t,typeStats:a,quota:s,usageRatio:s?e/s.quota:0}}async getQuotaInfo(){if("storage"in navigator&&"estimate"in navigator.storage)try{return await navigator.storage.estimate()}catch(e){b.log("ERROR","Failed to get quota info",{error:e.message})}return null}clearAll(){if(!this.isAvailable)return!1;const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a&&a.startsWith(M)&&e.push(a)}return e.forEach(e=>localStorage.removeItem(e)),b.log("INFO","All application data cleared",{clearedCount:e.length}),!0}},I=new class{constructor(){this.storage=O}async saveDCFModel(e,t){try{const a={symbol:e.toUpperCase(),assumptions:t.assumptions||{},projections:t.projections||{},valuation:t.valuation||{},metadata:{createdAt:Date.now(),lastModified:Date.now(),version:"1.0",modelType:"DCF",...t.metadata}};return await this.storage.setItem("dcfModel",e.toUpperCase(),a),b.log("INFO","DCF model saved",{symbol:e,valuation:a.valuation.intrinsicValue}),!0}catch(a){throw b.log("ERROR","Failed to save DCF model",{symbol:e,error:a.message}),a}}async getDCFModel(e){try{const t=await this.storage.getItem("dcfModel",e.toUpperCase());return t&&b.log("DEBUG","DCF model retrieved",{symbol:e}),t}catch(t){return b.log("ERROR","Failed to retrieve DCF model",{symbol:e,error:t.message}),null}}async listDCFModels(){return this.storage.listItems("dcfModel")}async deleteDCFModel(e){return this.storage.removeItem("dcfModel",e.toUpperCase())}async saveLBOModel(e,t){try{const a={symbol:e.toUpperCase(),transaction:t.transaction||{},financing:t.financing||{},returns:t.returns||{},metadata:{createdAt:Date.now(),lastModified:Date.now(),version:"1.0",modelType:"LBO",...t.metadata}};return await this.storage.setItem("lboModel",e.toUpperCase(),a),b.log("INFO","LBO model saved",{symbol:e,irr:a.returns.irr,moic:a.returns.moic}),!0}catch(a){throw b.log("ERROR","Failed to save LBO model",{symbol:e,error:a.message}),a}}async getLBOModel(e){try{const t=await this.storage.getItem("lboModel",e.toUpperCase());return t&&b.log("DEBUG","LBO model retrieved",{symbol:e}),t}catch(t){return b.log("ERROR","Failed to retrieve LBO model",{symbol:e,error:t.message}),null}}async listLBOModels(){return this.storage.listItems("lboModel")}async deleteLBOModel(e){return this.storage.removeItem("lboModel",e.toUpperCase())}async saveMonteCarloResults(e,t){try{const a={modelType:t.modelType||"DCF",iterations:t.iterations||1e4,results:t.results||[],statistics:t.statistics||{},metadata:{createdAt:Date.now(),modelId:e,symbol:t.symbol,version:"1.0",...t.metadata}};return await this.storage.setItem("monteCarloResults",e,a),b.log("INFO","Monte Carlo results saved",{modelId:e,iterations:a.iterations,mean:a.statistics.mean}),!0}catch(a){throw b.log("ERROR","Failed to save Monte Carlo results",{modelId:e,error:a.message}),a}}async getMonteCarloResults(e){try{const t=await this.storage.getItem("monteCarloResults",e);return t&&b.log("DEBUG","Monte Carlo results retrieved",{modelId:e}),t}catch(t){return b.log("ERROR","Failed to retrieve Monte Carlo results",{modelId:e,error:t.message}),null}}async listMonteCarloResults(){return this.storage.listItems("monteCarloResults")}async deleteMonteCarloResults(e){return this.storage.removeItem("monteCarloResults",e)}async saveMarketData(e,t,a=15){try{const s={symbol:e.toUpperCase(),data:t,timestamp:Date.now(),source:t.source||"unknown",expiresAt:Date.now()+60*a*1e3};return await this.storage.setItem("marketData",e.toUpperCase(),s),b.log("DEBUG","Market data cached",{symbol:e,source:s.source,ttlMinutes:a}),!0}catch(s){throw b.log("ERROR","Failed to cache market data",{symbol:e,error:s.message}),s}}async getMarketData(e){try{const t=await this.storage.getItem("marketData",e.toUpperCase());return t&&t.expiresAt>Date.now()?(b.log("DEBUG","Market data cache hit",{symbol:e}),t.data):(t&&(await this.deleteMarketData(e),b.log("DEBUG","Market data cache expired",{symbol:e})),null)}catch(t){return b.log("ERROR","Failed to retrieve market data",{symbol:e,error:t.message}),null}}async deleteMarketData(e){return this.storage.removeItem("marketData",e.toUpperCase())}async saveUserPreferences(e){try{const t={theme:e.theme||"light",layout:e.layout||{},notifications:e.notifications||{},privacy:e.privacy||{},metadata:{lastUpdated:Date.now(),version:"1.0"}};return await this.storage.setItem("userPreferences","default",t),b.log("INFO","User preferences saved",{theme:t.theme}),!0}catch(t){throw b.log("ERROR","Failed to save user preferences",{error:t.message}),t}}async getUserPreferences(){try{const e=await this.storage.getItem("userPreferences","default");return e&&b.log("DEBUG","User preferences retrieved"),e}catch(e){return b.log("ERROR","Failed to retrieve user preferences",{error:e.message}),null}}async saveWatchlist(e,t){try{const a={name:e,symbols:t.map(e=>e.toUpperCase()),metadata:{createdAt:Date.now(),lastModified:Date.now(),symbolCount:t.length}};return await this.storage.setItem("watchlist",e,a),b.log("INFO","Watchlist saved",{name:e,symbolCount:t.length}),!0}catch(a){throw b.log("ERROR","Failed to save watchlist",{name:e,error:a.message}),a}}async getWatchlist(e){try{const t=await this.storage.getItem("watchlist",e);return t&&b.log("DEBUG","Watchlist retrieved",{name:e}),t}catch(t){return b.log("ERROR","Failed to retrieve watchlist",{name:e,error:t.message}),null}}async listWatchlists(){return this.storage.listItems("watchlist")}async deleteWatchlist(e){return this.storage.removeItem("watchlist",e)}async exportAllData(){try{const e={timestamp:Date.now(),version:"1.0",data:{dcfModels:{},lboModels:{},monteCarloResults:{},watchlists:{},userPreferences:null}},t=await this.listDCFModels();for(const l of t)e.data.dcfModels[l]=await this.getDCFModel(l);const a=await this.listLBOModels();for(const l of a)e.data.lboModels[l]=await this.getLBOModel(l);const s=await this.listMonteCarloResults();for(const l of s)e.data.monteCarloResults[l]=await this.getMonteCarloResults(l);const r=await this.listWatchlists();for(const l of r)e.data.watchlists[l]=await this.getWatchlist(l);return e.data.userPreferences=await this.getUserPreferences(),b.log("INFO","Data export completed",{dcfCount:t.length,lboCount:a.length,mcCount:s.length,watchlistCount:r.length}),e}catch(e){throw b.log("ERROR","Failed to export data",{error:e.message}),e}}async importData(e){try{let t=0;if(e.data.dcfModels)for(const[a,s]of Object.entries(e.data.dcfModels))await this.saveDCFModel(a,s),t++;if(e.data.lboModels)for(const[a,s]of Object.entries(e.data.lboModels))await this.saveLBOModel(a,s),t++;if(e.data.monteCarloResults)for(const[a,s]of Object.entries(e.data.monteCarloResults))await this.saveMonteCarloResults(a,s),t++;if(e.data.watchlists)for(const[a,s]of Object.entries(e.data.watchlists))await this.saveWatchlist(a,s.symbols),t++;return e.data.userPreferences&&(await this.saveUserPreferences(e.data.userPreferences),t++),b.log("INFO","Data import completed",{importCount:t}),t}catch(t){throw b.log("ERROR","Failed to import data",{error:t.message}),t}}async getFinancialDataStats(){return{...await this.storage.getStorageStats(),financialData:{dcfModels:(await this.listDCFModels()).length,lboModels:(await this.listLBOModels()).length,monteCarloResults:(await this.listMonteCarloResults()).length,watchlists:(await this.listWatchlists()).length}}}async cleanupExpiredMarketData(){const e=this.storage.listItems("marketData");let t=0;for(const a of e){const e=await this.storage.getItem("marketData",a);e&&e.expiresAt<=Date.now()&&(await this.deleteMarketData(a),t++)}return b.log("INFO","Expired market data cleaned",{cleanedCount:t}),t}},k=({data:e,onDataChange:t,savedAnalyses:a,onAnalysesChange:y})=>{const[f,j]=s.useState("excel"),[v,w]=s.useState(!1),[N,C]=s.useState(!1),[R,D]=s.useState(null),[S,M]=s.useState(null),[E,O]=s.useState(null),[k,F]=s.useState([{id:1,name:"Standard 3-Statement Model",category:"General",lastUsed:"2024-01-15",uses:42},{id:2,name:"SaaS DCF Template",category:"Technology",lastUsed:"2024-01-10",uses:28},{id:3,name:"LBO Analysis Template",category:"Private Equity",lastUsed:"2024-01-05",uses:35}]),[A,_]=s.useState([{id:1,name:"John Smith",email:"john@company.com",role:"Analyst",lastActive:"2 min ago",avatar:"JS"},{id:2,name:"Sarah Johnson",email:"sarah@company.com",role:"VP",lastActive:"1 hour ago",avatar:"SJ"}]);r.useEffect(()=>{U()},[]);const U=async()=>{try{const e=await I.getFinancialDataStats();O(e)}catch(e){b.log("ERROR","Failed to load storage stats",{error:e.message})}},L=async()=>{w(!0),D(null);try{const e=await I.exportAllData(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),s=document.createElement("a");s.href=a,s.download=`financeanalyst_backup_${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(s),s.click(),document.body.removeChild(s),URL.revokeObjectURL(a),D({type:"success",message:"Data exported successfully",details:{dcfModels:Object.keys(e.data.dcfModels).length,lboModels:Object.keys(e.data.lboModels).length,monteCarloResults:Object.keys(e.data.monteCarloResults).length,watchlists:Object.keys(e.data.watchlists).length}}),b.log("INFO","Data export completed",{totalItems:Object.keys(e.data.dcfModels).length+Object.keys(e.data.lboModels).length+Object.keys(e.data.monteCarloResults).length+Object.keys(e.data.watchlists).length})}catch(e){D({type:"error",message:"Export failed",details:e.message}),b.log("ERROR","Data export failed",{error:e.message})}finally{w(!1)}};return l.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:l.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[l.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[l.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Data Management"}),l.jsx("button",{onClick:onClose,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"Ã—"})]}),l.jsx("div",{className:"border-b border-gray-200",children:l.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"excel",label:"Excel Integration",icon:i},{id:"templates",label:"Templates",icon:n},{id:"collaboration",label:"Collaboration",icon:o},{id:"export",label:"Export",icon:c},{id:"import",label:"Import",icon:d},{id:"stats",label:"Statistics",icon:m}].map(e=>{const t=e.icon;return l.jsxs("button",{onClick:()=>j(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(f===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[l.jsx(t,{className:"w-4 h-4"}),l.jsx("span",{children:e.label})]},e.id)})})}),l.jsxs("div",{className:"p-6",children:["excel"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(h,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-blue-900",children:"Excel Integration"}),l.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Connect your Excel spreadsheets to FinanceAnalyst for seamless data synchronization."})]})]})}),l.jsx("button",{onClick:L,disabled:v,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:v?l.jsxs(l.Fragment,{children:[l.jsx(u,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(c,{className:"w-4 h-4 mr-2"}),"Export All Data"]})}),R&&l.jsx("div",{className:"border rounded-lg p-4 "+("success"===R.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:l.jsxs("div",{className:"flex items-start",children:["success"===R.type?l.jsx(g,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):l.jsx(p,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium "+("success"===R.type?"text-green-900":"text-red-900"),children:R.message}),"success"===R.type&&R.details&&l.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[l.jsx("p",{children:"Exported items:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4",children:[l.jsxs("li",{children:[R.details.dcfModels," DCF Models"]}),l.jsxs("li",{children:[R.details.lboModels," LBO Models"]}),l.jsxs("li",{children:[R.details.monteCarloResults," Monte Carlo Results"]}),l.jsxs("li",{children:[R.details.watchlists," Watchlists"]})]})]}),"error"===R.type&&l.jsx("p",{className:"text-sm text-red-700 mt-1",children:R.details})]})]})})]}),"templates"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Templates"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:k.map(e=>l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:e.name}),l.jsx("p",{className:"text-sm text-gray-600",children:e.category}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Last used: ",e.lastUsed]}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Uses: ",e.uses]})]},e.id))})]}),"collaboration"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Collaboration"}),l.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:A.map(e=>l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:e.name}),l.jsx("p",{className:"text-sm text-gray-600",children:e.email}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Role: ",e.role]}),l.jsxs("p",{className:"text-sm text-gray-600",children:["Last active: ",e.lastActive]})]},e.id))})]}),"export"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(h,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-blue-900",children:"Export Your Data"}),l.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Download all your financial models, analysis results, and preferences as a backup file."})]})]})}),l.jsx("button",{onClick:L,disabled:v,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:v?l.jsxs(l.Fragment,{children:[l.jsx(u,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):l.jsxs(l.Fragment,{children:[l.jsx(c,{className:"w-4 h-4 mr-2"}),"Export All Data"]})}),R&&l.jsx("div",{className:"border rounded-lg p-4 "+("success"===R.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:l.jsxs("div",{className:"flex items-start",children:["success"===R.type?l.jsx(g,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):l.jsx(p,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium "+("success"===R.type?"text-green-900":"text-red-900"),children:R.message}),"success"===R.type&&R.details&&l.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[l.jsx("p",{children:"Exported items:"}),l.jsxs("ul",{className:"list-disc list-inside ml-4",children:[l.jsxs("li",{children:[R.details.dcfModels," DCF Models"]}),l.jsxs("li",{children:[R.details.lboModels," LBO Models"]}),l.jsxs("li",{children:[R.details.monteCarloResults," Monte Carlo Results"]}),l.jsxs("li",{children:[R.details.watchlists," Watchlists"]})]})]}),"error"===R.type&&l.jsx("p",{className:"text-sm text-red-700 mt-1",children:R.details})]})]})})]}),"import"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:l.jsxs("div",{className:"flex items-start",children:[l.jsx(p,{className:"w-5 h-5 text-amber-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h3",{className:"font-medium text-amber-900",children:"Import Data"}),l.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Import data from a backup file. This will add to your existing data."})]})]})}),l.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[l.jsx(x,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),l.jsxs("label",{className:"cursor-pointer",children:[l.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Choose backup file"}),l.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Select a JSON backup file to import"}),l.jsx("input",{type:"file",accept:".json",onChange:async e=>{const t=e.target.files[0];if(t){C(!0),M(null);try{const e=await t.text(),a=JSON.parse(e);if(!a.data||!a.version)throw new Error("Invalid backup file format");const s=await I.importData(a);M({type:"success",message:"Data imported successfully",details:{importCount:s,timestamp:new Date(a.timestamp).toLocaleString()}}),await U(),b.log("INFO","Data import completed",{importCount:s})}catch(a){M({type:"error",message:"Import failed",details:a.message}),b.log("ERROR","Data import failed",{error:a.message})}finally{C(!1),e.target.value=""}}},disabled:N,className:"hidden"})]})]}),N&&l.jsxs("div",{className:"flex items-center justify-center py-4",children:[l.jsx(u,{className:"w-6 h-6 animate-spin text-blue-600 mr-2"}),l.jsx("span",{className:"text-gray-600",children:"Importing data..."})]}),S&&l.jsx("div",{className:"border rounded-lg p-4 "+("success"===S.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:l.jsxs("div",{className:"flex items-start",children:["success"===S.type?l.jsx(g,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):l.jsx(p,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),l.jsxs("div",{children:[l.jsx("h4",{className:"font-medium "+("success"===S.type?"text-green-900":"text-red-900"),children:S.message}),"success"===S.type&&S.details&&l.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[l.jsxs("p",{children:["Imported ",S.details.importCount," items"]}),l.jsxs("p",{children:["Backup created: ",S.details.timestamp]})]}),"error"===S.type&&l.jsx("p",{className:"text-sm text-red-700 mt-1",children:S.details})]})]})})]}),"stats"===f&&l.jsxs("div",{className:"space-y-4",children:[l.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Storage Statistics"}),E?l.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Storage Usage"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Total Size:"}),l.jsx("span",{className:"font-medium",children:(e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(E.totalSize)})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Total Items:"}),l.jsx("span",{className:"font-medium",children:E.itemCount})]}),E.quota&&l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Usage:"}),l.jsxs("span",{className:"font-medium",children:[(100*E.usageRatio).toFixed(1),"%"]})]})]})]}),l.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[l.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Financial Data"}),l.jsxs("div",{className:"space-y-2 text-sm",children:[l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"DCF Models:"}),l.jsx("span",{className:"font-medium",children:E.financialData.dcfModels})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"LBO Models:"}),l.jsx("span",{className:"font-medium",children:E.financialData.lboModels})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Monte Carlo Results:"}),l.jsx("span",{className:"font-medium",children:E.financialData.monteCarloResults})]}),l.jsxs("div",{className:"flex justify-between",children:[l.jsx("span",{children:"Watchlists:"}),l.jsx("span",{className:"font-medium",children:E.financialData.watchlists})]})]})]})]}):l.jsxs("div",{className:"flex items-center justify-center py-8",children:[l.jsx(u,{className:"w-6 h-6 animate-spin text-blue-600 mr-2"}),l.jsx("span",{className:"text-gray-600",children:"Loading statistics..."})]})]})]})]})})},F=r.lazy(()=>a(()=>import("./private-analysis-heavy-DbFWoyh2.js").then(e=>e.a),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),A=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.A),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),_=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.C),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),U=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.E),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),L=r.lazy(()=>a(()=>import("./private-analysis-heavy-DbFWoyh2.js").then(e=>e.E),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11]))),B=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.F),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),P=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.b),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),T=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.M),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2]))),q=r.lazy(()=>a(()=>import("./private-analysis-CjCiuYvO.js").then(e=>e.c),__vite__mapDeps([8,1,3,4,5,6,7,9,10,11,0,2])));class W extends r.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){}render(){return this.state.hasError?this.props.fallback||l.jsx("div",{className:"p-8 text-center text-red-400",children:"Something went wrong. Please refresh the page."}):this.props.children}}const z=()=>{const[a,i]=s.useState("spreadsheet"),[n,o]=s.useState({lbo:null,threeStatement:null,scenarios:null,marketData:null,monteCarlo:null}),[c,h]=s.useState(D),[u,g]=s.useState({}),[p,b]=s.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,taxRate:25},scenario:{scenarios:[]}}),[S,M]=s.useState(!1),[E,O]=s.useState(null),[I,z]=s.useState(()=>{try{const e=localStorage.getItem("privateAnalyses");return e?JSON.parse(e):[]}catch(e){return[]}}),[V,G]=s.useState(!1),[J,$]=s.useState("ready"),[K,Q]=s.useState(null),H=()=>{if(!c?.statements)return 0;let e=0,t=0;["totalRevenue","totalCostOfGoodsSold","operatingIncome","netIncome"].forEach(a=>{t+=3,void 0!==c.statements.incomeStatement?.[a]?.[2]&&(e+=3)}),["totalAssets","totalLiabilities","totalEquity"].forEach(a=>{t+=2,void 0!==c.statements.balanceSheet?.[a]?.[2]&&(e+=2)}),["operatingCashFlow","investingCashFlow","financingCashFlow"].forEach(a=>{t+=2,void 0!==c.statements.cashFlow?.[a]?.[2]&&(e+=2)});const a=Math.round(e/t*100);return void 0!==c?.statements?.incomeStatement?.totalRevenue?.[2]&&void 0!==c?.statements?.incomeStatement?.operatingIncome?.[2]?Math.max(a,80):a},Y=()=>{let e=0;return p?.dcf?.discountRate&&p?.dcf?.terminalGrowthRate&&(e+=40),H()>=80&&(e+=20),p?.scenario?.scenarios&&p.scenario.scenarios.length>0&&(e+=20),(n.lbo||n.threeStatement||n.monteCarlo)&&(e+=20),Math.min(e,100)},X=()=>{let e=0;return c?.statements?.incomeStatement&&(e+=30),n.lbo&&(e+=20),n.threeStatement&&(e+=20),n.scenarios&&(e+=15),n.monteCarlo&&(e+=15),Math.min(e,100)};s.useEffect(()=>{X()>60&&!S&&M(!0)},[c,n,S]);const Z=({status:e,label:t})=>l.jsxs("div",{className:`flex items-center gap-2 ${(()=>{switch(e){case"ready":return"text-green-400";case"modified":return"text-yellow-400";case"saving":return"text-blue-400";case"error":return"text-red-400";default:return"text-gray-400"}})()}`,children:[l.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse"}),l.jsx("span",{className:"text-sm",children:t})]}),ee=[{id:"spreadsheet",label:"Financial Spreadsheet",icon:m},{id:"modeling",label:"Financial Modeling",icon:j},{id:"analysis",label:"Analysis & Results",icon:x},{id:"lbo",label:"Advanced LBO",icon:j},{id:"threestatement",label:"3-Statement Model",icon:m},{id:"scenarios",label:"Scenario Analysis",icon:j},{id:"marketdata",label:"Market Data",icon:j},{id:"montecarlo",label:"Monte Carlo",icon:j},{id:"import-export",label:"Import/Export",icon:d}];return l.jsxs("div",{className:"min-h-screen bg-slate-900 relative",children:[l.jsx(v,{title:"Private Analysis Suite | FinanceAnalyst Pro",description:"Comprehensive financial analysis platform with advanced modeling tools, scenario analysis, Monte Carlo simulation, and private equity workflows.",canonical:"/private-analysis",keywords:"private analysis, financial modeling, scenario analysis, Monte Carlo simulation, LBO analysis, private equity tools"}),l.jsx(e,{}),l.jsxs("main",{id:"main-content",className:"container mx-auto px-4 py-8",role:"main",children:[l.jsxs("div",{className:"mb-8",children:[l.jsxs("div",{className:"flex items-center justify-between mb-4",children:[l.jsx("h1",{className:"text-3xl font-bold text-white",children:"Private Analysis"}),l.jsxs("div",{className:"flex items-center gap-4",children:[l.jsx(Z,{status:J,label:"ready"===J?"Ready":"saving"===J?"Saving...":"Modified"}),K&&l.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[l.jsx(y,{className:"w-4 h-4"}),l.jsxs("span",{className:"text-sm",children:["Saved ",K.toLocaleTimeString()]})]}),l.jsxs(t,{onClick:()=>(async()=>{try{G(!0),$("saving");const t={id:Date.now().toString(),name:`Analysis ${(new Date).toLocaleDateString()}`,timestamp:(new Date).toISOString(),financialData:c,adjustedValues:u,modelInputs:p,advancedResults:n,dataCompleteness:H(),modelingProgress:Y(),analysisProgress:X()},a=[...I,t];z(a);try{localStorage.setItem("privateAnalyses",JSON.stringify(a))}catch(e){throw new Error("Failed to save analysis to localStorage")}$("ready"),Q(new Date)}catch(e){$("error")}finally{G(!1)}})(),disabled:V,className:"flex items-center gap-2",variant:"primary",children:[l.jsx(f,{className:"w-4 h-4"}),V?"Saving...":"Save"]})]})]}),l.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[l.jsxs("div",{className:"bg-slate-800 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-gray-400",children:"Data Completeness"}),l.jsxs("span",{className:"text-white font-semibold",children:[H(),"%"]})]}),l.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:l.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-500",style:{width:`${H()}%`}})})]}),l.jsxs("div",{className:"bg-slate-800 rounded-lg p-4",children:[l.jsxs("div",{className:"flex items-center justify-between mb-2",children:[l.jsx("span",{className:"text-gray-400",children:"Analysis Progress"}),l.jsxs("span",{className:"text-white font-semibold",children:[X(),"%"]})]}),l.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:l.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${X()}%`}})})]})]})]}),l.jsx("div",{className:"mb-6",children:l.jsx("div",{className:"flex flex-wrap gap-2 p-1 bg-slate-800 rounded-lg",children:ee.map(e=>{const t=e.icon;return l.jsxs("button",{onClick:()=>i(e.id),className:`\n                    flex items-center gap-2 px-4 py-2 rounded-md transition-all duration-200\n                    ${a===e.id?"bg-blue-600 text-white shadow-lg":"text-gray-300 hover:text-white hover:bg-slate-700"}\n                  `,children:[l.jsx(t,{className:"w-4 h-4"}),l.jsx("span",{className:"text-sm font-medium",children:e.label})]},e.id)})})}),l.jsx("div",{className:"relative",children:l.jsxs(N.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:["spreadsheet"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading spreadsheet. Please refresh the page."}),children:l.jsx(P,{data:c,onDataChange:h,onAdjustedValuesChange:g})}),"modeling"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading modeling tools. Please refresh the page."}),children:l.jsx(T,{data:c,adjustedValues:u,onDataChange:h})}),"analysis"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading analysis results. Please check your data and refresh."}),children:l.jsx(A,{data:c,adjustedValues:u,modelInputs:p,calculateDCF:e=>w(e,p),formatCurrency:C,formatPercentage:R})}),"lbo"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading LBO tool. Please check your data."}),children:l.jsx(r.Suspense,{fallback:l.jsx("div",{className:"p-8 text-center text-blue-400",children:"Loading LBO Tool..."}),children:l.jsx(F,{data:c,onDataChange:e=>o(t=>({...t,lbo:e}))})})}),"threestatement"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading financial model workspace."}),children:l.jsx(r.Suspense,{fallback:l.jsx("div",{className:"p-8 text-center text-blue-400",children:"Loading Financial Model Workspace..."}),children:l.jsx(B,{data:c,onDataChange:e=>o(t=>({...t,threeStatement:e}))})})}),"scenarios"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading scenario analysis."}),children:l.jsx(r.Suspense,{fallback:l.jsx("div",{className:"p-8 text-center text-blue-400",children:"Loading Scenario Analysis..."}),children:l.jsx(L,{data:c,onDataChange:e=>o(t=>({...t,scenarios:e})),calculateDCF:e=>w(e,p),lboModelingEngine:null})})}),"marketdata"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading market data dashboard."}),children:l.jsx(r.Suspense,{fallback:l.jsx("div",{className:"p-8 text-center text-blue-400",children:"Loading Market Data Dashboard..."}),children:l.jsx(U,{data:c,onDataChange:e=>o(t=>({...t,marketData:e}))})})}),"montecarlo"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading Monte Carlo integration."}),children:l.jsx(r.Suspense,{fallback:l.jsx("div",{className:"p-8 text-center text-blue-400",children:"Loading Monte Carlo Analysis..."}),children:l.jsx(q,{data:c,dcfResults:n.dcf,lboResults:n.lbo,financialModel:n.threeStatement,scenarioResults:n.scenarios,onDataChange:e=>o(t=>({...t,monteCarlo:e}))})})}),"import-export"===a&&l.jsx(W,{fallback:l.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading import/export tools."}),children:l.jsx(k,{data:c,onDataChange:h,savedAnalyses:I,onAnalysesChange:z})})]},a)}),l.jsx(_,{financialData:c,currentMetric:E,analysisContext:"analysis"===a?"dcf":a,onInsightClick:e=>{O(e.metric)},isVisible:S,onToggle:()=>{M(!S)}})]})]})};export{z as default};
//# sourceMappingURL=PrivateAnalysis-Bmitbutq.js.map
