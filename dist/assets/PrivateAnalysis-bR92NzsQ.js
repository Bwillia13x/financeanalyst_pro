import{r as e,R as t,j as s,as as a,at as r,U as l,O as o,ae as i,au as n,I as c,av as d,v as m,x as h,F as u,ai as g,ad as x,h as p,aw as y}from"./react-core-LZql00V9.js";import{H as f,B as b}from"./ui-components-B6dtFGFZ.js";import{S as j}from"./valuation-tools-ByCr1zrB.js";import{F as v,M as w,A as N,b as C,E as R,c as D,C as S}from"./private-analysis-CULRlbZQ.js";import{a as M,E as O}from"./private-analysis-heavy-DbRFEumZ.js";import{a as E}from"./financial-engines-B7TnAHCU.js";import{g as I,b as k,f as F}from"./defaultFinancialData-Dvv1HwuD.js";import{m as A}from"./animations-PwArlWzR.js";import"./vendor-BUoS_Aj_.js";import"./ui-charts-B2uDbWNs.js";import"./utils-vendor-DofaKlSJ.js";import"./charts-vendor-EG81evMP.js";const U="1.0.0",B="financeanalyst_",L=1024,P=.8,W={dcfModel:{version:"1.0",required:["symbol","assumptions","projections","valuation"],structure:{symbol:"string",assumptions:"object",projections:"object",valuation:"object",metadata:"object"}},lboModel:{version:"1.0",required:["symbol","transaction","financing","returns"],structure:{symbol:"string",transaction:"object",financing:"object",returns:"object",metadata:"object"}},monteCarloResults:{version:"1.0",required:["modelType","iterations","results","statistics"],structure:{modelType:"string",iterations:"number",results:"array",statistics:"object",metadata:"object"}},userPreferences:{version:"1.0",required:["theme","layout"],structure:{theme:"string",layout:"object",notifications:"object",privacy:"object"}},marketData:{version:"1.0",required:["symbol","data","timestamp"],structure:{symbol:"string",data:"object",timestamp:"number",source:"string"}}},q=new class{constructor(){this.isAvailable=this.checkStorageAvailability(),this.compressionWorker=null,this.initializeCompression(),this.setupQuotaMonitoring()}checkStorageAvailability(){try{const e="__storage_test__";return localStorage.setItem(e,e),localStorage.removeItem(e),!0}catch(e){return E.log("ERROR","localStorage not available",{error:e.message}),!1}}initializeCompression(){"CompressionStream"in window?this.compressionAvailable=!0:this.compressionAvailable=!1}setupQuotaMonitoring(){"storage"in navigator&&"estimate"in navigator.storage&&this.monitorQuota()}async monitorQuota(){try{const e=await navigator.storage.estimate(),t=e.usage/e.quota;t>P&&(E.log("WARN","Storage quota threshold exceeded",{usage:e.usage,quota:e.quota,ratio:t}),await this.performCleanup())}catch(e){E.log("ERROR","Failed to monitor storage quota",{error:e.message})}}generateKey(e,t){return`${B}${e}_${t}`}validateData(e,t){const s=W[t];if(!s)throw new Error(`Unknown schema type: ${t}`);for(const a of s.required)if(!(a in e))throw new Error(`Missing required field: ${a}`);for(const[a,r]of Object.entries(s.structure))if(a in e){const t=Array.isArray(e[a])?"array":typeof e[a];if(t!==r)throw new Error(`Invalid type for ${a}: expected ${r}, got ${t}`)}return!0}async compressData(e){const t=JSON.stringify(e);if(t.length<L||!this.compressionAvailable)return{data:t,compressed:!1};try{return{data:await this.simpleCompress(t),compressed:!0}}catch(s){return E.log("WARN","Compression failed, storing uncompressed",{error:s.message}),{data:t,compressed:!1}}}async simpleCompress(e){return btoa(encodeURIComponent(e))}async decompressData(e,t){if(!t)return e;try{return decodeURIComponent(atob(e))}catch(s){throw E.log("ERROR","Decompression failed",{error:s.message}),new Error("Failed to decompress data")}}async setItem(e,t,s,a={}){if(!this.isAvailable)throw new Error("Storage not available");try{W[e]&&this.validateData(s,e);const r={version:U,schemaVersion:W[e]?.version||"1.0",timestamp:Date.now(),data:s,metadata:{type:e,identifier:t,size:JSON.stringify(s).length,...a.metadata}},{data:l,compressed:o}=await this.compressData(r),i={compressed:o,data:l},n=this.generateKey(e,t);return localStorage.setItem(n,JSON.stringify(i)),E.log("DEBUG","Data stored successfully",{key:n,type:e,identifier:t,compressed:o,size:l.length}),!0}catch(r){throw E.log("ERROR","Failed to store data",{type:e,identifier:t,error:r.message}),r}}async getItem(e,t){if(!this.isAvailable)return null;try{const s=this.generateKey(e,t),a=localStorage.getItem(s);if(!a)return null;const r=JSON.parse(a),l=await this.decompressData(r.data,r.compressed),o=JSON.parse(l);return o.version!==U&&E.log("WARN","Version mismatch detected",{stored:o.version,current:U}),E.log("DEBUG","Data retrieved successfully",{key:s,type:e,identifier:t,age:Date.now()-o.timestamp}),o.data}catch(s){return E.log("ERROR","Failed to retrieve data",{type:e,identifier:t,error:s.message}),null}}removeItem(e,t){if(!this.isAvailable)return!1;try{const s=this.generateKey(e,t);return localStorage.removeItem(s),E.log("DEBUG","Data removed successfully",{key:s,type:e,identifier:t}),!0}catch(s){return E.log("ERROR","Failed to remove data",{type:e,identifier:t,error:s.message}),!1}}listItems(e){if(!this.isAvailable)return[];const t=this.generateKey(e,""),s=[];for(let a=0;a<localStorage.length;a++){const e=localStorage.key(a);if(e&&e.startsWith(t)){const a=e.replace(t,"");s.push(a)}}return s}async performCleanup(){const e=Date.now()-2592e6;let t=0;for(let a=localStorage.length-1;a>=0;a--){const r=localStorage.key(a);if(r&&r.startsWith(B))try{const s=localStorage.getItem(r),a=JSON.parse(s),l=await this.decompressData(a.data,a.compressed);JSON.parse(l).timestamp<e&&(localStorage.removeItem(r),t++)}catch(s){localStorage.removeItem(r),t++}}return E.log("INFO","Storage cleanup completed",{cleanedCount:t}),t}async getStorageStats(){let e=0,t=0;const s={};for(let r=0;r<localStorage.length;r++){const a=localStorage.key(r);if(a&&a.startsWith(B)){e+=localStorage.getItem(a).length,t++;const r=a.split("_")[1];r&&(s[r]=(s[r]||0)+1)}}const a=await this.getQuotaInfo();return{totalSize:e,itemCount:t,typeStats:s,quota:a,usageRatio:a?e/a.quota:0}}async getQuotaInfo(){if("storage"in navigator&&"estimate"in navigator.storage)try{return await navigator.storage.estimate()}catch(e){E.log("ERROR","Failed to get quota info",{error:e.message})}return null}clearAll(){if(!this.isAvailable)return!1;const e=[];for(let t=0;t<localStorage.length;t++){const s=localStorage.key(t);s&&s.startsWith(B)&&e.push(s)}return e.forEach(e=>localStorage.removeItem(e)),E.log("INFO","All application data cleared",{clearedCount:e.length}),!0}},T=new class{constructor(){this.storage=q}async saveDCFModel(e,t){try{const s={symbol:e.toUpperCase(),assumptions:t.assumptions||{},projections:t.projections||{},valuation:t.valuation||{},metadata:{createdAt:Date.now(),lastModified:Date.now(),version:"1.0",modelType:"DCF",...t.metadata}};return await this.storage.setItem("dcfModel",e.toUpperCase(),s),E.log("INFO","DCF model saved",{symbol:e,valuation:s.valuation.intrinsicValue}),!0}catch(s){throw E.log("ERROR","Failed to save DCF model",{symbol:e,error:s.message}),s}}async getDCFModel(e){try{const t=await this.storage.getItem("dcfModel",e.toUpperCase());return t&&E.log("DEBUG","DCF model retrieved",{symbol:e}),t}catch(t){return E.log("ERROR","Failed to retrieve DCF model",{symbol:e,error:t.message}),null}}async listDCFModels(){return this.storage.listItems("dcfModel")}async deleteDCFModel(e){return this.storage.removeItem("dcfModel",e.toUpperCase())}async saveLBOModel(e,t){try{const s={symbol:e.toUpperCase(),transaction:t.transaction||{},financing:t.financing||{},returns:t.returns||{},metadata:{createdAt:Date.now(),lastModified:Date.now(),version:"1.0",modelType:"LBO",...t.metadata}};return await this.storage.setItem("lboModel",e.toUpperCase(),s),E.log("INFO","LBO model saved",{symbol:e,irr:s.returns.irr,moic:s.returns.moic}),!0}catch(s){throw E.log("ERROR","Failed to save LBO model",{symbol:e,error:s.message}),s}}async getLBOModel(e){try{const t=await this.storage.getItem("lboModel",e.toUpperCase());return t&&E.log("DEBUG","LBO model retrieved",{symbol:e}),t}catch(t){return E.log("ERROR","Failed to retrieve LBO model",{symbol:e,error:t.message}),null}}async listLBOModels(){return this.storage.listItems("lboModel")}async deleteLBOModel(e){return this.storage.removeItem("lboModel",e.toUpperCase())}async saveMonteCarloResults(e,t){try{const s={modelType:t.modelType||"DCF",iterations:t.iterations||1e4,results:t.results||[],statistics:t.statistics||{},metadata:{createdAt:Date.now(),modelId:e,symbol:t.symbol,version:"1.0",...t.metadata}};return await this.storage.setItem("monteCarloResults",e,s),E.log("INFO","Monte Carlo results saved",{modelId:e,iterations:s.iterations,mean:s.statistics.mean}),!0}catch(s){throw E.log("ERROR","Failed to save Monte Carlo results",{modelId:e,error:s.message}),s}}async getMonteCarloResults(e){try{const t=await this.storage.getItem("monteCarloResults",e);return t&&E.log("DEBUG","Monte Carlo results retrieved",{modelId:e}),t}catch(t){return E.log("ERROR","Failed to retrieve Monte Carlo results",{modelId:e,error:t.message}),null}}async listMonteCarloResults(){return this.storage.listItems("monteCarloResults")}async deleteMonteCarloResults(e){return this.storage.removeItem("monteCarloResults",e)}async saveMarketData(e,t,s=15){try{const a={symbol:e.toUpperCase(),data:t,timestamp:Date.now(),source:t.source||"unknown",expiresAt:Date.now()+60*s*1e3};return await this.storage.setItem("marketData",e.toUpperCase(),a),E.log("DEBUG","Market data cached",{symbol:e,source:a.source,ttlMinutes:s}),!0}catch(a){throw E.log("ERROR","Failed to cache market data",{symbol:e,error:a.message}),a}}async getMarketData(e){try{const t=await this.storage.getItem("marketData",e.toUpperCase());return t&&t.expiresAt>Date.now()?(E.log("DEBUG","Market data cache hit",{symbol:e}),t.data):(t&&(await this.deleteMarketData(e),E.log("DEBUG","Market data cache expired",{symbol:e})),null)}catch(t){return E.log("ERROR","Failed to retrieve market data",{symbol:e,error:t.message}),null}}async deleteMarketData(e){return this.storage.removeItem("marketData",e.toUpperCase())}async saveUserPreferences(e){try{const t={theme:e.theme||"light",layout:e.layout||{},notifications:e.notifications||{},privacy:e.privacy||{},metadata:{lastUpdated:Date.now(),version:"1.0"}};return await this.storage.setItem("userPreferences","default",t),E.log("INFO","User preferences saved",{theme:t.theme}),!0}catch(t){throw E.log("ERROR","Failed to save user preferences",{error:t.message}),t}}async getUserPreferences(){try{const e=await this.storage.getItem("userPreferences","default");return e&&E.log("DEBUG","User preferences retrieved"),e}catch(e){return E.log("ERROR","Failed to retrieve user preferences",{error:e.message}),null}}async saveWatchlist(e,t){try{const s={name:e,symbols:t.map(e=>e.toUpperCase()),metadata:{createdAt:Date.now(),lastModified:Date.now(),symbolCount:t.length}};return await this.storage.setItem("watchlist",e,s),E.log("INFO","Watchlist saved",{name:e,symbolCount:t.length}),!0}catch(s){throw E.log("ERROR","Failed to save watchlist",{name:e,error:s.message}),s}}async getWatchlist(e){try{const t=await this.storage.getItem("watchlist",e);return t&&E.log("DEBUG","Watchlist retrieved",{name:e}),t}catch(t){return E.log("ERROR","Failed to retrieve watchlist",{name:e,error:t.message}),null}}async listWatchlists(){return this.storage.listItems("watchlist")}async deleteWatchlist(e){return this.storage.removeItem("watchlist",e)}async exportAllData(){try{const e={timestamp:Date.now(),version:"1.0",data:{dcfModels:{},lboModels:{},monteCarloResults:{},watchlists:{},userPreferences:null}},t=await this.listDCFModels();for(const l of t)e.data.dcfModels[l]=await this.getDCFModel(l);const s=await this.listLBOModels();for(const l of s)e.data.lboModels[l]=await this.getLBOModel(l);const a=await this.listMonteCarloResults();for(const l of a)e.data.monteCarloResults[l]=await this.getMonteCarloResults(l);const r=await this.listWatchlists();for(const l of r)e.data.watchlists[l]=await this.getWatchlist(l);return e.data.userPreferences=await this.getUserPreferences(),E.log("INFO","Data export completed",{dcfCount:t.length,lboCount:s.length,mcCount:a.length,watchlistCount:r.length}),e}catch(e){throw E.log("ERROR","Failed to export data",{error:e.message}),e}}async importData(e){try{let t=0;if(e.data.dcfModels)for(const[s,a]of Object.entries(e.data.dcfModels))await this.saveDCFModel(s,a),t++;if(e.data.lboModels)for(const[s,a]of Object.entries(e.data.lboModels))await this.saveLBOModel(s,a),t++;if(e.data.monteCarloResults)for(const[s,a]of Object.entries(e.data.monteCarloResults))await this.saveMonteCarloResults(s,a),t++;if(e.data.watchlists)for(const[s,a]of Object.entries(e.data.watchlists))await this.saveWatchlist(s,a.symbols),t++;return e.data.userPreferences&&(await this.saveUserPreferences(e.data.userPreferences),t++),E.log("INFO","Data import completed",{importCount:t}),t}catch(t){throw E.log("ERROR","Failed to import data",{error:t.message}),t}}async getFinancialDataStats(){return{...await this.storage.getStorageStats(),financialData:{dcfModels:(await this.listDCFModels()).length,lboModels:(await this.listLBOModels()).length,monteCarloResults:(await this.listMonteCarloResults()).length,watchlists:(await this.listWatchlists()).length}}}async cleanupExpiredMarketData(){const e=this.storage.listItems("marketData");let t=0;for(const s of e){const e=await this.storage.getItem("marketData",s);e&&e.expiresAt<=Date.now()&&(await this.deleteMarketData(s),t++)}return E.log("INFO","Expired market data cleaned",{cleanedCount:t}),t}},G=({data:g,onDataChange:x,savedAnalyses:p,onAnalysesChange:y})=>{const[f,b]=e.useState("excel"),[j,v]=e.useState(!1),[w,N]=e.useState(!1),[C,R]=e.useState(null),[D,S]=e.useState(null),[M,O]=e.useState(null),[I,k]=e.useState([{id:1,name:"Standard 3-Statement Model",category:"General",lastUsed:"2024-01-15",uses:42},{id:2,name:"SaaS DCF Template",category:"Technology",lastUsed:"2024-01-10",uses:28},{id:3,name:"LBO Analysis Template",category:"Private Equity",lastUsed:"2024-01-05",uses:35}]),[F,A]=e.useState([{id:1,name:"John Smith",email:"john@company.com",role:"Analyst",lastActive:"2 min ago",avatar:"JS"},{id:2,name:"Sarah Johnson",email:"sarah@company.com",role:"VP",lastActive:"1 hour ago",avatar:"SJ"}]);t.useEffect(()=>{U()},[]);const U=async()=>{try{const e=await T.getFinancialDataStats();O(e)}catch(e){E.log("ERROR","Failed to load storage stats",{error:e.message})}},B=async()=>{v(!0),R(null);try{const e=await T.exportAllData(),t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(t),a=document.createElement("a");a.href=s,a.download=`financeanalyst_backup_${(new Date).toISOString().split("T")[0]}.json`,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(s),R({type:"success",message:"Data exported successfully",details:{dcfModels:Object.keys(e.data.dcfModels).length,lboModels:Object.keys(e.data.lboModels).length,monteCarloResults:Object.keys(e.data.monteCarloResults).length,watchlists:Object.keys(e.data.watchlists).length}}),E.log("INFO","Data export completed",{totalItems:Object.keys(e.data.dcfModels).length+Object.keys(e.data.lboModels).length+Object.keys(e.data.monteCarloResults).length+Object.keys(e.data.watchlists).length})}catch(e){R({type:"error",message:"Export failed",details:e.message}),E.log("ERROR","Data export failed",{error:e.message})}finally{v(!1)}};return s.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[s.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Data Management"}),s.jsx("button",{onClick:onClose,className:"text-gray-400 hover:text-gray-600 transition-colors",children:"×"})]}),s.jsx("div",{className:"border-b border-gray-200",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"excel",label:"Excel Integration",icon:a},{id:"templates",label:"Templates",icon:r},{id:"collaboration",label:"Collaboration",icon:l},{id:"export",label:"Export",icon:o},{id:"import",label:"Import",icon:i},{id:"stats",label:"Statistics",icon:n}].map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>b(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(f===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[s.jsx(t,{className:"w-4 h-4"}),s.jsx("span",{children:e.label})]},e.id)})})}),s.jsxs("div",{className:"p-6",children:["excel"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(c,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-blue-900",children:"Excel Integration"}),s.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Connect your Excel spreadsheets to FinanceAnalyst for seamless data synchronization."})]})]})}),s.jsx("button",{onClick:B,disabled:j,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:j?s.jsxs(s.Fragment,{children:[s.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(o,{className:"w-4 h-4 mr-2"}),"Export All Data"]})}),C&&s.jsx("div",{className:"border rounded-lg p-4 "+("success"===C.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:s.jsxs("div",{className:"flex items-start",children:["success"===C.type?s.jsx(m,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):s.jsx(h,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium "+("success"===C.type?"text-green-900":"text-red-900"),children:C.message}),"success"===C.type&&C.details&&s.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[s.jsx("p",{children:"Exported items:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4",children:[s.jsxs("li",{children:[C.details.dcfModels," DCF Models"]}),s.jsxs("li",{children:[C.details.lboModels," LBO Models"]}),s.jsxs("li",{children:[C.details.monteCarloResults," Monte Carlo Results"]}),s.jsxs("li",{children:[C.details.watchlists," Watchlists"]})]})]}),"error"===C.type&&s.jsx("p",{className:"text-sm text-red-700 mt-1",children:C.details})]})]})})]}),"templates"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Templates"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:I.map(e=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600",children:e.category}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Last used: ",e.lastUsed]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Uses: ",e.uses]})]},e.id))})]}),"collaboration"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Collaboration"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:F.map(e=>s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:e.name}),s.jsx("p",{className:"text-sm text-gray-600",children:e.email}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Role: ",e.role]}),s.jsxs("p",{className:"text-sm text-gray-600",children:["Last active: ",e.lastActive]})]},e.id))})]}),"export"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(c,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-blue-900",children:"Export Your Data"}),s.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"Download all your financial models, analysis results, and preferences as a backup file."})]})]})}),s.jsx("button",{onClick:B,disabled:j,className:"w-full bg-blue-600 text-white py-3 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center justify-center",children:j?s.jsxs(s.Fragment,{children:[s.jsx(d,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):s.jsxs(s.Fragment,{children:[s.jsx(o,{className:"w-4 h-4 mr-2"}),"Export All Data"]})}),C&&s.jsx("div",{className:"border rounded-lg p-4 "+("success"===C.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:s.jsxs("div",{className:"flex items-start",children:["success"===C.type?s.jsx(m,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):s.jsx(h,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium "+("success"===C.type?"text-green-900":"text-red-900"),children:C.message}),"success"===C.type&&C.details&&s.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[s.jsx("p",{children:"Exported items:"}),s.jsxs("ul",{className:"list-disc list-inside ml-4",children:[s.jsxs("li",{children:[C.details.dcfModels," DCF Models"]}),s.jsxs("li",{children:[C.details.lboModels," LBO Models"]}),s.jsxs("li",{children:[C.details.monteCarloResults," Monte Carlo Results"]}),s.jsxs("li",{children:[C.details.watchlists," Watchlists"]})]})]}),"error"===C.type&&s.jsx("p",{className:"text-sm text-red-700 mt-1",children:C.details})]})]})})]}),"import"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-4",children:s.jsxs("div",{className:"flex items-start",children:[s.jsx(h,{className:"w-5 h-5 text-amber-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h3",{className:"font-medium text-amber-900",children:"Import Data"}),s.jsx("p",{className:"text-sm text-amber-700 mt-1",children:"Import data from a backup file. This will add to your existing data."})]})]})}),s.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-8 text-center",children:[s.jsx(u,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),s.jsxs("label",{className:"cursor-pointer",children:[s.jsx("span",{className:"text-lg font-medium text-gray-900",children:"Choose backup file"}),s.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Select a JSON backup file to import"}),s.jsx("input",{type:"file",accept:".json",onChange:async e=>{const t=e.target.files[0];if(t){N(!0),S(null);try{const e=await t.text(),s=JSON.parse(e);if(!s.data||!s.version)throw new Error("Invalid backup file format");const a=await T.importData(s);S({type:"success",message:"Data imported successfully",details:{importCount:a,timestamp:new Date(s.timestamp).toLocaleString()}}),await U(),E.log("INFO","Data import completed",{importCount:a})}catch(s){S({type:"error",message:"Import failed",details:s.message}),E.log("ERROR","Data import failed",{error:s.message})}finally{N(!1),e.target.value=""}}},disabled:w,className:"hidden"})]})]}),w&&s.jsxs("div",{className:"flex items-center justify-center py-4",children:[s.jsx(d,{className:"w-6 h-6 animate-spin text-blue-600 mr-2"}),s.jsx("span",{className:"text-gray-600",children:"Importing data..."})]}),D&&s.jsx("div",{className:"border rounded-lg p-4 "+("success"===D.type?"bg-green-50 border-green-200":"bg-red-50 border-red-200"),children:s.jsxs("div",{className:"flex items-start",children:["success"===D.type?s.jsx(m,{className:"w-5 h-5 text-green-600 mt-0.5 mr-3"}):s.jsx(h,{className:"w-5 h-5 text-red-600 mt-0.5 mr-3"}),s.jsxs("div",{children:[s.jsx("h4",{className:"font-medium "+("success"===D.type?"text-green-900":"text-red-900"),children:D.message}),"success"===D.type&&D.details&&s.jsxs("div",{className:"text-sm text-green-700 mt-2",children:[s.jsxs("p",{children:["Imported ",D.details.importCount," items"]}),s.jsxs("p",{children:["Backup created: ",D.details.timestamp]})]}),"error"===D.type&&s.jsx("p",{className:"text-sm text-red-700 mt-1",children:D.details})]})]})})]}),"stats"===f&&s.jsxs("div",{className:"space-y-4",children:[s.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Storage Statistics"}),M?s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Storage Usage"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Size:"}),s.jsx("span",{className:"font-medium",children:(e=>{if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]})(M.totalSize)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Total Items:"}),s.jsx("span",{className:"font-medium",children:M.itemCount})]}),M.quota&&s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Usage:"}),s.jsxs("span",{className:"font-medium",children:[(100*M.usageRatio).toFixed(1),"%"]})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Financial Data"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"DCF Models:"}),s.jsx("span",{className:"font-medium",children:M.financialData.dcfModels})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"LBO Models:"}),s.jsx("span",{className:"font-medium",children:M.financialData.lboModels})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Monte Carlo Results:"}),s.jsx("span",{className:"font-medium",children:M.financialData.monteCarloResults})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Watchlists:"}),s.jsx("span",{className:"font-medium",children:M.financialData.watchlists})]})]})]})]}):s.jsxs("div",{className:"flex items-center justify-center py-8",children:[s.jsx(d,{className:"w-6 h-6 animate-spin text-blue-600 mr-2"}),s.jsx("span",{className:"text-gray-600",children:"Loading statistics..."})]})]})]})]})})};class J extends t.Component{constructor(e){super(e),this.state={hasError:!1}}static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){}render(){return this.state.hasError?this.props.fallback||s.jsx("div",{className:"p-8 text-center text-red-400",children:"Something went wrong. Please refresh the page."}):this.props.children}}const $=()=>{const[t,a]=e.useState("spreadsheet"),[r,l]=e.useState({lbo:null,threeStatement:null,scenarios:null,marketData:null,monteCarlo:null}),[o,c]=e.useState(I),[d,m]=e.useState({}),[h,E]=e.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,taxRate:25},scenario:{scenarios:[]}}),[U,B]=e.useState(!1),[L,P]=e.useState(null),[W,q]=e.useState(()=>{try{const e=localStorage.getItem("privateAnalyses");return e?JSON.parse(e):[]}catch(e){return[]}}),[T,$]=e.useState(!1),[_,z]=e.useState("ready"),[V,K]=e.useState(null),Q=()=>{if(!o?.statements)return 0;let e=0,t=0;["totalRevenue","totalCostOfGoodsSold","operatingIncome","netIncome"].forEach(s=>{t+=3,void 0!==o.statements.incomeStatement?.[s]?.[2]&&(e+=3)}),["totalAssets","totalLiabilities","totalEquity"].forEach(s=>{t+=2,void 0!==o.statements.balanceSheet?.[s]?.[2]&&(e+=2)}),["operatingCashFlow","investingCashFlow","financingCashFlow"].forEach(s=>{t+=2,void 0!==o.statements.cashFlow?.[s]?.[2]&&(e+=2)});const s=Math.round(e/t*100);return void 0!==o?.statements?.incomeStatement?.totalRevenue?.[2]&&void 0!==o?.statements?.incomeStatement?.operatingIncome?.[2]?Math.max(s,80):s},Y=()=>{let e=0;return h?.dcf?.discountRate&&h?.dcf?.terminalGrowthRate&&(e+=40),Q()>=80&&(e+=20),h?.scenario?.scenarios&&h.scenario.scenarios.length>0&&(e+=20),(r.lbo||r.threeStatement||r.monteCarlo)&&(e+=20),Math.min(e,100)},H=()=>{let e=0;return o?.statements?.incomeStatement&&(e+=30),r.lbo&&(e+=20),r.threeStatement&&(e+=20),r.scenarios&&(e+=15),r.monteCarlo&&(e+=15),Math.min(e,100)};e.useEffect(()=>{H()>60&&!U&&B(!0)},[o,r,U]);const X=({status:e,label:t})=>s.jsxs("div",{className:`flex items-center gap-2 ${(()=>{switch(e){case"ready":return"text-green-400";case"modified":return"text-yellow-400";case"saving":return"text-blue-400";case"error":return"text-red-400";default:return"text-gray-400"}})()}`,children:[s.jsx("div",{className:"w-2 h-2 rounded-full bg-current animate-pulse"}),s.jsx("span",{className:"text-sm",children:t})]}),Z=[{id:"spreadsheet",label:"Financial Spreadsheet",icon:n},{id:"modeling",label:"Financial Modeling",icon:p},{id:"analysis",label:"Analysis & Results",icon:u},{id:"lbo",label:"Advanced LBO",icon:p},{id:"threestatement",label:"3-Statement Model",icon:n},{id:"scenarios",label:"Scenario Analysis",icon:p},{id:"marketdata",label:"Market Data",icon:p},{id:"montecarlo",label:"Monte Carlo",icon:p},{id:"import-export",label:"Import/Export",icon:i}];return s.jsxs("div",{className:"min-h-screen bg-slate-900 relative",children:[s.jsx(j,{title:"Private Analysis Suite | FinanceAnalyst Pro",description:"Comprehensive financial analysis platform with advanced modeling tools, scenario analysis, Monte Carlo simulation, and private equity workflows.",canonical:"/private-analysis",keywords:"private analysis, financial modeling, scenario analysis, Monte Carlo simulation, LBO analysis, private equity tools"}),s.jsx(f,{}),s.jsxs("main",{id:"main-content",className:"container mx-auto px-4 py-8",role:"main",children:[s.jsxs("div",{className:"mb-8",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h1",{className:"text-3xl font-bold text-white",children:"Private Analysis"}),s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(X,{status:_,label:"ready"===_?"Ready":"saving"===_?"Saving...":"Modified"}),V&&s.jsxs("div",{className:"flex items-center gap-2 text-gray-400",children:[s.jsx(g,{className:"w-4 h-4"}),s.jsxs("span",{className:"text-sm",children:["Saved ",V.toLocaleTimeString()]})]}),s.jsxs(b,{onClick:()=>(async()=>{try{$(!0),z("saving");const t={id:Date.now().toString(),name:`Analysis ${(new Date).toLocaleDateString()}`,timestamp:(new Date).toISOString(),financialData:o,adjustedValues:d,modelInputs:h,advancedResults:r,dataCompleteness:Q(),modelingProgress:Y(),analysisProgress:H()},s=[...W,t];q(s);try{localStorage.setItem("privateAnalyses",JSON.stringify(s))}catch(e){throw new Error("Failed to save analysis to localStorage")}z("ready"),K(new Date)}catch(e){z("error")}finally{$(!1)}})(),disabled:T,className:"flex items-center gap-2",variant:"primary",children:[s.jsx(x,{className:"w-4 h-4"}),T?"Saving...":"Save"]})]})]}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[s.jsxs("div",{className:"bg-slate-800 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-400",children:"Data Completeness"}),s.jsxs("span",{className:"text-white font-semibold",children:[Q(),"%"]})]}),s.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:s.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-500",style:{width:`${Q()}%`}})})]}),s.jsxs("div",{className:"bg-slate-800 rounded-lg p-4",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-gray-400",children:"Analysis Progress"}),s.jsxs("span",{className:"text-white font-semibold",children:[H(),"%"]})]}),s.jsx("div",{className:"w-full bg-slate-700 rounded-full h-2",children:s.jsx("div",{className:"bg-green-500 h-2 rounded-full transition-all duration-500",style:{width:`${H()}%`}})})]})]})]}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"flex flex-wrap gap-2 p-1 bg-slate-800 rounded-lg",children:Z.map(e=>{const r=e.icon;return s.jsxs("button",{onClick:()=>a(e.id),className:`\n                    flex items-center gap-2 px-4 py-2 rounded-md transition-all duration-200\n                    ${t===e.id?"bg-blue-600 text-white shadow-lg":"text-gray-300 hover:text-white hover:bg-slate-700"}\n                  `,children:[s.jsx(r,{className:"w-4 h-4"}),s.jsx("span",{className:"text-sm font-medium",children:e.label})]},e.id)})})}),s.jsx("div",{className:"relative",children:s.jsxs(A.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.2},children:["spreadsheet"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading spreadsheet. Please refresh the page."}),children:s.jsx(v,{data:o,onDataChange:c,onAdjustedValuesChange:m})}),"modeling"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading modeling tools. Please refresh the page."}),children:s.jsx(w,{data:o,adjustedValues:d,onDataChange:c})}),"analysis"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading analysis results. Please check your data and refresh."}),children:s.jsx(N,{data:o,adjustedValues:d,modelInputs:h,calculateDCF:e=>y(e,h),formatCurrency:F,formatPercentage:k})}),"lbo"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading LBO tool. Please check your data."}),children:s.jsx(M,{data:o,onDataChange:e=>l(t=>({...t,lbo:e}))})}),"threestatement"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading financial model workspace."}),children:s.jsx(C,{data:o,onDataChange:e=>l(t=>({...t,threeStatement:e}))})}),"scenarios"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading scenario analysis."}),children:s.jsx(O,{data:o,onDataChange:e=>l(t=>({...t,scenarios:e})),calculateDCF:e=>y(e,h),lboModelingEngine:null})}),"marketdata"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading market data dashboard."}),children:s.jsx(R,{data:o,onDataChange:e=>l(t=>({...t,marketData:e}))})}),"montecarlo"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading Monte Carlo integration."}),children:s.jsx(D,{data:o,dcfResults:r.dcf,lboResults:r.lbo,financialModel:r.threeStatement,scenarioResults:r.scenarios,onDataChange:e=>l(t=>({...t,monteCarlo:e}))})}),"import-export"===t&&s.jsx(J,{fallback:s.jsx("div",{className:"p-8 text-center text-red-400",children:"Error loading import/export tools."}),children:s.jsx(G,{data:o,onDataChange:c,savedAnalyses:W,onAnalysesChange:q})})]},t)}),s.jsx(S,{financialData:o,currentMetric:L,analysisContext:"analysis"===t?"dcf":t,onInsightClick:e=>{P(e.metric)},isVisible:U,onToggle:()=>{B(!U)}})]})]})};export{$ as default};
//# sourceMappingURL=PrivateAnalysis-bR92NzsQ.js.map
