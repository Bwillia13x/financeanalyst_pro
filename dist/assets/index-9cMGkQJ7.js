import{j as e,c as s,I as t}from"./index-xYEbf7FX.js";import{R as a,r}from"./react-vendor-BaLqnLcQ.js";import{B as n}from"./Button-DCLNLQvv.js";import{H as i}from"./Header-ClTVm1uh.js";import{a as o,d as c}from"./dataFetching-CrSJiL9f.js";import{a as l}from"./data-vendor-B1ga0eaz.js";import{a as d}from"./utils-vendor-Cj_bvvWu.js";import{P as m}from"./charts-vendor-D2zAVpJz.js";import{W as u,K as h,T as p,a as x,b as g}from"./ui-vendor-Cvmjbkc9.js";import{I as f}from"./Input-Bq9tbhCz.js";const b=new class{constructor(){this.validationRules=this.initializeValidationRules(),this.qualityMetrics=new Map,this.anomalyDetection=new Map}initializeValidationRules(){return{marketData:{required:["symbol","currentPrice","volume"],numeric:["currentPrice","previousClose","change","changePercent","volume","marketCap"],ranges:{currentPrice:{min:0,max:1e5},volume:{min:0,max:1e12},changePercent:{min:-50,max:50}},formats:{symbol:/^[A-Z]{1,5}$/,timestamp:/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/}},financialStatements:{required:["revenue","netIncome"],numeric:["revenue","netIncome","totalDebt","cashAndCashEquivalents"],ranges:{revenue:{min:0,max:1e12},netIncome:{min:-1e11,max:1e11}}},companyProfile:{required:["symbol","companyName","sector"],numeric:["mktCap","pe","pb","beta"],ranges:{pe:{min:0,max:1e3},pb:{min:0,max:100},beta:{min:-5,max:5}}},dcfModel:{required:["cashFlows","discountRate"],numeric:["discountRate","terminalGrowthRate","years"],custom:e=>{const s=[];return Array.isArray(e.cashFlows)&&0!==e.cashFlows.length||s.push("Cash flows must be a non-empty array"),e.discountRate<0&&s.push("Discount rate must be non-negative"),{errors:s,warnings:[]}}},lboModel:{required:["purchasePrice","debtFinancing","equityFinancing"],numeric:["purchasePrice","debtFinancing","equityFinancing","exitMultiple","holdingPeriod"],custom:e=>{const s=[],t=[];if(e.debtFinancing&&e.equityFinancing&&e.purchasePrice){const a=e.debtFinancing+e.equityFinancing;Math.abs(a-e.purchasePrice)>.01&&s.push("Debt + Equity must equal purchase price");e.debtFinancing/e.purchasePrice>.9&&t.push("High leverage ratio detected")}return{errors:s,warnings:t}}},stockData:{required:["symbol","price"],numeric:["price","volume","change","changePercent"],custom:e=>{const s=[];return e.symbol&&"string"==typeof e.symbol&&""!==e.symbol.trim()||s.push("Symbol is required and must be a non-empty string"),("number"!=typeof e.price||e.price<0)&&s.push("Price must be a positive number"),{errors:s,warnings:[]}}}}}validateData(e,s){try{const t=this.validationRules[s];if(!t)return{isValid:!1,errors:[`Unknown data type: ${s}`]};const a=[],r=[];for(const s of t.required||[])void 0!==e[s]&&null!==e[s]||a.push(`Missing required field: ${s}`);for(const s of t.numeric||[])if(void 0!==e[s]&&null!==e[s]){const n=parseFloat(e[s]);if(isNaN(n))a.push(`Field ${s} must be numeric, got: ${e[s]}`);else{const e=t.ranges?.[s];e&&(n<e.min||n>e.max)&&r.push(`Field ${s} value ${n} outside expected range [${e.min}, ${e.max}]`)}}for(const[s,o]of Object.entries(t.formats||{}))e[s]&&!o.test(e[s])&&a.push(`Field ${s} format invalid: ${e[s]}`);const n=this.validateBusinessLogic(e,s);if(a.push(...n.errors),r.push(...n.warnings),t.custom){const s=t.custom(e);a.push(...s.errors||[]),r.push(...s.warnings||[])}const i=0===a.length;return i?r.length>0&&o.log("WARN",`Data validation warnings for ${s}`,{warnings:r}):o.log("ERROR",`Data validation failed for ${s}`,{errors:a,warnings:r}),{isValid:i,errors:a,warnings:r,qualityScore:this.calculateQualityScore(a,r)}}catch(t){return{isValid:!1,errors:["An unexpected error occurred during validation."],warnings:[]}}}validateBusinessLogic(e,s){const t=[],a=[];switch(s){case"marketData":if(e.currentPrice&&e.previousClose){const s=e.currentPrice-e.previousClose,t=s/e.previousClose*100;e.change&&Math.abs(e.change-s)>.01&&a.push(`Price change inconsistency: reported ${e.change}, calculated ${s.toFixed(2)}`),e.changePercent&&Math.abs(e.changePercent-t)>.1&&a.push(`Change percent inconsistency: reported ${e.changePercent}%, calculated ${t.toFixed(2)}%`)}e.currentPrice&&e.dayHigh&&e.dayLow&&(e.currentPrice>e.dayHigh&&a.push(`Current price ${e.currentPrice} exceeds day high ${e.dayHigh}`),e.currentPrice<e.dayLow&&a.push(`Current price ${e.currentPrice} below day low ${e.dayLow}`),e.dayLow>e.dayHigh&&t.push(`Day low ${e.dayLow} greater than day high ${e.dayHigh}`));break;case"financialStatements":if(e.revenue&&e.netIncome){const s=e.netIncome/e.revenue*100;(s<-100||s>100)&&a.push(`Unusual net profit margin: ${s.toFixed(2)}%`)}if(e.totalCurrentAssets&&e.totalCurrentLiabilities){const s=e.totalCurrentAssets/e.totalCurrentLiabilities;(s<.1||s>20)&&a.push(`Unusual current ratio: ${s.toFixed(2)}`)}break;case"companyProfile":e.pe&&(e.pe<0||e.pe>500)&&a.push(`Unusual P/E ratio: ${e.pe}`),e.pb&&(e.pb<0||e.pb>50)&&a.push(`Unusual P/B ratio: ${e.pb}`)}return{errors:t,warnings:a}}calculateQualityScore(e,s){return e.length>0?Math.max(0,50-10*e.length):Math.max(70,100-5*s.length)}crossValidateData(e,s){if(e.length<2)return{isConsistent:!0,discrepancies:[],recommendedSource:e[0]?.source};const t=[],a=this.validationRules[s]?.numeric||[];for(const i of a){const s=e.filter(e=>void 0!==e[i]&&null!==e[i]).map(e=>({value:parseFloat(e[i]),source:e.source}));if(s.length>1){const e=s.reduce((e,s)=>e+s.value,0)/s.length,a=Math.max(...s.map(s=>Math.abs(s.value-e))),r=.05*e;a>r&&t.push({field:i,values:s,mean:e,maxDeviation:a,threshold:r})}}const r=e.map(e=>{const t=this.validateData(e,s);return{source:e.source,qualityScore:t.qualityScore,errorCount:t.errors.length,warningCount:t.warnings.length}}),n=r.sort((e,s)=>s.qualityScore-e.qualityScore)[0]?.source;return{isConsistent:0===t.length,discrepancies:t,sourceQuality:r,recommendedSource:n}}detectAnomalies(e,s){if(e.length<10)return[];const t=e.map(e=>parseFloat(e[s])).filter(e=>!isNaN(e)),a=t.reduce((e,s)=>e+s,0)/t.length,r=t.reduce((e,s)=>e+Math.pow(s-a,2),0)/t.length,n=Math.sqrt(r),i=[];return e.forEach((e,t)=>{const r=parseFloat(e[s]);if(!isNaN(r)){const s=Math.abs((r-a)/n);s>2.5&&i.push({index:t,timestamp:e.timestamp,value:r,zScore:s,deviation:r-a,severity:s>3?"high":"medium"})}}),i}getValidationSummary(e,s){const t=this.validateData(e,s);return{dataType:s,timestamp:(new Date).toISOString(),isValid:t.isValid,qualityScore:t.qualityScore,errorCount:t.errors.length,warningCount:t.warnings.length,completeness:this.calculateCompleteness(e,s),freshness:this.calculateFreshness(e),source:e.source||"unknown"}}calculateCompleteness(e,s){const t=this.validationRules[s];if(!t)return 0;const a=[...t.required||[],...t.numeric||[],...Object.keys(t.formats||{})],r=[...new Set(a)];return r.filter(s=>void 0!==e[s]&&null!==e[s]&&""!==e[s]).length/r.length*100}calculateFreshness(e){if(!e.timestamp)return 50;const s=new Date(e.timestamp),t=(new Date-s)/6e4;return t<5?100:t<15?90:t<60?80:t<240?70:t<1440?60:40}sanitizeInput(e){if(null==e)return"";return String(e).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<[^>]*>/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"")}isInRange(e,s,t){return"number"==typeof e&&e>=s&&e<=t}isValidPercentage(e){return"number"==typeof e&&e>=0&&e<=1}isValidNumber(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}isValidArray(e){return Array.isArray(e)}isValidObject(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}validateFinancialRatios(e){const s=[],t=[];return e.currentRatio<1&&t.push("Current ratio below 1.0 indicates potential liquidity issues"),e.debtToEquity>2&&t.push("High debt-to-equity ratio indicates high leverage"),e.returnOnEquity<0&&t.push("Negative return on equity indicates poor performance"),{isValid:0===s.length,errors:s,warnings:t}}},y={baseURL:"https://www.alphavantage.co/query"},v={baseURL:"https://query1.finance.yahoo.com/v8/finance/chart"},N={marketData:["YAHOO_FINANCE","ALPHA_VANTAGE"],financialStatements:["FMP","ALPHA_VANTAGE"],companyProfile:["FMP","ALPHA_VANTAGE"],secFilings:["SEC_EDGAR"],economicData:["FRED","QUANDL"],peers:["FMP"]};const j=new class{constructor(){this.rateLimiters=new Map,this.sourceHealth=new Map,this.lastRequests=new Map,this.apiKeys=this.loadApiKeys(),this.initializeSourceHealth()}loadApiKeys(){const e={ALPHA_VANTAGE:"your_alpha_vantage_api_key_here",FMP:"your_fmp_api_key_here",QUANDL:void 0,FRED:void 0},s=Object.entries(e).filter(([e,s])=>s&&"demo"!==s).map(([e,s])=>e);return o.log("INFO","API keys loaded",{availableKeys:s,totalKeys:s.length}),e}initializeSourceHealth(){["ALPHA_VANTAGE","FMP","YAHOO_FINANCE","SEC_EDGAR","QUANDL","FRED"].forEach(e=>{this.sourceHealth.set(e,{status:"unknown",successRate:1,avgResponseTime:0,lastError:null,requestCount:0,errorCount:0,lastHealthCheck:null})})}hasValidApiKey(e){const s=this.apiKeys[e];return s&&"demo"!==s&&s.length>5}getBestSource(e){const s=N[e]||[];for(const t of s){const e=this.sourceHealth.get(t);if(e&&"error"!==e.status){if(!this.requiresApiKey(t))return t;if(this.hasValidApiKey(t))return t}}return s[0]||"YAHOO_FINANCE"}requiresApiKey(e){return["ALPHA_VANTAGE","FMP","QUANDL","FRED"].includes(e)}async fetchRealTimeMarketData(e,s={}){const t=this.getBestSource("marketData");try{let a;switch(t){case"YAHOO_FINANCE":a=await this.fetchFromYahooFinance(e,s);break;case"ALPHA_VANTAGE":a=await this.fetchFromAlphaVantage(e,"GLOBAL_QUOTE",s);break;default:throw new Error(`Unsupported source for market data: ${t}`)}return this.updateSourceHealth(t,!0,Date.now()),this.normalizeMarketData(a,t)}catch(a){this.updateSourceHealth(t,!1,Date.now(),a);if(N.marketData.filter(e=>e!==t).length>0)return o.log("WARN",`Primary source ${t} failed, trying fallback`,{error:a.message}),this.fetchRealTimeMarketData(e,{...s,excludeSource:t});throw a}}async fetchFromYahooFinance(e,s={}){const t=`${v.baseURL}/${e}`,a={range:s.range||"1d",interval:s.interval||"1m",includePrePost:!0,events:"div,splits"},r=await l.get(t,{params:a,timeout:1e4,headers:{"User-Agent":"FinanceAnalyst-Pro/1.0"}});if(!r.data?.chart?.result?.[0])throw new Error(`No data found for symbol: ${e}`);return r.data.chart.result[0]}async fetchFromAlphaVantage(e,s,t={}){if(!this.hasValidApiKey("ALPHA_VANTAGE"))throw new Error("Alpha Vantage API key not available");const a=y,r={function:s,symbol:e,apikey:this.apiKeys.ALPHA_VANTAGE,...t.params},n=await l.get(a.baseURL,{params:r,timeout:15e3});if(n.data["Error Message"])throw new Error(`Alpha Vantage error: ${n.data["Error Message"]}`);if(n.data.Note)throw new Error(`Alpha Vantage rate limit: ${n.data.Note}`);return n.data}async fetchComprehensiveData(e){const s={},t={},a=[{key:"marketData",method:"fetchRealTimeMarketData"},{key:"profile",method:"fetchCompanyProfile"},{key:"financials",method:"fetchFinancialStatements"},{key:"peers",method:"fetchPeerComparison"}].map(async({key:a,method:r})=>{try{s[a]="fetchFinancialStatements"===r?await c[r](e,"income-statement"):"fetchPeerComparison"===r?await c[r](e):await this[r](e)}catch(n){t[a]=n.message,o.log("ERROR",`Failed to fetch ${a} for ${e}`,{error:n.message})}});return await Promise.allSettled(a),{symbol:e,timestamp:(new Date).toISOString(),data:s,errors:Object.keys(t).length>0?t:null,sources:this.getSourcesUsed(s)}}normalizeMarketData(e,s){switch(s){case"YAHOO_FINANCE":return this.normalizeYahooData(e);case"ALPHA_VANTAGE":return this.normalizeAlphaVantageData(e);default:return e}}normalizeYahooData(e){const s=e.meta,t=e.indicators?.quote?.[0],a=t?{open:t.open[t.open.length-1],high:t.high[t.high.length-1],low:t.low[t.low.length-1],close:t.close[t.close.length-1],volume:t.volume[t.volume.length-1]}:{};return{symbol:s.symbol,currentPrice:s.regularMarketPrice||a.close,previousClose:s.previousClose,change:s.regularMarketPrice-s.previousClose,changePercent:(s.regularMarketPrice-s.previousClose)/s.previousClose*100,dayHigh:s.regularMarketDayHigh||a.high,dayLow:s.regularMarketDayLow||a.low,volume:s.regularMarketVolume||a.volume,marketCap:s.marketCap,currency:s.currency,exchangeName:s.exchangeName,timestamp:new Date(1e3*s.regularMarketTime).toISOString(),source:"YAHOO_FINANCE"}}normalizeAlphaVantageData(e){const s=e["Global Quote"];if(!s)throw new Error("Invalid Alpha Vantage response format");return{symbol:s["01. symbol"],currentPrice:parseFloat(s["05. price"]),previousClose:parseFloat(s["08. previous close"]),change:parseFloat(s["09. change"]),changePercent:parseFloat(s["10. change percent"].replace("%","")),dayHigh:parseFloat(s["03. high"]),dayLow:parseFloat(s["04. low"]),volume:parseInt(s["06. volume"]),timestamp:s["07. latest trading day"],source:"ALPHA_VANTAGE"}}updateSourceHealth(e,s,t,a=null){const r=this.sourceHealth.get(e);r&&(r.requestCount++,s?(r.status="healthy",r.lastError=null):(r.errorCount++,r.lastError=a?.message||"Unknown error",r.status="error"),r.successRate=(r.requestCount-r.errorCount)/r.requestCount,r.avgResponseTime=(r.avgResponseTime+t)/2,r.lastHealthCheck=(new Date).toISOString(),this.sourceHealth.set(e,r))}getSourceHealthStatus(){const e={};for(const[s,t]of this.sourceHealth.entries())e[s]={...t,hasValidApiKey:this.hasValidApiKey(s),requiresApiKey:this.requiresApiKey(s)};return e}getSourcesUsed(e){const s=new Set;return Object.values(e).forEach(e=>{e?.source&&s.add(e.source)}),Array.from(s)}};const w=new class{constructor(){this.subscribers=new Map,this.activeStreams=new Map,this.pollingIntervals=new Map,this.connectionStatus=new Map,this.lastUpdateTimes=new Map,this.updateIntervals={marketData:5e3,quotes:1e3,news:3e4,fundamentals:3e5},this.maxRetries=3,this.retryDelay=2e3}subscribe(e,s,t){const a=`${e}_${s}_${Date.now()}`,r=`${e}_${s}`;return this.subscribers.has(r)||this.subscribers.set(r,new Map),this.subscribers.get(r).set(a,t),1===this.subscribers.get(r).size&&this.startStream(e,s),o.log("INFO",`Subscribed to ${s} for ${e}`,{subscriptionId:a,totalSubscribers:this.subscribers.get(r).size}),a}unsubscribe(e){for(const[s,t]of this.subscribers.entries())if(t.has(e)){if(t.delete(e),0===t.size){const[e,t]=s.split("_");this.stopStream(e,t),this.subscribers.delete(s)}o.log("INFO",`Unsubscribed from ${s}`,{subscriptionId:e,remainingSubscribers:t.size});break}}async startStream(e,s){const t=`${e}_${s}`;if(!this.activeStreams.has(t)){this.activeStreams.set(t,!0),this.connectionStatus.set(t,"connecting");try{this.supportsWebSocket(s)?await this.startWebSocketStream(e,s):await this.startPollingStream(e,s),this.connectionStatus.set(t,"connected"),o.log("INFO",`Started real-time stream for ${e} ${s}`)}catch(a){this.connectionStatus.set(t,"error"),o.log("ERROR",`Failed to start stream for ${e} ${s}`,{error:a.message}),this.supportsWebSocket(s)&&await this.startPollingStream(e,s)}}}stopStream(e,s){const t=`${e}_${s}`;this.pollingIntervals.has(t)&&(clearInterval(this.pollingIntervals.get(t)),this.pollingIntervals.delete(t)),this.activeStreams.has(t)&&this.activeStreams.delete(t),this.connectionStatus.set(t,"disconnected"),o.log("INFO",`Stopped real-time stream for ${e} ${s}`)}async startWebSocketStream(e,s){throw new Error("WebSocket streaming not yet implemented")}async startPollingStream(e,s){const t=`${e}_${s}`,a=this.updateIntervals[s]||1e4;await this.fetchAndBroadcast(e,s);const r=setInterval(async()=>{try{await this.fetchAndBroadcast(e,s)}catch(t){o.log("ERROR",`Polling error for ${e} ${s}`,{error:t.message})}},a);this.pollingIntervals.set(t,r)}async fetchAndBroadcast(e,s){const t=`${e}_${s}`;try{let a;switch(s){case"marketData":a=await c.fetchMarketData(e);break;case"quotes":a=await c.fetchCompanyProfile(e);break;case"fundamentals":a=await c.fetchFinancialStatements(e,"income-statement");break;default:throw new Error(`Unknown data type: ${s}`)}const r={...a,symbol:e,dataType:s,timestamp:(new Date).toISOString(),source:"realTimeDataService"},n=this.subscribers.get(t);n&&n.forEach(e=>{try{e(r)}catch(s){o.log("ERROR",`Subscriber callback error for ${t}`,{error:s.message})}}),this.lastUpdateTimes.set(t,new Date)}catch(a){throw o.log("ERROR",`Failed to fetch data for ${e} ${s}`,{error:a.message}),a}}supportsWebSocket(e){return!1}getConnectionStatus(){const e={};for(const[s,t]of this.connectionStatus.entries()){const[a,r]=s.split("_");e[a]||(e[a]={}),e[a][r]={status:t,lastUpdate:this.lastUpdateTimes.get(s),subscriberCount:this.subscribers.get(s)?.size||0}}return e}getActiveSubscriptions(){const e=[];for(const[s,t]of this.subscribers.entries()){const[a,r]=s.split("_");e.push({symbol:a,dataType:r,subscriberCount:t.size,status:this.connectionStatus.get(s)||"unknown",lastUpdate:this.lastUpdateTimes.get(s)})}return e}cleanup(){for(const e of this.pollingIntervals.values())clearInterval(e);this.subscribers.clear(),this.activeStreams.clear(),this.pollingIntervals.clear(),this.connectionStatus.clear(),this.lastUpdateTimes.clear(),o.log("INFO","Real-time data service cleaned up")}},S=d("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive",warning:"border-warning/50 text-warning dark:border-warning [&>svg]:text-warning",success:"border-success/50 text-success dark:border-success [&>svg]:text-success",info:"border-info/50 text-info dark:border-info [&>svg]:text-info"}},defaultVariants:{variant:"default"}}),A=a.forwardRef(({className:t,variant:a,...r},n)=>e.jsx("div",{ref:n,role:"alert",className:s(S({variant:a}),t),...r}));A.displayName="Alert";const D=a.forwardRef(({className:t,...a},r)=>e.jsx("h5",{ref:r,className:s("mb-1 font-medium leading-none tracking-tight",t),...a}));D.displayName="AlertTitle";const k=a.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:s("text-sm [&_p]:leading-relaxed",t),...a}));k.displayName="AlertDescription",A.propTypes={className:m.string,variant:m.oneOf(["default","destructive","warning","success","info"])},D.propTypes={className:m.string},k.propTypes={className:m.string};const P=d("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-success text-success-foreground hover:bg-success/80",warning:"border-transparent bg-warning text-warning-foreground hover:bg-warning/80",info:"border-transparent bg-info text-info-foreground hover:bg-info/80"},size:{default:"px-2.5 py-0.5 text-xs",sm:"px-2 py-0.5 text-xs",lg:"px-3 py-1 text-sm"}},defaultVariants:{variant:"default",size:"default"}}),C=a.forwardRef(({className:t,variant:a,size:r,...n},i)=>e.jsx("div",{ref:i,className:s(P({variant:a,size:r}),t),...n}));C.displayName="Badge",C.propTypes={className:m.string,variant:m.oneOf(["default","secondary","destructive","outline","success","warning","info"]),size:m.oneOf(["default","sm","lg"])};const F=a.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:s("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a}));F.displayName="Card";const M=a.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:s("flex flex-col space-y-1.5 p-6",t),...a}));M.displayName="CardHeader";const R=a.forwardRef(({className:t,...a},r)=>e.jsx("h3",{ref:r,className:s("text-2xl font-semibold leading-none tracking-tight",t),...a}));R.displayName="CardTitle";const $=a.forwardRef(({className:t,...a},r)=>e.jsx("p",{ref:r,className:s("text-sm text-muted-foreground",t),...a}));$.displayName="CardDescription";const E=a.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:s("p-6 pt-0",t),...a}));E.displayName="CardContent";const T=a.forwardRef(({className:t,...a},r)=>e.jsx("div",{ref:r,className:s("flex items-center p-6 pt-0",t),...a}));T.displayName="CardFooter",F.propTypes={className:m.string},M.propTypes={className:m.string},R.propTypes={className:m.string},$.propTypes={className:m.string},E.propTypes={className:m.string},T.propTypes={className:m.string};const L=a.forwardRef(({className:t,value:a=0,max:r=100,"aria-label":n,"aria-labelledby":i,...o},c)=>{const l=Math.min(Math.max(a/r*100,0),100);return e.jsx("div",{ref:c,className:s("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),role:"progressbar","aria-valuemin":0,"aria-valuemax":r,"aria-valuenow":a,"aria-label":n||`Progress: ${l}%`,"aria-labelledby":i,...o,children:e.jsx("div",{className:"h-full bg-primary transition-all duration-300 ease-in-out",style:{width:`${l}%`}})})});L.displayName="Progress",L.propTypes={className:m.string,value:m.number,max:m.number,"aria-label":m.string,"aria-labelledby":m.string};const H=({apiHealthStatus:s={},realDataEnabled:t=!1,dataSources:a=[],dataQuality:r={}})=>{const n=s=>{switch(s){case"healthy":case"connected":return e.jsx(g,{className:"h-4 w-4 text-green-500"});case"error":case"disconnected":return e.jsx(x,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(p,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(p,{className:"h-4 w-4 text-gray-400"})}},i=e=>{switch(e){case"healthy":case"connected":return"bg-green-100 text-green-800";case"error":case"disconnected":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},o=a.filter(e=>"connected"===e.status).length,c=a.length,l=c>0?o/c*100:0;return e.jsxs(F,{children:[e.jsx(M,{children:e.jsxs(R,{className:"flex items-center gap-2",children:[e.jsx(u,{className:"h-5 w-5"}),"API Status & Data Quality"]})}),e.jsxs(E,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n(t?"connected":"disconnected"),e.jsxs("span",{className:"font-medium",children:["Real Data: ",t?"Enabled":"Disabled"]})]}),e.jsx(C,{className:i(t?"connected":"disconnected"),children:t?"Live":"Demo Mode"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Connection Health"}),e.jsxs("span",{children:[o,"/",c," sources"]})]}),e.jsx(L,{value:l,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Data Sources"}),e.jsx("div",{className:"space-y-2",children:a.map(s=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[n(s.status),e.jsx("span",{children:s.name}),s.requiresKey&&e.jsx(h,{className:"h-3 w-3 text-gray-400",title:"Requires API Key"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",className:`text-xs ${i(s.status)}`,children:s.status}),"connected"===s.status&&e.jsxs("span",{className:"text-xs text-gray-500",children:[s.latency,"ms"]})]})]},s.id))})]}),Object.keys(s).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"API Health Details"}),e.jsx("div",{className:"space-y-1 text-xs",children:Object.entries(s).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"capitalize",children:s.toLowerCase().replace("_"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Success: ",(100*t.successRate).toFixed(1),"%"]}),e.jsxs("span",{children:["Avg: ",t.avgResponseTime.toFixed(0),"ms"]})]})]},s))})]}),Object.keys(r).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Data Quality"}),e.jsx("div",{className:"space-y-1",children:Object.entries(r).map(([s,t])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:s}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(L,{value:t,className:"h-1 w-16"}),e.jsxs("span",{className:"text-xs",children:[t,"%"]})]})]},s))})]}),!t&&e.jsxs(A,{children:[e.jsx(p,{className:"h-4 w-4"}),e.jsxs(k,{className:"text-sm",children:["Running in demo mode. Add API keys to enable real-time data.",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-600",children:"Set VITE_ALPHA_VANTAGE_API_KEY or VITE_FMP_API_KEY in your .env file"})]})]}),t&&o<c&&e.jsxs(A,{children:[e.jsx(p,{className:"h-4 w-4"}),e.jsx(k,{className:"text-sm",children:"Some data sources are unavailable. Check your API keys and network connection."})]})]})]})},I=({selectedSymbols:s,onBulkExport:a,onBulkAlert:i,onBulkHistorical:o})=>{const[c,l]=r.useState(!1),[d,m]=r.useState("csv"),[u,h]=r.useState(""),[p,x]=r.useState("1y");return 0===s.length?null:e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-elevation-1",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>l(!c),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx(t,{name:"Layers",size:16,color:"white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Bulk Operations"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.length," symbol",1!==s.length?"s":""," selected"]})]})]}),e.jsx(t,{name:c?"ChevronUp":"ChevronDown",size:20,className:"text-muted-foreground"})]}),c&&e.jsxs("div",{className:"border-t border-border",children:[e.jsxs("div",{className:"p-4 border-b border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Selected Symbols:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.slice(0,10).map(s=>e.jsx("span",{className:"px-2 py-1 bg-muted text-muted-foreground text-xs rounded",children:s},s)),s.length>10&&e.jsxs("span",{className:"px-2 py-1 bg-muted text-muted-foreground text-xs rounded",children:["+",s.length-10," more"]})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Data Export"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-2 border border-border rounded-lg text-sm bg-input text-foreground",children:[e.jsx("option",{value:"csv",children:"CSV Format"}),e.jsx("option",{value:"xlsx",children:"Excel Format"}),e.jsx("option",{value:"json",children:"JSON Format"}),e.jsx("option",{value:"pdf",children:"PDF Report"})]}),e.jsx(n,{variant:"outline",size:"sm",iconName:"Download",onClick:()=>{a({symbols:s,format:d,timestamp:(new Date).toISOString()})},children:"Export Data"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Price Alerts"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(f,{type:"number",placeholder:"Threshold %",value:u,onChange:e=>h(e.target.value),className:"flex-1"}),e.jsx(n,{variant:"outline",size:"sm",iconName:"Bell",onClick:()=>{u&&(i({symbols:s,threshold:parseFloat(u),type:"price_change"}),h(""))},disabled:!u,children:"Set Alerts"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Historical Data"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:p,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-border rounded-lg text-sm bg-input text-foreground",children:[e.jsx("option",{value:"1d",children:"1 Day"}),e.jsx("option",{value:"1w",children:"1 Week"}),e.jsx("option",{value:"1m",children:"1 Month"}),e.jsx("option",{value:"3m",children:"3 Months"}),e.jsx("option",{value:"6m",children:"6 Months"}),e.jsx("option",{value:"1y",children:"1 Year"}),e.jsx("option",{value:"5y",children:"5 Years"})]}),e.jsx(n,{variant:"outline",size:"sm",iconName:"BarChart3",onClick:()=>{o({symbols:s,period:p})},children:"Get Historical"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-border bg-muted/30",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:s.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Symbols"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:Math.min(50*s.length,1e3)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Data Points"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["~",Math.ceil(s.length/10),"s"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Time"})]})]})})]})]})},V=({connectionHealth:s,lastUpdate:a})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{name:(e=>{switch(e){case"excellent":case"good":default:return"Wifi";case"warning":return"WifiOff";case"error":return"AlertTriangle"}})(s.overall),size:16,className:(e=>{switch(e){case"excellent":return"text-success";case"good":return"text-primary";case"warning":return"text-warning";case"error":return"text-error";default:return"text-muted-foreground"}})(s.overall)}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:["Connection: ",s.overall]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(t,{name:"Clock",size:14}),e.jsxs("span",{children:["Last update: ",a]})]}),e.jsx("div",{className:"flex items-center space-x-1",children:Object.entries(s.sources).map(([s,t])=>e.jsx("div",{className:"w-3 h-3 rounded-full "+("connected"===t?"bg-success":"warning"===t?"bg-warning":"bg-error"),title:`${s}: ${t}`},s))})]}),z=({dataSources:s,onToggle:t})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Data Sources:"}),e.jsx("div",{className:"flex items-center space-x-2",children:s.map(s=>e.jsxs("button",{onClick:()=>t(s.id),className:`\n              flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium transition-smooth\n              ${s.enabled?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}\n            `,children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+("connected"===s.status?"bg-success":"warning"===s.status?"bg-warning":"bg-error")}),e.jsx("span",{children:s.name}),e.jsxs("span",{className:"text-xs opacity-75",children:[s.latency,"ms"]})]},s.id))})]}),O=({widget:s,onResize:a,onRemove:r})=>{const n=(e,s)=>{switch(s){case"currency":return`$${e.toLocaleString("en-US",{minimumFractionDigits:2})}`;case"percentage":return`${e.toFixed(2)}%`;case"number":return e.toLocaleString("en-US",{minimumFractionDigits:2});default:return e}};return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4 shadow-elevation-1 hover:shadow-elevation-2 transition-smooth",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:s.symbol}),e.jsx("span",{className:"text-sm text-muted-foreground",children:s.name}),e.jsx("div",{className:`w-2 h-2 rounded-full ${(e=>{const s=(new Date-new Date(e))/1e3;return s<5?"bg-success":s<30?"bg-warning":"bg-error"})(s.lastUpdate)}`,title:`Last updated: ${new Date(s.lastUpdate).toLocaleTimeString()}`})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>a(s.id),className:"p-1 text-muted-foreground hover:text-foreground transition-smooth",title:"Resize widget",children:e.jsx(t,{name:"Maximize2",size:14})}),e.jsx("button",{onClick:()=>r(s.id),className:"p-1 text-muted-foreground hover:text-error transition-smooth",title:"Remove widget",children:e.jsx(t,{name:"X",size:14})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:n(s.currentValue,s.valueType)}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm "+(i=s.change,i>0?"text-success":i<0?"text-error":"text-muted-foreground"),children:[e.jsx(t,{name:(e=>e>0?"TrendingUp":e<0?"TrendingDown":"Minus")(s.change),size:14}),e.jsx("span",{children:n(Math.abs(s.change),s.valueType)}),e.jsxs("span",{children:["(",s.changePercent>0?"+":"",s.changePercent.toFixed(2),"%)"]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"h-16 bg-muted rounded flex items-end space-x-1 p-2",children:s.sparklineData.map((t,a)=>e.jsx("div",{className:"flex-1 rounded-sm "+(t>s.sparklineData[0]?"bg-success":"bg-error"),style:{height:t/Math.max(...s.sparklineData)*100+"%",minHeight:"2px"}},a))})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"High:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:n(s.dayHigh,s.valueType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Low:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:n(s.dayLow,s.valueType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Volume:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:s.volume?s.volume.toLocaleString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:s.source})]})]})]});var i},q=({onSymbolSelect:s,watchlist:a,onAddToWatchlist:n})=>{const[i,o]=r.useState(""),[c,l]=r.useState([]),[d,m]=r.useState(!1),[u,h]=r.useState(-1),p=r.useRef(null),x=[{symbol:"AAPL",name:"Apple Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"MSFT",name:"Microsoft Corporation",exchange:"NASDAQ",sector:"Technology"},{symbol:"GOOGL",name:"Alphabet Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"AMZN",name:"Amazon.com Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary"},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary"},{symbol:"META",name:"Meta Platforms Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"NVDA",name:"NVIDIA Corporation",exchange:"NASDAQ",sector:"Technology"},{symbol:"JPM",name:"JPMorgan Chase & Co.",exchange:"NYSE",sector:"Financial Services"},{symbol:"JNJ",name:"Johnson & Johnson",exchange:"NYSE",sector:"Healthcare"},{symbol:"V",name:"Visa Inc.",exchange:"NYSE",sector:"Financial Services"}];r.useEffect(()=>{if(i.length>0){const e=x.filter(e=>e.symbol.toLowerCase().includes(i.toLowerCase())||e.name.toLowerCase().includes(i.toLowerCase())).slice(0,8);l(e),m(!0),h(-1)}else l([]),m(!1)},[i]);const g=e=>{s(e),o(""),m(!1),h(-1)};return e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("div",{className:"relative",children:[e.jsx(f,{type:"text",placeholder:"Search symbols (e.g., AAPL, Apple)...",value:i,onChange:e=>o(e.target.value),onKeyDown:e=>{if(d)switch(e.key){case"ArrowDown":e.preventDefault(),h(e=>e<c.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),h(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),u>=0&&g(c[u]);break;case"Escape":m(!1),h(-1)}},className:"pl-10 pr-4"}),e.jsx(t,{name:"Search",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"})]}),d&&c.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-popover border border-border rounded-lg shadow-elevation-2 z-50 max-h-64 overflow-y-auto",children:c.map((s,r)=>{return e.jsxs("div",{className:`\n                flex items-center justify-between p-3 cursor-pointer transition-smooth\n                ${r===u?"bg-muted":"hover:bg-muted"}\n              `,onClick:()=>g(s),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold text-foreground",children:s.symbol}),e.jsx("span",{className:"text-xs px-2 py-1 bg-muted rounded text-muted-foreground",children:s.exchange})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:s.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:s.sector})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(i=s.symbol,!a.some(e=>e.symbol===i)&&e.jsx("button",{onClick:e=>{e.stopPropagation(),n(s)},className:"p-1 text-muted-foreground hover:text-primary transition-smooth",title:"Add to watchlist",children:e.jsx(t,{name:"Star",size:16})})),e.jsx(t,{name:"Plus",size:16,className:"text-muted-foreground"})]})]},s.symbol);var i})}),d&&i.length>0&&0===c.length&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-popover border border-border rounded-lg shadow-elevation-2 z-50 p-4 text-center",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(t,{name:"Search",size:24,className:"mx-auto mb-2"}),e.jsxs("p",{children:['No symbols found for "',i,'"']})]})})]})},U=({watchlist:s,onRemoveFromWatchlist:a,onSelectSymbol:i})=>{const[o,c]=r.useState("symbol"),[l,d]=r.useState("asc"),m=[...s].sort((e,s)=>{let t=e[o],a=s[o];return"string"==typeof t&&(t=t.toLowerCase(),a=a.toLowerCase()),"asc"===l?t<a?-1:t>a?1:0:t>a?-1:t<a?1:0}),u=(e,s)=>{switch(s){case"currency":return`$${e.toLocaleString("en-US",{minimumFractionDigits:2})}`;case"percentage":return`${e.toFixed(2)}%`;default:return e}};return e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-elevation-1",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Watchlist"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[s.length," symbols"]}),e.jsx(n,{variant:"ghost",size:"sm",iconName:"MoreVertical","aria-label":"Watchlist options"})]})]})}),e.jsx("div",{className:"p-3 border-b border-border bg-muted/30",children:e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sort by:"}),["symbol","name","price","change"].map(s=>e.jsxs("button",{onClick:()=>(e=>{o===e?d("asc"===l?"desc":"asc"):(c(e),d("asc"))})(s),className:`\n                flex items-center space-x-1 px-2 py-1 rounded transition-smooth\n                ${o===s?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}\n              `,children:[e.jsx("span",{className:"capitalize",children:s}),o===s&&e.jsx(t,{name:"asc"===l?"ChevronUp":"ChevronDown",size:12})]},s))]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===m.length?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(t,{name:"Star",size:32,className:"mx-auto mb-3 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No symbols in watchlist"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Search and add symbols to track them here"})]}):m.map(s=>{return e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-border last:border-b-0 hover:bg-muted/50 cursor-pointer transition-smooth",onClick:()=>i(s),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold text-foreground",children:s.symbol}),e.jsx("span",{className:"text-xs px-2 py-1 bg-muted rounded text-muted-foreground",children:s.exchange})]}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:s.name})]}),e.jsxs("div",{className:"text-right mr-3",children:[e.jsx("div",{className:"font-semibold text-foreground",children:u(s.price||150.25,"currency")}),e.jsxs("div",{className:"text-sm "+(r=s.change||2.15,r>0?"text-success":r<0?"text-error":"text-muted-foreground"),children:[s.change>0?"+":"",u(Math.abs(s.change||2.15),"currency"),"(",s.changePercent>0?"+":"",(s.changePercent||1.45).toFixed(2),"%)"]})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),a(s.symbol)},className:"p-1 text-muted-foreground hover:text-error transition-smooth",title:"Remove from watchlist",children:e.jsx(t,{name:"X",size:16})})]},s.symbol);var r})}),s.length>0&&e.jsx("div",{className:"p-3 border-t border-border bg-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(n,{variant:"ghost",size:"sm",iconName:"Download",children:"Export"}),e.jsx(n,{variant:"ghost",size:"sm",iconName:"Bell",children:"Set Alerts"})]})})]})},_=()=>{const[s,a]=r.useState([{id:"yahoo",name:"Yahoo Finance",enabled:!0,status:"connected",latency:12,requiresKey:!1},{id:"alpha_vantage",name:"Alpha Vantage",enabled:!1,status:"disconnected",latency:25,requiresKey:!0},{id:"fmp",name:"Financial Modeling Prep",enabled:!1,status:"disconnected",latency:18,requiresKey:!0},{id:"sec_edgar",name:"SEC EDGAR",enabled:!0,status:"connected",latency:45,requiresKey:!1}]),[o,c]=r.useState({overall:"good",sources:{yahoo:"connected",alpha_vantage:"disconnected",fmp:"disconnected",sec_edgar:"connected"}}),[l,d]=r.useState(!1),[m,u]=r.useState({}),[h,p]=r.useState({}),[x,g]=r.useState([{id:"widget-1",symbol:"AAPL",name:"Apple Inc.",currentValue:182.52,change:2.15,changePercent:1.19,valueType:"currency",dayHigh:184.3,dayLow:180.15,volume:52847392,source:"Bloomberg",lastUpdate:new Date(Date.now()-2e3),sparklineData:[180.25,181.15,180.95,182.1,181.85,182.52]},{id:"widget-2",symbol:"MSFT",name:"Microsoft Corporation",currentValue:378.85,change:-1.25,changePercent:-.33,valueType:"currency",dayHigh:381.2,dayLow:377.5,volume:28394751,source:"FactSet",lastUpdate:new Date(Date.now()-1500),sparklineData:[380.15,379.85,378.95,379.4,378.2,378.85]},{id:"widget-3",symbol:"GOOGL",name:"Alphabet Inc.",currentValue:2847.35,change:15.8,changePercent:.56,valueType:"currency",dayHigh:2855,dayLow:2830.15,volume:1847392,source:"Bloomberg",lastUpdate:new Date(Date.now()-3e3),sparklineData:[2835.25,2841.15,2838.95,2845.1,2843.85,2847.35]},{id:"widget-4",symbol:"US10Y",name:"US 10-Year Treasury",currentValue:4.285,change:.025,changePercent:.59,valueType:"percentage",dayHigh:4.295,dayLow:4.26,volume:null,source:"Refinitiv",lastUpdate:new Date(Date.now()-5e3),sparklineData:[4.26,4.27,4.275,4.28,4.285,4.285]}]),[f,y]=r.useState([{symbol:"AAPL",name:"Apple Inc.",exchange:"NASDAQ",sector:"Technology",price:182.52,change:2.15,changePercent:1.19},{symbol:"MSFT",name:"Microsoft Corporation",exchange:"NASDAQ",sector:"Technology",price:378.85,change:-1.25,changePercent:-.33},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary",price:248.42,change:5.67,changePercent:2.34}]),[v,N]=r.useState([]),[S,A]=r.useState("2 min ago"),[D,k]=r.useState(5e3),[P,C]=r.useState(!0);r.useEffect(()=>{(async()=>{try{const e=j.getSourceHealthStatus();u(e),a(s=>s.map(s=>{const t=e[s.id.toUpperCase()];return t?{...s,enabled:t.hasValidApiKey||!t.requiresApiKey,status:t.hasValidApiKey||!t.requiresApiKey?"connected":"disconnected"}:s}));const s=Object.values(e).some(e=>e.hasValidApiKey||!e.requiresApiKey);d(s)}catch(e){}})()},[]),r.useEffect(()=>{if(!P)return;const e=setInterval(async()=>{if(l){const e=await Promise.all(x.map(async e=>{try{const s=await j.fetchRealTimeMarketData(e.symbol),t=b.validateData(s,"marketData");return{...e,currentValue:s.currentPrice,change:s.change,changePercent:s.changePercent,dayHigh:s.dayHigh,dayLow:s.dayLow,volume:s.volume,lastUpdate:new Date,source:s.source,dataQuality:t.qualityScore,sparklineData:[...e.sparklineData.slice(1),s.currentPrice]}}catch(s){return{...e,currentValue:e.currentValue+2*(Math.random()-.5),change:5*(Math.random()-.5),changePercent:2*(Math.random()-.5),lastUpdate:new Date,source:"Simulation",sparklineData:[...e.sparklineData.slice(1),e.currentValue+2*(Math.random()-.5)]}}}));g(e)}else g(e=>e.map(e=>({...e,currentValue:e.currentValue+2*(Math.random()-.5),change:5*(Math.random()-.5),changePercent:2*(Math.random()-.5),lastUpdate:new Date,source:"Simulation",sparklineData:[...e.sparklineData.slice(1),e.currentValue+2*(Math.random()-.5)]})));A("Just now")},D);return()=>clearInterval(e)},[D,P,l,x]);const F=async e=>{try{let t,a="Simulation",r=75;if(l)try{t=await j.fetchRealTimeMarketData(e.symbol);const s=b.validateData(t,"marketData");a=t.source,r=s.qualityScore}catch(s){t=null}const n={id:`widget-${Date.now()}`,symbol:e.symbol,name:e.name,currentValue:t?.currentPrice||1e3*Math.random()+50,change:t?.change||10*(Math.random()-.5),changePercent:t?.changePercent||5*(Math.random()-.5),valueType:"currency",dayHigh:t?.dayHigh||1e3*Math.random()+60,dayLow:t?.dayLow||1e3*Math.random()+40,volume:t?.volume||Math.floor(1e8*Math.random()),source:a,dataQuality:r,lastUpdate:new Date,sparklineData:Array.from({length:6},()=>t?.currentPrice||1e3*Math.random()+50)};g(e=>[...e,n]),l&&w.subscribe(e.symbol,"marketData",s=>{g(t=>t.map(t=>t.symbol===e.symbol?{...t,currentValue:s.currentPrice,change:s.change,changePercent:s.changePercent,lastUpdate:new Date(s.timestamp),source:s.source}:t))})}catch(s){}},M=e=>{},R=e=>{g(s=>s.filter(s=>s.id!==e))},$=e=>{e.ctrlKey&&"f"===e.key&&(e.preventDefault(),document.querySelector('input[placeholder*="Search symbols"]')?.focus())};return r.useEffect(()=>(document.addEventListener("keydown",$),()=>document.removeEventListener("keydown",$)),[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(i,{}),e.jsxs("div",{className:"pt-[60px]",children:[e.jsx("div",{className:"bg-card border-b border-border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx(z,{dataSources:s,onToggle:e=>{a(s=>s.map(s=>s.id===e?{...s,enabled:!s.enabled}:s))}}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",iconName:"RefreshCw",onClick:()=>{A("Just now")},className:P?"animate-spin":"",children:"Refresh"}),e.jsx(n,{variant:P?"default":"outline",size:"sm",iconName:P?"Pause":"Play",onClick:()=>C(!P),children:P?"Pause":"Resume"})]})]}),e.jsx(V,{connectionHealth:o,lastUpdate:S})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-3 space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4 shadow-elevation-1",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Add Symbols"}),e.jsx(q,{onSymbolSelect:F,watchlist:f,onAddToWatchlist:e=>{f.some(s=>s.symbol===e.symbol)||y(s=>[...s,{...e,price:1e3*Math.random()+50,change:10*(Math.random()-.5),changePercent:5*(Math.random()-.5)}])}}),e.jsx("div",{className:"mt-3 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(t,{name:"Keyboard",size:12}),e.jsx("span",{children:"Ctrl+F to focus search"})]})})]}),e.jsx(U,{watchlist:f,onRemoveFromWatchlist:e=>{y(s=>s.filter(s=>s.symbol!==e))},onSelectSymbol:F}),e.jsx(I,{selectedSymbols:v,onBulkExport:e=>{alert(`Exporting ${e.symbols.length} symbols in ${e.format.toUpperCase()} format`)},onBulkAlert:e=>{alert(`Setting ${e.threshold}% alerts for ${e.symbols.length} symbols`)},onBulkHistorical:e=>{alert(`Fetching ${e.period} historical data for ${e.symbols.length} symbols`)}}),e.jsx(H,{apiHealthStatus:m,realDataEnabled:l,dataSources:s,dataQuality:h})]}),e.jsxs("div",{className:"col-span-9",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-foreground",children:["Market Data Widgets (",x.length,")"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(n,{variant:"outline",size:"sm",iconName:"Settings",children:"Layout"}),e.jsx(n,{variant:"outline",size:"sm",iconName:"Save",children:"Save Dashboard"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:x.map(s=>e.jsx(O,{widget:s,onResize:M,onRemove:R},s.id))}),0===x.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(t,{name:"BarChart3",size:48,className:"mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No Data Widgets"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Search and add symbols to start monitoring market data"}),e.jsx(n,{variant:"outline",iconName:"Plus",children:"Add Your First Widget"})]})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border p-2",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Active Widgets: ",x.length]}),e.jsxs("span",{children:["Watchlist: ",f.length]}),e.jsxs("span",{children:["Auto-refresh: ",P?"ON":"OFF"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{children:"Market Hours: OPEN"}),e.jsxs("span",{children:["Last Update: ",S]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-success rounded-full"}),e.jsx("span",{children:"All systems operational"})]})]})]})})]})]})};export{_ as default};
//# sourceMappingURL=index-9cMGkQJ7.js.map
