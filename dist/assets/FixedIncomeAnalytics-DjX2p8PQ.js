import{r as e,j as t,C as a,t as s,T as i,S as r,a8 as l,P as c,a as n,D as d}from"./react-DbKEDq5F.js";import{A as o,m as u}from"./animations-DmEkbmfl.js";import{R as m,L as x,C as h,X as p,Y as y,T as j,e as f,a as g,B as b,b as N}from"./recharts-vendor-CMq9LHd_.js";import"./utils-vendor-DofaKlSJ.js";import"./vendor-DYwn_Zoo.js";import"./d3-vendor-C2v6EsNF.js";class v{constructor(){this.bondCache=new Map,this.yieldCurves=new Map,this.creditSpreads=new Map}calculateBondPrice(e,t,a=new Date){const{faceValue:s=1e3,couponRate:i,maturityDate:r,paymentFrequency:l=2}=e,c=this.calculateYearsToMaturity(r,a),n=Math.ceil(c*l),d=s*i/l,o=t/l;let u=0,m=0;for(let h=1;h<=n;h++)u+=d*Math.pow(1+o,-h);const x=s/Math.pow(1+o,n);return u+=x,m=this.calculateAccruedInterest(e,a),{cleanPrice:u,dirtyPrice:u+m,accruedInterest:m,yieldToMaturity:t,modifiedDuration:this.calculateModifiedDuration(e,t),convexity:this.calculateConvexity(e,t),dv01:this.calculateDV01(e,t),bondMetrics:{yearsToMaturity:c,periodsToMaturity:n,couponPayment:d,principalPV:x}}}calculateYieldToMaturity(e,t,a=1e-4,s=100){let i=e.couponRate||.05;for(let r=0;r<s;r++){const s=this.calculateBondPrice(e,i),l=s.cleanPrice-t;if(Math.abs(l)<a)return{yieldToMaturity:i,iterations:r+1,priceAccuracy:l,...s};i-=l/(this.calculateModifiedDuration(e,i)*t)}throw new Error("YTM calculation did not converge")}calculateModifiedDuration(e,t){const{faceValue:a=1e3,couponRate:s,maturityDate:i,paymentFrequency:r=2}=e,l=this.calculateYearsToMaturity(i),c=Math.ceil(l*r),n=a*s/r,d=t/r;let o=0,u=0;for(let m=1;m<=c;m++){const e=(m===c?n+a:n)*Math.pow(1+d,-m);o+=m/r*e,u+=e}return o/u/(1+d)}calculateConvexity(e,t){const{faceValue:a=1e3,couponRate:s,maturityDate:i,paymentFrequency:r=2}=e,l=this.calculateYearsToMaturity(i),c=Math.ceil(l*r),n=a*s/r,d=t/r;let o=0,u=0;for(let m=1;m<=c;m++){const e=(m===c?n+a:n)*Math.pow(1+d,-m);o+=m*(m+1)/Math.pow(r,2)*e,u+=e}return o/(u*Math.pow(1+d,2))}calculateDV01(e,t){const a=this.calculateBondPrice(e,t),s=this.calculateBondPrice(e,t+1e-4);return Math.abs(a.cleanPrice-s.cleanPrice)}bootstrapYieldCurve(e,t){const a=e.map((e,a)=>({...e,marketPrice:t[a]})).sort((e,t)=>this.calculateYearsToMaturity(e.maturityDate)-this.calculateYearsToMaturity(t.maturityDate)),s=[],i=[];for(let r=0;r<a.length;r++){const e=a[r],t=this.calculateYearsToMaturity(e.maturityDate);if(0===r){const a=this.calculateYieldToMaturity(e,e.marketPrice);i.push({maturity:t,rate:a.yieldToMaturity})}else{const a=this.bootstrapSingleRate(e,i);i.push({maturity:t,rate:a})}s.push({maturity:t,zeroCouponRate:i[r].rate,bondYTM:this.calculateYieldToMaturity(e,e.marketPrice).yieldToMaturity,bond:e})}return{curve:s,spotRates:i,forwardRates:this.calculateForwardRates(i),curveMetrics:this.analyzeCurveShape(s)}}calculateForwardRates(e){const t=[];for(let a=1;a<e.length;a++){const s=e[a-1].maturity,i=e[a].maturity,r=e[a-1].rate,l=e[a].rate,c=(Math.pow(1+l,i)/Math.pow(1+r,s)-1)/(i-s);t.push({startPeriod:s,endPeriod:i,forwardRate:c,impliedRate:c})}return t}analyzeCurveShape(e){if(e.length<3)return{shape:"insufficient_data"};const t=e[0].zeroCouponRate,a=e[e.length-1].zeroCouponRate,s=e[Math.floor(e.length/2)].zeroCouponRate;let i="normal";t>a?i="inverted":s>t&&s>a?i="humped":Math.abs(t-a)<.001&&(i="flat");const r=a-t;return{shape:i,slope:r,curvature:2*s-t-a,level:(t+s+a)/3,steepness:r/e[e.length-1].maturity,spread_2y10y:this.interpolateRate(e,10)-this.interpolateRate(e,2),spread_3m10y:this.interpolateRate(e,10)-this.interpolateRate(e,.25)}}calculateCreditSpread(e,t,a){const s=this.calculateYearsToMaturity(e.maturityDate),i=this.interpolateRate(t,s),r=this.calculateYieldToMaturity(e,a).yieldToMaturity;return{creditSpread:r-i,corporateYTM:r,riskFreeRate:i,spreadBasisPoints:1e4*(r-i),maturity:s}}calculateOptionAdjustedSpread(e,t,a=.15){const s=this.calculateCreditSpread(e,this.yieldCurves.get("government"),t),i=this.estimateEmbeddedOptionValue(e,a);return{...s,optionAdjustedSpread:s.creditSpread-i/t,embeddedOptionValue:i,zSpread:s.creditSpread}}calculateYearsToMaturity(e,t=new Date){return(new Date(e).getTime()-t.getTime())/315576e5}calculateAccruedInterest(e,t=new Date){const{faceValue:a=1e3,couponRate:s,paymentFrequency:i=2}=e;return a*s/i*(30/(365.25/i))}interpolateRate(e,t){if(0===e.length)return 0;let a=-1,s=-1;for(let c=0;c<e.length;c++)if(e[c].maturity<=t&&(a=c),e[c].maturity>=t&&-1===s){s=c;break}if(a===s)return e[a].zeroCouponRate;if(-1===a)return e[0].zeroCouponRate;if(-1===s)return e[e.length-1].zeroCouponRate;const i=e[a].maturity,r=e[s].maturity,l=e[a].zeroCouponRate;return l+(e[s].zeroCouponRate-l)*(t-i)/(r-i)}bootstrapSingleRate(e,t){return this.calculateYieldToMaturity(e,e.marketPrice).yieldToMaturity}estimateEmbeddedOptionValue(e,t){return e.callable||e.putable?(e.callDate?this.calculateYearsToMaturity(e.callDate):0)*t*100:0}analyzeFixedIncomePortfolio(e,t,a){let s=0,i=0,r=0,l=0;return{bonds:e.map((e,c)=>{const n=a[c],d=t[c],o=this.calculateBondPrice(e,.05),u=n*d;return s+=o.modifiedDuration*d,i+=o.convexity*d,r+=o.yieldToMaturity*d,l+=u,{bond:e,weight:d,marketValue:u,...o}}),portfolio:{totalMarketValue:l,weightedDuration:s,weightedConvexity:i,weightedYield:r,dv01:s*l*1e-4,riskMetrics:{interestRateRisk:s,convexityBenefit:i,priceVolatility:.01*s}}}}}const M=()=>{const[M,w]=e.useState(null),[R,C]=e.useState(null);e.useState(null);const[T,A]=e.useState("bonds"),[Y,D]=e.useState(null),[P,S]=e.useState({bonds:[],yieldCurves:{},creditSpreads:{}}),F=e.useMemo(()=>new v,[]),k=[{id:"UST_10Y",name:"US Treasury 10Y",issuer:"US Treasury",couponRate:.025,faceValue:1e3,maturityDate:"2034-08-15",paymentFrequency:2,creditRating:"AAA",sector:"Government",callable:!1},{id:"CORP_AAPL",name:"Apple Inc. 2.45%",issuer:"Apple Inc.",couponRate:.0245,faceValue:1e3,maturityDate:"2029-08-04",paymentFrequency:2,creditRating:"AA+",sector:"Technology",callable:!1},{id:"UST_5Y",name:"US Treasury 5Y",issuer:"US Treasury",couponRate:.02,faceValue:1e3,maturityDate:"2029-08-15",paymentFrequency:2,creditRating:"AAA",sector:"Government",callable:!1}],B=[985.5,1024.75,992.25];e.useEffect(()=>{S(e=>({...e,bonds:k.map((e,t)=>({...e,marketPrice:B[t],analytics:F.calculateBondPrice(e,.03)}))}));const e=F.bootstrapYieldCurve(k,B);C(e)},[F]);const V=()=>t.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(s,{className:"mr-2"}),"Bond Pricing Calculator"]}),M&&Y&&t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-lg mb-3",children:M.name}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Issuer:"}),t.jsx("span",{className:"font-medium",children:M.issuer})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Coupon Rate:"}),t.jsxs("span",{className:"font-medium",children:[(100*M.couponRate).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Maturity:"}),t.jsx("span",{className:"font-medium",children:M.maturityDate})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Credit Rating:"}),t.jsx("span",{className:"font-medium",children:M.creditRating})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-lg mb-3",children:"Pricing & Analytics"}),t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Clean Price:"}),t.jsxs("span",{className:"font-medium",children:["$",Y.cleanPrice.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Dirty Price:"}),t.jsxs("span",{className:"font-medium",children:["$",Y.dirtyPrice.toFixed(2)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Yield to Maturity:"}),t.jsxs("span",{className:"font-medium",children:[(100*Y.yieldToMaturity).toFixed(3),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Modified Duration:"}),t.jsx("span",{className:"font-medium",children:Y.modifiedDuration.toFixed(3)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Convexity:"}),t.jsx("span",{className:"font-medium",children:Y.convexity.toFixed(3)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"DV01:"}),t.jsxs("span",{className:"font-medium",children:["$",Y.dv01.toFixed(4)]})]})]})]})]})]}),z=()=>{if(!R)return null;const e=R.curve.map(e=>({maturity:e.maturity.toFixed(1),"Zero Coupon Rate":(100*e.zeroCouponRate).toFixed(2),"Bond YTM":(100*e.bondYTM).toFixed(2)}));return t.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(i,{className:"mr-2"}),"Yield Curve Analysis"]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:t.jsx(m,{width:"100%",height:300,children:t.jsxs(x,{data:e,children:[t.jsx(h,{strokeDasharray:"3 3"}),t.jsx(p,{dataKey:"maturity",label:{value:"Years to Maturity",position:"insideBottom",offset:-5}}),t.jsx(y,{label:{value:"Yield (%)",angle:-90,position:"insideLeft"}}),t.jsx(j,{}),t.jsx(f,{}),t.jsx(g,{type:"monotone",dataKey:"Zero Coupon Rate",stroke:"#2563eb",strokeWidth:2}),t.jsx(g,{type:"monotone",dataKey:"Bond YTM",stroke:"#dc2626",strokeWidth:2,strokeDasharray:"5 5"})]})})}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-lg mb-3",children:"Curve Metrics"}),R.curveMetrics&&t.jsxs("div",{className:"space-y-2",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Shape:"}),t.jsx("span",{className:"font-medium capitalize",children:R.curveMetrics.shape})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Slope:"}),t.jsxs("span",{className:"font-medium",children:[(100*R.curveMetrics.slope).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"Level:"}),t.jsxs("span",{className:"font-medium",children:[(100*R.curveMetrics.level).toFixed(2),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"2Y-10Y Spread:"}),t.jsxs("span",{className:"font-medium",children:[(100*R.curveMetrics.spread_2y10y).toFixed(0),"bp"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-gray-600",children:"3M-10Y Spread:"}),t.jsxs("span",{className:"font-medium",children:[(100*R.curveMetrics.spread_3m10y).toFixed(0),"bp"]})]})]})]})]})]})},I=()=>t.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(a,{className:"mr-2"}),"Bond Universe"]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full table-auto",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b",children:[t.jsx("th",{className:"text-left py-2",children:"Bond"}),t.jsx("th",{className:"text-left py-2",children:"Issuer"}),t.jsx("th",{className:"text-left py-2",children:"Coupon"}),t.jsx("th",{className:"text-left py-2",children:"Maturity"}),t.jsx("th",{className:"text-left py-2",children:"Price"}),t.jsx("th",{className:"text-left py-2",children:"YTM"}),t.jsx("th",{className:"text-left py-2",children:"Duration"}),t.jsx("th",{className:"text-left py-2",children:"Rating"}),t.jsx("th",{className:"text-left py-2",children:"Actions"})]})}),t.jsx("tbody",{children:P.bonds.map(e=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"py-2 font-medium",children:e.name}),t.jsx("td",{className:"py-2",children:e.issuer}),t.jsxs("td",{className:"py-2",children:[(100*e.couponRate).toFixed(2),"%"]}),t.jsx("td",{className:"py-2",children:e.maturityDate}),t.jsxs("td",{className:"py-2",children:["$",e.marketPrice]}),t.jsxs("td",{className:"py-2",children:[(100*e.analytics.yieldToMaturity).toFixed(3),"%"]}),t.jsx("td",{className:"py-2",children:e.analytics.modifiedDuration.toFixed(2)}),t.jsx("td",{className:"py-2",children:t.jsx("span",{className:"px-2 py-1 rounded text-xs "+("AAA"===e.creditRating?"bg-green-100 text-green-800":e.creditRating.startsWith("AA")?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"),children:e.creditRating})}),t.jsx("td",{className:"py-2",children:t.jsx("button",{onClick:()=>(e=>{w(e);const t=F.calculateBondPrice(e,.03),a=F.calculateYieldToMaturity(e,e.marketPrice);D({...t,...a})})(e),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700",children:"Analyze"})})]},e.id))})]})})]}),U=()=>t.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("h3",{className:"text-xl font-bold mb-4 flex items-center",children:[t.jsx(r,{className:"mr-2"}),"Credit Analysis"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-lg mb-3",children:"Credit Spreads by Sector"}),t.jsx("div",{className:"space-y-3",children:[{sector:"Government",spread:0,rating:"AAA"},{sector:"Technology",spread:85,rating:"AA+"},{sector:"Financial",spread:120,rating:"A+"},{sector:"Energy",spread:180,rating:"BBB+"}].map(e=>t.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[t.jsxs("div",{children:[t.jsx("span",{className:"font-medium",children:e.sector}),t.jsxs("span",{className:"ml-2 text-sm text-gray-600",children:["(",e.rating,")"]})]}),t.jsxs("span",{className:"font-bold text-blue-600",children:[e.spread,"bp"]})]},e.sector))})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-lg mb-3",children:"Credit Quality Distribution"}),t.jsx(m,{width:"100%",height:200,children:t.jsxs(b,{data:[{rating:"AAA",count:15,percentage:25},{rating:"AA",count:20,percentage:33},{rating:"A",count:18,percentage:30},{rating:"BBB",count:7,percentage:12}],children:[t.jsx(h,{strokeDasharray:"3 3"}),t.jsx(p,{dataKey:"rating"}),t.jsx(y,{}),t.jsx(j,{}),t.jsx(N,{dataKey:"count",fill:"#3b82f6"})]})})]})]})]});return t.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:t.jsxs("div",{className:"max-w-7xl mx-auto",children:[t.jsxs("header",{className:"mb-8",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Fixed Income Analytics"}),t.jsx("p",{className:"text-gray-600",children:"Comprehensive bond analysis, yield curve modeling, and credit analytics"})]}),t.jsx("div",{className:"mb-6",children:t.jsx("nav",{className:"flex space-x-1 bg-blue-50 p-1 rounded-lg",children:[{id:"bonds",label:"Bond Universe",icon:a},{id:"pricing",label:"Pricing Calculator",icon:s},{id:"curves",label:"Yield Curves",icon:i},{id:"credit",label:"Credit Analysis",icon:r}].map(e=>{const a=e.icon;return t.jsxs("button",{onClick:()=>A(e.id),className:"flex items-center px-4 py-2 rounded-md font-medium transition-colors "+(T===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[t.jsx(a,{className:"w-4 h-4 mr-2"}),e.label]},e.id)})})}),t.jsxs(o,{mode:"wait",children:["bonds"===T&&t.jsx(I,{}),"pricing"===T&&t.jsx(V,{}),"curves"===T&&t.jsx(z,{}),"credit"===T&&t.jsx(U,{})]}),t.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mt-8 grid grid-cols-1 md:grid-cols-4 gap-4",children:[{label:"Avg Portfolio Duration",value:"4.2 years",icon:l,color:"blue"},{label:"Portfolio Yield",value:"3.15%",icon:c,color:"green"},{label:"Credit Spread",value:"125bp",icon:n,color:"orange"},{label:"Total Market Value",value:"$2.4M",icon:d,color:"purple"}].map(e=>{const a=e.icon;return t.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:e.label}),t.jsx("p",{className:"text-xl font-bold",children:e.value})]}),t.jsx(a,{className:`w-8 h-8 text-${e.color}-600`})]})},e.label)})})]})})};export{M as default};
//# sourceMappingURL=FixedIncomeAnalytics-DjX2p8PQ.js.map
