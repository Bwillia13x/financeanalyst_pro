import{r as e,j as s,Z as a,ab as t,l,n as i,y as r}from"./react-core-CeHLCIBw.js";import{m as n}from"./monteCarloEngine-VpQcTKma.js";import{b as d}from"./ui-vendor-B5RWaOCb.js";import"./vendor-D2fsnhsW.js";import"./ai-vendor-CuiosWbE.js";import"./advanced-analytics-y00dU25g.js";import"./utils-vendor-DUg4_aAP.js";import"./recharts-vendor-DQPXk1vH.js";import"./d3-vendor-DOBQrAlH.js";import"./react-dom-B6lyId6m.js";import"./apiLogger-D987Un6Q.js";const c=({data:c,dcfResults:o,lboResults:m,financialModel:x,scenarioResults:g,onDataChange:h})=>{const[u,b]=e.useState("unified"),[p,v]=e.useState({iterations:1e4,confidenceLevel:.95,correlationsEnabled:!0,crossModelAnalysis:!0,riskMetrics:["var","cvar","downside"]}),[j,y]=e.useState(null),[f,N]=e.useState(!1),[C,M]=e.useState(0),R=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",[]),S=e.useCallback(e=>`${(100*e).toFixed(1)}%`,[]),k=e.useCallback(async()=>{N(!0),M(0);try{const e={dcf:null,lbo:null,correlation:null,portfolio:null,riskMetrics:null};if(o&&p.crossModelAnalysis){const s={revenueGrowthRate:{type:"normal",parameters:{mean:.05,stdDev:.02},enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.1,mode:.15,max:.2},enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},enabled:!0}},a={currentRevenue:1e3*c?.statements?.incomeStatement?.totalRevenue?.[0]||1e6,currentPrice:100,sharesOutstanding:1e6,...o};M(25),e.dcf=await n.runDCFSimulation(a,s,{iterations:p.iterations,confidenceLevel:p.confidenceLevel,onProgress:e=>M(25+.25*e)})}if(m&&p.crossModelAnalysis){const s={ebitdaGrowthRate:{type:"normal",parameters:{mean:.06,stdDev:.02},enabled:!0},exitMultiple:{type:"triangular",parameters:{min:8,mode:10,max:12},enabled:!0},leverageRatio:{type:"normal",parameters:{mean:5.5,stdDev:.5},enabled:!0}};M(50),e.lbo=await n.runLBOSimulation(m.inputs||{},s,{iterations:p.iterations,confidenceLevel:p.confidenceLevel,onProgress:e=>M(50+.25*e)})}e.dcf&&e.lbo&&p.correlationsEnabled&&(M(75),e.correlation=w(e.dcf,e.lbo)),M(90),e.riskMetrics=D(e),g&&g.scenarios&&(e.portfolio=F(e,g)),M(100),y(e),h&&h({monteCarloIntegrated:{settings:p,results:e,timestamp:(new Date).toISOString()}})}catch(e){alert(`Simulation error: ${e.message}`)}finally{N(!1),M(0)}},[o,m,g,p,c,h]),w=e.useCallback((e,s)=>{const a=e.simulations?.map(e=>e.pricePerShare)||[],t=s.simulations?.map(e=>e.irr)||[];if(0===a.length||0===t.length)return null;const l=L(a,t);return{dcfLboCorrelation:l,interpretation:Math.abs(l)>.7?"Strong":Math.abs(l)>.4?"Moderate":"Weak",riskImplication:l>0?"Aligned Risk":"Hedged Risk"}},[]),L=(e,s)=>{const a=Math.min(e.length,s.length);if(0===a)return 0;const t=e.slice(0,a).reduce((e,s)=>e+s,0),l=s.slice(0,a).reduce((e,s)=>e+s,0),i=e.slice(0,a).reduce((e,a,t)=>e+a*s[t],0),r=e.slice(0,a).reduce((e,s)=>e+s*s,0),n=s.slice(0,a).reduce((e,s)=>e+s*s,0),d=a*i-t*l,c=Math.sqrt((a*r-t*t)*(a*n-l*l));return 0===c?0:d/c},D=e.useCallback(e=>{const s={};return e.dcf?.analysis&&(s.dcf={var95:e.dcf.analysis.percentiles?.pricePerShare?.p5||0,expectedValue:e.dcf.analysis.summary?.mean||0,volatility:e.dcf.analysis.summary?.standardDeviation||0}),e.lbo?.analysis&&(s.lbo={var95:e.lbo.analysis.percentiles?.irr?.p5||0,expectedValue:e.lbo.analysis.summary?.mean||0,volatility:e.lbo.analysis.summary?.standardDeviation||0}),s},[]),F=e.useCallback((e,s)=>s.scenarios.reduce((s,a)=>{const t=a.probability/100;return e.dcf&&(s.dcfWeighted=(s.dcfWeighted||0)+(e.dcf.analysis?.summary?.mean||0)*t),e.lbo&&(s.lboWeighted=(s.lboWeighted||0)+(e.lbo.analysis?.summary?.mean||0)*t),s},{}),[]),I=[{id:"unified",label:"Unified Analysis",icon:a},{id:"dcf",label:"DCF Monte Carlo",icon:l},{id:"lbo",label:"LBO Monte Carlo",icon:i},{id:"correlation",label:"Cross-Model Risk",icon:r}];return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(a,{className:"text-purple-600",size:28}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Monte Carlo Integration Hub"}),s.jsx("p",{className:"text-gray-600",children:"Cross-model risk analysis & unified simulations"})]})]}),s.jsx("div",{className:"flex space-x-3",children:s.jsxs(d.button,{onClick:k,disabled:f,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(f?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),whileHover:f?{}:{scale:1.02},whileTap:f?{}:{scale:.98},children:[s.jsx(t,{size:18}),s.jsx("span",{children:f?"Running...":"Run Integrated Simulation"})]})})]}),f&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Simulation Progress"}),s.jsxs("span",{className:"text-sm text-gray-500",children:[C.toFixed(0),"%"]})]}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:s.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${C}%`}})})]}),s.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Simulation Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",htmlFor:"iterations",children:"Iterations"}),s.jsx("input",{id:"iterations",type:"number",value:p.iterations,onChange:e=>v(s=>({...s,iterations:parseInt(e.target.value)||1e4})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",htmlFor:"confidence-level",children:"Confidence Level"}),s.jsxs("select",{id:"confidence-level",value:p.confidenceLevel,onChange:e=>v(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:.9,children:"90%"}),s.jsx("option",{value:.95,children:"95%"}),s.jsx("option",{value:.99,children:"99%"})]})]}),s.jsx("div",{className:"flex items-end",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:p.correlationsEnabled,onChange:e=>v(s=>({...s,correlationsEnabled:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Correlations"})]})}),s.jsx("div",{className:"flex items-end",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:p.crossModelAnalysis,onChange:e=>v(s=>({...s,crossModelAnalysis:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Analysis"})]})})]})]}),s.jsx("div",{className:"border-b border-gray-200 mb-6",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:I.map(e=>{const a=e.icon;return s.jsxs("button",{onClick:()=>b(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(u===e.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[s.jsx(a,{size:16}),s.jsx("span",{children:e.label})]},e.id)})})}),j?s.jsxs(d.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:["unified"===u&&s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[j.dcf&&s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:R(j.dcf.analysis?.summary?.mean||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"DCF Expected Value"})]}),j.lbo&&s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:S(j.lbo.analysis?.summary?.mean||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"LBO Expected IRR"})]}),j.correlation&&s.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(j.correlation.dcfLboCorrelation||0).toFixed(2)}),s.jsx("div",{className:"text-sm text-gray-600",children:"DCF-LBO Correlation"})]}),s.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:p.iterations.toLocaleString()}),s.jsx("div",{className:"text-sm text-gray-600",children:"Simulations Run"})]})]}),j.correlation&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cross-Model Risk Analysis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[s.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Correlation Strength"}),s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:j.correlation.interpretation}),s.jsx("div",{className:"text-sm text-gray-600",children:j.correlation.riskImplication})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[s.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Risk Diversification"}),s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.abs(j.correlation.dcfLboCorrelation)<.5?"High":"Low"}),s.jsx("div",{className:"text-sm text-gray-600",children:"Portfolio benefit"})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[s.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Confidence Level"}),s.jsx("div",{className:"text-2xl font-bold text-green-600",children:S(p.confidenceLevel)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Statistical confidence"})]})]})]}),j.portfolio&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Portfolio-Weighted Analysis"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[s.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted DCF"}),s.jsx("div",{className:"text-xl font-bold text-blue-600",children:R(j.portfolio.dcfWeighted||0)})]}),s.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[s.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted LBO IRR"}),s.jsx("div",{className:"text-xl font-bold text-green-600",children:S(j.portfolio.lboWeighted||0)})]})]})]})]}),"dcf"===u&&j.dcf&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"DCF Monte Carlo Results"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:R(j.dcf.analysis?.summary?.mean||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Mean Value"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:R(j.dcf.analysis?.percentiles?.pricePerShare?.p95||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-red-600",children:R(j.dcf.analysis?.percentiles?.pricePerShare?.p5||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-purple-600",children:R(j.dcf.analysis?.summary?.standardDeviation||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Std Deviation"})]})]})]}),"lbo"===u&&j.lbo&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"LBO Monte Carlo Results"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-green-600",children:S(j.lbo.analysis?.summary?.mean||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Mean IRR"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-blue-600",children:S(j.lbo.analysis?.percentiles?.irr?.p95||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile IRR"})]}),s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"text-lg font-bold text-red-600",children:S(j.lbo.analysis?.percentiles?.irr?.p5||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile IRR"})]}),s.jsxs("div",{className:"text-center",children:[s.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[((j.lbo.analysis?.percentiles?.moic?.p95||0)+(j.lbo.analysis?.percentiles?.moic?.p5||0))/2,"x"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Avg MOIC"})]})]})]})]}):s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(a,{size:48,className:"mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Configure settings and run integrated simulation to see cross-model analysis"}),s.jsx("p",{className:"text-sm mt-2",children:o||m?"Ready to run comprehensive Monte Carlo analysis":"Run DCF and/or LBO analysis first to enable Monte Carlo integration"})]})]})};export{c as default};
//# sourceMappingURL=MonteCarloIntegrationHub-CBx9oRQ-.js.map
