import{j as e}from"./index-CBjix4AU.js";import{r as s,R as t}from"./react-vendor-BaLqnLcQ.js";import{H as a}from"./Header-CXltiDi0.js";import{B as l}from"./Button-BZ7UytOM.js";import{d as i,P as r,F as n,c as o,e as c,f as d,g as m,h as x,m as u,i as h,M as p,j as g,k as b,S as j,E as f,l as v,n as y,o as N,D as w,I as C,B as k,U as M,p as R,q as S,r as F,s as I,t as A,u as P,v as V,T as D,Z as E,b as O,w as B,C as T,x as z,y as q,z as G,G as L,H as $}from"./ui-vendor-Bpmum6lB.js";import{R as _,B as W,C as U,X as K,Y as H,T as Y,a as Q,d as J,e as X,f as Z,g as ee,h as se,L as te,A as ae,c as le,S as ie,b as re}from"./charts-vendor-h_g8xRFq.js";import{a as ne}from"./apiLogger-BNPwdfUB.js";import{g as oe,b as ce,f as de}from"./defaultFinancialData-BqNGcy_-.js";import"./utils-vendor-Cj_bvvWu.js";const me=new class{constructor(){this.workers=[],this.isRunning=!1,this.currentSimulation=null}async runDCFSimulation(e,s,t={}){const{iterations:a=1e4,confidenceLevel:l=.95,correlationMatrix:i=null,randomSeed:r=null}=t;ne.log("INFO","Starting DCF Monte Carlo simulation",{iterations:a,variables:Object.keys(s).length}),this.isRunning=!0;const n=Date.now();try{r&&this.setSeed(r);const o=this.generateCorrelatedSamples(s,a,i),c=[],d=t.onProgress;for(let t=0;t<a;t++){if(!this.isRunning)throw new Error("Simulation cancelled");const l=this.createScenarioInputs(e,o[t],s),i=this.calculateDCFScenario(l);c.push({iteration:t+1,pricePerShare:i.pricePerShare,enterpriseValue:i.enterpriseValue,upside:i.upside,inputs:l}),d&&t%Math.floor(a/100)===0&&d(t/a*100)}const m=this.analyzeResults(c,l),x=Date.now();return ne.log("INFO","DCF Monte Carlo simulation completed",{iterations:a,duration:x-n,meanPrice:m.statistics.mean}),{type:"DCF_MONTE_CARLO",timestamp:(new Date).toISOString(),parameters:{iterations:a,confidenceLevel:l,randomSeed:r},results:c,analysis:m,duration:x-n}}catch(o){throw this.isRunning=!1,ne.log("ERROR","DCF Monte Carlo simulation failed",{error:o.message}),o}finally{this.isRunning=!1}}async runLBOSimulation(e,s,t={}){const{iterations:a=1e4,confidenceLevel:l=.95,correlationMatrix:i=null,randomSeed:r=null}=t;ne.log("INFO","Starting LBO Monte Carlo simulation",{iterations:a,variables:Object.keys(s).length}),this.isRunning=!0;const n=Date.now();try{r&&this.setSeed(r);const o=this.generateCorrelatedSamples(s,a,i),c=[],d=t.onProgress;for(let t=0;t<a;t++){if(!this.isRunning)throw new Error("Simulation cancelled");const l=this.createScenarioInputs(e,o[t],s),i=this.calculateLBOScenario(l);c.push({iteration:t+1,irr:i.irr,moic:i.moic,totalReturn:i.totalReturn,inputs:l}),d&&t%Math.floor(a/100)===0&&d(t/a*100)}const m=this.analyzeResults(c,l,["irr","moic","totalReturn"]),x=Date.now();return ne.log("INFO","LBO Monte Carlo simulation completed",{iterations:a,duration:x-n,meanIRR:m.statistics.irr?.mean}),{type:"LBO_MONTE_CARLO",timestamp:(new Date).toISOString(),parameters:{iterations:a,confidenceLevel:l,randomSeed:r},results:c,analysis:m,duration:x-n}}catch(o){throw this.isRunning=!1,ne.log("ERROR","LBO Monte Carlo simulation failed",{error:o.message}),o}finally{this.isRunning=!1}}generateCorrelatedSamples(e,s,t){const a=Object.keys(e),l=a.length,i=[],r=[];for(let n=0;n<s;n++){const s={};a.forEach(t=>{const a=e[t];s[t]=this.sampleFromDistribution(a)}),r.push(s)}if(t&&t.length===l){const e=this.choleskyDecomposition(t);for(let t=0;t<s;t++){const s={},l=a.map(e=>r[t][e]),n=this.applyCorrelation(l,e);a.forEach((e,t)=>{s[e]=n[t]}),i.push(s)}}else i.push(...r);return i}sampleFromDistribution(e){const{type:s,parameters:t}=e;switch(s){case"normal":return this.normalRandom(t.mean,t.stdDev);case"lognormal":const e=this.normalRandom(t.mu,t.sigma);return Math.exp(e);case"uniform":return t.min+Math.random()*(t.max-t.min);case"triangular":return this.triangularRandom(t.min,t.mode,t.max);case"beta":return this.betaRandom(t.alpha,t.beta);case"exponential":return this.exponentialRandom(t.lambda);case"weibull":return this.weibullRandom(t.shape,t.scale);case"pareto":return this.paretoRandom(t.scale,t.shape);case"student_t":return this.studentTRandom(t.df);case"chi_squared":return this.chiSquaredRandom(t.df);default:throw new Error(`Unsupported distribution type: ${s}`)}}exponentialRandom(e){return-Math.log(1-Math.random())/e}weibullRandom(e,s){const t=Math.random();return s*Math.pow(-Math.log(1-t),1/e)}paretoRandom(e,s){const t=Math.random();return e/Math.pow(t,1/s)}studentTRandom(e){if(e<=0)throw new Error("Degrees of freedom must be positive");const s=this.normalRandom(0,1),t=this.chiSquaredRandom(e);return s/Math.sqrt(t/e)}chiSquaredRandom(e){if(e<=0)throw new Error("Degrees of freedom must be positive");return 2*this.gammaRandom(e/2)}normalRandom(e=0,s=1){if(void 0!==this.spareNormal){const t=this.spareNormal;return this.spareNormal=void 0,t*s+e}const t=Math.random(),a=Math.random(),l=Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*a),i=Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*a);return this.spareNormal=i,l*s+e}triangularRandom(e,s,t){const a=Math.random();return a<(s-e)/(t-e)?e+Math.sqrt(a*(t-e)*(s-e)):t-Math.sqrt((1-a)*(t-e)*(t-s))}betaRandom(e,s){const t=this.gammaRandom(e);return t/(t+this.gammaRandom(s))}gammaRandom(e){if(!(e>=1))return this.gammaRandom(e+1)*Math.pow(Math.random(),1/e);{const s=e-1/3,t=1/Math.sqrt(9*s);for(;;){let e,a;do{e=this.normalRandom(),a=1+t*e}while(a<=0);a*=a*a;const l=Math.random();if(l<1-.0331*e*e*e*e)return s*a;if(Math.log(l)<.5*e*e+s*(1-a+Math.log(a)))return s*a}}}choleskyDecomposition(e){const s=e.length,t=Array(s).fill().map(()=>Array(s).fill(0));for(let a=0;a<s;a++)for(let s=0;s<=a;s++)if(a===s){let a=0;for(let e=0;e<s;e++)a+=t[s][e]*t[s][e];t[s][s]=Math.sqrt(e[s][s]-a)}else{let l=0;for(let e=0;e<s;e++)l+=t[a][e]*t[s][e];t[a][s]=(e[a][s]-l)/t[s][s]}return t}applyCorrelation(e,s){const t=e.length,a=Array(t).fill(0);for(let l=0;l<t;l++)for(let t=0;t<=l;t++)a[l]+=s[l][t]*e[t];return a}createScenarioInputs(e,s,t){const a={...e};return Object.entries(s).forEach(([e,s])=>{const l=t[e];l.applyTo?a[l.applyTo]=s:a[e]=s}),a}calculateDCFScenario(e){const{currentRevenue:s=1e9,revenueGrowthRate:t=.1,fcfMargin:a=.15,wacc:l=.1,terminalGrowthRate:i=.025,sharesOutstanding:r=1e8,currentPrice:n=100}=e;let o=0,c=s;for(let x=1;x<=5;x++){c*=1+t;o+=c*a/Math.pow(1+l,x)}const d=o+c*a*(1+i)/(l-i)/Math.pow(1+l,5),m=d/r;return{pricePerShare:m,enterpriseValue:d,upside:(m-n)/n*100}}calculateLBOScenario(e){const{ebitda:s=1e8,ebitdaGrowthRate:t=.05,exitMultiple:a=10,debtMultiple:l=5,holdingPeriod:i=5}=e,r=s*l,n=10*s-r,o=s*Math.pow(1+t,i)*a-.5*r,c=o/n;return{irr:Math.pow(c,1/i)-1,moic:c,totalReturn:o}}analyzeResults(e,s,t=["pricePerShare","enterpriseValue","upside"]){const a={statistics:{},percentiles:{},confidenceIntervals:{},riskMetrics:{},distributionTests:{},correlations:{}};return t.forEach(t=>{const l=e.map(e=>e[t]).filter(e=>null!==e&&!isNaN(e)).sort((e,s)=>e-s);if(0===l.length)return;const i=l.reduce((e,s)=>e+s,0)/l.length,r=l.reduce((e,s)=>e+Math.pow(s-i,2),0)/l.length,n=Math.sqrt(r),o=Math.sqrt(r*l.length/(l.length-1));a.statistics[t]={mean:i,median:this.percentile(l,.5),mode:this.calculateMode(l),stdDev:n,sampleStdDev:o,variance:r,min:l[0],max:l[l.length-1],range:l[l.length-1]-l[0],count:l.length,trimmedMean:this.calculateTrimmedMean(l,.1),mad:this.calculateMAD(l),iqr:this.percentile(l,.75)-this.percentile(l,.25)},a.percentiles[t]={p1:this.percentile(l,.01),p5:this.percentile(l,.05),p10:this.percentile(l,.1),p25:this.percentile(l,.25),p50:this.percentile(l,.5),p75:this.percentile(l,.75),p90:this.percentile(l,.9),p95:this.percentile(l,.95),p99:this.percentile(l,.99)};const c=1-s,d=this.percentile(l,c/2),m=this.percentile(l,1-c/2);a.confidenceIntervals[t]={level:s,lowerBound:d,upperBound:m,width:m-d,bootstrapCI:this.calculateBootstrapCI(l,s)};const x=this.percentile(l,.05),u=this.percentile(l,.01),h=l.slice(0,Math.floor(.05*l.length)).reduce((e,s)=>e+s,0)/Math.floor(.05*l.length),p=l.slice(0,Math.floor(.01*l.length)).reduce((e,s)=>e+s,0)/Math.floor(.01*l.length);a.riskMetrics[t]={var95:x,var99:u,cvar95:h,cvar99:p,skewness:this.calculateSkewness(l,i,n),kurtosis:this.calculateKurtosis(l,i,n),excessKurtosis:this.calculateKurtosis(l,i,n)-3,expectedShortfall:h,maxDrawdown:this.calculateMaxDrawdown(l),sharpeRatio:this.calculateSharpeRatio(l,.02),sortinoRatio:this.calculateSortinoRatio(l,i)},a.distributionTests[t]={jarqueBera:this.jarqueBeraTest(l),kolmogorovSmirnov:this.ksTestNormality(l),shapiroWilk:l.length<=5e3?this.shapiroWilkTest(l):null}}),t.length>1&&(a.correlations=this.calculateCorrelationMatrix(e,t)),a}calculateMode(e){const s={};e.forEach(e=>{const t=Math.round(100*e)/100;s[t]=(s[t]||0)+1});const t=Math.max(...Object.values(s)),a=Object.keys(s).filter(e=>s[e]===t);return 1===a.length?parseFloat(a[0]):null}calculateTrimmedMean(e,s=.1){const t=Math.floor(e.length*s),a=e.slice(t,-t||void 0);return a.reduce((e,s)=>e+s,0)/a.length}calculateMAD(e){const s=this.percentile(e,.5),t=e.map(e=>Math.abs(e-s)).sort((e,s)=>e-s);return this.percentile(t,.5)}calculateBootstrapCI(e,s,t=1e3){const a=[];for(let i=0;i<t;i++){const s=[];for(let t=0;t<e.length;t++)s.push(e[Math.floor(Math.random()*e.length)]);a.push(s.reduce((e,s)=>e+s,0)/s.length)}a.sort((e,s)=>e-s);const l=1-s;return{lowerBound:this.percentile(a,l/2),upperBound:this.percentile(a,1-l/2)}}calculateMaxDrawdown(e){let s=e[0],t=0;for(const a of e){a>s&&(s=a);const e=(s-a)/s;e>t&&(t=e)}return t}calculateSharpeRatio(e,s=.02){const t=e.reduce((e,s)=>e+s,0)/e.length,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/e.length,l=Math.sqrt(a);return l>0?(t-s)/l:0}calculateSortinoRatio(e,s){const t=e.map(e=>e-s),a=t.filter(e=>e<0);if(0===a.length)return 1/0;const l=Math.sqrt(a.reduce((e,s)=>e+s*s,0)/a.length),i=t.reduce((e,s)=>e+s,0)/t.length;return l>0?i/l:0}jarqueBeraTest(e){const s=e.length,t=e.reduce((e,s)=>e+s,0)/s,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/s,l=Math.sqrt(a),i=this.calculateSkewness(e,t,l),r=this.calculateKurtosis(e,t,l),n=s/6*(Math.pow(i,2)+Math.pow(r-3,2)/4),o=1-this.chiSquaredCDF(n,2);return{statistic:n,pValue:o,isNormal:o>.05}}chiSquaredCDF(e,s){return e<=0?0:this.incompleteGamma(s/2,e/2)}incompleteGamma(e,s){if(0===s)return 0;if(s<e+1){let t=1/e,a=1/e;for(let l=1;l<100&&(a*=s/(e+l),t+=a,!(a<1e-15));l++);return Math.exp(-s+e*Math.log(s)-this.logGamma(e))*t}return 1-this.incompleteGamma(e,s)}logGamma(e){const s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let t=0;const a=1.000000000190015;let l=e,i=l=e,r=e+5.5;for(r-=(e+.5)*Math.log(r);t<6;t++)a+=s[t]/++i;return-r+Math.log(2.5066282746310007*a/l)}ksTestNormality(e){const s=e.length,t=e.reduce((e,s)=>e+s,0)/s,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/s,l=Math.sqrt(a);let i=0;for(let n=0;n<s;n++){const a=(n+1)/s,r=this.normalCDF((e[n]-t)/l),o=Math.abs(a-r);o>i&&(i=o)}const r=1.36/Math.sqrt(s);return{statistic:i,critical:r,isNormal:i<r}}normalCDF(e){return.5*(1+this.erf(e/Math.sqrt(2)))}erf(e){const s=e<0?-1:1,t=1/(1+.3275911*(e=Math.abs(e)));return s*(1-((((1.061405429*t-1.453152027)*t+1.421413741)*t-.284496736)*t+.254829592)*t*Math.exp(-e*e))}shapiroWilkTest(e){const s=e.length;if(s<3||s>5e3)return null;const t=[...e].sort((e,s)=>e-s),a=e.reduce((e,s)=>e+s,0)/s;let l=0;for(let r=0;r<s;r++)l+=Math.pow(t[r]-a,2);const i=0/l;return{statistic:i,isNormal:i>.9}}calculateCorrelationMatrix(e,s){const t={};for(let a=0;a<s.length;a++){t[s[a]]={};for(let l=0;l<s.length;l++)if(a===l)t[s[a]][s[l]]=1;else{const i=e.map(e=>e[s[a]]).filter(e=>null!==e&&!isNaN(e)),r=e.map(e=>e[s[l]]).filter(e=>null!==e&&!isNaN(e));t[s[a]][s[l]]=this.calculateCorrelation(i,r)}}return t}calculateCorrelation(e,s){if(e.length!==s.length||0===e.length)return 0;const t=e.length,a=e.reduce((e,s)=>e+s,0)/t,l=s.reduce((e,s)=>e+s,0)/t;let i=0,r=0,n=0;for(let c=0;c<t;c++){const t=e[c]-a,o=s[c]-l;i+=t*o,r+=t*t,n+=o*o}const o=Math.sqrt(r*n);return o>0?i/o:0}percentile(e,s){const t=s*(e.length-1),a=Math.floor(t),l=Math.ceil(t),i=t-a;return a===l?e[a]:e[a]*(1-i)+e[l]*i}calculateSkewness(e,s,t){const a=e.length;return a/((a-1)*(a-2))*e.reduce((e,a)=>e+Math.pow((a-s)/t,3),0)}calculateKurtosis(e,s,t){const a=e.length;return a*(a+1)/((a-1)*(a-2)*(a-3))*e.reduce((e,a)=>e+Math.pow((a-s)/t,4),0)-3*Math.pow(a-1,2)/((a-2)*(a-3))}setSeed(e){this.seed=e,this.random=()=>(this.seed=(9301*this.seed+49297)%233280,this.seed/233280),Math.random=this.random}stopSimulation(){this.isRunning=!1}isSimulationRunning(){return this.isRunning}},xe=({data:a,onDataChange:l,onAdjustedValuesChange:x})=>{const[u,h]=s.useState("incomeStatement"),[p,g]=s.useState({}),[b,j]=s.useState({revenue:!0,costOfGoodsSold:!0,operatingExpenses:!0,salariesBenefits:!0,grossProfit:!0,operatingIncome:!0,incomeBeforeTax:!0,otherIncomeExpense:!0,currentAssets:!0,nonCurrentAssets:!0,currentLiabilities:!0,nonCurrentLiabilities:!0,equity:!0,operatingActivities:!0,investingActivities:!0,financingActivities:!0}),[f,v]=s.useState(null),[y,N]=s.useState(""),w=s.useRef(null);s.useEffect(()=>{if(a?.statements?.incomeStatement&&0===Object.keys(p).length){const e={},s=a.statements.incomeStatement;Object.keys(s).forEach(t=>{s[t]&&void 0!==s[t][2]&&(e[t]=s[t][2])}),g(e),x&&x(e)}},[a,p,x]);const C={revenue:{title:"Revenue",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"energyDevices",label:"Energy Devices",level:1},{key:"injectables",label:"Injectables",level:1},{key:"wellness",label:"Wellness",level:1},{key:"weightloss",label:"Weightloss",level:1},{key:"retailSales",label:"Retail Sales",level:1},{key:"surgery",label:"Surgery",level:1},{key:"totalRevenue",label:"Total Revenue",level:0,bold:!0,formula:!0}]},costOfGoodsSold:{title:"Cost of Goods Sold",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"energyDeviceSupplies",label:"Energy Device Supplies",level:1},{key:"injectablesCogs",label:"Injectables",level:1},{key:"wellnessCogs",label:"Wellness",level:1},{key:"weightlossCogs",label:"Weightloss",level:1},{key:"retailProducts",label:"Retail Products",level:1},{key:"surgicalSupplies",label:"Surgical Supplies",level:1},{key:"totalCostOfGoodsSold",label:"Total Cost of Goods Sold",level:0,bold:!0,formula:!0}]},grossProfit:{title:"Gross Profit",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"grossProfit",label:"Gross Profit",level:0,bold:!0,formula:!0}]},salariesBenefits:{title:"Salaries & Benefits",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"employeeBenefits",label:"Employee Benefits",level:1},{key:"payroll",label:"Payroll",level:1},{key:"payrollTaxes",label:"Payroll Taxes",level:1},{key:"totalSalariesBenefits",label:"Total Salaries & Benefits",level:0,bold:!0,formula:!0}]},operatingExpenses:{title:"Operating Expenses",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"marketing",label:"Marketing",level:1},{key:"automobile",label:"Automobile",level:1},{key:"creditCardBankCharges",label:"Credit Card and Bank Charges",level:1},{key:"donations",label:"Donations",level:1},{key:"computerTelephoneUtilities",label:"Computer, Telephone, and Utilities",level:1},{key:"depreciation",label:"Depreciation",level:1},{key:"duesSubscriptions",label:"Dues & Subscriptions",level:1},{key:"education",label:"Education",level:1},{key:"equipmentRental",label:"Equipment Rental",level:1},{key:"insurance",label:"Insurance",level:1},{key:"interestExpense",label:"Interest Expense",level:1},{key:"travelMealsEntertainment",label:"Travel, Meals, and Entertainment",level:1},{key:"rent",label:"Rent",level:1},{key:"officeExpenses",label:"Office Expenses",level:1},{key:"professionalFees",label:"Professional Fees",level:1},{key:"repairsMaintenance",label:"Repairs & Maintenance",level:1},{key:"localTax",label:"Local Tax",level:1},{key:"stateTax",label:"State Tax",level:1},{key:"totalOperatingExpense",label:"Total Operating Expense",level:0,bold:!0,formula:!0}]},operatingIncome:{title:"Operating Income",color:"bg-teal-50 border-teal-300",headerBg:"bg-teal-600",textColor:"text-teal-900",items:[{key:"operatingIncome",label:"Operating Income",level:0,bold:!0}]},otherIncomeExpense:{title:"Other Income / (Expense)",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-600",textColor:"text-slate-900",items:[{key:"gainOnAssetSale",label:"Gain (Loss) On Asset Sale",level:1},{key:"interestIncome",label:"Interest Income",level:1},{key:"otherExpenses",label:"Other Expenses",level:1},{key:"totalOtherIncomeExpense",label:"Total Other Income / (Expenses)",level:0,bold:!0,formula:!0}]},incomeBeforeTax:{title:"Net Income Before Taxes",color:"bg-amber-50 border-amber-300",headerBg:"bg-amber-600",textColor:"text-amber-900",items:[{key:"incomeBeforeTax",label:"Net Income Before Taxes",level:0,bold:!0}]}},k={currentAssets:{title:"Current Assets",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"cash",label:"Cash and Cash Equivalents",level:1},{key:"receivables",label:"Accounts Receivable",level:1},{key:"inventory",label:"Inventory",level:1},{key:"prepaidExpenses",label:"Prepaid Expenses",level:1},{key:"otherCurrentAssets",label:"Other Current Assets",level:1},{key:"totalCurrentAssets",label:"Total Current Assets",level:0,formula:!0,bold:!0}]},nonCurrentAssets:{title:"Non-Current Assets",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"ppe",label:"Property, Plant & Equipment",level:1},{key:"accumulatedDepreciation",label:"Less: Accumulated Depreciation",level:1},{key:"netPPE",label:"Net Property, Plant & Equipment",level:1,formula:!0},{key:"intangibleAssets",label:"Intangible Assets",level:1},{key:"goodwill",label:"Goodwill",level:1},{key:"otherNonCurrentAssets",label:"Other Non-Current Assets",level:1},{key:"totalNonCurrentAssets",label:"Total Non-Current Assets",level:0,formula:!0,bold:!0}]},totalAssets:{title:"Total Assets",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalAssets",label:"Total Assets",level:0,formula:!0,bold:!0}]},currentLiabilities:{title:"Current Liabilities",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"accountsPayable",label:"Accounts Payable",level:1},{key:"accruedExpenses",label:"Accrued Expenses",level:1},{key:"shortTermDebt",label:"Short-term Debt",level:1},{key:"currentPortionLongTermDebt",label:"Current Portion of Long-term Debt",level:1},{key:"otherCurrentLiabilities",label:"Other Current Liabilities",level:1},{key:"totalCurrentLiabilities",label:"Total Current Liabilities",level:0,formula:!0,bold:!0}]},nonCurrentLiabilities:{title:"Non-Current Liabilities",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"longTermDebt",label:"Long-term Debt",level:1},{key:"deferredTaxLiabilities",label:"Deferred Tax Liabilities",level:1},{key:"otherNonCurrentLiabilities",label:"Other Non-Current Liabilities",level:1},{key:"totalNonCurrentLiabilities",label:"Total Non-Current Liabilities",level:0,formula:!0,bold:!0}]},totalLiabilities:{title:"Total Liabilities",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilities",label:"Total Liabilities",level:0,formula:!0,bold:!0}]},equity:{title:"Shareholders' Equity",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"commonStock",label:"Common Stock",level:1},{key:"retainedEarnings",label:"Retained Earnings",level:1},{key:"otherEquity",label:"Other Comprehensive Income",level:1},{key:"totalEquity",label:"Total Shareholders' Equity",level:0,formula:!0,bold:!0}]},totalLiabilitiesEquity:{title:"Total Liabilities and Equity",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilitiesEquity",label:"Total Liabilities and Shareholders' Equity",level:0,formula:!0,bold:!0}]}},M={operatingActivities:{title:"Operating Activities",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"netIncome",label:"Net Income",level:1},{key:"depreciation",label:"Depreciation and Amortization",level:1},{key:"receivablesChange",label:"Change in Accounts Receivable",level:1},{key:"inventoryChange",label:"Change in Inventory",level:1},{key:"payablesChange",label:"Change in Accounts Payable",level:1},{key:"otherOperatingChanges",label:"Other Operating Changes",level:1},{key:"netCashFromOperating",label:"Net Cash from Operating Activities",level:0,formula:!0,bold:!0}]},investingActivities:{title:"Investing Activities",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"capex",label:"Capital Expenditures",level:1},{key:"acquisitions",label:"Acquisitions",level:1},{key:"assetSales",label:"Asset Sales",level:1},{key:"otherInvestingActivities",label:"Other Investing Activities",level:1},{key:"netCashFromInvesting",label:"Net Cash from Investing Activities",level:0,formula:!0,bold:!0}]},financingActivities:{title:"Financing Activities",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"debtIssuance",label:"Debt Issuance",level:1},{key:"debtRepayment",label:"Debt Repayment",level:1},{key:"equityIssuance",label:"Equity Issuance",level:1},{key:"dividends",label:"Dividends Paid",level:1},{key:"otherFinancingActivities",label:"Other Financing Activities",level:1},{key:"netCashFromFinancing",label:"Net Cash from Financing Activities",level:0,formula:!0,bold:!0}]},netCashFlow:{title:"Net Cash Flow",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"netCashFlow",label:"Net Change in Cash",level:0,formula:!0,bold:!0},{key:"beginningCash",label:"Cash at Beginning of Period",level:1},{key:"endingCash",label:"Cash at End of Period",level:0,formula:!0,bold:!0}]}},R=(()=>{switch(u){case"balanceSheet":return k;case"cashFlow":return M;default:return C}})(),S=(e,s,t=!1)=>{v({rowKey:e,periodIndex:s,isAdjusted:t});let l="";l=t?p[e]||"":a.statements.incomeStatement[e]?.[s]||"",N(l.toString())},F=()=>{if(f){const{rowKey:e,periodIndex:s,isAdjusted:t}=f,i=parseFloat(y)||0;if(t){const s={...p,[e]:i};g(s),x&&x(s)}else{const t={...a};t.statements.incomeStatement[e]||(t.statements.incomeStatement[e]={}),t.statements.incomeStatement[e][s]=i,l(t)}v(null),N("")}},I=e=>{"Enter"===e.key?(e.preventDefault(),F()):"Escape"===e.key?(e.preventDefault(),v(null),N("")):"Tab"===e.key&&(e.preventDefault(),F())},A=e=>/^-?\d*\.?\d*$/.test(e)||""===e,P=e=>{if(!e&&0!==e)return"";const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"";const t=Math.abs(s);let a;return t>=1e6?(a=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(s/1e6),a+="M"):a=t>=1e3?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s):new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s),a};s.useEffect(()=>{f&&w.current&&(w.current.focus(),w.current.select())},[f]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:e.jsx("div",{className:"max-w-full mx-auto px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(i,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Financial Spreadsheet"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Professional financial modeling workspace"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{const e=prompt('Enter period label (e.g., "Year 5"):');if(e){const s={...a};s.periods=[...s.periods,e],l(s)}},className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium",children:[e.jsx(r,{size:16}),"Add Period"]}),e.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:"px-4 py-2.5 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium shadow-sm",children:[e.jsx("option",{value:"incomeStatement",children:"Income Statement"}),e.jsx("option",{value:"balanceSheet",children:"Balance Sheet"}),e.jsx("option",{value:"cashFlow",children:"Cash Flow Statement"})]})]})]})})}),e.jsxs("div",{className:"max-w-full mx-auto p-8",children:[e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-800 to-slate-900 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[320px] px-6 py-4 text-left text-sm font-semibold tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{size:16,className:"text-slate-300"}),"Account Description"]})}),e.jsx("th",{className:"w-20 px-4 py-4 text-center text-sm font-semibold",children:"Units"}),a.periods.map((s,t)=>e.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s}),e.jsx("span",{className:"text-xs text-slate-300 font-normal",children:"Actual"})]})},t)),e.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold bg-gradient-to-r from-amber-600 to-yellow-600 border-l-2 border-amber-400",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"Adjusted"}),e.jsx("span",{className:"text-xs text-amber-100 font-normal",children:"Modified"})]})}),e.jsx("th",{className:"w-28 px-4 py-4 text-center text-sm font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(o,{size:14}),"Type"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:Object.entries(R).map(([s,i])=>e.jsxs(t.Fragment,{children:[e.jsx("tr",{className:`${i.headerBg||"bg-slate-600"} border-b-2 border-slate-300`,children:e.jsx("td",{colSpan:a.periods.length+4,className:"py-4 px-6",children:e.jsxs("button",{onClick:()=>(e=>{j(s=>({...s,[e]:!s[e]}))})(s),className:"flex items-center gap-3 text-white hover:text-slate-200 transition-colors w-full text-left group",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/20 group-hover:bg-white/30 transition-colors",children:b[s]?e.jsx(c,{size:14}):e.jsx(d,{size:14})}),e.jsx("span",{className:"font-bold text-lg",children:i.title}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(()=>{if(prompt("Enter row label:")){const e={...a};l(e)}})()},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Add custom row",children:e.jsx(r,{size:16})})]})})}),b[s]&&i.items.map(s=>(s=>{const{key:t,label:l,level:i,formula:r,bold:n}=s,c=1===i?"pl-8":2===i?"pl-12":"pl-4",d=n?"font-bold":0===i?"font-semibold":"font-medium",x=0===i?"text-slate-900":"text-slate-700",u=0===i?"bg-slate-50/70":"bg-white",h=0===i?"border-slate-200":"border-slate-100";return e.jsxs("tr",{className:`${u} border-b ${h} hover:bg-slate-50 transition-all duration-150 group`,children:[e.jsx("td",{className:`px-6 py-4 ${c} ${d} text-sm ${x}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[0===i&&e.jsx("div",{className:"w-1.5 h-4 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full flex-shrink-0 shadow-sm"}),e.jsx("span",{className:"leading-tight",children:l}),r&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{size:14,className:"text-blue-500/80 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium px-1.5 py-0.5 bg-blue-50 rounded-md",children:"AUTO"})]})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide bg-slate-100 px-2 py-1 rounded-md",children:"$ 000s"})}),a.periods.map((s,l)=>e.jsx("td",{className:"px-4 py-4 text-right",children:f?.rowKey!==t||f?.periodIndex!==l||f?.isAdjusted?e.jsxs("div",{onClick:()=>!r&&S(t,l),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(r?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),children:[e.jsx("span",{className:r?"text-blue-900":"text-slate-700",children:P(a.statements.incomeStatement[t]?.[l])||"—"}),!r&&e.jsx(m,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-slate-400 transition-opacity"})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:w,type:"text",value:y,onChange:e=>{const s=e.target.value;A(s)&&N(s)},onBlur:F,onKeyDown:I,className:"w-full px-3 py-2.5 bg-white border-2 border-blue-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-blue-100 focus:border-blue-500 shadow-lg",placeholder:"0.00"}),e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[e.jsx("button",{onClick:F,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),e.jsx("button",{onClick:()=>{v(null),N("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]})},l)),e.jsx("td",{className:"px-4 py-4 text-right bg-gradient-to-r from-amber-50 to-yellow-50 border-l-2 border-amber-300",children:f?.rowKey===t&&f?.isAdjusted?e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:w,type:"text",value:y,onChange:e=>{const s=e.target.value;A(s)&&N(s)},onBlur:F,onKeyDown:I,className:"w-full px-3 py-2.5 bg-white border-2 border-amber-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-amber-100 focus:border-amber-500 shadow-lg",placeholder:"0.00"}),e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[e.jsx("button",{onClick:F,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),e.jsx("button",{onClick:()=>{v(null),N("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]}):e.jsxs("div",{onClick:()=>!r&&S(t,null,!0),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(r?"bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-800 font-semibold border border-amber-300 shadow-sm":"hover:bg-amber-100 text-slate-800 cursor-pointer border border-transparent hover:border-amber-300 hover:shadow-sm"),children:[e.jsx("span",{className:r?"text-amber-900":"text-slate-700",children:P(p[t]||0)||"—"}),!r&&e.jsx(m,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-amber-500 transition-opacity"})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium "+(r?"bg-blue-100 text-blue-800 border border-blue-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:r?e.jsxs(e.Fragment,{children:[e.jsx(o,{size:10,className:"mr-1"}),"Auto"]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{size:10,className:"mr-1"}),"Manual"]})})})]},t)})(s))]},s))})]})})}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(o,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"How to Use"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Click any editable cell to modify values with enhanced input controls"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Use Enter to save changes or Escape to cancel editing"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Expand/collapse sections using the arrow controls"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Formula cells automatically calculate based on inputs"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(i,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Professional Features"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Color-coded sections for easy visual navigation"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Adjusted column for scenario analysis and modifications"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Professional number formatting with proper alignment"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Enhanced editing experience with save/cancel controls"]})]})]})]})]})]})},ue=({data:t,modelInputs:a,onModelInputChange:l,calculateDCF:n,formatCurrency:o,formatPercent:c})=>{const[d,m]=s.useState(!1),b=a.scenario?.scenarios||[],j=s.useMemo(()=>b.map(e=>{try{const s={...t.statements.incomeStatement},a=s.totalRevenue||{},l={};Object.keys(a).forEach(s=>{const t=parseInt(s);if(0===t)l[s]=a[s];else{const i=1+e.revenueGrowth/100;l[s]=a[0]*Math.pow(i,t)}});const i=s.operatingIncome||{},r={};Object.keys(i).forEach(s=>{if(0===parseInt(s))r[s]=i[s];else{const t=a[s]||0,n=l[s]||0,o=i[s]||0;if(t>0){const a=o/t+e.marginImprovement/100;r[s]=n*a}else r[s]=o}});const o={...t,statements:{...t.statements,incomeStatement:{...s,totalRevenue:l,operatingIncome:r}}},c=n(o);return{...e,...c,weightedValue:c.enterpriseValue*(e.probability/100)}}catch(s){return{...e,enterpriseValue:0,equityValue:0,weightedValue:0}}}),[b,t,n]),f=j.reduce((e,s)=>e+s.weightedValue,0),v=(e,s,t)=>{const a=b.map((a,l)=>l===e?{...a,[s]:t}:a);l("scenario","scenarios",a)},y=({scenario:s,index:t})=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name"}),e.jsx("input",{type:"text",value:s.name,onChange:e=>v(t,"name",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter scenario name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probability (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:s.probability,onChange:e=>v(t,"probability",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue Growth (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.revenueGrowth,onChange:e=>v(t,"revenueGrowth",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margin Change (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.marginImprovement,onChange:e=>v(t,"marginImprovement",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"flex justify-end mt-4 gap-2",children:e.jsxs("button",{onClick:()=>(e=>{const s=b.filter((s,t)=>t!==e);l("scenario","scenarios",s)})(t),className:"px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-1",children:[e.jsx(g,{size:16}),"Delete"]})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-gray-600",children:"Create and compare multiple financial scenarios with different assumptions and probabilities."})}),e.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(r,{size:16}),"Add Scenario"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Assumptions"}),b.map((s,t)=>e.jsx(y,{scenario:s,index:t},t)),d&&e.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h5",{className:"font-medium",children:"Add New Scenario"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const e={name:`Scenario ${b.length+1}`,probability:Math.max(0,100-b.reduce((e,s)=>e+s.probability,0)),revenueGrowth:10,marginImprovement:0};l("scenario","scenarios",[...b,e]),m(!1)},className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add"}),e.jsx("button",{onClick:()=>m(!1),className:"px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})]}),j.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Analysis Results"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(x,{size:20,className:"text-blue-600"}),e.jsx("h5",{className:"font-semibold text-blue-800",children:"Probability-Weighted Valuation"})]}),e.jsx("div",{className:"text-3xl font-bold text-blue-800",children:o(f)}),e.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Expected value based on scenario probabilities"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:j.map((s,t)=>e.jsxs(u.div,{className:"bg-white rounded-lg border p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:[s.probability,"% probability"]}),s.revenueGrowth>15?e.jsx(i,{size:14,className:"text-green-500"}):s.revenueGrowth<5?e.jsx(h,{size:14,className:"text-red-500"}):e.jsx(p,{size:14,className:"text-gray-500"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Enterprise Value"}),e.jsx("div",{className:"text-xl font-bold text-gray-800",children:o(s.enterpriseValue)})]}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Revenue Growth:"}),e.jsx("span",{className:"font-medium",children:c(s.revenueGrowth)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Margin Change:"}),e.jsxs("span",{className:"font-medium "+(s.marginImprovement>=0?"text-green-600":"text-red-600"),children:[s.marginImprovement>=0?"+":"",c(s.marginImprovement)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Weighted Value:"}),e.jsx("span",{className:"font-medium",children:o(s.weightedValue)})]})]})]})]},t))}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h5",{className:"font-semibold mb-4",children:"Scenario Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o(Math.max(...j.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Best Case"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o(Math.min(...j.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Worst Case"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o(f)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Expected Value"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o(Math.max(...j.map(e=>e.enterpriseValue))-Math.min(...j.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Value Range"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Total Probability:"})," ",b.reduce((e,s)=>e+s.probability,0),"%",100!==b.reduce((e,s)=>e+s.probability,0)&&e.jsx("span",{className:"text-orange-600 ml-2",children:"⚠ Probabilities should sum to 100%"})]})})]})]}),0===b.length&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(x,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No scenarios created yet."}),e.jsx("p",{className:"text-sm mt-2",children:'Click "Add Scenario" to get started with scenario modeling.'})]})]})},he=({data:t,modelInputs:a,onModelInputChange:l,calculateDCF:i,formatCurrency:n,formatPercent:o})=>{const[c,d]=s.useState(null),m=a.sensitivity||{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},u={revenue:{name:"Revenue Growth",unit:"%",description:"Annual revenue growth rate",baseValue:15,isPercentage:!0},grossMargin:{name:"Gross Margin",unit:"%",description:"Gross profit margin improvement",baseValue:45,isPercentage:!0},discountRate:{name:"Discount Rate (WACC)",unit:"%",description:"Weighted average cost of capital",baseValue:a.dcf?.discountRate||10,isPercentage:!0},terminalGrowthRate:{name:"Terminal Growth Rate",unit:"%",description:"Long-term growth rate assumption",baseValue:a.dcf?.terminalGrowthRate||2.5,isPercentage:!0},taxRate:{name:"Tax Rate",unit:"%",description:"Corporate tax rate",baseValue:a.dcf?.taxRate||25,isPercentage:!0}},h=s.useMemo(()=>i(),[t,a,i]),g=s.useMemo(()=>{const e={};return m.variables.forEach(s=>{const l=m.ranges[s],i=u[s];if(!l||!i)return;const r=(l.max-l.min)/8,n=[];for(let e=0;e<9;e++){const o=l.min+r*e;let c={...t},d={...a.dcf,[s]:(i.isPercentage,o)};if("revenue"===s||"grossMargin"===s){const e={...t.statements.incomeStatement};if("revenue"===s){const s=e.totalRevenue||{},t={};Object.keys(s).forEach(e=>{const a=parseInt(e);if(0===a)t[e]=s[e];else{const l=1+o/100;t[e]=s[0]*Math.pow(l,a)}}),e.totalRevenue=t}if("grossMargin"===s){const s=e.operatingIncome||{},t=e.totalRevenue||{},a={};Object.keys(s).forEach(e=>{const l=t[e]||0,i=s[e]||0;if(l>0){const s=i/l+o/100;a[e]=l*s}else a[e]=i}),e.operatingIncome=a}c={...t,statements:{...t.statements,incomeStatement:e}}}const m=(()=>{try{const e={discountRate:d.discountRate||10,terminalGrowthRate:d.terminalGrowthRate||2.5,projectionYears:d.projectionYears||5,taxRate:d.taxRate||25},s=c.statements.incomeStatement.operatingIncome||{};let t=[];if(Object.keys(s).forEach(e=>{parseInt(e)>=0&&t.push(s[e]||0)}),0===t.length)return{enterpriseValue:0,equityValue:0};let a=0;const l=1+e.discountRate/100;t.forEach((s,t)=>{if(t>0&&t<=e.projectionYears){const i=s*(1-e.taxRate/100)/Math.pow(l,t);a+=i}});const i=t[t.length-1]||0,r=i*(1+e.terminalGrowthRate/100)*(1-e.taxRate/100)/((e.discountRate-e.terminalGrowthRate)/100),n=r/Math.pow(l,e.projectionYears),o=a+n;return{enterpriseValue:o,equityValue:o,presentValueOperations:a,presentValueTerminal:n,terminalValue:r}}catch(e){return{enterpriseValue:0,equityValue:0}}})();n.push({variable:o,valuation:m.enterpriseValue,changeFromBase:(m.enterpriseValue-h.enterpriseValue)/h.enterpriseValue*100})}e[s]={definition:i,range:l,dataPoints:n}}),e},[t,a,m,h,i]),f=s.useMemo(()=>Object.entries(g).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>Math.abs(e.changeFromBase)));return{variable:e,definition:s.definition,maxImpact:t,positiveImpact:Math.max(...s.dataPoints.map(e=>e.changeFromBase)),negativeImpact:Math.min(...s.dataPoints.map(e=>e.changeFromBase))}}).sort((e,s)=>s.maxImpact-e.maxImpact),[g]),v=(e,s,t)=>{const a={...m.ranges,[e]:{...m.ranges[e],[s]:parseFloat(t)}};l("sensitivity","ranges",a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze how changes in key variables impact enterprise valuation. Higher sensitivity indicates greater risk and importance for due diligence."}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsxs("span",{children:["Base Case: ",n(h.enterpriseValue)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:14}),e.jsxs("span",{children:[m.variables.length," variables analyzed"]})]})]})]}),e.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[e.jsx(j,{size:16}),"Configure"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("h4",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(x,{size:20}),"Impact Ranking (Tornado Chart)"]}),e.jsx("div",{className:"space-y-3",children:f.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-sm font-medium",children:[t+1,". ",s.definition.name]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["±",s.maxImpact.toFixed(1),"%"]})]}),e.jsxs("div",{className:"relative h-8 bg-gray-100 rounded",children:[e.jsx("div",{className:"absolute left-1/2 h-full bg-red-400 rounded-l",style:{width:Math.abs(s.negativeImpact)/Math.max(Math.abs(s.negativeImpact),s.positiveImpact)*50+"%",transform:"translateX(-100%)"}}),e.jsx("div",{className:"absolute left-1/2 h-full bg-green-400 rounded-r",style:{width:s.positiveImpact/Math.max(Math.abs(s.negativeImpact),s.positiveImpact)*50+"%"}}),e.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-400 transform -translate-x-0.5"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-2 text-xs font-medium text-white",children:[e.jsxs("span",{children:[s.negativeImpact.toFixed(1),"%"]}),e.jsxs("span",{children:["+",s.positiveImpact.toFixed(1),"%"]})]})]})]},s.variable))})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Variable Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.variables.map(s=>{const t=g[s];return t?e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium",children:t.definition.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.definition.description})]}),e.jsx("button",{onClick:()=>(e=>{const s=m.variables.filter(s=>s!==e),{[e]:t,...a}=m.ranges;l("sensitivity","variables",s),l("sensitivity","ranges",a)})(s),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:e.jsx(p,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Min Value (",t.definition.unit,")"]}),e.jsx("input",{type:"number",step:"0.1",value:t.range.min,onChange:e=>v(s,"min",e.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Max Value (",t.definition.unit,")"]}),e.jsx("input",{type:"number",step:"0.1",value:t.range.max,onChange:e=>v(s,"max",e.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"h-16 bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Valuation Sensitivity"}),e.jsx("div",{className:"flex items-end justify-between h-8",children:t.dataPoints.map((s,a)=>e.jsx("div",{className:"w-1 rounded-t "+(s.changeFromBase>0?"bg-green-400":s.changeFromBase<0?"bg-red-400":"bg-blue-400"),style:{height:Math.abs(s.changeFromBase)/50*100+"%",minHeight:"2px"},title:`${s.variable}${t.definition.unit}: ${n(s.valuation)}`},a))})]})]},s):null}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(r,{size:24,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add Variable"}),e.jsx("div",{className:"space-y-2",children:Object.keys(u).filter(e=>!m.variables.includes(e)).map(s=>e.jsx("button",{onClick:()=>(e=>{if(!m.variables.includes(e)&&u[e]){const s=[...m.variables,e],t={...m.ranges,[e]:{min:-10,max:10}};l("sensitivity","variables",s),l("sensitivity","ranges",t)}})(s),className:"block w-full px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:u[s].name},s))})]})})]})]}),c&&g[c]&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("h4",{className:"font-semibold text-lg mb-4",children:["Detailed Analysis: ",g[c].definition.name]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium mb-3",children:"Data Points"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:g[c].dataPoints.map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center text-sm p-2 bg-gray-50 rounded",children:[e.jsxs("span",{children:[s.variable,g[c].definition.unit]}),e.jsx("span",{className:"font-medium",children:n(s.valuation)}),e.jsxs("span",{className:"font-medium "+(s.changeFromBase>0?"text-green-600":s.changeFromBase<0?"text-red-600":"text-gray-600"),children:[s.changeFromBase>0?"+":"",s.changeFromBase.toFixed(1),"%"]})]},t))})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Range Impact:"}),e.jsxs("span",{className:"font-medium",children:["±",Math.max(...g[c].dataPoints.map(e=>Math.abs(e.changeFromBase))).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max Upside:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["+",Math.max(...g[c].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max Downside:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[Math.min(...g[c].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]})]})]})]})]})]})},pe=({dcfData:t,sensitivityData:a,scenarioData:l,formatCurrency:r,formatPercent:n})=>{const[o,c]=s.useState("dcf-waterfall"),[d,m]=s.useState(!0),h=[{id:"dcf-waterfall",label:"DCF Waterfall",icon:x,category:"dcf"},{id:"cashflow-trend",label:"Cash Flow Trend",icon:i,category:"dcf"},{id:"sensitivity-tornado",label:"Sensitivity Tornado",icon:b,category:"sensitivity"},{id:"scenario-distribution",label:"Scenario Distribution",icon:y,category:"scenario"},{id:"valuation-bridge",label:"Valuation Bridge",icon:x,category:"combined"}],p=s.useMemo(()=>{if(!t?.years)return[];let e=0;const s=[];t.years.forEach((t,a)=>{const l=e;e+=t.presentValue,s.push({name:`Year ${t.year}`,value:t.presentValue,cumulative:e,start:l,freeCashFlow:t.freeCashFlow,category:"operations"})});const a=e;return e+=t.presentValueTerminal,s.push({name:"Terminal Value",value:t.presentValueTerminal,cumulative:e,start:a,category:"terminal"}),s},[t]),g=s.useMemo(()=>t?.years?t.years.map((e,s)=>({year:`Year ${e.year}`,freeCashFlow:e.freeCashFlow,presentValue:e.presentValue,revenue:e.revenue,operatingIncome:e.operatingIncome,workingCapitalChange:e.workingCapitalChange,capex:Math.abs(e.capex)})):[],[t]),j=s.useMemo(()=>a?Object.entries(a).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>e.changeFromBase)),a=Math.min(...s.dataPoints.map(e=>e.changeFromBase));return{variable:s.definition.name,upside:t,downside:Math.abs(a),range:t-a}}).sort((e,s)=>s.range-e.range):[],[a]),N=s.useMemo(()=>l?.length?l.map((e,s)=>({name:e.name,value:e.enterpriseValue,probability:e.probability,weightedValue:e.weightedValue,fill:`hsl(${137.5*s%360}, 70%, 50%)`})):[],[l]),w=({active:s,payload:t,label:a,chartType:l})=>{if(!s||!t||!t.length)return null;return e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium text-gray-800",children:a}),t.map((s,t)=>{return e.jsx("p",{style:{color:s.color},className:"text-sm",children:`${s.dataKey}: ${a=s.value,l=s.dataKey,l?.includes("Percent")||l?.includes("Rate")?n(a):r(a)}`},t);var a,l})]})},C=()=>e.jsx(_,{width:"100%",height:400,children:e.jsxs(W,{data:p,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"name"}),e.jsx(H,{tickFormatter:e=>r(e)}),e.jsx(Y,{content:e.jsx(w,{chartType:"waterfall"})}),e.jsx(Q,{dataKey:"value",fill:"#3B82F6"})]})}),k=()=>e.jsx(_,{width:"100%",height:400,children:e.jsxs(ee,{data:g,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"year"}),e.jsx(H,{tickFormatter:e=>r(e)}),e.jsx(Y,{content:e.jsx(w,{chartType:"trend"})}),e.jsx(se,{}),e.jsx(te,{type:"monotone",dataKey:"freeCashFlow",stroke:"#10B981",strokeWidth:3,name:"Free Cash Flow"}),e.jsx(te,{type:"monotone",dataKey:"presentValue",stroke:"#3B82F6",strokeWidth:2,name:"Present Value"}),e.jsx(te,{type:"monotone",dataKey:"revenue",stroke:"#8B5CF6",strokeWidth:2,name:"Revenue"})]})}),M=()=>e.jsx(_,{width:"100%",height:400,children:e.jsxs(W,{data:j,layout:"horizontal",margin:{top:20,right:30,left:100,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{type:"number",tickFormatter:e=>`${e.toFixed(1)}%`}),e.jsx(H,{type:"category",dataKey:"variable"}),e.jsx(Y,{formatter:(e,s)=>[`${e.toFixed(1)}%`,s],labelFormatter:e=>`Variable: ${e}`}),e.jsx(Q,{dataKey:"upside",fill:"#10B981",name:"Upside Impact"}),e.jsx(Q,{dataKey:"downside",fill:"#EF4444",name:"Downside Impact"})]})}),R=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(_,{width:"100%",height:300,children:e.jsxs(J,{children:[e.jsx(X,{data:N,cx:"50%",cy:"50%",outerRadius:80,dataKey:"probability",label:({name:e,probability:s})=>`${e}: ${s}%`,children:N.map((s,t)=>e.jsx(Z,{fill:s.fill},`cell-${t}`))}),e.jsx(Y,{formatter:e=>`${e}%`})]})}),e.jsx(_,{width:"100%",height:300,children:e.jsxs(W,{data:N,children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"name"}),e.jsx(H,{tickFormatter:e=>r(e)}),e.jsx(Y,{content:e.jsx(w,{chartType:"scenario"})}),e.jsx(Q,{dataKey:"value",fill:"#8B5CF6",name:"Enterprise Value"})]})})]}),S=()=>{const s=[{name:"PV of Operations",value:t?.cumulativePV||0,type:"positive"},{name:"PV of Terminal",value:t?.presentValueTerminal||0,type:"positive"},{name:"Enterprise Value",value:t?.enterpriseValue||0,type:"total"}];return e.jsx(_,{width:"100%",height:400,children:e.jsxs(W,{data:s,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"name"}),e.jsx(H,{tickFormatter:e=>r(e)}),e.jsx(Y,{content:e.jsx(w,{chartType:"bridge"})}),e.jsx(Q,{dataKey:"value",fill:e=>"total"===e.type?"#1F2937":"#3B82F6"})]})})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(x,{size:20}),"Data Visualization"]}),e.jsx("p",{className:"text-gray-600",children:"Interactive charts and graphs to visualize valuation results and sensitivity analysis."})]}),e.jsxs("button",{onClick:()=>m(!d),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 "+(d?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:[d?e.jsx(f,{size:14}):e.jsx(v,{size:14}),d?"Hide Details":"Show Details"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:h.map(s=>{const t=s.icon;return e.jsxs(u.button,{onClick:()=>c(s.id),className:"p-3 rounded-lg border-2 transition-all text-center "+(o===s.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:border-gray-300 text-gray-700"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(t,{size:20,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-xs font-medium",children:s.label})]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:h.find(e=>e.id===o)?.label}),d&&e.jsx("span",{className:"text-sm text-gray-500",children:(()=>{switch(o){case"dcf-waterfall":return"Shows the contribution of each year's cash flows and terminal value to total enterprise value.";case"cashflow-trend":return"Displays the trend of free cash flows, present values, and key financial metrics over time.";case"sensitivity-tornado":return"Illustrates how changes in key variables impact enterprise value, ranked by sensitivity.";case"scenario-distribution":return"Compares different scenarios by probability weights and resulting enterprise values.";case"valuation-bridge":return"Breaks down enterprise value into operating value and terminal value components.";default:return""}})()})]}),e.jsx("div",{className:"min-h-[400px]",children:(()=>{switch(o){case"dcf-waterfall":default:return e.jsx(C,{});case"cashflow-trend":return e.jsx(k,{});case"sensitivity-tornado":return e.jsx(M,{});case"scenario-distribution":return e.jsx(R,{});case"valuation-bridge":return e.jsx(S,{})}})()})]}),d&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Key Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["dcf-waterfall"===o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Operations Contribution"}),e.jsx("div",{className:"text-lg font-bold text-blue-800",children:t?.cumulativePV?`${(t.cumulativePV/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Terminal Contribution"}),e.jsx("div",{className:"text-lg font-bold text-purple-800",children:t?.presentValueTerminal?`${(t.presentValueTerminal/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Avg. Annual FCF"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:t?.freeCashFlows?r(t.freeCashFlows.reduce((e,s)=>e+s,0)/t.freeCashFlows.length):"N/A"})]})]}),"sensitivity-tornado"===o&&j.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Highest Risk Variable"}),e.jsx("div",{className:"text-lg font-bold text-red-800",children:j[0]?.variable}),e.jsxs("div",{className:"text-sm text-red-600",children:["±",j[0]?.range.toFixed(1),"% impact"]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Medium Risk Variables"}),e.jsx("div",{className:"text-lg font-bold text-yellow-800",children:j.slice(1,3).map(e=>e.variable).join(", ")})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Lowest Risk Variable"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:j[j.length-1]?.variable})]})]})]})]})]})},ge=({modelInputs:t,onModelInputChange:a,formatPercent:l})=>{const[r,n]=s.useState(!0),[c,d]=s.useState("inputs"),m=t.dcf.wacc||{riskFreeRate:4.5,marketRiskPremium:6,beta:1.2,smallCompanyPremium:3,companySpecificRisk:2,debtInterestRate:6.5,taxRate:25,marketValueEquity:1e5,marketValueDebt:3e4,buildUpMethod:{riskFreeRate:4.5,equityRiskPremium:6,sizeRiskPremium:3,industryRiskPremium:2,companySpecificRisk:2},industryWACC:10.5,industryBeta:1.1,industryDebtEquityRatio:.3},x=s.useMemo(()=>{const e={...m,...t.dcf.wacc},s=e.riskFreeRate+e.beta*e.marketRiskPremium+e.smallCompanyPremium+e.companySpecificRisk,a=e.buildUpMethod.riskFreeRate+e.buildUpMethod.equityRiskPremium+e.buildUpMethod.sizeRiskPremium+e.buildUpMethod.industryRiskPremium+e.buildUpMethod.companySpecificRisk,l=e.debtInterestRate*(1-e.taxRate/100),i=e.marketValueEquity+e.marketValueDebt,r=e.marketValueEquity/i,n=e.marketValueDebt/i,o=s/100*r+l/100*n,c=a/100*r+l/100*n;return{costOfEquityCAPM:s,costOfEquityBuildUp:a,costOfDebtAfterTax:l,equityWeight:100*r,debtWeight:100*n,waccCAPM:100*o,waccBuildUp:100*c,finalWACC:100*((o+c)/2),totalCapital:i,debtToEquityRatio:e.marketValueDebt/e.marketValueEquity}},[m,t.dcf.wacc]),h=(e,s)=>{const l={...m,...t.dcf.wacc,[e]:parseFloat(s)||0};a("dcf","wacc",l)},p=[{id:"inputs",label:"Inputs",icon:j},{id:"calculation",label:"Calculation",icon:o},{id:"benchmarks",label:"Benchmarks",icon:i}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(o,{size:20}),"WACC Calculator"]}),e.jsx("p",{className:"text-gray-600",children:"Professional weighted average cost of capital calculation using CAPM and build-up methods."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{return e=x.finalWACC,void a("dcf","discountRate",e);var e},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Apply to DCF"}),e.jsx("button",{onClick:()=>n(!r),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(r?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-600"),children:r?"Hide Details":"Show Details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(N,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"FINAL WACC"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l(x.finalWACC)}),e.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Risk-adjusted average"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"COST OF EQUITY"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(x.costOfEquityCAPM)}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"CAPM method"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"COST OF DEBT"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:l(x.costOfDebtAfterTax)}),e.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"After-tax"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"DEBT/EQUITY"})]}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[x.debtToEquityRatio.toFixed(2),"x"]}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Capital structure"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:p.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>d(s.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(c===s.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[e.jsx(t,{size:16}),s.label]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["inputs"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"WACC Input Parameters"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"Cost of Equity (CAPM Method)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Risk-Free Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.riskFreeRate||m.riskFreeRate,onChange:e=>h("riskFreeRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"10-year Treasury rate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Risk Premium (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.marketRiskPremium||m.marketRiskPremium,onChange:e=>h("marketRiskPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Expected market return - risk-free rate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beta (β)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.beta||m.beta,onChange:e=>h("beta",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Systematic risk relative to market"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Small Company Premium (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium,onChange:e=>h("smallCompanyPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Size-related risk premium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company-Specific Risk (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.companySpecificRisk||m.companySpecificRisk,onChange:e=>h("companySpecificRisk",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Unsystematic risk premium"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4 text-purple-800",children:"Capital Structure & Cost of Debt"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Equity ($000s)"}),e.jsx("input",{type:"number",value:t.dcf.wacc?.marketValueEquity||m.marketValueEquity,onChange:e=>h("marketValueEquity",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Debt ($000s)"}),e.jsx("input",{type:"number",value:t.dcf.wacc?.marketValueDebt||m.marketValueDebt,onChange:e=>h("marketValueDebt",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre-Tax Cost of Debt (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.debtInterestRate||m.debtInterestRate,onChange:e=>h("debtInterestRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Interest rate on debt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.taxRate||t.dcf.taxRate,onChange:e=>h("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Corporate tax rate"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-2",children:"Capital Structure"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Equity Weight:"}),e.jsx("span",{className:"font-medium",children:l(x.equityWeight)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Debt Weight:"}),e.jsx("span",{className:"font-medium",children:l(x.debtWeight)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{children:"Total Capital:"}),e.jsxs("span",{className:"font-medium",children:["$",(x.totalCapital/1e3).toFixed(0),"M"]})]})]})]})]})]})]})]}),"calculation"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"WACC Calculation Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"CAPM Method"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Risk-Free Rate:"}),e.jsx("span",{className:"font-medium",children:l(t.dcf.wacc?.riskFreeRate||m.riskFreeRate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta × Market Risk Premium:"}),e.jsx("span",{className:"font-medium",children:l((t.dcf.wacc?.beta||m.beta)*(t.dcf.wacc?.marketRiskPremium||m.marketRiskPremium))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Small Company Premium:"}),e.jsx("span",{className:"font-medium",children:l(t.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Company-Specific Risk:"}),e.jsx("span",{className:"font-medium",children:l(t.dcf.wacc?.companySpecificRisk||m.companySpecificRisk)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[e.jsx("span",{children:"Cost of Equity (CAPM):"}),e.jsx("span",{children:l(x.costOfEquityCAPM)})]})]})]}),e.jsxs("div",{className:"p-6 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("h5",{className:"font-medium mb-4 text-green-800",children:"Build-up Method"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Risk-Free Rate:"}),e.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.riskFreeRate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Equity Risk Premium:"}),e.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.equityRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Size Risk Premium:"}),e.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.sizeRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Industry Risk Premium:"}),e.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.industryRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Company-Specific Risk:"}),e.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.companySpecificRisk)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[e.jsx("span",{children:"Cost of Equity (Build-up):"}),e.jsx("span",{children:l(x.costOfEquityBuildUp)})]})]})]})]}),e.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[e.jsx("h5",{className:"font-medium mb-4",children:"Final WACC Calculation"}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"WACC (CAPM Method):"}),e.jsx("span",{className:"font-medium",children:l(x.waccCAPM)})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityCAPM)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"WACC (Build-up Method):"}),e.jsx("span",{className:"font-medium",children:l(x.waccBuildUp)})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityBuildUp)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Risk-Adjusted WACC:"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:l(x.finalWACC)})]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Average of CAPM and Build-up methods"})]})]})]})]}),"benchmarks"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Industry Benchmarks & Validation"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Your Company"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC:"}),e.jsx("span",{className:"font-semibold",children:l(x.finalWACC)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta:"}),e.jsx("span",{className:"font-semibold",children:(t.dcf.wacc?.beta||m.beta).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"D/E Ratio:"}),e.jsxs("span",{className:"font-semibold",children:[x.debtToEquityRatio.toFixed(2),"x"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-green-800 mb-2",children:"Industry Average"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC:"}),e.jsx("span",{className:"font-semibold",children:l(m.industryWACC)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta:"}),e.jsx("span",{className:"font-semibold",children:m.industryBeta.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"D/E Ratio:"}),e.jsxs("span",{className:"font-semibold",children:[m.industryDebtEquityRatio.toFixed(2),"x"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Variance"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC Diff:"}),e.jsxs("span",{className:"font-semibold "+(x.finalWACC>m.industryWACC?"text-red-600":"text-green-600"),children:[x.finalWACC>m.industryWACC?"+":"",l(x.finalWACC-m.industryWACC)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta Diff:"}),e.jsxs("span",{className:"font-semibold "+((t.dcf.wacc?.beta||m.beta)>m.industryBeta?"text-red-600":"text-green-600"),children:[(t.dcf.wacc?.beta||m.beta)>m.industryBeta?"+":"",((t.dcf.wacc?.beta||m.beta)-m.industryBeta).toFixed(2)]})]})]})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{size:16,className:"text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Validation Guidelines"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• WACC should be within ±2% of industry average for similar companies"}),e.jsx("li",{children:"• Beta should reflect business risk relative to market (typically 0.8-1.5 for most companies)"}),e.jsx("li",{children:"• Cost of equity should exceed risk-free rate by at least 4-6% for private companies"}),e.jsx("li",{children:"• Debt/equity ratio should align with industry norms and company strategy"}),e.jsx("li",{children:"• Consider economic conditions and company-specific factors"})]})]})]})})]})]})]})},be=({data:t,modelInputs:a,onModelInputChange:l,formatCurrency:r,formatPercent:n})=>{const[c,d]=s.useState(!1),[m,h]=s.useState(!0),[p,g]=s.useState("results"),b=s.useMemo(()=>{const{discountRate:e,terminalGrowthRate:s,projectionYears:l,taxRate:i}=a.dcf,r=t.statements,n=a.dcf.workingCapital||{receivablesDays:45,inventoryDays:60,payablesDays:30},o=a.dcf.capex||{capexAsPercentOfRevenue:3.5,depreciationRate:7},c={years:[],freeCashFlows:[],presentValues:[],workingCapitalChanges:[],capexAmounts:[],unleveredFreeCashFlow:[],cumulativePV:0,terminalValue:0,presentValueTerminal:0,enterpriseValue:0,equityValue:0,impliedShare:0},d=r.incomeStatement.totalRevenue?.[0]||1e5;for(let t=1;t<=l;t++){const s={year:t,revenue:r.incomeStatement.totalRevenue?.[t]||0,operatingIncome:r.incomeStatement.operatingIncome?.[t]||0,nopat:0,workingCapitalChange:0,capex:0,depreciation:0,freeCashFlow:0,presentValue:0};s.nopat=s.operatingIncome*(1-i/100);const a=s.revenue,l=t>1?r.incomeStatement.totalRevenue?.[t-1]||0:d,m=a*n.receivablesDays/365,x=a*n.inventoryDays/365,u=a*n.payablesDays/365,h=m-l*n.receivablesDays/365,p=x-l*n.inventoryDays/365,g=u-l*n.payablesDays/365;s.workingCapitalChange=-(h+p-g),s.capex=-a*o.capexAsPercentOfRevenue/100,s.depreciation=Math.abs(s.capex)/o.depreciationRate,s.freeCashFlow=s.nopat+s.depreciation+s.capex+s.workingCapitalChange;const b=Math.pow(1+e/100,t);s.presentValue=s.freeCashFlow/b,c.years.push(s),c.freeCashFlows.push(s.freeCashFlow),c.presentValues.push(s.presentValue),c.workingCapitalChanges.push(s.workingCapitalChange),c.capexAmounts.push(s.capex),c.unleveredFreeCashFlow.push(s.freeCashFlow),c.cumulativePV+=s.presentValue}const m=(c.years[c.years.length-1]?.freeCashFlow||0)*(1+s/100);c.terminalValue=m/((e-s)/100);const x=Math.pow(1+e/100,l);c.presentValueTerminal=c.terminalValue/x,c.enterpriseValue=c.cumulativePV+c.presentValueTerminal;c.equityValue=c.enterpriseValue-0;const u=a.dcf.sharesOutstanding||1e3;return c.impliedShare=c.equityValue/u,c},[t,a]),f=(e,s,t)=>{const i={...a.dcf,[e]:{...a.dcf[e],[s]:parseFloat(t)||0}};l("dcf",e,i[e])},v=(e,s)=>{l("dcf",e,parseFloat(s)||0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(o,{size:20}),"Advanced DCF Valuation"]}),e.jsx("p",{className:"text-gray-600",children:"Professional-grade DCF with working capital analysis, capex modeling, and detailed cash flow projections."})]}),e.jsx("div",{className:"flex gap-2",children:["results","charts","wacc","assumptions"].map(s=>e.jsxs("button",{onClick:()=>g(s),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-1 "+(p===s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:["results"===s&&e.jsx(w,{size:14}),"charts"===s&&e.jsx(x,{size:14}),"wacc"===s&&e.jsx(o,{size:14}),"assumptions"===s&&e.jsx(j,{size:14}),s.charAt(0).toUpperCase()+s.slice(1)]},s))})]}),"results"===p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"ENTERPRISE VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:r(b.enterpriseValue)}),e.jsxs("div",{className:"text-sm text-green-600 mt-1",children:["PV Operations: ",r(b.cumulativePV)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EQUITY VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:r(b.equityValue)}),e.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:["Per Share: ",r(b.impliedShare)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(x,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"TERMINAL VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:r(b.terminalValue)}),e.jsxs("div",{className:"text-sm text-purple-600 mt-1",children:["PV: ",r(b.presentValueTerminal)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"IMPLIED MULTIPLE"})]}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[(b.enterpriseValue/(t.statements.incomeStatement.totalRevenue?.[1]||1)).toFixed(1),"x"]}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"EV/Revenue (Year 1)"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Detailed Cash Flow Analysis"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Year"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Operating Income"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"NOPAT"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Depreciation"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Capex"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"ΔWorking Capital"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Free Cash Flow"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Present Value"})]})}),e.jsxs("tbody",{children:[b.years.map((s,t)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.year}),e.jsx("td",{className:"p-3 text-right",children:r(s.revenue)}),e.jsx("td",{className:"p-3 text-right",children:r(s.operatingIncome)}),e.jsx("td",{className:"p-3 text-right",children:r(s.nopat)}),e.jsxs("td",{className:"p-3 text-right text-green-600",children:["+",r(s.depreciation)]}),e.jsx("td",{className:"p-3 text-right text-red-600",children:r(s.capex)}),e.jsxs("td",{className:"p-3 text-right "+(s.workingCapitalChange>=0?"text-green-600":"text-red-600"),children:[s.workingCapitalChange>=0?"+":"",r(s.workingCapitalChange)]}),e.jsx("td",{className:"p-3 text-right font-medium",children:r(s.freeCashFlow)}),e.jsx("td",{className:"p-3 text-right font-medium",children:r(s.presentValue)})]},t)),e.jsxs("tr",{className:"border-b-2 border-gray-300 bg-blue-50",children:[e.jsx("td",{className:"p-3 font-bold",children:"Terminal"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3 text-right font-bold",children:r(b.terminalValue)}),e.jsx("td",{className:"p-3 text-right font-bold",children:r(b.presentValueTerminal)})]}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-3",children:"TOTAL"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3 text-right text-lg",children:r(b.enterpriseValue)})]})]})]})})]})]}),"charts"===p&&e.jsx(pe,{dcfData:b,sensitivityData:null,scenarioData:null,formatCurrency:r,formatPercent:n}),"wacc"===p&&e.jsx(ge,{modelInputs:a,onModelInputChange:l,formatPercent:n}),"assumptions"===p&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Model Assumptions"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Core Assumptions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Rate (WACC) %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.discountRate,onChange:e=>v("discountRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terminal Growth Rate %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.terminalGrowthRate,onChange:e=>v("terminalGrowthRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.taxRate,onChange:e=>v("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Working Capital"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receivables (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.receivablesDays||45,onChange:e=>f("workingCapital","receivablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inventory (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.inventoryDays||60,onChange:e=>f("workingCapital","inventoryDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payables (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.payablesDays||30,onChange:e=>f("workingCapital","payablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Capital Expenditure"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capex (% of Revenue)"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.capex?.capexAsPercentOfRevenue||3.5,onChange:e=>f("capex","capexAsPercentOfRevenue",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Depreciation Period (Years)"}),e.jsx("input",{type:"number",value:a.dcf.capex?.depreciationRate||7,onChange:e=>f("capex","depreciationRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shares Outstanding (000s)"}),e.jsx("input",{type:"number",value:a.dcf.sharesOutstanding||1e3,onChange:e=>v("sharesOutstanding",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]})]})]})},je=({data:t,formatCurrency:a,formatPercent:l})=>{const[n,o]=s.useState("multiples"),[c,d]=s.useState("ev_revenue"),[m,h]=s.useState(!1),[p,g]=s.useState([{id:1,name:"MedSpa Corp",ticker:"MSPA",marketCap:45e4,enterpriseValue:52e4,revenue:18e4,ebitda:45e3,netIncome:28e3,employees:1200,founded:2015,geography:"US",businessModel:"B2C Medical Spa Chain"},{id:2,name:"Wellness Holdings",ticker:"WELL",marketCap:68e4,enterpriseValue:75e4,revenue:22e4,ebitda:55e3,netIncome:35e3,employees:1800,founded:2012,geography:"US",businessModel:"Integrated Wellness Platform"},{id:3,name:"Aesthetic Solutions Inc",ticker:"AEST",marketCap:32e4,enterpriseValue:38e4,revenue:125e3,ebitda:32e3,netIncome:18e3,employees:850,founded:2018,geography:"US",businessModel:"Medical Device & Services"},{id:4,name:"Premium Health Group",ticker:"PHG",marketCap:92e4,enterpriseValue:105e4,revenue:31e4,ebitda:78e3,netIncome:48e3,employees:2500,founded:2010,geography:"US",businessModel:"Premium Healthcare Services"}]),b=s.useMemo(()=>p.map(e=>({...e,multiples:{ev_revenue:e.enterpriseValue/e.revenue,ev_ebitda:e.enterpriseValue/e.ebitda,pe_ratio:e.marketCap/e.netIncome,revenue_per_employee:e.revenue/e.employees,market_cap_revenue:e.marketCap/e.revenue}})),[p]),j=s.useMemo(()=>{const e=b.map(e=>e.multiples),s=e=>({mean:e.reduce((e,s)=>e+s,0)/e.length,median:e.sort((e,s)=>e-s)[Math.floor(e.length/2)],min:Math.min(...e),max:Math.max(...e),p25:e.sort((e,s)=>e-s)[Math.floor(.25*e.length)],p75:e.sort((e,s)=>e-s)[Math.floor(.75*e.length)]});return{ev_revenue:s(e.map(e=>e.ev_revenue)),ev_ebitda:s(e.map(e=>e.ev_ebitda)),pe_ratio:s(e.map(e=>e.pe_ratio)),revenue_per_employee:s(e.map(e=>e.revenue_per_employee)),market_cap_revenue:s(e.map(e=>e.market_cap_revenue))}},[b]),f=s.useMemo(()=>{const e=t.statements.incomeStatement.totalRevenue?.[1]||1e5,s=1.15*(t.statements.incomeStatement.operatingIncome?.[1]||5e4),a=.7*(t.statements.incomeStatement.operatingIncome?.[1]||5e4);return{ev_revenue:{mean:e*j.ev_revenue.mean,median:e*j.ev_revenue.median,p25:e*j.ev_revenue.p25,p75:e*j.ev_revenue.p75},ev_ebitda:{mean:s*j.ev_ebitda.mean,median:s*j.ev_ebitda.median,p25:s*j.ev_ebitda.p25,p75:s*j.ev_ebitda.p75},pe_ratio:{mean:a*j.pe_ratio.mean,median:a*j.pe_ratio.median,p25:a*j.pe_ratio.p25,p75:a*j.pe_ratio.p75}}},[t,j]),v={ev_revenue:{name:"EV/Revenue",description:"Enterprise Value / Annual Revenue"},ev_ebitda:{name:"EV/EBITDA",description:"Enterprise Value / EBITDA"},pe_ratio:{name:"P/E Ratio",description:"Market Cap / Net Income"},revenue_per_employee:{name:"Revenue/Employee",description:"Revenue per Employee"},market_cap_revenue:{name:"Market Cap/Revenue",description:"Market Cap / Revenue"}},y=[{id:"multiples",label:"Trading Multiples",icon:x},{id:"analysis",label:"Valuation Analysis",icon:R},{id:"companies",label:"Comparable Set",icon:M}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(M,{size:20}),"Comparable Company Analysis"]}),e.jsx("p",{className:"text-gray-600",children:"Market-based valuation using trading multiples from similar public companies."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",children:[e.jsx(r,{size:16}),"Add Comparable"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(x,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EV/REVENUE"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[j.ev_revenue.median.toFixed(1),"x"]}),e.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Median multiple"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"IMPLIED VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:a(f.ev_revenue.median)}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"EV/Revenue basis"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"VALUATION RANGE"})]}),e.jsxs("div",{className:"text-lg font-bold text-purple-800",children:[a(f.ev_revenue.p25)," - ",a(f.ev_revenue.p75)]}),e.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"25th - 75th percentile"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(M,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"PEER COUNT"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-800",children:p.length}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Comparable companies"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:y.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>o(s.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(n===s.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[e.jsx(t,{size:16}),s.label]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["multiples"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Trading Multiples Analysis"}),e.jsx("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(v).map(([s,t])=>e.jsx("option",{value:s,children:t.name},s))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Company"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Market Cap"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Enterprise Value"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"EV/Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"EV/EBITDA"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"P/E Ratio"})]})}),e.jsxs("tbody",{children:[b.map((s,t)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.ticker})]})}),e.jsx("td",{className:"p-3 text-right",children:a(s.marketCap)}),e.jsx("td",{className:"p-3 text-right",children:a(s.enterpriseValue)}),e.jsx("td",{className:"p-3 text-right",children:a(s.revenue)}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.ev_revenue.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.ev_ebitda.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.pe_ratio.toFixed(1),"x"]})]},s.id)),e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-blue-50 font-semibold",children:[e.jsx("td",{className:"p-3",children:"Market Statistics"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsxs("td",{className:"p-3 text-right",children:[j.ev_revenue.median.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right",children:[j.ev_ebitda.median.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right",children:[j.pe_ratio.median.toFixed(1),"x"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-3",children:"Multiple Distribution"}),e.jsx("div",{className:"space-y-3",children:Object.entries(j).slice(0,3).map(([s,t])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:v[s].name}),e.jsxs("span",{className:"font-medium",children:[t.median.toFixed(1),"x"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:(t.median-t.min)/(t.max-t.min)*100+"%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:[t.min.toFixed(1),"x"]}),e.jsxs("span",{children:[t.max.toFixed(1),"x"]})]})]},s))})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Companies Analyzed:"}),e.jsx("span",{className:"font-medium",children:p.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median Market Cap:"}),e.jsx("span",{className:"font-medium",children:a(p.sort((e,s)=>e.marketCap-s.marketCap)[Math.floor(p.length/2)]?.marketCap||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median Revenue:"}),e.jsx("span",{className:"font-medium",children:a(p.sort((e,s)=>e.revenue-s.revenue)[Math.floor(p.length/2)]?.revenue||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg Founded Year:"}),e.jsx("span",{className:"font-medium",children:Math.round(p.reduce((e,s)=>e+s.founded,0)/p.length)})]})]})]})]})]}),"analysis"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Valuation Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4",children:"Implied Valuation by Multiple"}),e.jsx("div",{className:"space-y-4",children:Object.entries(f).map(([s,t])=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:v[s].name}),e.jsxs("span",{className:"text-sm text-gray-500",children:[j[s].median.toFixed(1),"x median"]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"25th Percentile:"}),e.jsx("span",{className:"font-medium",children:a(t.p25)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median:"}),e.jsx("span",{className:"font-bold text-blue-600",children:a(t.median)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"75th Percentile:"}),e.jsx("span",{className:"font-medium",children:a(t.p75)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mean:"}),e.jsx("span",{className:"font-medium",children:a(t.mean)})]})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4",children:"Valuation Summary"}),e.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Recommended Range"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[a((f.ev_revenue.p25+f.ev_ebitda.p25)/2)," -",a((f.ev_revenue.p75+f.ev_ebitda.p75)/2)]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Blended 25th-75th percentile"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Midpoint Valuation"}),e.jsx("div",{className:"text-xl font-bold text-blue-800",children:a((f.ev_revenue.median+f.ev_ebitda.median)/2)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Average of median multiples"})]})]})}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{size:16,className:"text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-yellow-800 mb-1",children:"Valuation Considerations"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• Consider company-specific growth and margin profiles"}),e.jsx("li",{children:"• Adjust for differences in business model and scale"}),e.jsx("li",{children:"• Factor in market conditions and sector trends"}),e.jsx("li",{children:"• Apply appropriate discount for private company liquidity"})]})]})]})})]})]})]}),"companies"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Comparable Company Set"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(S,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search companies...",className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{className:"px-3 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(F,{size:16}),"Filter"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:p.map(s=>e.jsxs(u.div,{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.ticker," • ",s.geography]})]}),e.jsx("button",{onClick:()=>{return e=s.id,void g(p.filter(s=>s.id!==e));var e},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Market Cap:"}),e.jsx("span",{className:"font-medium",children:a(s.marketCap)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Revenue:"}),e.jsx("span",{className:"font-medium",children:a(s.revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"EV/Revenue:"}),e.jsxs("span",{className:"font-medium",children:[(s.enterpriseValue/s.revenue).toFixed(1),"x"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Founded:"}),e.jsx("span",{className:"font-medium",children:s.founded})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx("div",{className:"text-xs text-gray-600",children:s.businessModel})})]},s.id))})]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Add Comparable Company"}),e.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=new FormData(e.target);(e=>{const s={id:Date.now(),...e,marketCap:parseFloat(e.marketCap)||0,enterpriseValue:parseFloat(e.enterpriseValue)||0,revenue:parseFloat(e.revenue)||0,ebitda:parseFloat(e.ebitda)||0,netIncome:parseFloat(e.netIncome)||0,employees:parseInt(e.employees)||0,founded:parseInt(e.founded)||(new Date).getFullYear()};g([...p,s]),h(!1)})(Object.fromEntries(s))},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker"}),e.jsx("input",{name:"ticker",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Cap ($000s)"}),e.jsx("input",{name:"marketCap",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enterprise Value ($000s)"}),e.jsx("input",{name:"enterpriseValue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue ($000s)"}),e.jsx("input",{name:"revenue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA ($000s)"}),e.jsx("input",{name:"ebitda",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Model"}),e.jsx("input",{name:"businessModel",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Company"}),e.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})},fe=({data:t,onDataChange:a})=>{const[l,i]=s.useState("setup"),[r,o]=s.useState(null),[c,d]=s.useState(!1),[m,x]=s.useState(0),[h,p]=s.useState({iterations:1e4,confidenceLevel:.95,randomSeed:null,enableCorrelation:!1}),[g,b]=s.useState({revenueGrowthRate:{type:"normal",parameters:{mean:.1,stdDev:.03},name:"Revenue Growth Rate",enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.12,mode:.15,max:.18},name:"FCF Margin",enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},name:"WACC",enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},name:"Terminal Growth Rate",enabled:!0}}),[j,f]=s.useState([[1,.3,-.2,.1],[.3,1,-.4,.2],[-.2,-.4,1,-.3],[.1,.2,-.3,1]]),v=[{value:"normal",label:"Normal",parameters:["mean","stdDev"]},{value:"triangular",label:"Triangular",parameters:["min","mode","max"]},{value:"uniform",label:"Uniform",parameters:["min","max"]},{value:"lognormal",label:"Log-Normal",parameters:["mu","sigma"]},{value:"beta",label:"Beta",parameters:["alpha","beta"]}],y=s.useCallback(async()=>{try{d(!0),x(0);const e=Object.fromEntries(Object.entries(g).filter(([e,s])=>s.enabled)),s={iterations:h.iterations,confidenceLevel:h.confidenceLevel,randomSeed:h.randomSeed,correlationMatrix:h.enableCorrelation?j:null,onProgress:x},a={currentRevenue:t?.dcf?.currentRevenue||1e9,currentPrice:t?.dcf?.currentPrice||100,sharesOutstanding:t?.dcf?.sharesOutstanding||1e8,...Object.fromEntries(Object.entries(e).map(([e,s])=>[e,s.parameters.mean||s.parameters.mode||(s.parameters.min+s.parameters.max)/2]))},l=await me.runDCFSimulation(a,e,s);o(l)}catch(e){}finally{d(!1),x(0)}},[g,h,j,t]),N=s.useCallback(()=>{me.stopSimulation(),d(!1)},[]),w=s.useCallback((e,s)=>{b(t=>({...t,[e]:{...t[e],...s}}))},[]),C=s.useCallback((e,s,t)=>{f(a=>{const l=a.map(e=>[...e]);return l[e][s]=t,l[s][e]=t,l})},[]),k=s.useMemo(()=>{if(!r?.results)return[];const e=r.results.map(e=>e.pricePerShare),s=Math.min(...e),t=(Math.max(...e)-s)/50,a=Array(50).fill(0).map((e,a)=>({bin:s+a*t,count:0,frequency:0}));return e.forEach(e=>{const l=Math.min(Math.floor((e-s)/t),49);a[l].count++}),a.forEach(s=>{s.frequency=s.count/e.length}),a},[r]),M=s.useMemo(()=>r?.results?r.results.slice(0,1e3).map((e,s)=>({x:100*e.inputs.revenueGrowthRate,y:e.pricePerShare,upside:e.upside})):[],[r]),R=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center",children:[e.jsx(Zap,{className:"inline-block mr-2"}),"Monte Carlo Simulation"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Advanced risk analysis using probabilistic modeling • Generate thousands of scenarios • Measure uncertainty"})]})}),e.jsx("div",{className:"mb-6",children:["setup","run","results","analysis"].map(s=>e.jsx("button",{onClick:()=>i(s),className:"px-4 py-2 rounded-lg font-medium transition-colors "+(l===s?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:s.charAt(0).toUpperCase()+s.slice(1)},s))}),e.jsx("div",{className:"mt-6",children:e.jsxs(I,{mode:"wait",children:["setup"===l&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"🎛️ Simulation Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Iterations"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:h.iterations,onChange:e=>p(s=>({...s,iterations:parseInt(e.target.value)})),min:"1000",max:"100000",step:"1000"}),e.jsx("small",{className:"text-gray-400",children:"Leave empty for random"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Confidence Level"}),e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:h.confidenceLevel,onChange:e=>p(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),children:[e.jsx("option",{value:.9,children:"90%"}),e.jsx("option",{value:.95,children:"95%"}),e.jsx("option",{value:.99,children:"99%"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Random Seed (Optional)"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:h.randomSeed||"",onChange:e=>p(s=>({...s,randomSeed:e.target.value?parseInt(e.target.value):null})),placeholder:"Leave empty for random"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500",checked:h.enableCorrelation,onChange:e=>p(s=>({...s,enableCorrelation:e.target.checked}))}),e.jsx("span",{children:"Enable Variable Correlation"})]})})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"📊 Variable Distributions"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Object.entries(g).map(([s,t])=>e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:e=>w(s,{enabled:e.target.checked})}),e.jsx("span",{className:"font-medium",children:t.name})]})}),t.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Distribution Type"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:t.type,onChange:e=>{const t=e.target.value;v.find(e=>e.value===t);const a={};"normal"===t?(a.mean=.1,a.stdDev=.02):"triangular"===t?(a.min=.05,a.mode=.1,a.max=.15):"uniform"===t&&(a.min=.05,a.max=.15),w(s,{type:t,parameters:a})},children:v.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:v.find(e=>e.value===t.type)?.parameters.map(a=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300",children:a.charAt(0).toUpperCase()+a.slice(1)}),e.jsx("input",{className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",type:"number",value:t.parameters[a]||"",onChange:e=>w(s,{parameters:{...t.parameters,[a]:parseFloat(e.target.value)}}),step:"0.001"})]},a))})]})]},s))})]}),h.enableCorrelation&&e.jsxs("div",{className:styles.correlationSection,children:[e.jsx("h3",{children:"🔗 Correlation Matrix"}),e.jsx("div",{className:styles.correlationMatrix,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),Object.keys(g).map(s=>e.jsx("th",{children:g[s].name},s))]})}),e.jsx("tbody",{children:Object.keys(g).map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:styles.correlationLabel,children:g[s].name}),Object.keys(g).map((s,a)=>e.jsx("td",{children:e.jsx("input",{type:"number",value:j[t][a],onChange:e=>C(t,a,parseFloat(e.target.value)),min:"-1",max:"1",step:"0.1",disabled:t===a,className:styles.correlationInput})},a))]},s))})]})})]})]})},"setup"),"run"===l&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs("div",{className:styles.runContainer,children:[e.jsxs("div",{className:styles.runHeader,children:[e.jsx("h3",{children:"🚀 Simulation Control"}),e.jsx("div",{className:"flex items-center space-x-2",children:c?e.jsxs("button",{onClick:N,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[e.jsx(P,{size:16}),e.jsx("span",{children:"Stop Simulation"})]}):e.jsxs("button",{onClick:y,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",disabled:Object.values(g).every(e=>!e.enabled),children:[e.jsx(A,{size:16}),e.jsx("span",{children:"Run Simulation"})]})})]}),c&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${m}%`}})}),e.jsxs("div",{className:"text-sm text-gray-400 text-center",children:[m.toFixed(1),"% Complete (",Math.floor(m*h.iterations/100)," / ",h.iterations," iterations)"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mt-4",children:[e.jsx("h4",{children:"📋 Simulation Preview"}),e.jsxs("div",{className:styles.previewGrid,children:[e.jsxs("div",{className:styles.previewCard,children:[e.jsx("div",{className:styles.previewLabel,children:"Iterations"}),e.jsx("div",{className:styles.previewValue,children:h.iterations.toLocaleString()})]}),e.jsxs("div",{className:styles.previewCard,children:[e.jsx("div",{className:styles.previewLabel,children:"Variables"}),e.jsx("div",{className:styles.previewValue,children:Object.values(g).filter(e=>e.enabled).length})]}),e.jsxs("div",{className:styles.previewCard,children:[e.jsx("div",{className:styles.previewLabel,children:"Confidence Level"}),e.jsxs("div",{className:styles.previewValue,children:[(100*h.confidenceLevel).toFixed(0),"%"]})]}),e.jsxs("div",{className:styles.previewCard,children:[e.jsx("div",{className:styles.previewLabel,children:"Correlation"}),e.jsx("div",{className:styles.previewValue,children:h.enableCorrelation?"Enabled":"Disabled"})]})]})]})]})},"run"),"results"===l&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r?e.jsxs("div",{className:styles.resultsContainer,children:[e.jsxs("div",{className:styles.resultsHeader,children:[e.jsx("h3",{children:"📈 Simulation Results"}),e.jsxs("div",{className:styles.resultsActions,children:[e.jsxs("button",{className:`${styles.button} ${styles.secondary}`,children:[e.jsx(V,{size:16}),"Export Results"]}),e.jsxs("button",{className:`${styles.button} ${styles.tertiary}`,children:[e.jsx(n,{size:16}),"Generate Report"]})]})]}),e.jsx("div",{className:styles.statisticsGrid,children:Object.entries(r.analysis.statistics).map(([s,t])=>e.jsxs("div",{className:styles.statisticCard,children:[e.jsx("h4",{children:"pricePerShare"===s?"Price per Share":"enterpriseValue"===s?"Enterprise Value":"Upside %"}),e.jsx("div",{className:styles.statValue,children:"upside"===s?`${t.mean.toFixed(1)}%`:R(t.mean)}),e.jsxs("div",{className:styles.statDetails,children:[e.jsxs("div",{children:["Median: ","upside"===s?`${t.median.toFixed(1)}%`:R(t.median)]}),e.jsxs("div",{children:["Std Dev: ","upside"===s?`${t.stdDev.toFixed(1)}%`:R(t.stdDev)]}),e.jsxs("div",{children:["Min: ","upside"===s?`${t.min.toFixed(1)}%`:R(t.min)]}),e.jsxs("div",{children:["Max: ","upside"===s?`${t.max.toFixed(1)}%`:R(t.max)]})]})]},s))}),e.jsxs("div",{className:styles.chartsSection,children:[e.jsxs("div",{className:styles.chartCard,children:[e.jsx("h4",{children:"📊 Price Distribution"}),e.jsx(_,{width:"100%",height:300,children:e.jsxs(ae,{data:k,children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"bin",tickFormatter:R}),e.jsx(H,{}),e.jsx(Y,{formatter:(e,s)=>[`${(100*e).toFixed(2)}%`,"Frequency"],labelFormatter:e=>`Price: ${R(e)}`}),e.jsx(le,{type:"monotone",dataKey:"frequency",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6})]})})]}),e.jsxs("div",{className:styles.chartCard,children:[e.jsx("h4",{children:"🎯 Sensitivity Scatter Plot"}),e.jsx(_,{width:"100%",height:300,children:e.jsxs(ie,{data:M,children:[e.jsx(U,{strokeDasharray:"3 3"}),e.jsx(K,{dataKey:"x",name:"Revenue Growth Rate",tickFormatter:e=>`${e.toFixed(1)}%`}),e.jsx(H,{dataKey:"y",name:"Price per Share",tickFormatter:R}),e.jsx(Y,{formatter:(e,s)=>["Revenue Growth Rate"===s?`${e.toFixed(2)}%`:R(e),s]}),e.jsx(re,{name:"Scenarios",fill:"#10B981",children:M.map((s,t)=>e.jsx(Z,{fill:s.upside>0?"#10B981":"#EF4444"},`cell-${t}`))})]})})]})]})]}):e.jsxs("div",{className:styles.noResults,children:[e.jsx(D,{size:48}),e.jsx("h3",{children:"No Results Available"}),e.jsx("p",{children:"Run a simulation to see results here."})]})},"results"),"analysis"===l&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:r?e.jsxs("div",{className:styles.analysisContainer,children:[e.jsxs("div",{className:styles.riskMetricsSection,children:[e.jsx("h3",{children:"⚠️ Risk Metrics"}),e.jsx("div",{className:styles.riskMetricsGrid,children:Object.entries(r.analysis.riskMetrics).map(([s,t])=>e.jsxs("div",{className:styles.riskCard,children:[e.jsx("h4",{children:"pricePerShare"===s?"Price per Share Risk":"enterpriseValue"===s?"Enterprise Value Risk":"Upside Risk"}),e.jsxs("div",{className:styles.riskMetric,children:[e.jsx("span",{children:"Value at Risk (5%):"}),e.jsx("span",{children:"upside"===s?`${t.var.toFixed(1)}%`:R(t.var)})]}),e.jsxs("div",{className:styles.riskMetric,children:[e.jsx("span",{children:"Conditional VaR:"}),e.jsx("span",{children:"upside"===s?`${t.cvar.toFixed(1)}%`:R(t.cvar)})]}),e.jsxs("div",{className:styles.riskMetric,children:[e.jsx("span",{children:"Skewness:"}),e.jsx("span",{children:t.skewness.toFixed(3)})]}),e.jsxs("div",{className:styles.riskMetric,children:[e.jsx("span",{children:"Kurtosis:"}),e.jsx("span",{children:t.kurtosis.toFixed(3)})]})]},s))})]}),e.jsxs("div",{className:styles.confidenceIntervalsSection,children:[e.jsxs("h3",{children:["🎯 Confidence Intervals (",(100*r.analysis.confidenceIntervals.pricePerShare?.level).toFixed(0),"%)"]}),e.jsx("div",{className:styles.intervalsGrid,children:Object.entries(r.analysis.confidenceIntervals).map(([s,t])=>e.jsxs("div",{className:styles.intervalCard,children:[e.jsx("h4",{children:"pricePerShare"===s?"Price per Share":"enterpriseValue"===s?"Enterprise Value":"Upside %"}),e.jsxs("div",{className:styles.intervalRange,children:[e.jsxs("div",{className:styles.intervalBound,children:[e.jsx("span",{children:"Lower Bound:"}),e.jsx("span",{children:"upside"===s?`${t.lowerBound.toFixed(1)}%`:R(t.lowerBound)})]}),e.jsxs("div",{className:styles.intervalBound,children:[e.jsx("span",{children:"Upper Bound:"}),e.jsx("span",{children:"upside"===s?`${t.upperBound.toFixed(1)}%`:R(t.upperBound)})]}),e.jsxs("div",{className:styles.intervalWidth,children:[e.jsx("span",{children:"Width:"}),e.jsx("span",{children:"upside"===s?`${t.width.toFixed(1)}%`:R(t.width)})]})]})]},s))})]}),e.jsxs("div",{className:styles.percentilesSection,children:[e.jsx("h3",{children:"📊 Percentile Analysis"}),e.jsx("div",{className:styles.percentilesTable,children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Metric"}),e.jsx("th",{children:"5th %ile"}),e.jsx("th",{children:"25th %ile"}),e.jsx("th",{children:"50th %ile"}),e.jsx("th",{children:"75th %ile"}),e.jsx("th",{children:"95th %ile"})]})}),e.jsx("tbody",{children:Object.entries(r.analysis.percentiles).map(([s,t])=>e.jsxs("tr",{children:[e.jsx("td",{children:"pricePerShare"===s?"Price per Share":"enterpriseValue"===s?"Enterprise Value":"Upside %"}),e.jsx("td",{children:"upside"===s?`${t.p5.toFixed(1)}%`:R(t.p5)}),e.jsx("td",{children:"upside"===s?`${t.p25.toFixed(1)}%`:R(t.p25)}),e.jsx("td",{children:"upside"===s?`${t.p50.toFixed(1)}%`:R(t.p50)}),e.jsx("td",{children:"upside"===s?`${t.p75.toFixed(1)}%`:R(t.p75)}),e.jsx("td",{children:"upside"===s?`${t.p95.toFixed(1)}%`:R(t.p95)})]},s))})]})})]})]}):e.jsxs("div",{className:styles.noResults,children:[e.jsx(D,{size:48}),e.jsx("h3",{children:"No Analysis Available"}),e.jsx("p",{children:"Run a simulation to see analysis here."})]})},"analysis")]})})]})},ve=({data:a,adjustedValues:l,onDataChange:i})=>{const[r,n]=s.useState("dcf"),[o,c]=s.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,terminalValueMultiple:10,taxRate:25,sharesOutstanding:1e3,workingCapital:{receivablesDays:45,inventoryDays:60,payablesDays:30,receivablesGrowth:2,inventoryGrowth:1.5,payablesGrowth:1.8},capex:{capexAsPercentOfRevenue:3.5,depreciationRate:7,maintenanceCapex:2}},ratios:{compareToIndustry:!0,industryAverages:{grossMargin:45,operatingMargin:15,netMargin:8,currentRatio:2.1,debtToEquity:.5}},sensitivity:{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},scenario:{scenarios:[{name:"Base Case",probability:50,revenueGrowth:15,marginImprovement:0},{name:"Bull Case",probability:25,revenueGrowth:25,marginImprovement:2},{name:"Bear Case",probability:25,revenueGrowth:5,marginImprovement:-2}]}}),d=s.useMemo(()=>{const e=a.statements.incomeStatement,s=a.periods,t={revenue:[],grossProfit:[],operatingIncome:[],margins:{gross:[],operating:[],net:[]},growth:{revenue:[],operating:[]}};return s.forEach((a,i)=>{const r=i===s.length-1,n=r&&l?.totalRevenue?l.totalRevenue:e.totalRevenue?.[i]||0,o=r&&l?.totalCostOfGoodsSold?l.totalCostOfGoodsSold:e.totalCostOfGoodsSold?.[i]||0,c=r&&l?.grossProfit?l.grossProfit:e.grossProfit?.[i]||n-o,d=r&&l?.operatingIncome?l.operatingIncome:e.operatingIncome?.[i]||0;if(t.revenue.push(n),t.grossProfit.push(c),t.operatingIncome.push(d),t.margins.gross.push(n?c/n*100:0),t.margins.operating.push(n?d/n*100:0),i>0){const s=e.totalRevenue?.[i-1]||0,a=e.operatingIncome?.[i-1]||0;t.growth.revenue.push(s?(n-s)/s*100:0),t.growth.operating.push(a?(d-a)/a*100:0)}}),t},[a]),m=(e=null)=>{const{discountRate:s,terminalGrowthRate:t,projectionYears:l,taxRate:i}=o.dcf,r=e||a;let n;if(e?(n=[],r.periods.forEach((e,s)=>{s>0&&s<=l&&n.push(r.statements.incomeStatement.operatingIncome?.[s]||0)})):n=d.operatingIncome.slice(1,l+1),0===n.length)return{enterpriseValue:0,equityValue:0,sharePrice:0};let c=0;const m=1+s/100;n.forEach((e,s)=>{const t=e*(1-i/100)/Math.pow(m,s+1);c+=t});const x=(n[n.length-1]||0)*(1+t/100)*(1-i/100)/((s-t)/100),u=x/Math.pow(m,l),h=c+u;return{enterpriseValue:h,equityValue:h,presentValueOperations:c,presentValueTerminal:u,terminalValue:x}};m();const u=[{id:"dcf",label:"DCF Valuation",icon:w,description:"Discounted Cash Flow analysis"},{id:"ratios",label:"Ratio Analysis",icon:x,description:"Financial ratio comparison"},{id:"sensitivity",label:"Sensitivity Analysis",icon:b,description:"Variable impact analysis"},{id:"scenario",label:"Scenario Modeling",icon:R,description:"Multi-scenario projections"},{id:"comparable",label:"Comparable Analysis",icon:M,description:"Market-based valuation"},{id:"montecarlo",label:"Monte Carlo",icon:E,description:"Probabilistic risk analysis"}],h=(e,s,t)=>{c(a=>({...a,[e]:{...a[e],[s]:t}}))},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e),g=e=>`${e.toFixed(1)}%`;return e.jsxs("div",{className:"h-full bg-gray-900 text-white p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Financial Modeling"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a modeling approach to analyze your financial data"})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:u.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>n(s.id),className:(r===s.id?"bg-blue-600 text-white border-blue-500 shadow-lg":"bg-gray-800 text-gray-300 border-gray-700 hover:bg-gray-700 hover:text-white hover:border-gray-600")+" flex items-center gap-3 px-4 py-3 rounded-lg border transition-all duration-200",children:[e.jsx(t,{size:18,className:r===s.id?"text-white":"text-blue-400"}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id)})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.createElement(u.find(e=>e.id===r)?.icon,{size:20,className:"text-blue-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:u.find(e=>e.id===r)?.label}),e.jsx("p",{className:"text-gray-400 text-sm",children:u.find(e=>e.id===r)?.description})]})]})})]}),e.jsxs("div",{children:["dcf"===r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(w,{size:20,className:"text-blue-400"}),"DCF Valuation Model"]}),e.jsx(be,{data:a,modelInputs:o,onModelInputChange:h,formatCurrency:p,formatPercent:g})]}),"ratios"===r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(x,{size:20}),"Financial Ratio Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Profitability Ratios"}),e.jsxs("div",{className:"space-y-3",children:[d.margins.gross.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Gross Margin:"]}),e.jsx("span",{className:"font-medium",children:g(s)})]},t)),d.margins.operating.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Operating Margin:"]}),e.jsx("span",{className:"font-medium",children:g(s)})]},t))]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Growth Rates"}),e.jsxs("div",{className:"space-y-3",children:[d.growth.revenue.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Revenue Growth:"]}),e.jsx("span",{className:"font-medium "+(s>=0?"text-green-600":"text-red-600"),children:g(s)})]},t)),d.growth.operating.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Operating Growth:"]}),e.jsx("span",{className:"font-medium "+(s>=0?"text-green-600":"text-red-600"),children:g(s)})]},t))]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Industry Comparison"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-3 bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Industry Avg"}),e.jsxs("div",{className:"text-sm",children:["Gross Margin: ",g(o.ratios.industryAverages.grossMargin)]}),e.jsxs("div",{className:"text-sm",children:["Operating Margin: ",g(o.ratios.industryAverages.operatingMargin)]}),e.jsxs("div",{className:"text-sm",children:["Net Margin: ",g(o.ratios.industryAverages.netMargin)]})]})})]})]})]}),"sensitivity"===r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(b,{size:20}),"Sensitivity Analysis"]}),e.jsx(he,{data:a,modelInputs:o,onModelInputChange:h,calculateDCF:m,formatCurrency:p,formatPercent:g})]}),"scenario"===r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(R,{size:20}),"Scenario Modeling"]}),e.jsx(ue,{data:a,modelInputs:o,onModelInputChange:h,calculateDCF:m,formatCurrency:p,formatPercent:g})]}),"comparable"===r&&e.jsx("div",{className:"p-6",children:e.jsx(je,{data:a,formatCurrency:p,formatPercent:g})}),"montecarlo"===r&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(E,{size:20}),"Monte Carlo Simulation"]}),e.jsx(fe,{data:a,onDataChange:i})]})]})]})},ye=({data:t,adjustedValues:a,modelInputs:l,calculateDCF:r,formatCurrency:n,formatPercentage:o})=>{const c=s.useMemo(()=>{if(!t?.statements?.incomeStatement)return null;const e=t.statements.incomeStatement,s=Object.keys(e.totalRevenue||{}).sort((e,s)=>parseInt(e)-parseInt(s));if(s.length<2)return null;const l=s[s.length-1],i=s[s.length-2],n=s[0],o=a?.totalRevenue||e.totalRevenue?.[l]||0,c=e.totalRevenue?.[i]||0,d=e.totalRevenue?.[n]||0,m=a?.grossProfit||e.grossProfit?.[l]||0,x=e.grossProfit?.[i]||0,u=a?.operatingIncome||e.operatingIncome?.[l]||0,h=e.operatingIncome?.[i]||0;a?.totalCostOfGoodsSold||e.totalCostOfGoodsSold,e.totalCostOfGoodsSold;const p=c?(o-c)/c*100:0,g=d&&s.length>2?100*(Math.pow(o/d,1/(s.length-1))-1):0,b=o?m/o*100:0,j=o?u/o*100:0,f=b-(c?x/c*100:0),v=j-(c?h/c*100:0);let y=null;if(r)try{y=r(t)}catch(C){}const N=[{name:"Energy Devices",value:e.energyDevices?.[l]||0},{name:"Injectables",value:e.injectables?.[l]||0},{name:"Wellness",value:e.wellness?.[l]||0},{name:"Weightloss",value:e.weightloss?.[l]||0},{name:"Retail Sales",value:e.retailSales?.[l]||0},{name:"Surgery",value:e.surgery?.[l]||0}].filter(e=>e.value>0),w=[{title:"Revenue Growth",value:`${p>0?"+":""}${p.toFixed(1)}%`,trend:p>0?"up":"down",description:"Year-over-year revenue growth rate"},{title:"Gross Margin",value:`${b.toFixed(1)}%`,trend:f>0?"up":"down",description:`${f>0?"+":""}${f.toFixed(1)}% vs prior year`},{title:"Operating Margin",value:`${j.toFixed(1)}%`,trend:v>0?"up":"down",description:`${v>0?"+":""}${v.toFixed(1)}% vs prior year`},{title:"Revenue CAGR",value:`${g>0?"+":""}${g.toFixed(1)}%`,trend:g>5?"up":g>0?"neutral":"down",description:`Compound annual growth rate over ${s.length-1} years`}];return{periods:s,latest:l,previous:i,revenue:{latest:o,previous:c,growth:p,cagr:g},profitability:{grossMargin:b,grossMarginChange:f,operatingMargin:j,operatingMarginChange:v},dcf:y,revenueBreakdown:N,kpis:w}},[t,r]);if(!c)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-yellow-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Insufficient Data"}),e.jsx("p",{className:"text-gray-500",children:"Please ensure financial data is loaded to generate analysis results."})]})});const d=({title:s,value:t,trend:a,description:l,icon:r})=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-gray-600 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+("up"===a?"bg-green-900/30 text-green-400":"down"===a?"bg-red-900/30 text-red-400":"bg-gray-700 text-gray-400"),children:e.jsx(r,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-300",children:s}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:l})]})]}),"up"===a&&e.jsx(i,{className:"h-5 w-5 text-green-400 flex-shrink-0"}),"down"===a&&e.jsx(h,{className:"h-5 w-5 text-red-400 flex-shrink-0"})]}),e.jsx("div",{className:"text-3xl font-bold text-white",children:t})]});return e.jsxs("div",{className:"space-y-6 p-6 bg-gray-900 text-white h-full",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center",children:[e.jsx(x,{className:"h-6 w-6 text-blue-400 mr-3"}),"Financial Analysis Results"]}),e.jsx("p",{className:"text-gray-400",children:"Comprehensive analysis of your company's financial performance and valuation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.kpis.map((s,t)=>e.jsx(d,{...s},t))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(b,{className:"h-5 w-5 text-purple-400 mr-2"}),"Performance Trends"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Revenue Analysis"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Latest Period:"}),e.jsx("span",{className:"font-semibold text-white",children:n(c.revenue.latest)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"YoY Growth:"}),e.jsxs("span",{className:"font-semibold "+(c.revenue.growth>0?"text-green-400":"text-red-400"),children:[c.revenue.growth>0?"+":"",c.revenue.growth.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"CAGR:"}),e.jsxs("span",{className:"font-semibold text-gray-200",children:[c.revenue.cagr.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Profitability Margins"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Gross Margin:"}),e.jsxs("span",{className:"font-semibold text-white",children:[c.profitability.grossMargin.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Operating Margin:"}),e.jsxs("span",{className:"font-semibold text-white",children:[c.profitability.operatingMargin.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Margin Change:"}),e.jsxs("span",{className:"font-semibold "+(c.profitability.grossMarginChange>0?"text-green-400":"text-red-400"),children:[c.profitability.grossMarginChange>0?"+":"",c.profitability.grossMarginChange.toFixed(1),"pp"]})]})]})]})]})]}),c.dcf&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(w,{className:"h-5 w-5 text-green-400 mr-2"}),"DCF Valuation Summary"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-900/30 border border-green-700 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:n(c.dcf.enterpriseValue)}),e.jsx("div",{className:"text-sm text-green-300",children:"Enterprise Value"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-900/30 border border-blue-700 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:n(c.dcf.sharePrice)}),e.jsx("div",{className:"text-sm text-blue-300",children:"Price per Share"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-300",children:n(c.dcf.terminalValue)}),e.jsx("div",{className:"text-sm text-gray-400",children:"Terminal Value"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(y,{className:"h-5 w-5 text-orange-400 mr-2"}),"Business Unit Performance"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.revenueBreakdown.map((s,t)=>{const a=c.revenue.latest?s.value/c.revenue.latest*100:0;return e.jsxs("div",{className:"p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:s.name}),e.jsxs("span",{className:"text-sm text-gray-400",children:[a.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-lg font-semibold text-white mb-1",children:n(s.value)}),e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min(a,100)}%`}})})]},t)})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(O,{className:"h-5 w-5 text-green-400 mr-2"}),"Key Financial Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Strengths"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[c.revenue.growth>0&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-green-500 mr-2"}),"Positive revenue growth trajectory"]}),c.profitability.grossMargin>60&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-green-500 mr-2"}),"Strong gross margin above 60%"]}),c.profitability.grossMarginChange>0&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-green-500 mr-2"}),"Improving profitability margins"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(O,{className:"h-4 w-4 text-green-500 mr-2"}),"Diversified healthcare revenue streams"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Areas for Focus"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[c.revenue.growth<5&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Revenue growth below industry benchmarks"]}),c.profitability.operatingMargin<20&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Operating margin optimization opportunities"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Monitor competitive positioning in key segments"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Consider strategic initiatives for growth acceleration"]})]})]})]})]})]})},Ne=({activeStep:t,onStepChange:a,dataCompleteness:l,modelingProgress:r,analysisProgress:n,validationErrors:c={}})=>{const[m,h]=s.useState(null),p=e=>{switch(e){case"data":return l>=80?"completed":l>0?"in-progress":"pending";case"modeling":return l<50?"disabled":r>=80?"completed":r>0?"in-progress":"available";case"analysis":return l<80||r<50?"disabled":n>=80?"completed":n>0?"in-progress":"available";default:return"pending"}},g=[{id:"data",title:"Data Entry",subtitle:"Financial statements & inputs",icon:B,progress:l,description:"Import or manually input your company's financial statements including income statement, balance sheet, and cash flow data.",validationFields:["revenue","expenses","assets"],helpContent:{title:"Data Entry Guidelines",items:["Ensure all financial figures are in the same currency","Use consistent time periods across all statements","Review data for obvious errors or inconsistencies","Include at least 3 years of historical data for better analysis"]}},{id:"modeling",title:"Financial Modeling",subtitle:"DCF, LBO & scenario analysis",icon:o,progress:r,description:"Configure valuation parameters, build financial models, and run scenario analyses to understand value drivers.",validationFields:["discountRate","growthAssumptions","margins"],helpContent:{title:"Modeling Best Practices",items:["Set realistic discount rates based on industry benchmarks","Use conservative growth assumptions for terminal value","Consider multiple scenarios (base, bull, bear cases)","Validate model outputs against comparable companies"]}},{id:"analysis",title:"Analysis & Results",subtitle:"Insights, reports & recommendations",icon:x,progress:n,description:"Review valuation results, sensitivity analysis, and generate comprehensive reports with actionable insights.",validationFields:["valuation","sensitivity","recommendations"],helpContent:{title:"Analysis Interpretation",items:["Compare results across different valuation methods","Pay attention to key value drivers in sensitivity analysis","Consider qualitative factors not captured in models","Document assumptions and limitations in your analysis"]}}],b=e=>{switch(e){case"completed":return"text-emerald-400";case"in-progress":return"text-blue-400";case"available":return"text-slate-300";case"disabled":return"text-slate-500";default:return"text-slate-400"}},j=(e,s)=>{switch(e){case"completed":return"bg-emerald-500/10 border-emerald-400/20";case"in-progress":return"bg-blue-500/10 border-blue-400/20";case"available":return"bg-slate-700/30 border-slate-600/20";case"disabled":return"bg-slate-800/30 border-slate-700/10";default:return"bg-slate-700/20 border-slate-600/10"}},f=(s,t,a)=>{const l=s.icon;return"completed"===t?e.jsx(O,{size:20,className:"text-emerald-400"}):"disabled"===t?e.jsx(l,{size:20,className:"text-slate-500"}):c[s.id]?.length>0?e.jsx(D,{size:20,className:"text-amber-400"}):"in-progress"===t?e.jsx(q,{size:20,className:"text-blue-400"}):e.jsx(l,{size:20,className:a?"text-white":b(t)})},v=(s,t)=>{const a=2*Math.PI*18,l=a,i=a-s/100*a;return e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-10 h-10 transform -rotate-90",viewBox:"0 0 40 40",children:[e.jsx("circle",{cx:"20",cy:"20",r:18,stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-slate-700"}),e.jsx("circle",{cx:"20",cy:"20",r:18,stroke:s>=80?"#10b981":s>=50?"#3b82f6":s>0?"#f59e0b":"#64748b",strokeWidth:"2",fill:"none",strokeDasharray:l,strokeDashoffset:i,className:"transition-all duration-500 ease-in-out",strokeLinecap:"round"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs font-medium text-slate-300",children:[Math.round(s),"%"]})})]})},y=({step:s,isVisible:t,onClose:a})=>t?e.jsxs(u.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute top-full left-0 mt-2 w-80 bg-slate-800 border border-slate-600 rounded-lg p-4 shadow-xl z-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(T,{size:16,className:"text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:s.helpContent.title})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-3",children:s.description}),e.jsx("ul",{className:"space-y-2",children:s.helpContent.items.map((s,t)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-400",children:[e.jsx(d,{size:14,className:"text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t))}),e.jsx("button",{onClick:a,className:"absolute top-2 right-2 text-slate-400 hover:text-white transition-colors",children:"×"})]}):null;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(i,{size:20,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Analysis Workflow"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Follow these steps to complete your analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-slate-300",children:"Overall Progress"}),e.jsxs("div",{className:"text-xs text-slate-400",children:[Math.round((l+r+n)/3),"% Complete"]})]}),e.jsx("div",{className:"w-16 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx(u.div,{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500",initial:{width:0},animate:{width:(l+r+n)/3+"%"},transition:{duration:.8,ease:"easeOut"}})})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:g.map((s,l)=>{const i=p(s.id),r=t===s.id,n="disabled"===i,o=c[s.id]?.length>0;return e.jsxs("div",{className:"relative",children:[e.jsxs(u.button,{onClick:()=>!n&&a(s.id),disabled:n,className:`\n                  w-full p-4 rounded-xl border transition-all duration-200 text-left relative overflow-hidden\n                  ${r?"bg-blue-600 border-blue-500 shadow-lg shadow-blue-600/20":j(i)}\n                  ${n||r?"":"hover:border-slate-500 hover:bg-slate-700/40"}\n                  ${n?"cursor-not-allowed opacity-60":"cursor-pointer"}\n                  ${o?"border-amber-400/40":"border-slate-600/30"}\n                `,whileHover:n||r?{}:{scale:1.02},whileTap:n?{}:{scale:.98},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`\n                      flex items-center justify-center w-10 h-10 rounded-lg transition-all\n                      ${r?"bg-white/20":"completed"===i?"bg-emerald-500/20":"bg-slate-600/30"}\n                    `,children:f(s,i,r)}),e.jsxs("div",{className:"text-xs font-medium text-slate-400",children:["Step ",l+1]})]}),s.progress>0&&e.jsx("div",{className:"flex-shrink-0",children:v(s.progress)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:`font-semibold ${r?"text-white":b(i)}`,children:s.title}),e.jsx("p",{className:"text-sm "+(r?"text-blue-100":"text-slate-400"),children:s.subtitle})]}),o&&e.jsxs("div",{className:"mt-2 text-xs text-amber-400",children:[c[s.id].length," validation issue(s)"]}),r&&e.jsx(u.div,{className:"absolute bottom-0 left-0 right-0 h-1 bg-white/30",layoutId:"activeIndicator"})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),h(m===s.id?null:s.id)},className:"absolute top-2 right-2 p-1.5 text-slate-400 hover:text-white transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(T,{size:14})}),e.jsx(y,{step:s,isVisible:m===s.id,onClose:()=>h(null)}),l<g.length-1&&e.jsx("div",{className:"absolute top-1/2 -right-2 transform -translate-y-1/2 z-10",children:e.jsx(d,{size:16,className:`\n                      ${"disabled"!==p(g[l+1].id)?"text-slate-400":"text-slate-600"}\n                    `})})]},s.id)})}),e.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(z,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Data Quality"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[l,"%"]})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(o,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Models Built"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[Math.round(r),"%"]})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Analysis Done"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[Math.round(n),"%"]})]})]})]})},we=()=>{const[t,i]=s.useState("data"),[r,o]=s.useState(oe),[c,d]=s.useState({}),[m,x]=s.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,taxRate:25},scenario:{scenarios:[]}}),[h,p]=s.useState(()=>{const e=localStorage.getItem("privateAnalyses");return e?JSON.parse(e):[]}),[g,j]=s.useState(!1),[f,v]=s.useState("ready"),[,y]=s.useState(null),[N,w]=s.useState(0),[C,k]=s.useState(0),[M,R]=s.useState({}),S=()=>{if(!r.statements)return 0;const e=["totalRevenue","totalCostOfGoodsSold","operatingIncome","netIncome"],s=["totalAssets","totalLiabilities","totalEquity"],t=["operatingCashFlow","investingCashFlow","financingCashFlow"],a=[...e,...s,...t];let l=0;return e.forEach(e=>{void 0!==r.statements.incomeStatement?.[e]?.[2]&&l++}),s.forEach(e=>{void 0!==r.statements.balanceSheet?.[e]?.[2]&&l++}),t.forEach(e=>{void 0!==r.statements.cashFlowStatement?.[e]?.[2]&&l++}),Math.round(l/a.length*100)},F=()=>{let e=0;return m.dcf.discountRate&&m.dcf.terminalGrowthRate&&(e+=40),m.scenario.scenarios&&m.scenario.scenarios.length>0&&(e+=30),c&&Object.keys(c).length>0&&(e+=30),Math.min(e,100)};s.useEffect(()=>{v("modified"),w(F()),k((()=>{let e=0;const s=S(),t=F();return s>50&&t>30&&(e=60),s>80&&t>60&&(e=100),e})()),R((()=>{const e={},s=[];r.statements?(r.statements.incomeStatement?.totalRevenue||s.push("Missing revenue data"),r.statements.balanceSheet?.totalAssets||s.push("Missing balance sheet data"),r.statements.cashFlowStatement?.operatingCashFlow||s.push("Missing cash flow data")):s.push("No financial statements found"),s.length>0&&(e.data=s);const t=[];(!m.dcf.discountRate||m.dcf.discountRate<=0)&&t.push("Invalid discount rate"),(!m.dcf.terminalGrowthRate||m.dcf.terminalGrowthRate<0)&&t.push("Invalid terminal growth rate"),t.length>0&&(e.modeling=t);const a=[],l=S(),i=F();return l<50&&a.push("Insufficient data for analysis"),i<30&&a.push("Models not configured"),a.length>0&&(e.analysis=a),e})())},[r,c,m]);const A=({status:s,label:t})=>{const a={ready:{color:"text-green-400",bg:"bg-green-400/10",icon:O},modified:{color:"text-yellow-400",bg:"bg-yellow-400/10",icon:q},saving:{color:"text-blue-400",bg:"bg-blue-400/10",icon:b},error:{color:"text-red-400",bg:"bg-red-400/10",icon:$}},l=a[s]||a.ready,i=l.icon;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full ${l.bg}`,children:[e.jsx(i,{size:14,className:l.color}),e.jsx("span",{className:`text-sm ${l.color}`,children:t})]})};return e.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[e.jsx(a,{}),e.jsxs("div",{className:"flex flex-col h-screen pt-16",children:[e.jsx("div",{className:"bg-slate-800/80 backdrop-blur-sm border-b border-slate-700/50",children:e.jsxs("div",{className:"px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(n,{size:24,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Private Analysis"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Professional financial modeling and valuation"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{status:f,label:"ready"===f?"Data Ready":"modified"===f?"Unsaved Changes":"saving"===f?"Saving...":"Error"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>{const e=prompt("Enter analysis name:");e&&(async e=>{if(e){j(!0),v("saving");try{const s={id:Date.now(),name:e,data:r,adjustedValues:c,modelInputs:m,completeness:S(),createdAt:(new Date).toISOString(),lastModified:(new Date).toISOString()},t=[...h,s];p(t),localStorage.setItem("privateAnalyses",JSON.stringify(t)),v("ready"),y(new Date)}catch(s){v("error")}finally{j(!1)}}})(e)},disabled:g,className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(G,{size:16}),"Save"]}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>{},className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(L,{size:16}),"Import"]}),e.jsxs(l,{variant:"ghost",size:"sm",onClick:()=>{},className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(V,{size:16}),"Export"]})]})]})]}),e.jsx(Ne,{activeStep:(e=>{switch(e){case"data":case"spreadsheet":default:return"data";case"modeling":return"modeling";case"analysis":return"analysis"}})(t),onStepChange:e=>{switch(e){case"data":default:i("spreadsheet");break;case"modeling":i("modeling");break;case"analysis":i("analysis")}},dataCompleteness:S(),modelingProgress:N,analysisProgress:C,validationErrors:M})]})}),e.jsx(I,{children:h.length>0&&e.jsxs(u.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-800/50 border-b border-slate-700/50 px-8 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx(B,{size:16,className:"text-slate-400"}),e.jsx("h3",{className:"text-sm font-medium text-slate-300",children:"Recent Analyses"})]}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:h.slice(-5).map(s=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-700/50 rounded-lg border border-slate-600/50",children:[e.jsx("button",{onClick:()=>(e=>{const s=h.find(s=>s.id===e);s&&(o(s.data),d(s.adjustedValues||{}),x(s.modelInputs||m),v("ready"))})(s.id),className:"text-slate-200 hover:text-white font-medium text-sm",children:s.name}),e.jsx("div",{className:"w-px h-4 bg-slate-600"}),e.jsx("button",{onClick:()=>(e=>{const s=h.filter(s=>s.id!==e);p(s),localStorage.setItem("privateAnalyses",JSON.stringify(s))})(s.id),className:"text-slate-400 hover:text-red-400 transition-colors",children:"×"})]},s.id))})]})}),e.jsx("div",{className:"flex-1 bg-slate-900 overflow-hidden",children:e.jsxs(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,ease:"easeOut"},className:"h-full",children:["spreadsheet"===t&&e.jsx(xe,{data:r,onDataChange:o,onAdjustedValuesChange:d}),"modeling"===t&&e.jsx(ve,{data:r,adjustedValues:c,onDataChange:o}),"analysis"===t&&e.jsx(ye,{data:r,adjustedValues:c,modelInputs:m,calculateDCF:null,formatCurrency:de,formatPercentage:ce})]},t)})]})]})};export{we as default};
//# sourceMappingURL=PrivateAnalysis-DG_wVQx-.js.map
