import{r as e,j as s,J as t,t as a,D as r,C as l,H as i,c as n,p as c,z as d,m as o,T as x,I as m,Z as u,K as p,N as h,F as g}from"./react-DbKEDq5F.js";import{l as b,m as j}from"./financial-engines-DJoNW2Bz.js";import{m as y,A as f}from"./animations-DmEkbmfl.js";import{R as v,B as N,C as w,X as C,Y as R,T as S,b as k,A as M,f as F,S as D,g as P,d as V}from"./recharts-vendor-CMq9LHd_.js";import{D as A,W as O}from"./private-analysis-CjCiuYvO.js";const I=Object.freeze(Object.defineProperty({__proto__:null,default:({data:i,onDataChange:n})=>{const[c,d]=e.useState("inputs"),[o,x]=e.useState(null),[m,u]=e.useState(!1),[p,h]=e.useState({symbol:"COMPANY",companyName:"Target Company",purchasePrice:5e8,ebitda:75e6,revenue:5e8,equityContribution:.35,seniorDebtMultiple:4,subordinatedDebtMultiple:1.5,seniorInterestRate:.055,subordinatedInterestRate:.095,ebitdaGrowthRate:.06,capexAsPercentOfRevenue:.03,nwcAsPercentOfRevenue:.02,holdingPeriod:5,exitMultiple:10,transactionFees:.02,managementFees:.02,taxRate:.21}),g=e.useCallback(e=>e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",[]),j=e.useCallback(e=>`${(100*e).toFixed(1)}%`,[]),f=e.useCallback(async()=>{try{u(!0);const e={symbol:p.symbol,companyName:p.companyName,purchasePrice:p.purchasePrice,ebitda:p.ebitda,revenue:p.revenue,assumptions:{debt:{seniorDebtMultiple:p.seniorDebtMultiple,subordinatedDebtMultiple:p.subordinatedDebtMultiple,seniorInterestRate:p.seniorInterestRate,subordinatedInterestRate:p.subordinatedInterestRate},operating:{ebitdaGrowthRate:p.ebitdaGrowthRate,capexAsPercentOfRevenue:p.capexAsPercentOfRevenue,nwcAsPercentOfRevenue:p.nwcAsPercentOfRevenue,taxRate:p.taxRate},exit:{exitMultiple:p.exitMultiple},transaction:{holdingPeriod:p.holdingPeriod,transactionFees:p.transactionFees}}},s=b.buildLBOModel(e);x(s),n&&n({lboModel:{inputs:p,results:s,timestamp:(new Date).toISOString()}})}catch(e){alert(`Error: ${e.message}`)}finally{u(!1)}},[p,n]),v=e.useCallback((e,s)=>{h(t=>({...t,[e]:"string"==typeof s?parseFloat(s)||0:s}))},[]);return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(t,{className:"text-blue-600",size:28}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Advanced LBO Modeling"}),s.jsx("p",{className:"text-gray-600",children:"Professional leveraged buyout analysis"})]})]}),s.jsxs(y.button,{onClick:f,disabled:m,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(m?"bg-gray-300 text-gray-500":"bg-blue-600 hover:bg-blue-700 text-white"),children:[s.jsx(a,{size:18}),s.jsx("span",{children:m?"Calculating...":"Calculate LBO"})]})]}),s.jsx("div",{className:"border-b border-gray-200 mb-6",children:s.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"inputs",label:"Model Inputs",icon:r},{id:"results",label:"Results & Analysis",icon:l}].map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>d(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(c===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[s.jsx(t,{size:16}),s.jsx("span",{children:e.label})]},e.id)})})}),"inputs"===c&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Transaction"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Purchase Price"}),s.jsx("input",{type:"number",value:p.purchasePrice,onChange:e=>v("purchasePrice",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"}),s.jsx("p",{className:"text-xs text-gray-500",children:g(p.purchasePrice)})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current EBITDA"}),s.jsx("input",{type:"number",value:p.ebitda,onChange:e=>v("ebitda",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Holding Period"}),s.jsx("input",{type:"number",value:p.holdingPeriod,onChange:e=>v("holdingPeriod",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Financing"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senior Debt Multiple"}),s.jsx("input",{type:"number",step:"0.1",value:p.seniorDebtMultiple,onChange:e=>v("seniorDebtMultiple",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sub Debt Multiple"}),s.jsx("input",{type:"number",step:"0.1",value:p.subordinatedDebtMultiple,onChange:e=>v("subordinatedDebtMultiple",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senior Rate (%)"}),s.jsx("input",{type:"number",step:"0.001",value:100*p.seniorInterestRate,onChange:e=>v("seniorInterestRate",(e.target.value||0)/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]}),s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-semibold mb-3",children:"Operating"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA Growth (%)"}),s.jsx("input",{type:"number",step:"0.01",value:100*p.ebitdaGrowthRate,onChange:e=>v("ebitdaGrowthRate",(e.target.value||0)/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Exit Multiple"}),s.jsx("input",{type:"number",step:"0.1",value:p.exitMultiple,onChange:e=>v("exitMultiple",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),s.jsx("input",{type:"number",step:"0.01",value:100*p.taxRate,onChange:e=>v("taxRate",(e.target.value||0)/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]})]})]})]})}),"results"===c&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:o?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:j(o.baseCase?.returnsAnalysis?.irr||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"IRR"})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(o.baseCase?.returnsAnalysis?.moic||0).toFixed(1),"x"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"MOIC"})]}),s.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[s.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[(o.transactionStructure?.debtToEbitda||0).toFixed(1),"x"]}),s.jsx("div",{className:"text-sm text-gray-600",children:"Leverage"})]}),s.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-orange-600",children:g(o.baseCase?.exitAnalysis?.equityProceeds||0)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Exit Value"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Transaction Structure"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Purchase Price:"}),s.jsx("span",{className:"font-medium",children:g(o.transactionStructure?.purchasePrice)})]}),s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Total Debt:"}),s.jsx("span",{className:"font-medium",children:g(o.transactionStructure?.totalDebt)})]}),s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Equity Investment:"}),s.jsx("span",{className:"font-medium",children:g(o.transactionStructure?.equityContribution)})]})]}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Entry Multiple:"}),s.jsxs("span",{className:"font-medium",children:[(o.transactionStructure?.entryMultiple||0).toFixed(1),"x"]})]}),s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Debt/EBITDA:"}),s.jsxs("span",{className:"font-medium",children:[(o.transactionStructure?.debtToEbitda||0).toFixed(1),"x"]})]}),s.jsxs("div",{className:"flex justify-between py-2",children:[s.jsx("span",{children:"Equity %:"}),s.jsx("span",{className:"font-medium",children:j(o.transactionStructure?.equityPercentage||0)})]})]})]})]}),o.scenarios&&Object.keys(o.scenarios).length>0&&s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Scenario Analysis"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-300",children:[s.jsx("th",{className:"text-left py-2",children:"Scenario"}),s.jsx("th",{className:"text-right py-2",children:"IRR"}),s.jsx("th",{className:"text-right py-2",children:"MOIC"}),s.jsx("th",{className:"text-right py-2",children:"Exit Value"})]})}),s.jsxs("tbody",{children:[s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("td",{className:"py-2 font-medium",children:"Base Case"}),s.jsx("td",{className:"text-right py-2",children:j(o.baseCase?.returnsAnalysis?.irr||0)}),s.jsxs("td",{className:"text-right py-2",children:[(o.baseCase?.returnsAnalysis?.moic||0).toFixed(1),"x"]}),s.jsx("td",{className:"text-right py-2",children:g(o.baseCase?.exitAnalysis?.equityProceeds||0)})]}),Object.entries(o.scenarios).map(([e,t])=>s.jsxs("tr",{className:"border-b border-gray-200",children:[s.jsx("td",{className:"py-2",children:e}),s.jsx("td",{className:"text-right py-2",children:j(t.returnsAnalysis?.irr||0)}),s.jsxs("td",{className:"text-right py-2",children:[(t.returnsAnalysis?.moic||0).toFixed(1),"x"]}),s.jsx("td",{className:"text-right py-2",children:g(t.exitAnalysis?.equityProceeds||0)})]},e))]})]})})]})]}):s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(l,{size:48,className:"mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Run LBO calculation to see results"})]})})]})}},Symbol.toStringTag,{value:"Module"})),E=Object.freeze(Object.defineProperty({__proto__:null,default:({data:t,onDataChange:a,calculateDCF:r,lboModelingEngine:o})=>{e.useState("scenarios");const[x,m]=e.useState([{id:1,name:"Base Case",probability:40,revenueGrowth:5,marginExpansion:.5,exitMultiple:10,capexIntensity:3,isBase:!0},{id:2,name:"Bull Case",probability:30,revenueGrowth:8,marginExpansion:1.5,exitMultiple:12,capexIntensity:2.5,isBase:!1},{id:3,name:"Bear Case",probability:30,revenueGrowth:2,marginExpansion:-.5,exitMultiple:8,capexIntensity:4,isBase:!1}]),[u,p]=e.useState({modelType:"dcf",outputMetric:"enterpriseValue",includeCorrelations:!1,numSimulations:1e3}),[h,g]=e.useState(null),[b,j]=e.useState(!1),f=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",[]),M=e.useCallback(e=>`${(e||0).toFixed(1)}%`,[]),F=e.useCallback(async()=>{j(!0);try{const e=[];for(const i of x){let s=null;if("dcf"===u.modelType){const e={...t,statements:{...t.statements,incomeStatement:{...t.statements.incomeStatement,totalRevenue:t.statements.incomeStatement.totalRevenue?.map((e,s)=>0===s?e:e*Math.pow(1+i.revenueGrowth/100,s))}}};s=r?r(e):null}else if("lbo"===u.modelType&&o){const e={symbol:t.symbol||"COMPANY",companyName:t.companyName||"Target Company",purchasePrice:5e8,ebitda:75e6,revenue:5e8,assumptions:{operating:{ebitdaGrowthRate:i.revenueGrowth/100,capexAsPercentOfRevenue:i.capexIntensity/100},exit:{exitMultiple:i.exitMultiple}}};s=o.buildLBOModel(e)}e.push({...i,result:s,enterpriseValue:s?.enterpriseValue||s?.baseCase?.exitAnalysis?.enterpriseValue||0,equityValue:s?.equityValue||s?.baseCase?.exitAnalysis?.equityProceeds||0,irr:s?.irr||s?.baseCase?.returnsAnalysis?.irr||0,moic:s?.moic||s?.baseCase?.returnsAnalysis?.moic||0})}const s=e.reduce((e,s)=>e+s.enterpriseValue*s.probability/100,0),a={min:Math.min(...e.map(e=>e.enterpriseValue)),max:Math.max(...e.map(e=>e.enterpriseValue)),range:Math.max(...e.map(e=>e.enterpriseValue))-Math.min(...e.map(e=>e.enterpriseValue))},l=Math.sqrt(e.reduce((e,t)=>{const a=t.enterpriseValue-s;return e+a*a*t.probability/100},0));g({scenarios:e,summary:{weightedValue:s,valueRange:a,standardDeviation:l,coefficientOfVariation:l/s,probabilityOfPositiveReturn:e.filter(e=>e.enterpriseValue>(t.currentMarketCap||1e9)).reduce((e,s)=>e+s.probability,0)},chartData:e.map(e=>({name:e.name,value:e.enterpriseValue,probability:e.probability,irr:100*e.irr,moic:e.moic}))})}catch(e){alert(`Error running scenario analysis: ${e.message}`)}finally{j(!1)}},[x,u,t,r,o]),D=e.useCallback(()=>{const e={id:Date.now(),name:`Scenario ${x.length+1}`,probability:Math.max(0,100-x.reduce((e,s)=>e+s.probability,0)),revenueGrowth:5,marginExpansion:0,exitMultiple:10,capexIntensity:3,isBase:!1};m(s=>[...s,e])},[x]),P=e.useCallback((e,s,t)=>{m(a=>a.map(a=>a.id===e?{...a,[s]:parseFloat(t)||t}:a))},[]),V=e.useCallback(e=>{m(s=>s.filter(s=>s.id!==e&&!s.isBase))},[]),A=e.useMemo(()=>x.reduce((e,s)=>e+s.probability,0),[x]);return s.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center space-x-3",children:[s.jsx(l,{className:"text-purple-600",size:28}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Enhanced Scenario Analysis"}),s.jsx("p",{className:"text-gray-600",children:"Cross-model scenario planning & risk assessment"})]})]}),s.jsx("div",{className:"flex space-x-3",children:s.jsxs(y.button,{onClick:F,disabled:b||100!==A,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(b||100!==A?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),whileHover:b||100!==A?{}:{scale:1.02},children:[s.jsx(i,{size:18}),s.jsx("span",{children:b?"Running...":"Run Analysis"})]})})]}),s.jsx("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Model Type"}),s.jsxs("select",{value:u.modelType,onChange:e=>p(s=>({...s,modelType:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:"dcf",children:"DCF Valuation"}),s.jsx("option",{value:"lbo",children:"LBO Analysis"}),s.jsx("option",{value:"3statement",children:"3-Statement Model"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Output Metric"}),s.jsxs("select",{value:u.outputMetric,onChange:e=>p(s=>({...s,outputMetric:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[s.jsx("option",{value:"enterpriseValue",children:"Enterprise Value"}),s.jsx("option",{value:"equityValue",children:"Equity Value"}),s.jsx("option",{value:"irr",children:"IRR"}),s.jsx("option",{value:"moic",children:"MOIC"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Simulations"}),s.jsx("input",{type:"number",value:u.numSimulations,onChange:e=>p(s=>({...s,numSimulations:parseInt(e.target.value)||1e3})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),s.jsx("div",{className:"flex items-end",children:s.jsxs("label",{className:"flex items-center",children:[s.jsx("input",{type:"checkbox",checked:u.includeCorrelations,onChange:e=>p(s=>({...s,includeCorrelations:e.target.checked})),className:"mr-2"}),s.jsx("span",{className:"text-sm text-gray-700",children:"Include Correlations"})]})})]})}),100!==A&&s.jsxs("div",{className:"mb-6 p-3 bg-amber-50 border border-amber-200 rounded-lg flex items-center",children:[s.jsx(n,{className:"text-amber-500 mr-2",size:20}),s.jsxs("span",{className:"text-amber-800",children:["Total probability is ",A,"%. Adjust scenarios to sum to 100%."]})]}),s.jsxs("div",{className:"mb-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"Scenarios"}),s.jsxs(y.button,{onClick:D,className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[s.jsx(c,{size:16}),s.jsx("span",{children:"Add Scenario"})]})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b-2 border-gray-300",children:[s.jsx("th",{className:"text-left py-3 px-4",children:"Scenario"}),s.jsx("th",{className:"text-right py-3 px-4",children:"Probability (%)"}),s.jsx("th",{className:"text-right py-3 px-4",children:"Revenue Growth (%)"}),s.jsx("th",{className:"text-right py-3 px-4",children:"Margin Expansion (bps)"}),s.jsx("th",{className:"text-right py-3 px-4",children:"Exit Multiple"}),s.jsx("th",{className:"text-right py-3 px-4",children:"CapEx Intensity (%)"}),s.jsx("th",{className:"text-center py-3 px-4",children:"Actions"})]})}),s.jsx("tbody",{children:x.map(e=>s.jsxs("tr",{className:"border-b border-gray-200 "+(e.isBase?"bg-blue-50":""),children:[s.jsx("td",{className:"py-3 px-4",children:s.jsx("input",{type:"text",value:e.name,onChange:s=>P(e.id,"name",s.target.value),disabled:e.isBase,className:"border border-gray-300 rounded px-2 py-1 "+(e.isBase?"bg-gray-100":"")})}),s.jsx("td",{className:"text-right py-3 px-4",children:s.jsx("input",{type:"number",step:"1",value:e.probability,onChange:s=>P(e.id,"probability",s.target.value),className:"w-20 text-right border border-gray-300 rounded px-2 py-1"})}),s.jsx("td",{className:"text-right py-3 px-4",children:s.jsx("input",{type:"number",step:"0.1",value:e.revenueGrowth,onChange:s=>P(e.id,"revenueGrowth",s.target.value),className:"w-20 text-right border border-gray-300 rounded px-2 py-1"})}),s.jsx("td",{className:"text-right py-3 px-4",children:s.jsx("input",{type:"number",step:"0.1",value:e.marginExpansion,onChange:s=>P(e.id,"marginExpansion",s.target.value),className:"w-20 text-right border border-gray-300 rounded px-2 py-1"})}),s.jsx("td",{className:"text-right py-3 px-4",children:s.jsx("input",{type:"number",step:"0.1",value:e.exitMultiple,onChange:s=>P(e.id,"exitMultiple",s.target.value),className:"w-20 text-right border border-gray-300 rounded px-2 py-1"})}),s.jsx("td",{className:"text-right py-3 px-4",children:s.jsx("input",{type:"number",step:"0.1",value:e.capexIntensity,onChange:s=>P(e.id,"capexIntensity",s.target.value),className:"w-20 text-right border border-gray-300 rounded px-2 py-1"})}),s.jsx("td",{className:"text-center py-3 px-4",children:!e.isBase&&s.jsx("button",{onClick:()=>V(e.id),className:"text-red-600 hover:text-red-800",children:s.jsx(d,{size:16})})})]},e.id))})]})})]}),h&&s.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-blue-600",children:f(h.summary.weightedValue)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Expected Value"})]}),s.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-green-600",children:f(h.summary.valueRange.max)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Best Case"})]}),s.jsxs("div",{className:"bg-red-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-red-600",children:f(h.summary.valueRange.min)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Worst Case"})]}),s.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[s.jsx("div",{className:"text-2xl font-bold text-purple-600",children:M(h.summary.probabilityOfPositiveReturn)}),s.jsx("div",{className:"text-sm text-gray-600",children:"Success Probability"})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Scenario Results"}),s.jsx("div",{className:"h-80",children:s.jsx(v,{width:"100%",height:"100%",children:s.jsxs(N,{data:h.chartData,children:[s.jsx(w,{strokeDasharray:"3 3"}),s.jsx(C,{dataKey:"name"}),s.jsx(R,{tickFormatter:e=>f(e)}),s.jsx(S,{formatter:e=>[f(e),"Enterprise Value"]}),s.jsx(k,{dataKey:"value",fill:"#8884d8"})]})})})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Risk Metrics"}),s.jsxs("div",{className:"space-y-2 text-sm",children:[s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Standard Deviation:"}),s.jsx("span",{className:"font-medium",children:f(h.summary.standardDeviation)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Coefficient of Variation:"}),s.jsxs("span",{className:"font-medium",children:[(100*h.summary.coefficientOfVariation).toFixed(1),"%"]})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Value at Risk (5%):"}),s.jsx("span",{className:"font-medium",children:f(h.summary.valueRange.min)})]}),s.jsxs("div",{className:"flex justify-between",children:[s.jsx("span",{children:"Upside Potential:"}),s.jsx("span",{className:"font-medium",children:f(h.summary.valueRange.range)})]})]})]}),s.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[s.jsx("h4",{className:"font-semibold mb-3",children:"Scenario Returns"}),s.jsx("div",{className:"space-y-2 text-sm",children:h.scenarios.map(e=>s.jsxs("div",{className:"flex justify-between",children:[s.jsxs("span",{children:[e.name,":"]}),s.jsx("span",{className:"font-medium",children:"irr"===u.outputMetric?M(e.irr):"moic"===u.outputMetric?`${e.moic.toFixed(1)}x`:f(e[u.outputMetric])})]},e.id))})]})]})]}),!h&&s.jsxs("div",{className:"text-center py-12 text-gray-500",children:[s.jsx(l,{size:48,className:"mx-auto mb-4 opacity-50"}),s.jsx("p",{children:"Configure scenarios and run analysis to see results"})]})]})}},Symbol.toStringTag,{value:"Module"})),T=({data:t,modelInputs:i,onModelInputChange:n,formatCurrency:c,formatPercent:d})=>{e.useState(!1),e.useState(!0);const[u,p]=e.useState("results"),h=e.useMemo(()=>{const{discountRate:e,terminalGrowthRate:s,projectionYears:a,taxRate:r}=i.dcf,l=t.statements,n=i.dcf.workingCapital||{receivablesDays:45,inventoryDays:60,payablesDays:30},c=i.dcf.capex||{capexAsPercentOfRevenue:3.5,depreciationRate:7},d={years:[],freeCashFlows:[],presentValues:[],workingCapitalChanges:[],capexAmounts:[],unleveredFreeCashFlow:[],cumulativePV:0,terminalValue:0,presentValueTerminal:0,enterpriseValue:0,equityValue:0,impliedShare:0},o=l.incomeStatement.totalRevenue?.[0]||1e5;for(let t=1;t<=a;t++){const s={year:t,revenue:l.incomeStatement.totalRevenue?.[t]||0,operatingIncome:l.incomeStatement.operatingIncome?.[t]||0,nopat:0,workingCapitalChange:0,capex:0,depreciation:0,freeCashFlow:0,presentValue:0};s.nopat=s.operatingIncome*(1-r/100);const a=s.revenue,i=t>1?l.incomeStatement.totalRevenue?.[t-1]||0:o,x=a*n.receivablesDays/365,m=a*n.inventoryDays/365,u=a*n.payablesDays/365,p=x-i*n.receivablesDays/365,h=m-i*n.inventoryDays/365,g=u-i*n.payablesDays/365;s.workingCapitalChange=-(p+h-g),s.capex=-a*c.capexAsPercentOfRevenue/100,s.depreciation=Math.abs(s.capex)/c.depreciationRate,s.freeCashFlow=s.nopat+s.depreciation+s.capex+s.workingCapitalChange;const b=Math.pow(1+e/100,t);s.presentValue=s.freeCashFlow/b,d.years.push(s),d.freeCashFlows.push(s.freeCashFlow),d.presentValues.push(s.presentValue),d.workingCapitalChanges.push(s.workingCapitalChange),d.capexAmounts.push(s.capex),d.unleveredFreeCashFlow.push(s.freeCashFlow),d.cumulativePV+=s.presentValue}const x=(d.years[d.years.length-1]?.freeCashFlow||0)*(1+s/100);d.terminalValue=x/((e-s)/100);const m=Math.pow(1+e/100,a);d.presentValueTerminal=d.terminalValue/m,d.enterpriseValue=d.cumulativePV+d.presentValueTerminal,d.equityValue=d.enterpriseValue-0;const u=i.dcf.sharesOutstanding||1e3;return d.impliedShare=d.equityValue/u,d},[t,i]),g=(e,s,t)=>{const a={...i.dcf,[e]:{...i.dcf[e],[s]:parseFloat(t)||0}};n("dcf",e,a[e])},b=(e,s)=>{n("dcf",e,parseFloat(s)||0)};return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex justify-between items-start",children:[s.jsxs("div",{children:[s.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[s.jsx(a,{size:20}),"Advanced DCF Valuation"]}),s.jsx("p",{className:"text-gray-600",children:"Professional-grade DCF with working capital analysis, capex modeling, and detailed cash flow projections."})]}),s.jsx("div",{className:"flex gap-2",children:["results","charts","wacc","assumptions"].map(e=>s.jsxs("button",{onClick:()=>p(e),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-1 "+(u===e?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:["results"===e&&s.jsx(r,{size:14}),"charts"===e&&s.jsx(l,{size:14}),"wacc"===e&&s.jsx(a,{size:14}),"assumptions"===e&&s.jsx(o,{size:14}),e.charAt(0).toUpperCase()+e.slice(1)]},e))})]}),"results"===u&&s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[s.jsxs(y.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(r,{size:20,className:"text-green-600"}),s.jsx("span",{className:"text-xs text-green-600 font-medium",children:"ENTERPRISE VALUE"})]}),s.jsx("div",{className:"text-2xl font-bold text-green-800",children:c(h.enterpriseValue)}),s.jsxs("div",{className:"text-sm text-green-600 mt-1",children:["PV Operations: ",c(h.cumulativePV)]})]}),s.jsxs(y.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(x,{size:20,className:"text-blue-600"}),s.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EQUITY VALUE"})]}),s.jsx("div",{className:"text-2xl font-bold text-blue-800",children:c(h.equityValue)}),s.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:["Per Share: ",c(h.impliedShare)]})]}),s.jsxs(y.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(l,{size:20,className:"text-purple-600"}),s.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"TERMINAL VALUE"})]}),s.jsx("div",{className:"text-2xl font-bold text-purple-800",children:c(h.terminalValue)}),s.jsxs("div",{className:"text-sm text-purple-600 mt-1",children:["PV: ",c(h.presentValueTerminal)]})]}),s.jsxs(y.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsx(m,{size:20,className:"text-orange-600"}),s.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"IMPLIED MULTIPLE"})]}),s.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[(h.enterpriseValue/(t.statements.incomeStatement.totalRevenue?.[1]||1)).toFixed(1),"x"]}),s.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"EV/Revenue (Year 1)"})]})]}),s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Detailed Cash Flow Analysis"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b bg-gray-50",children:[s.jsx("th",{className:"text-left p-3 font-medium",children:"Year"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Operating Income"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"NOPAT"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Depreciation"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Capex"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Î”Working Capital"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Free Cash Flow"}),s.jsx("th",{className:"text-right p-3 font-medium",children:"Present Value"})]})}),s.jsxs("tbody",{children:[h.years.map((e,t)=>s.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[s.jsx("td",{className:"p-3 font-medium",children:e.year}),s.jsx("td",{className:"p-3 text-right",children:c(e.revenue)}),s.jsx("td",{className:"p-3 text-right",children:c(e.operatingIncome)}),s.jsx("td",{className:"p-3 text-right",children:c(e.nopat)}),s.jsxs("td",{className:"p-3 text-right text-green-600",children:["+",c(e.depreciation)]}),s.jsx("td",{className:"p-3 text-right text-red-600",children:c(e.capex)}),s.jsxs("td",{className:"p-3 text-right "+(e.workingCapitalChange>=0?"text-green-600":"text-red-600"),children:[e.workingCapitalChange>=0?"+":"",c(e.workingCapitalChange)]}),s.jsx("td",{className:"p-3 text-right font-medium",children:c(e.freeCashFlow)}),s.jsx("td",{className:"p-3 text-right font-medium",children:c(e.presentValue)})]},t)),s.jsxs("tr",{className:"border-b-2 border-gray-300 bg-blue-50",children:[s.jsx("td",{className:"p-3 font-bold",children:"Terminal"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3 text-right font-bold",children:c(h.terminalValue)}),s.jsx("td",{className:"p-3 text-right font-bold",children:c(h.presentValueTerminal)})]}),s.jsxs("tr",{className:"bg-gray-100 font-bold",children:[s.jsx("td",{className:"p-3",children:"TOTAL"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3"}),s.jsx("td",{className:"p-3 text-right text-lg",children:c(h.enterpriseValue)})]})]})]})})]})]}),"charts"===u&&s.jsx(A,{dcfData:h,sensitivityData:null,scenarioData:null,formatCurrency:c,formatPercent:d}),"wacc"===u&&s.jsx(O,{modelInputs:i,onModelInputChange:n,formatPercent:d}),"assumptions"===u&&s.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[s.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Model Assumptions"}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Core Assumptions"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Rate (WACC) %"}),s.jsx("input",{type:"number",step:"0.1",value:i.dcf.discountRate,onChange:e=>b("discountRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terminal Growth Rate %"}),s.jsx("input",{type:"number",step:"0.1",value:i.dcf.terminalGrowthRate,onChange:e=>b("terminalGrowthRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate %"}),s.jsx("input",{type:"number",step:"0.1",value:i.dcf.taxRate,onChange:e=>b("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Working Capital"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receivables (Days)"}),s.jsx("input",{type:"number",value:i.dcf.workingCapital?.receivablesDays||45,onChange:e=>g("workingCapital","receivablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inventory (Days)"}),s.jsx("input",{type:"number",value:i.dcf.workingCapital?.inventoryDays||60,onChange:e=>g("workingCapital","inventoryDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payables (Days)"}),s.jsx("input",{type:"number",value:i.dcf.workingCapital?.payablesDays||30,onChange:e=>g("workingCapital","payablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),s.jsxs("div",{children:[s.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Capital Expenditure"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capex (% of Revenue)"}),s.jsx("input",{type:"number",step:"0.1",value:i.dcf.capex?.capexAsPercentOfRevenue||3.5,onChange:e=>g("capex","capexAsPercentOfRevenue",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Depreciation Period (Years)"}),s.jsx("input",{type:"number",value:i.dcf.capex?.depreciationRate||7,onChange:e=>g("capex","depreciationRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shares Outstanding (000s)"}),s.jsx("input",{type:"number",value:i.dcf.sharesOutstanding||1e3,onChange:e=>b("sharesOutstanding",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]})]})]})},B=({data:t,onDataChange:a})=>{const[r,c]=e.useState("setup"),[d,m]=e.useState(null),[b,N]=e.useState(!1),[k,A]=e.useState(0),[O,I]=e.useState({iterations:1e4,confidenceLevel:.95,randomSeed:null,enableCorrelation:!1}),[E,T]=e.useState({revenueGrowthRate:{type:"normal",parameters:{mean:.1,stdDev:.03},name:"Revenue Growth Rate",enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.12,mode:.15,max:.18},name:"FCF Margin",enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},name:"WACC",enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},name:"Terminal Growth Rate",enabled:!0}}),[B,L]=e.useState([[1,.3,-.2,.1],[.3,1,-.4,.2],[-.2,-.4,1,-.3],[.1,.2,-.3,1]]),z=[{value:"normal",label:"Normal",parameters:["mean","stdDev"]},{value:"triangular",label:"Triangular",parameters:["min","mode","max"]},{value:"uniform",label:"Uniform",parameters:["min","max"]},{value:"lognormal",label:"Log-Normal",parameters:["mu","sigma"]},{value:"beta",label:"Beta",parameters:["alpha","beta"]}],G=e.useCallback(async()=>{try{N(!0),A(0);const e=Object.fromEntries(Object.entries(E).filter(([e,s])=>s.enabled));if(0===Object.keys(e).length)throw new Error("No distributions are enabled. Please enable at least one variable distribution to run the simulation.");const s={iterations:O.iterations,confidenceLevel:O.confidenceLevel,randomSeed:O.randomSeed,correlationMatrix:O.enableCorrelation?B:null,onProgress:A},a=t?.statements?.incomeStatement,r=t?.periods?.length-1||2,l={currentRevenue:1e3*(a?.totalRevenue?.[r]||1e6),currentPrice:100,sharesOutstanding:1e6,currentOperatingIncome:1e3*(a?.operatingIncome?.[r]||15e4),...Object.fromEntries(Object.entries(e).map(([e,s])=>[e,s.parameters.mean||s.parameters.mode||(s.parameters.min+s.parameters.max)/2]))},i=await j.runDCFSimulation(l,e,s);m(i)}catch(e){alert(`Monte Carlo simulation failed: ${e.message}`)}finally{N(!1),A(0)}},[E,O,B,t]),$=e.useCallback(()=>{j.stopSimulation(),N(!1)},[]),q=e.useCallback((e,s)=>{T(t=>({...t,[e]:{...t[e],...s}}))},[]),U=e.useCallback((e,s,t)=>{L(a=>{const r=a.map(e=>[...e]);return r[e][s]=t,r[s][e]=t,r})},[]),H=e.useMemo(()=>{if(!d?.results)return[];const e=d.results.map(e=>e.pricePerShare),s=Math.min(...e),t=(Math.max(...e)-s)/50,a=Array(50).fill(0).map((e,a)=>({bin:s+a*t,count:0,frequency:0}));return e.forEach(e=>{const r=Math.min(Math.floor((e-s)/t),49);a[r].count++}),a.forEach(s=>{s.frequency=s.count/e.length}),a},[d]),Y=e.useMemo(()=>d?.results?d.results.slice(0,1e3).map((e,s)=>({x:100*e.inputs.revenueGrowthRate,y:e.pricePerShare,upside:e.upside})):[],[d]),_=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),K=[{id:"setup",label:"Setup",icon:o},{id:"run",label:"Run Simulation",icon:i},{id:"results",label:"Results",icon:l},{id:"analysis",label:"Analysis",icon:x}];return s.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[s.jsx("div",{className:"mb-6",children:s.jsxs(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[s.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center",children:[s.jsx(u,{className:"inline-block mr-2"}),"Monte Carlo Simulation"]}),s.jsx("p",{className:"text-gray-400 text-sm",children:"Advanced risk analysis using probabilistic modeling â€¢ Generate thousands of scenarios â€¢ Measure uncertainty"})]})}),s.jsx("div",{className:"mb-6",children:s.jsx("div",{className:"flex space-x-2",children:K.map(e=>{const t=e.icon;return s.jsxs("button",{onClick:()=>c(e.id),className:"px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 "+(r===e.id?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:[s.jsx(t,{size:16}),e.label]},e.id)})})}),s.jsx("div",{className:"mt-6",children:s.jsxs(f,{mode:"wait",children:["setup"===r&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"ðŸŽ›ï¸ Simulation Settings"}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Iterations"}),s.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:O.iterations,onChange:e=>I(s=>({...s,iterations:parseInt(e.target.value)})),min:"1000",max:"100000",step:"1000"}),s.jsx("small",{className:"text-gray-400",children:"Leave empty for random"})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Confidence Level"}),s.jsxs("select",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:O.confidenceLevel,onChange:e=>I(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),children:[s.jsx("option",{value:.9,children:"90%"}),s.jsx("option",{value:.95,children:"95%"}),s.jsx("option",{value:.99,children:"99%"})]})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Random Seed (Optional)"}),s.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:O.randomSeed||"",onChange:e=>I(s=>({...s,randomSeed:e.target.value?parseInt(e.target.value):null})),placeholder:"Leave empty for random"})]}),s.jsx("div",{className:"space-y-2",children:s.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[s.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500",checked:O.enableCorrelation,onChange:e=>I(s=>({...s,enableCorrelation:e.target.checked}))}),s.jsx("span",{children:"Enable Variable Correlation"})]})})]})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"ðŸ“Š Variable Distributions"}),s.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Object.entries(E).map(([e,t])=>s.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[s.jsx("input",{type:"checkbox",checked:t.enabled,onChange:s=>q(e,{enabled:s.target.checked})}),s.jsx("span",{className:"font-medium",children:t.name})]})}),t.enabled&&s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"space-y-2",children:[s.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Distribution Type"}),s.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:t.type,onChange:s=>{const t=s.target.value,a={};"normal"===t?(a.mean=.1,a.stdDev=.02):"triangular"===t?(a.min=.05,a.mode=.1,a.max=.15):"uniform"===t&&(a.min=.05,a.max=.15),q(e,{type:t,parameters:a})},children:z.map(e=>s.jsx("option",{value:e.value,children:e.label},e.value))})]}),s.jsx("div",{className:"grid grid-cols-2 gap-3",children:z.find(e=>e.value===t.type)?.parameters.map(a=>s.jsxs("div",{className:"space-y-1",children:[s.jsx("label",{className:"block text-xs font-medium text-gray-300",children:a.charAt(0).toUpperCase()+a.slice(1)}),s.jsx("input",{className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",type:"number",value:t.parameters[a]||"",onChange:s=>q(e,{parameters:{...t.parameters,[a]:parseFloat(s.target.value)}}),step:"0.001"})]},a))})]})]},e))})]}),O.enableCorrelation&&s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"ðŸ”— Correlation Matrix"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{}),Object.keys(E).map(e=>s.jsx("th",{children:E[e].name},e))]})}),s.jsx("tbody",{children:Object.keys(E).map((e,t)=>s.jsxs("tr",{children:[s.jsx("td",{className:"font-medium text-gray-200 p-2 border border-gray-600",children:E[e].name}),Object.keys(E).map((e,a)=>s.jsx("td",{className:"p-2 border border-gray-600",children:s.jsx("input",{type:"number",value:B[t][a],onChange:e=>U(t,a,parseFloat(e.target.value)),min:"-1",max:"1",step:"0.1",disabled:t===a,className:"w-full px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-700 disabled:text-gray-400"})},a))]},e))})]})})]})]})},"setup"),"run"===r&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{children:"ðŸš€ Simulation Control"}),s.jsx("div",{className:"flex items-center space-x-2",children:b?s.jsxs("button",{onClick:$,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[s.jsx(p,{size:16}),s.jsx("span",{children:"Stop Simulation"})]}):s.jsxs("button",{onClick:G,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",disabled:Object.values(E).every(e=>!e.enabled),children:[s.jsx(i,{size:16}),s.jsx("span",{children:"Run Simulation"})]})})]}),b&&s.jsxs("div",{className:"mt-4",children:[s.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mb-2",children:s.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${k}%`}})}),s.jsxs("div",{className:"text-sm text-gray-400 text-center",children:[k.toFixed(1),"% Complete (",Math.floor(k*O.iterations/100)," / ",O.iterations," iterations)"]})]}),s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mt-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"ðŸ“‹ Simulation Preview"}),s.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[s.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Iterations"}),s.jsx("div",{className:"text-xl font-bold text-white",children:O.iterations.toLocaleString()})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Variables"}),s.jsx("div",{className:"text-xl font-bold text-white",children:Object.values(E).filter(e=>e.enabled).length})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Confidence Level"}),s.jsxs("div",{className:"text-xl font-bold text-white",children:[(100*O.confidenceLevel).toFixed(0),"%"]})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[s.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Correlation"}),s.jsx("div",{className:"text-xl font-bold text-white",children:O.enableCorrelation?"Enabled":"Disabled"})]})]})]})]})},"run"),"results"===r&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:d?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("h3",{className:"text-xl font-semibold text-white flex items-center",children:"ðŸ“Š Simulation Results"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("button",{className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[s.jsx(h,{size:16}),"Export Results"]}),s.jsxs("button",{className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[s.jsx(g,{size:16}),"Generate Report"]})]})]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(d.analysis.statistics).map(([e,t])=>s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"pricePerShare"===e?"ðŸ’° Price per Share":"enterpriseValue"===e?"ðŸ¢ Enterprise Value":"ðŸ“ˆ Upside %"}),s.jsx("div",{className:"text-2xl font-bold text-green-400 mb-2",children:"upside"===e?`${t.mean.toFixed(1)}%`:_(t.mean)}),s.jsxs("div",{className:"space-y-1 text-sm text-gray-300",children:[s.jsxs("div",{children:["Median: ","upside"===e?`${t.median.toFixed(1)}%`:_(t.median)]}),s.jsxs("div",{children:["Std Dev: ","upside"===e?`${t.stdDev.toFixed(1)}%`:_(t.stdDev)]}),s.jsxs("div",{children:["Min: ","upside"===e?`${t.min.toFixed(1)}%`:_(t.min)]}),s.jsxs("div",{children:["Max: ","upside"===e?`${t.max.toFixed(1)}%`:_(t.max)]})]})]},e))}),s.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h4",{children:"ðŸ“Š Price Distribution"}),s.jsx(v,{width:"100%",height:300,children:s.jsxs(M,{data:H,children:[s.jsx(w,{strokeDasharray:"3 3"}),s.jsx(C,{dataKey:"bin",tickFormatter:_}),s.jsx(R,{}),s.jsx(S,{formatter:(e,s)=>[`${(100*e).toFixed(2)}%`,"Frequency"],labelFormatter:e=>`Price: ${_(e)}`}),s.jsx(F,{type:"monotone",dataKey:"frequency",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6})]})})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h4",{children:"ðŸŽ¯ Sensitivity Scatter Plot"}),s.jsx(v,{width:"100%",height:300,children:s.jsxs(D,{data:Y,children:[s.jsx(w,{strokeDasharray:"3 3"}),s.jsx(C,{dataKey:"x",name:"Revenue Growth Rate",tickFormatter:e=>`${e.toFixed(1)}%`}),s.jsx(R,{dataKey:"y",name:"Price per Share",tickFormatter:_}),s.jsx(S,{formatter:(e,s)=>["Revenue Growth Rate"===s?`${e.toFixed(2)}%`:_(e),s]}),s.jsx(P,{name:"Scenarios",fill:"#10B981",children:Y.map((e,t)=>s.jsx(V,{fill:e.upside>0?"#10B981":"#EF4444"},`cell-${t}`))})]})})]})]})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[s.jsx(n,{size:48,className:"text-gray-400 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Results Available"}),s.jsx("p",{className:"text-gray-400",children:"Run a simulation to see results here."})]})},"results"),"analysis"===r&&s.jsx(y.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:d?.analysis?s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"âš ï¸ Risk Metrics"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(d.analysis.riskMetrics).map(([e,t])=>s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[s.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"var95"===e?"Value at Risk (95%)":"cvar95"===e?"Conditional VaR (95%)":"probabilityOfLoss"===e?"Probability of Loss":"Sharpe Ratio"}),s.jsx("div",{className:"text-xl font-bold text-red-400 mb-1",children:"probabilityOfLoss"===e?`${(100*t).toFixed(1)}%`:_(t)}),s.jsx("div",{className:"text-xs text-gray-400",children:"Risk measure"})]},e))})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:["ðŸ“Š Confidence Intervals (",(100*d.analysis.confidenceIntervals.pricePerShare?.level).toFixed(0),"%)"]}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(d.analysis.confidenceIntervals).map(([e,t])=>s.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[s.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"pricePerShare"===e?"Price per Share":"enterpriseValue"===e?"Enterprise Value":"Upside %"}),s.jsxs("div",{className:"space-y-3",children:[s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-400",children:"Lower Bound:"}),s.jsx("span",{className:"font-medium text-white",children:"upside"===e?`${t.lowerBound.toFixed(1)}%`:_(t.lowerBound)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-400",children:"Upper Bound:"}),s.jsx("span",{className:"font-medium text-white",children:"upside"===e?`${t.upperBound.toFixed(1)}%`:_(t.upperBound)})]}),s.jsxs("div",{className:"flex justify-between items-center",children:[s.jsx("span",{className:"text-sm text-gray-400",children:"Width:"}),s.jsx("span",{className:"font-medium text-blue-400",children:"upside"===e?`${t.width.toFixed(1)}%`:_(t.width)})]})]})]},e))})]}),s.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[s.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"ðŸ“Š Percentile Analysis"}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-gray-600",children:[s.jsx("th",{className:"text-left p-3 text-sm font-medium text-gray-300",children:"Metric"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"5th %ile"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"25th %ile"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"50th %ile"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"75th %ile"}),s.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"95th %ile"})]})}),s.jsx("tbody",{children:Object.entries(d.analysis.percentiles).map(([e,t])=>s.jsxs("tr",{className:"border-b border-gray-600",children:[s.jsx("td",{className:"p-3 text-sm text-white",children:"pricePerShare"===e?"Price per Share":"enterpriseValue"===e?"Enterprise Value":"Upside %"}),s.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===e?`${t.p5.toFixed(1)}%`:_(t.p5)}),s.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===e?`${t.p25.toFixed(1)}%`:_(t.p25)}),s.jsx("td",{className:"p-3 text-sm text-right text-blue-400 font-medium",children:"upside"===e?`${t.p50.toFixed(1)}%`:_(t.p50)}),s.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===e?`${t.p75.toFixed(1)}%`:_(t.p75)}),s.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===e?`${t.p95.toFixed(1)}%`:_(t.p95)})]},e))})]})})]})]}):s.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[s.jsx(n,{size:48,className:"text-gray-400 mb-4"}),s.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Analysis Available"}),s.jsx("p",{className:"text-gray-400",children:"Run a simulation to see analysis here."})]})},"analysis")]})})]})};export{T as A,E,B as M,I as a};
//# sourceMappingURL=private-analysis-heavy-DbFWoyh2.js.map
