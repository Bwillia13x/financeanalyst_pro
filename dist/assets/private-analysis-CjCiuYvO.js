import{r as e,T as s,P as t,C as a,a as i,A as l,S as n,Z as r,b as o,j as c,c as d,E as m,d as x,G as u,U as h,e as g,D as b,f as p,g as f,h as y,X as v,i as j,k as N,L as w,I as C,M as k,l as S,m as F,n as M,o as A,B as R,p as I,q as E,F as P,s as D,t as T,u as V,R as O,v as q,w as B,x as L,y as z,z as _,H as $}from"./react-DbKEDq5F.js";import{m as G,A as W}from"./animations-DmEkbmfl.js";import{R as U,L as K,C as H,X as Y,Y as Q,T as X,a as J,B as Z,b as ee,P as se,c as te,d as ae,e as ie}from"./recharts-vendor-CMq9LHd_.js";import{a as le}from"./vendor-DYwn_Zoo.js";import{R as ne}from"./ui-components-DUPitwH-.js";import{A as re,M as oe}from"./private-analysis-heavy-DbFWoyh2.js";import{m as ce}from"./financial-engines-DJoNW2Bz.js";const de=new class{constructor(e={}){this.options={rules:{"color-contrast":{enabled:!0},"keyboard-navigation":{enabled:!0},"focus-management":{enabled:!0},"aria-labels":{enabled:!0},"heading-order":{enabled:!0},"landmark-one-main":{enabled:!0},"skip-link":{enabled:!0},"nested-interactive":{enabled:!1},...e.rules},tags:["wcag2a","wcag2aa","wcag21aa","best-practice"],runOnly:e.runOnly||null,reporter:e.reporter||"v2",...e},this.violations=[],this.lastTestResults=null}async runTests(e=document,s={}){const t={...this.options,...s};try{const s=await le.run(e,t);return this.lastTestResults=s,this.violations=s.violations,this.logResults(s),this.storeResults(s),s}catch(a){throw a}}async testFinancialComponent(e,s="generic"){const t=document.querySelector(e);if(!t)throw new Error(`Element not found: ${e}`);const a={spreadsheet:{rules:{"table-header":{enabled:!0},"th-has-data-cells":{enabled:!0},"table-duplicate-name":{enabled:!0},"scope-attr-valid":{enabled:!0}},tags:["wcag2aa","section508"]},chart:{rules:{"image-alt":{enabled:!0},"svg-img-alt":{enabled:!0},"aria-hidden-focus":{enabled:!0}},tags:["wcag2aa"]},calculator:{rules:{label:{enabled:!0},"form-field-multiple-labels":{enabled:!0},"duplicate-id":{enabled:!0}},tags:["wcag2aa","section508"]},modal:{rules:{"focus-trap":{enabled:!0},"aria-dialog-name":{enabled:!0},"keyboard-navigation":{enabled:!0}},tags:["wcag2aa","best-practice"]}}[s]||{};return await this.runTests(t,a)}async testKeyboardNavigation(){const e=this.getFocusableElements(),s=[];let t=-1;e.forEach((e,a)=>{const i=e.tabIndex||0;i>0&&i<=t&&s.push({element:e.tagName,id:e.id,tabIndex:i,position:a,issue:"Tab order not sequential"}),t=i});const a=[];return e.forEach(e=>{const s=window.getComputedStyle(e,":focus"),t="none"!==s.outline&&"0px"!==s.outline,i="none"!==s.boxShadow,l="transparent"!==s.backgroundColor;t||i||l||a.push({element:e.tagName,id:e.id,className:e.className,issue:"No visible focus indicator"})}),{focusableElementsCount:e.length,tabOrderIssues:s,focusVisibilityIssues:a,passed:0===s.length&&0===a.length}}async testColorContrast(){const e=document.querySelectorAll("p, span, div, td, th, label, button, a, h1, h2, h3, h4, h5, h6"),s=[];return e.forEach(e=>{const t=window.getComputedStyle(e),a=t.color,i=t.backgroundColor;if("transparent"===i||"rgba(0, 0, 0, 0)"===i)return;const l=this.calculateContrastRatio(a,i),n=parseInt(t.fontSize),r=t.fontWeight,o=n>=18||n>=14&&("bold"===r||r>=700)?3:4.5;l<o&&s.push({element:e.tagName,id:e.id,className:e.className,textColor:a,backgroundColor:i,contrast:l.toFixed(2),required:o,fontSize:n,fontWeight:r,text:e.textContent?.substring(0,50)+"..."})}),{totalElements:e.length,contrastIssues:s,passed:0===s.length}}async testFormAccessibility(){const e=document.querySelectorAll("form"),s=[];return e.forEach((e,t)=>{e.querySelectorAll("input, select, textarea").forEach(e=>{const a=[];this.hasAssociatedLabel(e)||a.push("Missing label"),e.required&&!this.hasRequiredIndication(e)&&a.push("Required field not clearly indicated"),"true"!==e.getAttribute("aria-invalid")||this.hasErrorMessage(e)||a.push("Error state without error message"),this.isFinancialInput(e)&&!e.autocomplete&&a.push("Financial input missing autocomplete attribute"),a.length>0&&s.push({formIndex:t,inputType:e.type,inputId:e.id,inputName:e.name,issues:a})})}),{totalForms:e.length,formIssues:s,passed:0===s.length}}generateReport(){if(!this.lastTestResults)throw new Error("No test results available. Run tests first.");const{violations:e,passes:s,incomplete:t,inapplicable:a}=this.lastTestResults;return{summary:{timestamp:(new Date).toISOString(),totalChecks:e.length+s.length+t.length+a.length,violations:e.length,passes:s.length,incomplete:t.length,inapplicable:a.length,score:this.calculateAccessibilityScore()},violations:e.map(e=>({id:e.id,impact:e.impact,description:e.description,help:e.help,helpUrl:e.helpUrl,nodes:e.nodes.length,tags:e.tags})),recommendations:this.generateRecommendations(e),financialSpecific:this.getFinancialAccessibilityInsights()}}calculateAccessibilityScore(){if(!this.lastTestResults)return 0;const{violations:e,passes:s}=this.lastTestResults,t=e.length+s.length;if(0===t)return 100;const a={critical:4,serious:3,moderate:2,minor:1},i=e.reduce((e,s)=>e+(a[s.impact]||1),0),l=4*t;return Math.max(0,100-i/l*100)}generateRecommendations(e){const s=[];return e.forEach(e=>{switch(e.id){case"color-contrast":s.push({category:"Visual Design",priority:"High",issue:"Insufficient color contrast",solution:"Ensure text colors meet WCAG AA standards (4.5:1 for normal text, 3:1 for large text)",financialContext:"Critical for reading financial data and avoiding misinterpretation of numbers"});break;case"keyboard-navigation":s.push({category:"Keyboard Access",priority:"High",issue:"Keyboard navigation issues",solution:"Ensure all interactive elements are keyboard accessible with visible focus indicators",financialContext:"Essential for users who rely on keyboard navigation to access financial tools"});break;case"label":s.push({category:"Form Controls",priority:"High",issue:"Missing form labels",solution:"Add proper labels to all form controls, especially financial input fields",financialContext:"Critical for screen readers to understand financial input requirements"});break;case"aria-hidden-focus":s.push({category:"ARIA Usage",priority:"Medium",issue:"Focusable elements hidden from screen readers",solution:"Review aria-hidden usage on interactive elements",financialContext:"May hide important financial controls from assistive technology users"})}}),s}getFinancialAccessibilityInsights(){const e=[];return document.querySelectorAll("table").length>0&&e.push({component:"Data Tables",recommendation:"Ensure financial data tables have proper headers and scope attributes for screen reader navigation"}),document.querySelectorAll("[data-chart], .recharts-wrapper, canvas").length>0&&e.push({component:"Charts and Graphs",recommendation:"Provide alternative text descriptions and data tables for financial charts"}),document.querySelectorAll("[data-calculator], .calculator").length>0&&e.push({component:"Financial Calculators",recommendation:"Ensure calculator inputs have clear labels and results are announced to screen readers"}),e}getFocusableElements(){return Array.from(document.querySelectorAll(["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",")))}hasAssociatedLabel(e){const s=e.id,t=e.getAttribute("aria-label"),a=e.getAttribute("aria-labelledby");return!!(t||a||s&&document.querySelector(`label[for="${s}"]`)||e.closest("label"))}hasRequiredIndication(e){const s=e.getAttribute("aria-required"),t=e.hasAttribute("required"),a=this.hasRequiredTextIndicator(e);return"true"===s||t||a}hasRequiredTextIndicator(e){const s=this.getAssociatedLabel(e);if(!s)return!1;const t=s.textContent||"";return t.includes("*")||t.toLowerCase().includes("required")}hasErrorMessage(e){const s=e.getAttribute("aria-describedby");if(s){const e=document.getElementById(s);return e&&e.textContent}return!1}isFinancialInput(e){return["number","email","tel"].includes(e.type)||["amount","price","rate","percent","currency","value"].some(s=>e.name?.toLowerCase().includes(s))}getAssociatedLabel(e){const s=e.id;if(s){const e=document.querySelector(`label[for="${s}"]`);if(e)return e}return e.closest("label")}calculateContrastRatio(e,s){const t=this.parseColor(e),a=this.parseColor(s),i=this.getLuminance(t),l=this.getLuminance(a);return(Math.max(i,l)+.05)/(Math.min(i,l)+.05)}parseColor(e){const s=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return s?[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])]:[0,0,0]}getLuminance([e,s,t]){const[a,i,l]=[e,s,t].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*a+.7152*i+.0722*l}logResults(e){e.violations.length>0&&e.violations.forEach(e=>{})}reportViolations(e){e.forEach(e=>{e.nodes.forEach(e=>{})})}storeResults(e){try{const s={timestamp:Date.now(),url:window.location.href,violations:e.violations.length,passes:e.passes.length,score:this.calculateAccessibilityScore()},t=JSON.parse(localStorage.getItem("accessibility-reports")||"[]");t.push(s),t.length>10&&t.splice(0,t.length-10),localStorage.setItem("accessibility-reports",JSON.stringify(t))}catch(s){}}},me={CLS:null,FID:null,FCP:null,LCP:null,TTFB:null,INP:null};function xe(){!function(){let e=0;const s=[];new PerformanceObserver(t=>{for(const a of t.getEntries())a.hadRecentInput||(e+=a.value,s.push(a));me.CLS=e,ue("CLS",e,s)}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(e=>{for(const s of e.getEntries())if("first-input-delay"===s.name&&(me.FID=s.processingStart-s.startTime,ue("FID",me.FID,[s])),s.interactionId){const e=s.processingEnd-s.startTime;(!me.INP||e>me.INP)&&(me.INP=e,ue("INP",e,[s]))}}).observe({type:"event",buffered:!0}),new PerformanceObserver(e=>{for(const s of e.getEntries())"first-contentful-paint"===s.name&&(me.FCP=s.startTime,ue("FCP",s.startTime,[s]))}).observe({type:"paint",buffered:!0}),new PerformanceObserver(e=>{const s=e.getEntries(),t=s[s.length-1];me.LCP=t.startTime,ue("LCP",t.startTime,[t])}).observe({type:"largest-contentful-paint",buffered:!0});const t=performance.getEntriesByType("navigation")[0];t&&(me.TTFB=t.responseStart-t.requestStart,ue("TTFB",me.TTFB,[t]))}(),["financial-spreadsheet","dcf-calculator","chart-rendering","market-data-fetch"].forEach(e=>{performance.mark(`${e}-start`)}),window.trackComponentRender=(e,s)=>{performance.mark(`${e}-end`),performance.measure(`${e}-render`,`${e}-start`,`${e}-end`),he("component-render",{component:e,renderTime:s,timestamp:Date.now()})},window.trackCalculationPerformance=(e,s,t)=>{he("financial-calculation",{type:e,duration:s,complexity:t,timestamp:Date.now()})},window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];var s;e&&(s={dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,ssl:e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,ttfb:e.responseStart-e.requestStart,download:e.responseEnd-e.responseStart,domProcessing:e.domComplete-e.domLoading,totalLoadTime:e.loadEventEnd-e.fetchStart},fe("navigation-timing",{...s,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:pe()}))},0)}),new PerformanceObserver(e=>{for(const s of e.getEntries())if("script"===s.initiatorType||"css"===s.initiatorType||"img"===s.initiatorType||"fetch"===s.initiatorType){const e={name:s.name,type:s.initiatorType,size:s.transferSize||s.encodedBodySize,duration:s.duration,cached:0===s.transferSize&&s.encodedBodySize>0,timestamp:Date.now()};(e.size>5e4||e.duration>1e3)&&ge(e)}}).observe({entryTypes:["resource"]}),function(){let e=0,s=0;["click","keydown","touchstart"].forEach(t=>{document.addEventListener(t,a=>{const i=performance.now();requestAnimationFrame(()=>{const l=performance.now()-i;e++,s+=l,l>100&&fe("slow-interaction",{type:t,target:a.target.tagName,duration:l,timestamp:Date.now()})})},{passive:!0})}),setInterval(()=>{e>0&&(fe("interaction-summary",{count:e,averageTime:s/e,timestamp:Date.now()}),e=0,s=0)},3e4)}()}function ue(e,s,t){fe("web-vital",{metric:e,value:Math.round(s),entries:t.map(e=>({startTime:e.startTime,duration:e.duration||0})),url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:pe()})}function he(e,s){fe("custom-metric",{type:e,...s,url:window.location.href,userAgent:navigator.userAgent})}function ge(e){fe("resource-timing",e)}function be(){const e=[];return Object.entries({LCP:2500,FID:100,CLS:.1,FCP:1800,TTFB:800}).forEach(([s,t])=>{const a=me[s];null!==a&&a>t&&e.push({metric:s,value:a,budget:t,overBy:a-t})}),e.length>0&&fe("budget-violations",{violations:e,timestamp:Date.now(),url:window.location.href}),e}function pe(){return"connection"in navigator?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt}:null}function fe(e,s){try{const t={type:e,data:s,sessionId:ve(),userId:je()},a=JSON.parse(localStorage.getItem("analytics-queue")||"[]");a.push(t),a.length>100&&a.splice(0,a.length-100),localStorage.setItem("analytics-queue",JSON.stringify(a)),a.length>=10&&ye()}catch(t){}}function ye(){try{const e=JSON.parse(localStorage.getItem("analytics-queue")||"[]");if(0===e.length)return;window.gtag&&e.forEach(e=>{window.gtag("event",e.type,{custom_parameter:JSON.stringify(e.data)})}),localStorage.removeItem("analytics-queue")}catch(e){}}function ve(){let e=sessionStorage.getItem("session-id");return e||(e=Date.now()+"-"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("session-id",e)),e}function je(){let e=localStorage.getItem("user-id");return e||(e="anonymous-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),localStorage.setItem("user-id",e)),e}function Ne(e,s){fe("performance-metric",{type:e,...s,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()})}function we(){const e=JSON.parse(localStorage.getItem("accessibility-history")||"[]"),s=JSON.parse(localStorage.getItem("analytics-queue")||"[]"),t=e.slice(-10),a=t.reduce((e,s)=>e+s.score,0)/t.length||0,i=t.reduce((e,s)=>e+s.violations,0)/t.length||0,l=s.filter(e=>"performance-metric"===e.type).slice(-20).map(e=>e.data),n=s.filter(e=>"web-vital"===e.type).slice(-10).map(e=>e.data);return{webVitals:me,budgetViolations:be(),accessibility:{currentScore:t[t.length-1]?.score||0,averageScore:Math.round(a),averageViolations:Math.round(i),history:t,trends:{scoreImproving:t.length>=2&&t[t.length-1].score>t[t.length-2].score}},performance:{recentMetrics:l,webVitalHistory:n},timestamp:Date.now()}}function Ce(s){const t=function(s={}){const{enabled:t=!1,autoTest:a=!1,testInterval:i=null,componentType:l="generic",onViolations:n=null,onSuccess:r=null}=s,[o,c]=e.useState(null),[d,m]=e.useState(!1),[x,u]=e.useState([]),[h,g]=e.useState(null),[b,p]=e.useState(null),f=e.useRef(null),y=e.useRef(null),v=e.useCallback(async(e=null,s={})=>{if(!t)return null;const a=e||f.current||document;m(!0);try{const e=await de.runTests(a,s);return c(e),u(e.violations||[]),g(de.calculateAccessibilityScore()),p(Date.now()),Ne("accessibility_test",{violations:e.violations?.length||0,score:de.calculateAccessibilityScore(),componentType:l,timestamp:Date.now()}),e.violations?.length>0?n?.(e.violations):r?.(e),e}catch(i){return null}finally{m(!1)}},[t,l,n,r]),j=e.useCallback(async(e,s=l)=>{if(!t)return null;m(!0);try{const t=await de.testFinancialComponent(e,s);return c(t),u(t.violations||[]),g(de.calculateAccessibilityScore()),p(Date.now()),Ne("financial_component_accessibility",{componentType:s,violations:t.violations?.length||0,score:de.calculateAccessibilityScore(),timestamp:Date.now()}),t}catch(a){return null}finally{m(!1)}},[t,l]),N=e.useCallback(async()=>{if(!t)return null;try{const e=await de.testKeyboardNavigation();return Ne("keyboard_navigation_test",{focusableElements:e.focusableElementsCount,tabOrderIssues:e.tabOrderIssues?.length||0,focusVisibilityIssues:e.focusVisibilityIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),w=e.useCallback(async()=>{if(!t)return null;try{const e=await de.testColorContrast();return Ne("color_contrast_test",{totalElements:e.totalElements,contrastIssues:e.contrastIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),C=e.useCallback(async()=>{if(!t)return null;try{const e=await de.testFormAccessibility();return Ne("form_accessibility_test",{totalForms:e.totalForms,formIssues:e.formIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),k=e.useCallback(()=>{if(!o)return null;try{const e=de.generateReport();return Ne("accessibility_report_generated",{score:e.summary.score,violations:e.summary.violations,totalChecks:e.summary.totalChecks,timestamp:Date.now()}),e}catch(e){return null}},[o]);return e.useEffect(()=>{if(!t||!a)return;const e=()=>{v()};return e(),i&&(y.current=setInterval(e,i)),()=>{y.current&&clearInterval(y.current)}},[t,a,i,v]),e.useEffect(()=>()=>{y.current&&clearInterval(y.current)},[]),{results:o,violations:x,score:h,isLoading:d,lastTestTime:b,runTests:v,testFinancialComponent:j,testKeyboardNavigation:N,testColorContrast:w,testFormAccessibility:C,generateReport:k,elementRef:f}}({componentType:s,autoTest:!0,testInterval:3e4,onViolations:e=>{}}),a=e.useCallback(async()=>{const e={};try{return e.keyboardNav=await t.testKeyboardNavigation(),e.colorContrast=await t.testColorContrast(),e.formAccessibility=await t.testFormAccessibility(),e.report=t.generateReport(),e}catch(s){return null}},[t,s]);return{...t,testFinancialFeatures:a}}function ke(s={}){const{threshold:t=80,alertOnViolations:a=!0,monitorInterval:i=6e4}=s,[l,n]=e.useState(!1),[r,o]=e.useState([]),c=e.useRef(null),d=e.useCallback(()=>{if(l)return;n(!0);const e=async()=>{try{const e=await de.runTests(document),s=de.calculateAccessibilityScore();if(s<t){const a={id:Date.now(),type:"low_score",message:`Accessibility score (${s}) is below threshold (${t})`,score:s,violations:e.violations?.length||0,timestamp:Date.now()};o(e=>[...e,a])}const i=e.violations?.filter(e=>"critical"===e.impact)||[];if(i.length>0&&a){const e={id:Date.now(),type:"critical_violations",message:`${i.length} critical accessibility violations found`,violations:i,timestamp:Date.now()};o(s=>[...s,e])}Ne("accessibility_monitoring",{score:s,violations:e.violations?.length||0,criticalViolations:i.length,timestamp:Date.now()})}catch(e){}};e(),c.current=setInterval(e,i)},[l,t,a,i]),m=e.useCallback(()=>{n(!1),c.current&&(clearInterval(c.current),c.current=null)},[]),x=e.useCallback(()=>{o([])},[]);return e.useEffect(()=>()=>{c.current&&clearInterval(c.current)},[]),{isMonitoring:l,alerts:r,startMonitoring:d,stopMonitoring:m,clearAlerts:x}}setInterval(ye,6e4),window.addEventListener("beforeunload",()=>{ye()});const Se=Object.freeze(Object.defineProperty({__proto__:null,default:({data:v,adjustedValues:j,modelInputs:N,calculateDCF:w,formatCurrency:C,formatPercentage:k})=>{const S=e.useMemo(()=>{try{if(!v?.statements?.incomeStatement)return null;const c=v.statements.incomeStatement,d=Object.keys(c.totalRevenue||{}).sort((e,s)=>parseInt(e)-parseInt(s));if(d.length<2)return null;const m=d[d.length-1],x=d[d.length-2],u=d[0],h=j?.totalRevenue||c.totalRevenue?.[m]||0,g=c.totalRevenue?.[x]||0,b=c.totalRevenue?.[u]||0,p=j?.grossProfit||c.grossProfit?.[m]||0,f=c.grossProfit?.[x]||0,y=j?.operatingIncome||c.operatingIncome?.[m]||0,N=c.operatingIncome?.[x]||0,k=g?(h-g)/g*100:0,S=b&&d.length>2?100*(Math.pow(h/b,1/(d.length-1))-1):0,F=N?(y-N)/N*100:0,M=h&&0!==h?p/h*100:0,A=g&&0!==g?f/g*100:0,R=h&&0!==h?y/h*100:0,I=g&&0!==g?N/g*100:0,E=isFinite(M)&&isFinite(A)?M-A:0,P=isFinite(R)&&isFinite(I)?R-I:0;let D=null;if(w)try{D=w(v)}catch(e){}const T=[{name:"Energy Devices",value:Number(c.energyDevices?.[m])||0},{name:"Injectables",value:Number(c.injectables?.[m])||0},{name:"Wellness",value:Number(c.wellness?.[m])||0},{name:"Weightloss",value:Number(c.weightloss?.[m])||0},{name:"Retail Sales",value:Number(c.retailSales?.[m])||0},{name:"Surgery",value:Number(c.surgery?.[m])||0}].filter(e=>e.value>0&&isFinite(e.value)),V=c.totalAssets?.[m]||1.2*h,O=c.totalEquity?.[m]||.6*V,q=c.totalDebt?.[m]||.3*V,B=c.currentAssets?.[m]||.4*V,L=c.currentLiabilities?.[m]||.2*V,z=c.inventory?.[m]||.15*h,_=c.accountsReceivable?.[m]||.1*h,$=c.cashAndEquivalents?.[m]||.1*V,G=V&&0!==V?y/V*100:0,W=O&&0!==O?y/O*100:0,U=O&&0!==O?q/O:0,K=L&&0!==L?B/L:0,H=L&&0!==L?(B-z)/L:0,Y=V&&0!==V?h/V:0,Q=z&&0!==z?.7*h/z:0,X=_&&0!==_?h/_:0,J=L&&0!==L?$/L:0,Z=B-L,ee=h&&0!==h?Z/h:0,se=Q>0&&X>0?365/Q+365/X:0,te=se>0?se-30:0,ae=0!==f?F/k:0,ie=100*(R-I),le=O&&0!==O?V/O:0,ne=c.interestExpense?.[m]?y/c.interestExpense[m]:0,re=c.debtService?.[m]?y/c.debtService[m]:0,oe=c.employeeCount?.[m]?h/c.employeeCount[m]:0,ce=c.sharesOutstanding?.[m]?h/c.sharesOutstanding[m]:0,de=c.sharesOutstanding?.[m]&&O?O/c.sharesOutstanding[m]:0,me={grossMargin:65,operatingMargin:18,returnOnAssets:8,returnOnEquity:15,currentRatio:2.5,debtToEquity:.4,assetTurnover:.8,revenueGrowth:8},xe={grossMargin:M-me.grossMargin,operatingMargin:R-me.operatingMargin,returnOnAssets:G-me.returnOnAssets,returnOnEquity:W-me.returnOnEquity,currentRatio:K-me.currentRatio,debtToEquity:me.debtToEquity-U,assetTurnover:Y-me.assetTurnover,revenueGrowth:k-me.revenueGrowth},ue=[{title:"Revenue Growth",value:`${k>0?"+":""}${isFinite(k)?k.toFixed(1):"0.0"}%`,trend:k>0?"up":"down",description:"Year-over-year revenue growth rate",icon:s,benchmark:me.revenueGrowth,performance:xe.revenueGrowth},{title:"Gross Margin",value:`${isFinite(M)?M.toFixed(1):"0.0"}%`,trend:E>0?"up":"down",description:`${E>0?"+":""}${isFinite(E)?E.toFixed(1):"0.0"}% vs prior year`,icon:t,benchmark:me.grossMargin,performance:xe.grossMargin},{title:"Operating Margin",value:`${isFinite(R)?R.toFixed(1):"0.0"}%`,trend:P>0?"up":"down",description:`${P>0?"+":""}${isFinite(P)?P.toFixed(1):"0.0"}% vs prior year`,icon:a,benchmark:me.operatingMargin,performance:xe.operatingMargin},{title:"Return on Assets",value:`${isFinite(G)?G.toFixed(1):"0.0"}%`,trend:G>me.returnOnAssets?"up":"down",description:"Asset utilization efficiency",icon:i,benchmark:me.returnOnAssets,performance:xe.returnOnAssets},{title:"Return on Equity",value:`${isFinite(W)?W.toFixed(1):"0.0"}%`,trend:W>me.returnOnEquity?"up":"down",description:"Shareholder value generation",icon:l,benchmark:me.returnOnEquity,performance:xe.returnOnEquity},{title:"Current Ratio",value:`${isFinite(K)?K.toFixed(1):"0.0"}x`,trend:K>2?"up":K>1.5?"neutral":"down",description:"Short-term liquidity strength",icon:n,benchmark:me.currentRatio,performance:xe.currentRatio},{title:"Asset Turnover",value:`${isFinite(Y)?Y.toFixed(1):"0.0"}x`,trend:Y>me.assetTurnover?"up":"down",description:"Revenue per dollar of assets",icon:r,benchmark:me.assetTurnover,performance:xe.assetTurnover},{title:"Debt-to-Equity",value:`${isFinite(U)?U.toFixed(1):"0.0"}x`,trend:U<me.debtToEquity?"up":"down",description:"Financial leverage position",icon:o,benchmark:me.debtToEquity,performance:xe.debtToEquity}],he=[{name:"Current Ratio",value:K,formatted:`${K.toFixed(2)}x`,benchmark:2.5,status:K>=2.5?"excellent":K>=2?"good":K>=1.5?"fair":"poor"},{name:"Quick Ratio",value:H,formatted:`${H.toFixed(2)}x`,benchmark:1.5,status:H>=1.5?"excellent":H>=1?"good":H>=.8?"fair":"poor"},{name:"Cash Ratio",value:J,formatted:`${J.toFixed(2)}x`,benchmark:.5,status:J>=.5?"excellent":J>=.3?"good":J>=.2?"fair":"poor"},{name:"Working Capital",value:Z,formatted:C(Z),benchmark:.15*h,status:Z>=.15*h?"excellent":Z>=0?"good":"poor"}],ge=[{name:"Asset Turnover",value:Y,formatted:`${Y.toFixed(2)}x`,description:"Revenue generation per asset dollar"},{name:"Inventory Turnover",value:Q,formatted:`${Q.toFixed(1)}x`,description:"Inventory management efficiency"},{name:"Receivables Turnover",value:X,formatted:`${X.toFixed(1)}x`,description:"Collection efficiency"},{name:"Operating Cycle",value:se,formatted:`${se.toFixed(0)} days`,description:"Cash-to-cash cycle duration"}],be=[{name:"Financial Leverage",value:le,formatted:`${le.toFixed(1)}x`,level:le<2?"low":le<3?"moderate":"high"},{name:"Debt-to-Equity",value:U,formatted:`${U.toFixed(2)}x`,level:U<.3?"low":U<.6?"moderate":"high"},{name:"Interest Coverage",value:ne,formatted:`${ne.toFixed(1)}x`,level:ne>10?"low":ne>5?"moderate":"high"}];return{periods:d,latest:m,previous:x,revenue:{latest:h,previous:g,growth:k,cagr:S},profitability:{grossMargin:M,grossMarginChange:E,operatingMargin:R,operatingMarginChange:P,operatingLeverage:ae,profitabilityTrend:ie},financial:{returnOnAssets:G,returnOnEquity:W,assetTurnover:Y,totalAssets:V,totalEquity:O,totalDebt:q,workingCapital:Z,workingCapitalRatio:ee},liquidity:{currentRatio:K,quickRatio:H,cashRatio:J,cashAndEquivalents:$,currentAssets:B,currentLiabilities:L},efficiency:{inventoryTurnover:Q,receivablesTurnover:X,operatingCycle:se,cashConversionCycle:te},risk:{debtToEquity:U,financialLeverage:le,interestCoverage:ne,debtServiceCoverage:re},market:{revenuePerEmployee:oe,revenuePerShare:ce,bookValuePerShare:de},benchmarks:{industry:me,comparison:xe},dcf:D,revenueBreakdown:T,kpis:ue,liquidityMetrics:he,efficiencyMetrics:ge,riskMetrics:be}}catch(e){return null}},[v,w]);if(!S)return c.jsx("div",{className:"flex items-center justify-center h-64",children:c.jsxs("div",{className:"text-center",children:[c.jsx(d,{className:"mx-auto h-12 w-12 text-yellow-400 mb-4"}),c.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Insufficient Data"}),c.jsx("p",{className:"text-gray-500",children:"Please ensure financial data is loaded to generate analysis results."})]})});const F=({title:e,value:t,trend:a,description:i,icon:l,benchmark:n,performance:r})=>c.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-gray-600 transition-all duration-200",children:[c.jsxs("div",{className:"flex items-start justify-between mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsx("div",{className:"p-2 rounded-lg "+("up"===a?"bg-green-900/30 text-green-400":"down"===a?"bg-red-900/30 text-red-400":"bg-gray-700 text-gray-400"),children:c.jsx(l,{className:"h-5 w-5"})}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-gray-300",children:e}),c.jsx("div",{className:"text-xs text-gray-500 mt-1",children:i})]})]}),"up"===a&&c.jsx(s,{className:"h-5 w-5 text-green-400 flex-shrink-0"}),"down"===a&&c.jsx(y,{className:"h-5 w-5 text-red-400 flex-shrink-0"})]}),c.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:t}),n&&c.jsxs("div",{className:"border-t border-gray-700 pt-3 mt-3",children:[c.jsxs("div",{className:"flex justify-between text-xs",children:[c.jsx("span",{className:"text-gray-400",children:"Industry Avg:"}),c.jsx("span",{className:"text-gray-300",children:"number"==typeof n?n.toFixed(1)+(e.includes("%")?"%":e.includes("x")?"x":""):n})]}),c.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[c.jsx("span",{className:"text-gray-400",children:"vs Industry:"}),c.jsxs("span",{className:"font-medium "+(r>0?"text-green-400":r<0?"text-red-400":"text-gray-300"),children:[r>0?"+":"",r?.toFixed(1)||"0.0"]})]})]})]});return c.jsxs("div",{className:"space-y-6 p-6 bg-gray-900 text-white h-full",children:[c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center",children:[c.jsx(a,{className:"h-6 w-6 text-blue-400 mr-3"}),"Financial Analysis Results"]}),c.jsx("p",{className:"text-gray-400",children:"Comprehensive analysis of your company's financial performance and valuation"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:S.kpis.map((e,s)=>c.jsx(F,{...e},s))}),c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[c.jsxs("div",{className:"flex border-b border-gray-700",children:[c.jsx("button",{className:"px-6 py-3 text-sm font-medium text-white bg-blue-600 border-r border-gray-700",children:"Liquidity Analysis"}),c.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Efficiency Metrics"}),c.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Risk Assessment"}),c.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white",children:"Benchmarking"})]}),c.jsxs("div",{className:"p-6",children:[c.jsxs("div",{className:"flex items-center mb-4",children:[c.jsx(n,{className:"h-5 w-5 text-blue-400 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Liquidity Position Analysis"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:S.liquidityMetrics.map((e,s)=>c.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-200",children:e.name}),c.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("excellent"===e.status?"bg-green-900/30 text-green-400":"good"===e.status?"bg-blue-900/30 text-blue-400":"fair"===e.status?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:e.status})]}),c.jsx("div",{className:"text-xl font-bold text-white mb-1",children:e.formatted}),c.jsxs("div",{className:"text-xs text-gray-400",children:["Benchmark: ","number"==typeof e.benchmark?e.benchmark.toFixed(1)+"x":C(e.benchmark)]})]},s))}),c.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[c.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[c.jsx(m,{className:"h-4 w-4 text-blue-400 mr-2"}),"Liquidity Analysis Summary"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Working Capital:"}),c.jsx("span",{className:"text-white ml-2 font-medium",children:C(S.financial.workingCapital)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Cash Position:"}),c.jsx("span",{className:"text-white ml-2 font-medium",children:C(S.liquidity.cashAndEquivalents)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Current Assets:"}),c.jsx("span",{className:"text-white ml-2 font-medium",children:C(S.liquidity.currentAssets)})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Current Liabilities:"}),c.jsx("span",{className:"text-white ml-2 font-medium",children:C(S.liquidity.currentLiabilities)})]})]})]})]})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx(r,{className:"h-5 w-5 text-orange-400 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Operational Efficiency Metrics"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:S.efficiencyMetrics.map((e,s)=>c.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[c.jsx("div",{className:"text-sm font-medium text-gray-200 mb-2",children:e.name}),c.jsx("div",{className:"text-xl font-bold text-white mb-1",children:e.formatted}),c.jsx("div",{className:"text-xs text-gray-400",children:e.description})]},s))}),c.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(x,{className:"h-4 w-4 text-orange-400 mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Cash Conversion"})]}),c.jsxs("div",{className:"text-lg font-bold text-white",children:[S.efficiency.cashConversionCycle.toFixed(0)," days"]}),c.jsx("div",{className:"text-xs text-gray-400",children:"Time to convert inventory to cash"})]}),c.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(u,{className:"h-4 w-4 text-orange-400 mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Asset Productivity"})]}),c.jsxs("div",{className:"text-lg font-bold text-white",children:[S.financial.assetTurnover.toFixed(2),"x"]}),c.jsx("div",{className:"text-xs text-gray-400",children:"Revenue per dollar of assets"})]}),c.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(h,{className:"h-4 w-4 text-orange-400 mr-2"}),c.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Revenue/Employee"})]}),c.jsx("div",{className:"text-lg font-bold text-white",children:S.market.revenuePerEmployee>0?C(S.market.revenuePerEmployee):"N/A"}),c.jsx("div",{className:"text-xs text-gray-400",children:"Productivity per employee"})]})]})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("div",{className:"flex items-center mb-6",children:[c.jsx(d,{className:"h-5 w-5 text-red-400 mr-2"}),c.jsx("h3",{className:"text-lg font-semibold text-white",children:"Financial Risk Assessment"})]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:S.riskMetrics.map((e,s)=>c.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-200",children:e.name}),c.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium "+("low"===e.level?"bg-green-900/30 text-green-400":"moderate"===e.level?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:[e.level," risk"]})]}),c.jsx("div",{className:"text-xl font-bold text-white",children:e.formatted})]},s))}),c.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[c.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[c.jsx(n,{className:"h-4 w-4 text-red-400 mr-2"}),"Risk Analysis Summary"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Financial Leverage:"}),c.jsxs("span",{className:"ml-2 font-medium "+(S.risk.financialLeverage<2?"text-green-400":S.risk.financialLeverage<3?"text-yellow-400":"text-red-400"),children:[S.risk.financialLeverage.toFixed(1),"x"]})]}),c.jsxs("div",{children:[c.jsx("span",{className:"text-gray-400",children:"Interest Coverage:"}),c.jsxs("span",{className:"ml-2 font-medium "+(S.risk.interestCoverage>10?"text-green-400":S.risk.interestCoverage>5?"text-yellow-400":"text-red-400"),children:[S.risk.interestCoverage.toFixed(1),"x"]})]})]})]})]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[c.jsx(g,{className:"h-5 w-5 text-purple-400 mr-2"}),"Performance Trends"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Revenue Analysis"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"Latest Period:"}),c.jsx("span",{className:"font-semibold text-white",children:C(S.revenue.latest)})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"YoY Growth:"}),c.jsxs("span",{className:"font-semibold "+(S.revenue.growth>0?"text-green-400":"text-red-400"),children:[S.revenue.growth>0?"+":"",S.revenue.growth.toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"CAGR:"}),c.jsxs("span",{className:"font-semibold text-gray-200",children:[S.revenue.cagr.toFixed(1),"%"]})]})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Profitability Margins"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"Gross Margin:"}),c.jsxs("span",{className:"font-semibold text-white",children:[S.profitability.grossMargin.toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"Operating Margin:"}),c.jsxs("span",{className:"font-semibold text-white",children:[S.profitability.operatingMargin.toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-sm text-gray-400",children:"Margin Change:"}),c.jsxs("span",{className:"font-semibold "+(S.profitability.grossMarginChange>0?"text-green-400":"text-red-400"),children:[S.profitability.grossMarginChange>0?"+":"",S.profitability.grossMarginChange.toFixed(1),"pp"]})]})]})]})]})]}),S.dcf&&c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[c.jsx(b,{className:"h-5 w-5 text-green-400 mr-2"}),"DCF Valuation Summary"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"text-center p-4 bg-green-900/30 border border-green-700 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-green-400",children:C(S.dcf.enterpriseValue)}),c.jsx("div",{className:"text-sm text-green-300",children:"Enterprise Value"})]}),c.jsxs("div",{className:"text-center p-4 bg-blue-900/30 border border-blue-700 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-400",children:C(S.dcf.sharePrice)}),c.jsx("div",{className:"text-sm text-blue-300",children:"Price per Share"})]}),c.jsxs("div",{className:"text-center p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-300",children:C(S.dcf.terminalValue)}),c.jsx("div",{className:"text-sm text-gray-400",children:"Terminal Value"})]})]})]})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[c.jsx(p,{className:"h-5 w-5 text-orange-400 mr-2"}),"Business Unit Performance"]}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.revenueBreakdown.map((e,s)=>{const t=S.revenue.latest?e.value/S.revenue.latest*100:0;return c.jsxs("div",{className:"p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-medium text-gray-200",children:e.name}),c.jsxs("span",{className:"text-sm text-gray-400",children:[t.toFixed(1),"%"]})]}),c.jsx("div",{className:"text-lg font-semibold text-white mb-1",children:C(e.value)}),c.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min(t,100)}%`}})})]},s)})})]}),c.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[c.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[c.jsx(f,{className:"h-5 w-5 text-green-400 mr-2"}),"Key Financial Insights"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Strengths"}),c.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[S.revenue.growth>0&&c.jsxs("li",{className:"flex items-center",children:[c.jsx(f,{className:"h-4 w-4 text-green-500 mr-2"}),"Positive revenue growth trajectory"]}),S.profitability.grossMargin>60&&c.jsxs("li",{className:"flex items-center",children:[c.jsx(f,{className:"h-4 w-4 text-green-500 mr-2"}),"Strong gross margin above 60%"]}),S.profitability.grossMarginChange>0&&c.jsxs("li",{className:"flex items-center",children:[c.jsx(f,{className:"h-4 w-4 text-green-500 mr-2"}),"Improving profitability margins"]}),c.jsxs("li",{className:"flex items-center",children:[c.jsx(f,{className:"h-4 w-4 text-green-500 mr-2"}),"Diversified healthcare revenue streams"]})]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Areas for Focus"}),c.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[S.revenue.growth<5&&c.jsxs("li",{className:"flex items-center",children:[c.jsx(d,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Revenue growth below industry benchmarks"]}),S.profitability.operatingMargin<20&&c.jsxs("li",{className:"flex items-center",children:[c.jsx(d,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Operating margin optimization opportunities"]}),c.jsxs("li",{className:"flex items-center",children:[c.jsx(d,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Monitor competitive positioning in key segments"]}),c.jsxs("li",{className:"flex items-center",children:[c.jsx(d,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Consider strategic initiatives for growth acceleration"]})]})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),Fe=Object.freeze(Object.defineProperty({__proto__:null,default:({financialData:t,currentMetric:l,analysisContext:n="general",onInsightClick:r,isVisible:o=!0,onToggle:m})=>{const[x,u]=e.useState({assumptions:!0,benchmarks:!0,insights:!0,suggestions:!1});e.useMemo(()=>({healthcare:{revenueGrowth:{min:8,median:15,max:25,unit:"%"},ebitdaMargin:{min:18,median:28,max:40,unit:"%"},grossMargin:{min:65,median:75,max:85,unit:"%"},roe:{min:12,median:18,max:25,unit:"%"}},technology:{revenueGrowth:{min:15,median:25,max:50,unit:"%"},ebitdaMargin:{min:20,median:35,max:50,unit:"%"},grossMargin:{min:70,median:80,max:90,unit:"%"},roe:{min:15,median:22,max:35,unit:"%"}},manufacturing:{revenueGrowth:{min:3,median:8,max:15,unit:"%"},ebitdaMargin:{min:10,median:18,max:25,unit:"%"},grossMargin:{min:25,median:35,max:45,unit:"%"},roe:{min:8,median:15,max:22,unit:"%"}}}),[]);const g=(()=>{const e=[];if(!t?.statements?.incomeStatement)return[{type:"info",title:"Getting Started",content:"Import financial data to see contextual insights and benchmarks.",action:"Import Data"}];const s=t.statements.incomeStatement,a=s.totalRevenue?.[2]||0,i=s.operatingIncome?.[2]||0;if(a>0){const s=i/a*100;e.push({type:"benchmark",title:"Operating Margin Analysis",content:`Current operating margin of ${s.toFixed(1)}% compares to healthcare industry median of 28%.`,metric:s,benchmark:28,status:s>=28?"above":s>=20?"within":"below"})}return"dcf"===n&&e.push({type:"assumption",title:"DCF Model Assumptions",content:"Consider industry-specific discount rates and terminal growth assumptions.",suggestions:["Healthcare companies typically use 8-12% WACC","Terminal growth rates should reflect long-term GDP growth (2-3%)","Consider regulatory risks in discount rate adjustments"]}),l?.includes("revenue")&&e.push({type:"insight",title:"Revenue Growth Drivers",content:"Analyze revenue composition and growth sustainability.",suggestions:["Break down revenue by service line","Assess recurring vs. one-time revenue","Evaluate market expansion opportunities"]}),e})(),b=e=>{u(s=>({...s,[e]:!s[e]}))},p=(e,s,t,a)=>{const i=a-t,l=Math.max(0,Math.min(100,(e-t)/i*100)),n=Math.max(0,Math.min(100,(s-t)/i*100));return c.jsxs("div",{className:"relative h-2 bg-slate-200 rounded-full overflow-hidden",children:[c.jsx("div",{className:"absolute top-0 h-full bg-blue-200 rounded-full",style:{width:`${n}%`}}),c.jsx("div",{className:"absolute top-0 h-full w-1 bg-blue-600 rounded-full",style:{left:`${n}%`}}),c.jsx("div",{className:"absolute top-0 h-full w-1 bg-amber-500 rounded-full",style:{left:`${l}%`}})]})};return o?c.jsxs(G.div,{initial:{x:320,opacity:0},animate:{x:0,opacity:1},exit:{x:320,opacity:0},className:"fixed right-0 top-16 bottom-0 w-80 bg-slate-50 border-l border-slate-200 shadow-xl z-40 overflow-hidden flex flex-col",children:[c.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border-b border-slate-200",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:c.jsx(a,{size:16,className:"text-blue-600"})}),c.jsx("h3",{className:"font-semibold text-slate-900",children:"Contextual Insights"})]}),m&&c.jsx("button",{onClick:m,className:"p-1.5 hover:bg-slate-100 rounded-lg transition-colors",children:c.jsx(v,{size:16,className:"text-slate-500"})})]}),c.jsx("div",{className:"flex-1 overflow-y-auto",children:c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[c.jsxs("button",{onClick:()=>b("assumptions"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(i,{size:16,className:"text-amber-600"}),c.jsx("span",{className:"font-medium text-slate-900",children:"Key Assumptions"})]}),x.assumptions?c.jsx(j,{size:16,className:"text-slate-400"}):c.jsx(N,{size:16,className:"text-slate-400"})]}),c.jsx(W,{children:x.assumptions&&c.jsx(G.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:c.jsxs("div",{className:"p-4 space-y-3",children:[c.jsxs("div",{className:"flex justify-between items-center text-sm",children:[c.jsx("span",{className:"text-slate-600",children:"Discount Rate"}),c.jsx("span",{className:"font-mono text-slate-900",children:"10.0%"})]}),c.jsxs("div",{className:"flex justify-between items-center text-sm",children:[c.jsx("span",{className:"text-slate-600",children:"Terminal Growth"}),c.jsx("span",{className:"font-mono text-slate-900",children:"2.5%"})]}),c.jsxs("div",{className:"flex justify-between items-center text-sm",children:[c.jsx("span",{className:"text-slate-600",children:"Tax Rate"}),c.jsx("span",{className:"font-mono text-slate-900",children:"25.0%"})]})]})})})]}),c.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[c.jsxs("button",{onClick:()=>b("benchmarks"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(h,{size:16,className:"text-emerald-600"}),c.jsx("span",{className:"font-medium text-slate-900",children:"Industry Benchmarks"})]}),x.benchmarks?c.jsx(j,{size:16,className:"text-slate-400"}):c.jsx(N,{size:16,className:"text-slate-400"})]}),c.jsx(W,{children:x.benchmarks&&c.jsx(G.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:c.jsxs("div",{className:"p-4 space-y-4",children:[c.jsxs("div",{className:"text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-slate-600",children:"Revenue Growth"}),c.jsx("span",{className:"text-xs text-slate-500",children:"Healthcare Industry"})]}),c.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[c.jsx("span",{children:"8%"}),c.jsx("span",{className:"font-medium",children:"15% (median)"}),c.jsx("span",{children:"25%"})]}),p(12,15,8,25)]}),c.jsxs("div",{className:"text-sm",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"text-slate-600",children:"EBITDA Margin"}),c.jsx("span",{className:"text-xs text-slate-500",children:"Healthcare Industry"})]}),c.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[c.jsx("span",{children:"18%"}),c.jsx("span",{className:"font-medium",children:"28% (median)"}),c.jsx("span",{children:"40%"})]}),p(24,28,18,40)]})]})})})]}),c.jsx("div",{className:"space-y-3",children:g.map((e,s)=>((e,s)=>{const t={info:"text-blue-500 bg-blue-50",benchmark:"text-emerald-500 bg-emerald-50",assumption:"text-amber-500 bg-amber-50",insight:"text-purple-500 bg-purple-50"},a={info:C,benchmark:i,assumption:d,insight:w}[e.type]||C,l=t[e.type]||t.info;return c.jsx(G.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"p-4 bg-white rounded-lg border border-slate-200 hover:border-slate-300 transition-colors",children:c.jsxs("div",{className:"flex items-start gap-3",children:[c.jsx("div",{className:`p-2 rounded-lg ${l}`,children:c.jsx(a,{size:16})}),c.jsxs("div",{className:"flex-1 min-w-0",children:[c.jsx("h4",{className:"font-semibold text-slate-900 text-sm mb-2",children:e.title}),c.jsx("p",{className:"text-sm text-slate-600 mb-3",children:e.content}),void 0!==e.metric&&void 0!==e.benchmark&&c.jsxs("div",{className:"mb-3",children:[c.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[c.jsxs("span",{children:["Current: ",e.metric.toFixed(1),"%"]}),c.jsxs("span",{children:["Benchmark: ",e.benchmark,"%"]})]}),p(e.metric,e.benchmark,0,Math.max(1.5*e.benchmark,1.2*e.metric))]}),e.suggestions&&c.jsx("div",{className:"mt-3",children:c.jsx("div",{className:"space-y-1",children:e.suggestions.map((e,s)=>c.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600",children:[c.jsx(N,{size:12,className:"text-slate-400 mt-0.5 flex-shrink-0"}),c.jsx("span",{children:e})]},s))})}),e.action&&c.jsx("button",{onClick:()=>r?.(e),className:"mt-3 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-700 text-xs font-medium rounded-md transition-colors",children:e.action})]})]})},s)})(e,s))}),c.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[c.jsxs("button",{onClick:()=>b("suggestions"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(w,{size:16,className:"text-purple-600"}),c.jsx("span",{className:"font-medium text-slate-900",children:"Smart Suggestions"})]}),x.suggestions?c.jsx(j,{size:16,className:"text-slate-400"}):c.jsx(N,{size:16,className:"text-slate-400"})]}),c.jsx(W,{children:x.suggestions&&c.jsx(G.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:c.jsxs("div",{className:"p-4 space-y-3",children:[c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[c.jsx(a,{size:14,className:"text-blue-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-blue-900 mb-1",children:"Create Revenue vs CapEx Chart"}),c.jsx("div",{className:"text-xs text-blue-700",children:"Visualize the relationship between revenue growth and capital expenditure"})]})]}),c.jsxs("div",{className:"flex items-start gap-3 p-3 bg-emerald-50 rounded-lg",children:[c.jsx(s,{size:14,className:"text-emerald-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm font-medium text-emerald-900 mb-1",children:"Add Sensitivity Analysis"}),c.jsx("div",{className:"text-xs text-emerald-700",children:"Test how valuation changes with different assumptions"})]})]})]})})})]})]})})]}):null}},Symbol.toStringTag,{value:"Module"})),Me=Object.freeze(Object.defineProperty({__proto__:null,default:({data:t,onDataChange:i})=>{const[l,n]=e.useState("overview"),[r,o]=e.useState([{symbol:"SPY",name:"SPDR S&P 500 ETF",price:445.67,change:2.34,changePercent:.53,category:"index"},{symbol:"QQQ",name:"Invesco QQQ Trust",price:378.91,change:-1.45,changePercent:-.38,category:"index"},{symbol:"VIX",name:"CBOE Volatility Index",price:18.45,change:.87,changePercent:4.95,category:"volatility"},{symbol:"DXY",name:"US Dollar Index",price:102.45,change:-.23,changePercent:-.22,category:"currency"},{symbol:"^TNX",name:"10-Year Treasury Yield",price:4.25,change:.05,changePercent:1.19,category:"rates"}]),[d,m]=e.useState({indices:{"S&P 500":{value:4456.78,change:23.45,changePercent:.53},NASDAQ:{value:13789.45,change:-45.67,changePercent:-.33},DOW:{value:34567.89,change:156.78,changePercent:.46},"Russell 2000":{value:1987.65,change:12.34,changePercent:.63}},sectors:[{name:"Technology",change:1.2,weight:23.5},{name:"Healthcare",change:.8,weight:13.2},{name:"Financial",change:-.4,weight:12.8},{name:"Consumer Disc.",change:.6,weight:10.9},{name:"Communication",change:-.2,weight:9.1},{name:"Industrials",change:.9,weight:8.7}],economicIndicators:{"Fed Funds Rate":{value:5.25,change:0,unit:"%"},"10Y Treasury":{value:4.25,change:.05,unit:"%"},"Inflation (CPI)":{value:3.1,change:-.2,unit:"%"},Unemployment:{value:3.8,change:.1,unit:"%"},"GDP Growth":{value:2.4,change:.1,unit:"%"}}}),[x,u]=e.useState([{id:1,type:"price",symbol:"SPY",condition:"above",value:450,active:!0},{id:2,type:"volatility",symbol:"VIX",condition:"above",value:20,active:!0}]),[h,b]=e.useState(""),[p,v]=e.useState(!1),j=e.useCallback(e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),[]),N=e.useCallback(e=>`${e>=0?"+":""}${e.toFixed(2)}%`,[]),w=e.useCallback(e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",[]),C=e.useCallback(e=>e>0?s:e<0?y:k,[]);e.useEffect(()=>{const e=setInterval(()=>{o(e=>e.map(e=>({...e,price:e.price+2*(Math.random()-.5),change:e.change+.5*(Math.random()-.5),changePercent:e.changePercent+.1*(Math.random()-.5)})))},5e3);return()=>clearInterval(e)},[]);const P=e.useCallback(async()=>{if(h.trim()){v(!0);try{await new Promise(e=>setTimeout(e,1e3));const e={symbol:h.toUpperCase(),name:`${h.toUpperCase()} Inc.`,price:200*Math.random()+50,change:10*(Math.random()-.5),changePercent:5*(Math.random()-.5),category:"stock"};o(s=>[...s,e]),b("")}catch(e){}finally{v(!1)}}},[h]),D=e.useCallback(e=>{o(s=>s.filter(s=>s.symbol!==e))},[]),T=e.useMemo(()=>{const e=new Date;return Array.from({length:30},(s,t)=>({time:new Date(e.getTime()-24*(29-t)*60*60*1e3).toLocaleDateString(),SPY:440+10*Math.sin(.2*t)+5*Math.random(),QQQ:370+15*Math.sin(.25*t)+8*Math.random(),VIX:20+5*Math.sin(.3*t)+3*Math.random()}))},[]),V=e.useMemo(()=>[{pair:"SPY vs QQQ",correlation:.85,strength:"Strong Positive"},{pair:"SPY vs VIX",correlation:-.72,strength:"Strong Negative"},{pair:"QQQ vs VIX",correlation:-.68,strength:"Moderate Negative"},{pair:"SPY vs DXY",correlation:-.45,strength:"Moderate Negative"}],[]);return c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(g,{className:"text-blue-600",size:28}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Enhanced Market Data Dashboard"}),c.jsx("p",{className:"text-gray-600",children:"Real-time market insights & valuation integration"})]})]}),c.jsxs("div",{className:"flex space-x-3",children:[c.jsxs(G.button,{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[c.jsx(S,{size:16}),c.jsx("span",{children:"Sync Data"})]}),c.jsxs(G.button,{className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[c.jsx(F,{size:16}),c.jsx("span",{children:"Settings"})]})]})]}),c.jsx("div",{className:"border-b border-gray-200 mb-6",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Market Overview",icon:M},{id:"watchlist",label:"Watchlist",icon:a},{id:"charts",label:"Charts & Analysis",icon:A},{id:"alerts",label:"Alerts",icon:R}].map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>n(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(l===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[c.jsx(s,{size:16}),c.jsx("span",{children:e.label})]},e.id)})})}),"overview"===l&&c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Major Indices"}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(d.indices).map(([e,s])=>{const t=C(s.change);return c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e}),c.jsx("div",{className:"text-xl font-bold text-gray-800",children:s.value.toLocaleString()}),c.jsxs("div",{className:`flex items-center space-x-1 text-sm ${w(s.change)}`,children:[c.jsx(t,{size:14}),c.jsxs("span",{children:[s.change>0?"+":"",s.change.toFixed(2)]}),c.jsxs("span",{children:["(",N(s.changePercent),")"]})]})]},e)})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sector Performance"}),c.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:d.sectors.map(e=>c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800",children:e.name}),c.jsxs("div",{className:"text-sm text-gray-600",children:[e.weight,"% weight"]})]}),c.jsx("div",{className:`font-semibold ${w(e.change)}`,children:N(e.change)})]},e.name))})})]}),c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Economic Indicators"}),c.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:Object.entries(d.economicIndicators).map(([e,s])=>c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e}),c.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[s.value,s.unit]}),c.jsxs("div",{className:`text-sm ${w(s.change)}`,children:[s.change>0?"+":"",s.change,s.unit]})]},e))})]})]}),"watchlist"===l&&c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[c.jsxs("div",{className:"flex space-x-3",children:[c.jsx("div",{className:"flex-1",children:c.jsx("input",{type:"text",placeholder:"Enter symbol (e.g., AAPL, MSFT)",value:h,onChange:e=>b(e.target.value.toUpperCase()),onKeyPress:e=>"Enter"===e.key&&P(),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),c.jsxs(G.button,{onClick:P,disabled:p||!h.trim(),className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(p||!h.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"),whileHover:!p&&h.trim()?{scale:1.02}:{},children:[c.jsx(I,{size:16}),c.jsx("span",{children:p?"Adding...":"Add"})]})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b-2 border-gray-300",children:[c.jsx("th",{className:"text-left py-3 px-4",children:"Symbol"}),c.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),c.jsx("th",{className:"text-right py-3 px-4",children:"Price"}),c.jsx("th",{className:"text-right py-3 px-4",children:"Change"}),c.jsx("th",{className:"text-right py-3 px-4",children:"Change %"}),c.jsx("th",{className:"text-center py-3 px-4",children:"Category"}),c.jsx("th",{className:"text-center py-3 px-4",children:"Actions"})]})}),c.jsx("tbody",{children:r.map(e=>{const s=C(e.change);return c.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[c.jsx("td",{className:"py-3 px-4 font-medium text-gray-800",children:e.symbol}),c.jsx("td",{className:"py-3 px-4 text-gray-600",children:e.name}),c.jsx("td",{className:"text-right py-3 px-4 font-medium",children:j(e.price)}),c.jsx("td",{className:`text-right py-3 px-4 ${w(e.change)}`,children:c.jsxs("div",{className:"flex items-center justify-end space-x-1",children:[c.jsx(s,{size:14}),c.jsxs("span",{children:[e.change>0?"+":"",e.change.toFixed(2)]})]})}),c.jsx("td",{className:`text-right py-3 px-4 font-medium ${w(e.changePercent)}`,children:N(e.changePercent)}),c.jsx("td",{className:"text-center py-3 px-4",children:c.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("index"===e.category?"bg-blue-100 text-blue-800":"stock"===e.category?"bg-green-100 text-green-800":"volatility"===e.category?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.category})}),c.jsx("td",{className:"text-center py-3 px-4",children:c.jsx("button",{onClick:()=>D(e.symbol),className:"text-red-600 hover:text-red-800",children:c.jsx(k,{size:16})})})]},e.symbol)})})]})})]}),"charts"===l&&c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"30-Day Price Performance"}),c.jsx("div",{className:"h-80",children:c.jsx(U,{width:"100%",height:"100%",children:c.jsxs(K,{data:T,children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{dataKey:"time"}),c.jsx(Q,{}),c.jsx(X,{}),c.jsx(J,{type:"monotone",dataKey:"SPY",stroke:"#3B82F6",strokeWidth:2,name:"S&P 500"}),c.jsx(J,{type:"monotone",dataKey:"QQQ",stroke:"#10B981",strokeWidth:2,name:"NASDAQ"}),c.jsx(J,{type:"monotone",dataKey:"VIX",stroke:"#EF4444",strokeWidth:2,name:"VIX"})]})})})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Correlation Analysis"}),c.jsx("div",{className:"space-y-3",children:V.map((e,s)=>c.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800",children:e.pair}),c.jsx("div",{className:"text-sm text-gray-600",children:e.strength})]}),c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx("div",{className:"text-lg font-bold "+(Math.abs(e.correlation)>.7?"text-red-600":Math.abs(e.correlation)>.4?"text-yellow-600":"text-green-600"),children:e.correlation.toFixed(2)}),c.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"h-2 rounded-full "+(Math.abs(e.correlation)>.7?"bg-red-600":Math.abs(e.correlation)>.4?"bg-yellow-600":"bg-green-600"),style:{width:100*Math.abs(e.correlation)+"%"}})})]})]},s))})]})]}),"alerts"===l&&c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[c.jsxs("div",{children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Active Alerts"}),c.jsx("div",{className:"space-y-3",children:x.map(e=>c.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(R,{className:"text-yellow-600",size:20}),c.jsxs("div",{children:[c.jsxs("div",{className:"font-medium text-gray-800",children:[e.symbol," ",e.type," alert"]}),c.jsxs("div",{className:"text-sm text-gray-600",children:["Notify when ",e.type," goes ",e.condition," ",e.value]})]})]}),c.jsxs("div",{className:"flex items-center space-x-2",children:[c.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.active?"Active":"Inactive"}),c.jsx("button",{className:"text-red-600 hover:text-red-800",children:c.jsx(k,{size:16})})]})]},e.id))})]}),c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Market Status"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[c.jsx(f,{className:"text-green-600",size:20}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800",children:"US Markets"}),c.jsx("div",{className:"text-sm text-gray-600",children:"Open (6h 23m remaining)"})]})]}),c.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[c.jsx(E,{className:"text-yellow-600",size:20}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800",children:"European Markets"}),c.jsx("div",{className:"text-sm text-gray-600",children:"Closed"})]})]}),c.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[c.jsx(E,{className:"text-red-600",size:20}),c.jsxs("div",{children:[c.jsx("div",{className:"font-medium text-gray-800",children:"Asian Markets"}),c.jsx("div",{className:"text-sm text-gray-600",children:"Closed"})]})]})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),Ae=Object.freeze(Object.defineProperty({__proto__:null,default:({data:t,onDataChange:a})=>{const[i,l]=e.useState("income"),[n,r]=e.useState({revenue:[1e5,105e3,110250,115763,121551],costOfGoodsSold:[6e4,63e3,66150,69458,72931],grossProfit:[4e4,42e3,44100,46305,48620],operatingExpenses:[25e3,26250,27563,28941,30388],ebitda:[15e3,15750,16538,17364,18232],depreciation:[3e3,3150,3308,3473,3647],ebit:[12e3,12600,13230,13891,14585],interestExpense:[2e3,1800,1580,1340,1080],ebt:[1e4,10800,11650,12551,13505],taxes:[2100,2268,2447,2636,2836],netIncome:[7900,8532,9203,9915,10669],cash:[5e3,8532,12735,17650,23319],accountsReceivable:[8333,8750,9188,9647,10129],inventory:[1e4,10500,11025,11576,12155],totalCurrentAssets:[23333,27782,32948,38873,45603],ppe:[5e4,51850,53543,55070,56423],totalAssets:[73333,79632,86491,93943,102026],accountsPayable:[5e3,5250,5513,5789,6078],shortTermDebt:[3e3,2e3,1e3,0,0],totalCurrentLiabilities:[8e3,7250,6513,5789,6078],longTermDebt:[25e3,23e3,21e3,19e3,17e3],totalLiabilities:[33e3,30250,27513,24789,23078],shareholderEquity:[40333,49382,58978,69154,78948],totalLiabilitiesEquity:[73333,79632,86491,93943,102026],operatingCashFlow:[8567,10233,11345,12464,13584],capex:[-5e3,-4850,-5e3,-5e3,-5e3],investingCashFlow:[-5e3,-4850,-5e3,-5e3,-5e3],debtRepayment:[-2e3,-2e3,-2e3,-2e3,-2e3],financingCashFlow:[-2e3,-2e3,-2e3,-2e3,-2e3],netCashFlow:[1567,3383,4345,5464,6584],endingCash:[5e3,8383,12728,18192,24776]}),[o,d]=e.useState({revenueGrowthRate:.05,cogsPercentOfRevenue:.6,opexGrowthRate:.05,taxRate:.21,depreciationRate:.06,capexPercentOfRevenue:.05,debtPaydown:2e3}),[m,x]=e.useState([]),u=["Year 1","Year 2","Year 3","Year 4","Year 5"],h=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e):"$0",[]),b=e.useCallback(()=>{const e={...n};for(let t=1;t<5;t++){e.revenue[t]=e.revenue[t-1]*(1+o.revenueGrowthRate),e.costOfGoodsSold[t]=e.revenue[t]*o.cogsPercentOfRevenue,e.grossProfit[t]=e.revenue[t]-e.costOfGoodsSold[t],e.operatingExpenses[t]=e.operatingExpenses[t-1]*(1+o.opexGrowthRate),e.ebitda[t]=e.grossProfit[t]-e.operatingExpenses[t],e.depreciation[t]=e.ppe[t-1]*o.depreciationRate,e.ebit[t]=e.ebitda[t]-e.depreciation[t],e.interestExpense[t]=.06*e.longTermDebt[t-1],e.ebt[t]=e.ebit[t]-e.interestExpense[t],e.taxes[t]=Math.max(0,e.ebt[t]*o.taxRate),e.netIncome[t]=e.ebt[t]-e.taxes[t];const s=e.revenue[t]*o.capexPercentOfRevenue;e.ppe[t]=e.ppe[t-1]+s-e.depreciation[t],e.longTermDebt[t]=Math.max(0,e.longTermDebt[t-1]-o.debtPaydown),e.shortTermDebt[t]=Math.max(0,e.shortTermDebt[t-1]-1e3),e.accountsReceivable[t]=.083*e.revenue[t],e.inventory[t]=.1*e.costOfGoodsSold[t],e.accountsPayable[t]=.05*e.costOfGoodsSold[t];const a=e.accountsReceivable[t]-e.accountsReceivable[t-1]+(e.inventory[t]-e.inventory[t-1])-(e.accountsPayable[t]-e.accountsPayable[t-1]);e.operatingCashFlow[t]=e.netIncome[t]+e.depreciation[t]-a,e.capex[t]=-s,e.investingCashFlow[t]=e.capex[t],e.debtRepayment[t]=-o.debtPaydown,e.financingCashFlow[t]=e.debtRepayment[t],e.netCashFlow[t]=e.operatingCashFlow[t]+e.investingCashFlow[t]+e.financingCashFlow[t],e.endingCash[t]=e.cash[t-1]+e.netCashFlow[t],e.cash[t]=e.endingCash[t],e.totalCurrentAssets[t]=e.cash[t]+e.accountsReceivable[t]+e.inventory[t],e.totalAssets[t]=e.totalCurrentAssets[t]+e.ppe[t],e.totalCurrentLiabilities[t]=e.accountsPayable[t]+e.shortTermDebt[t],e.totalLiabilities[t]=e.totalCurrentLiabilities[t]+e.longTermDebt[t],e.shareholderEquity[t]=e.totalAssets[t]-e.totalLiabilities[t],e.totalLiabilitiesEquity[t]=e.totalLiabilities[t]+e.shareholderEquity[t]}r(e);const s=[];for(let t=0;t<5;t++)Math.abs(e.totalAssets[t]-e.totalLiabilitiesEquity[t])>1&&s.push(`Balance sheet doesn't balance in ${u[t]}`);x(s)},[n,o,u]),p=e.useCallback((e,s)=>{d(t=>({...t,[e]:parseFloat(s)||0}))},[]),y=[{id:"income",label:"Income Statement",icon:s},{id:"balance",label:"Balance Sheet",icon:D},{id:"cashflow",label:"Cash Flow",icon:g},{id:"assumptions",label:"Assumptions",icon:T}];return c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(P,{className:"text-green-600",size:28}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"3-Statement Financial Model"}),c.jsx("p",{className:"text-gray-600",children:"Integrated Income Statement, Balance Sheet & Cash Flow"})]})]}),c.jsxs(G.button,{onClick:b,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[c.jsx(S,{size:16}),c.jsx("span",{children:"Recalculate"})]})]}),0===m.length?c.jsxs("div",{className:"mb-6 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[c.jsx(f,{className:"text-green-500 mr-2",size:20}),c.jsx("span",{className:"text-green-800 font-medium",children:"Model is balanced and consistent"})]}):c.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[c.jsxs("div",{className:"flex items-center mb-2",children:[c.jsx(E,{className:"text-red-500 mr-2",size:20}),c.jsx("h3",{className:"font-semibold text-red-800",children:"Validation Errors"})]}),c.jsx("ul",{className:"text-sm text-red-700",children:m.map((e,s)=>c.jsxs("li",{children:["• ",e]},s))})]}),c.jsx("div",{className:"border-b border-gray-200 mb-6",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:y.map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>l(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(i===e.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[c.jsx(s,{size:16}),c.jsx("span",{children:e.label})]},e.id)})})}),"income"===i&&c.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b-2 border-gray-300",children:[c.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Income Statement ($000s)"}),u.map(e=>c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),c.jsx("tbody",{children:[{label:"Revenue",key:"revenue"},{label:"Cost of Goods Sold",key:"costOfGoodsSold"},{label:"Gross Profit",key:"grossProfit"},{label:"Operating Expenses",key:"operatingExpenses"},{label:"EBITDA",key:"ebitda"},{label:"Depreciation",key:"depreciation"},{label:"EBIT",key:"ebit"},{label:"Interest Expense",key:"interestExpense"},{label:"EBT",key:"ebt"},{label:"Taxes",key:"taxes"},{label:"Net Income",key:"netIncome"}].map(e=>c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("td",{className:"py-2 px-4 font-medium",children:e.label}),n[e.key]?.map((e,s)=>c.jsx("td",{className:"text-right py-2 px-4",children:h(e)},s))]},e.key))})]})})}),"balance"===i&&c.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b-2 border-gray-300",children:[c.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Balance Sheet ($000s)"}),u.map(e=>c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),c.jsxs("tbody",{children:[c.jsx("tr",{className:"bg-gray-100",children:c.jsx("td",{colSpan:6,className:"py-2 px-4 font-semibold",children:"ASSETS"})}),[{label:"Cash",key:"cash"},{label:"Accounts Receivable",key:"accountsReceivable"},{label:"Inventory",key:"inventory"},{label:"Total Current Assets",key:"totalCurrentAssets"},{label:"PP&E",key:"ppe"},{label:"Total Assets",key:"totalAssets"}].map(e=>c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("td",{className:"py-2 px-4",children:e.label}),n[e.key]?.map((e,s)=>c.jsx("td",{className:"text-right py-2 px-4",children:h(e)},s))]},e.key)),c.jsx("tr",{className:"bg-gray-100",children:c.jsx("td",{colSpan:6,className:"py-2 px-4 font-semibold",children:"LIABILITIES & EQUITY"})}),[{label:"Accounts Payable",key:"accountsPayable"},{label:"Short-term Debt",key:"shortTermDebt"},{label:"Total Current Liabilities",key:"totalCurrentLiabilities"},{label:"Long-term Debt",key:"longTermDebt"},{label:"Total Liabilities",key:"totalLiabilities"},{label:"Shareholder Equity",key:"shareholderEquity"},{label:"Total Liab. & Equity",key:"totalLiabilitiesEquity"}].map(e=>c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("td",{className:"py-2 px-4",children:e.label}),n[e.key]?.map((e,s)=>c.jsx("td",{className:"text-right py-2 px-4",children:h(e)},s))]},e.key))]})]})})}),"cashflow"===i&&c.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b-2 border-gray-300",children:[c.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Cash Flow Statement ($000s)"}),u.map(e=>c.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),c.jsx("tbody",{children:[{label:"Operating Cash Flow",key:"operatingCashFlow"},{label:"CapEx",key:"capex"},{label:"Investing Cash Flow",key:"investingCashFlow"},{label:"Debt Repayment",key:"debtRepayment"},{label:"Financing Cash Flow",key:"financingCashFlow"},{label:"Net Cash Flow",key:"netCashFlow"},{label:"Ending Cash",key:"endingCash"}].map(e=>c.jsxs("tr",{className:"border-b border-gray-200",children:[c.jsx("td",{className:"py-2 px-4",children:e.label}),n[e.key]?.map((e,s)=>c.jsx("td",{className:"text-right py-2 px-4",children:h(e)},s))]},e.key))})]})})}),"assumptions"===i&&c.jsx(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[c.jsx("h3",{className:"font-semibold mb-4",children:"Key Assumptions"}),c.jsx("div",{className:"space-y-3",children:[{label:"Revenue Growth Rate (%)",key:"revenueGrowthRate",isPercent:!0},{label:"COGS % of Revenue",key:"cogsPercentOfRevenue",isPercent:!0},{label:"OpEx Growth Rate (%)",key:"opexGrowthRate",isPercent:!0},{label:"Tax Rate (%)",key:"taxRate",isPercent:!0},{label:"CapEx % of Revenue",key:"capexPercentOfRevenue",isPercent:!0},{label:"Annual Debt Paydown ($000s)",key:"debtPaydown",isPercent:!1}].map(e=>c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.label}),c.jsx("input",{type:"number",step:"0.01",value:e.isPercent?100*o[e.key]:o[e.key],onChange:s=>p(e.key,e.isPercent?(s.target.value||0)/100:s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]},e.key))})]}),c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[c.jsx("h3",{className:"font-semibold mb-4",children:"Model Metrics"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"5-Year Revenue CAGR:"}),c.jsxs("span",{className:"font-medium",children:[(100*(Math.pow(n.revenue[4]/n.revenue[0],1/4)-1)).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"5-Year EBITDA CAGR:"}),c.jsxs("span",{className:"font-medium",children:[(100*(Math.pow(n.ebitda[4]/n.ebitda[0],1/4)-1)).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Exit EBITDA Margin:"}),c.jsxs("span",{className:"font-medium",children:[(n.ebitda[4]/n.revenue[4]*100).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Exit Debt/EBITDA:"}),c.jsxs("span",{className:"font-medium",children:[(n.longTermDebt[4]/n.ebitda[4]).toFixed(1),"x"]})]})]})]})]})})]})}},Symbol.toStringTag,{value:"Module"})),Re=({data:t,onDataChange:i,onAdjustedValuesChange:l})=>{const[n,r]=e.useState("incomeStatement"),[o,d]=e.useState({}),[m,x]=e.useState({}),[u,h]=e.useState(0),[g,b]=e.useState(!1),p=e.useMemo(()=>({periods:Array.isArray(t?.periods)?t.periods:[],statements:{incomeStatement:t?.statements?.incomeStatement||{},balanceSheet:t?.statements?.balanceSheet||{},cashFlow:t?.statements?.cashFlow||{}}}),[t]),f=e=>{if(!e&&0!==e)return"—";const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"—";const t=Math.abs(s);return t>=1e6?`${(s/1e6).toFixed(1)}M`:t>=1e3?`${(s/1e3).toFixed(0)}K`:s.toLocaleString()},y=p.statements[n]||{},v=(()=>{const e={incomeStatement:{revenue:{title:"Revenue",color:"bg-emerald-500",items:[{key:"totalRevenue",label:"Total Revenue",level:0},{key:"energyDevices",label:"Energy Devices",level:1},{key:"injectables",label:"Injectables",level:1},{key:"wellness",label:"Wellness",level:1}]},expenses:{title:"Expenses",color:"bg-red-500",items:[{key:"totalCostOfGoodsSold",label:"Cost of Goods Sold",level:0},{key:"totalOperatingExpense",label:"Operating Expenses",level:0},{key:"marketing",label:"Marketing",level:1},{key:"payroll",label:"Payroll",level:1}]},profitability:{title:"Profitability",color:"bg-blue-500",items:[{key:"grossProfit",label:"Gross Profit",level:0},{key:"operatingIncome",label:"Operating Income",level:0},{key:"netIncome",label:"Net Income",level:0}]}},balanceSheet:{assets:{title:"Assets",color:"bg-green-500",items:[{key:"totalCurrentAssets",label:"Current Assets",level:0},{key:"cash",label:"Cash",level:1},{key:"receivables",label:"Receivables",level:1},{key:"totalNonCurrentAssets",label:"Non-Current Assets",level:0}]},liabilities:{title:"Liabilities",color:"bg-orange-500",items:[{key:"totalCurrentLiabilities",label:"Current Liabilities",level:0},{key:"totalNonCurrentLiabilities",label:"Non-Current Liabilities",level:0}]},equity:{title:"Equity",color:"bg-purple-500",items:[{key:"totalEquity",label:"Total Equity",level:0},{key:"retainedEarnings",label:"Retained Earnings",level:1}]}},cashFlow:{operating:{title:"Operating Activities",color:"bg-emerald-500",items:[{key:"netCashFromOperating",label:"Net Cash from Operations",level:0},{key:"netIncome",label:"Net Income",level:1},{key:"depreciation",label:"Depreciation",level:1}]},investing:{title:"Investing Activities",color:"bg-blue-500",items:[{key:"netCashFromInvesting",label:"Net Cash from Investing",level:0},{key:"capex",label:"Capital Expenditures",level:1}]},financing:{title:"Financing Activities",color:"bg-purple-500",items:[{key:"netCashFromFinancing",label:"Net Cash from Financing",level:0},{key:"debtIssuance",label:"Debt Issuance",level:1}]}}};return e[n]||e.incomeStatement})();return c.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-4",children:[c.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-slate-200 p-4 mb-4",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(s,{className:"w-5 h-5 text-blue-600"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-lg font-bold text-slate-900",children:"Financial Analysis"}),c.jsx("p",{className:"text-sm text-slate-600",children:"Mobile View"})]})]}),c.jsx("div",{className:"grid grid-cols-3 gap-2 mb-4",children:[{key:"incomeStatement",label:"Income",icon:a},{key:"balanceSheet",label:"Balance",icon:T},{key:"cashFlow",label:"Cash Flow",icon:s}].map(({key:e,label:s,icon:t})=>c.jsxs("button",{onClick:()=>r(e),className:"p-3 rounded-lg border transition-colors "+(n===e?"bg-blue-500 text-white border-blue-500":"bg-white text-slate-700 border-slate-200 hover:bg-slate-50"),children:[c.jsx(t,{size:16,className:"mx-auto mb-1"}),c.jsx("div",{className:"text-xs font-medium",children:s})]},e))}),c.jsxs("div",{className:"mb-4",children:[c.jsx("label",{className:"block text-sm font-medium text-slate-700 mb-2",children:"Time Period"}),c.jsx("select",{value:u,onChange:e=>h(parseInt(e.target.value)),className:"w-full p-2 border border-slate-300 rounded-lg bg-white text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500",children:p.periods.map((e,s)=>c.jsx("option",{value:s,children:e},s))})]}),c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[c.jsx("input",{type:"checkbox",checked:g,onChange:e=>b(e.target.checked),className:"rounded"}),c.jsx("span",{children:"Show adjusted values only"})]}),c.jsx("button",{onClick:()=>x({}),className:"text-sm text-blue-600 hover:text-blue-700",children:"Collapse All"})]})]}),c.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([e,s])=>((e,s)=>{const t=m[s];return c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden",children:[c.jsx("div",{className:`${e.color} p-4 text-white cursor-pointer`,onClick:()=>(e=>{x(s=>({...s,[e]:!s[e]}))})(s),children:c.jsxs("div",{className:"flex items-center justify-between",children:[c.jsxs("div",{className:"flex items-center gap-3",children:[t?c.jsx(j,{size:20}):c.jsx(N,{size:20}),c.jsx("h3",{className:"font-semibold text-lg",children:e.title})]}),c.jsx("div",{className:"text-right",children:c.jsx("div",{className:"text-sm opacity-75",children:p.periods[u]||"Current"})})]})}),c.jsx(W,{children:t&&c.jsx(G.div,{initial:{height:0},animate:{height:"auto"},exit:{height:0},className:"overflow-hidden",children:c.jsx("div",{className:"p-4 space-y-3",children:e.items.map(e=>{const s=y[e.key]?.[u],t=o[e.key],a=g?t:s;return c.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border border-slate-100 "+(0===e.level?"bg-slate-50":"bg-white"),children:[c.jsxs("div",{className:"flex items-center gap-3",children:[0===e.level&&c.jsx("div",{className:"w-2 h-8 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full"}),c.jsxs("div",{children:[c.jsx("div",{className:0===e.level?"font-semibold text-slate-900":"font-medium text-slate-700",children:e.label}),1===e.level&&c.jsx("div",{className:"text-xs text-slate-500 mt-1",children:p.periods[u]||"Current Period"})]})]}),c.jsxs("div",{className:"text-right",children:[c.jsx("div",{className:"font-mono "+(0===e.level?"font-bold text-lg":"font-medium"),children:f(a)}),!g&&void 0!==t&&t!==s&&c.jsxs("div",{className:"text-xs text-amber-600 font-medium",children:["Adj: ",f(t)]}),c.jsx("div",{className:"text-xs text-slate-500 uppercase tracking-wide",children:"$ 000s"})]})]},e.key)})})})})]},s)})(s,e))}),c.jsxs("div",{className:"fixed bottom-4 right-4 flex flex-col gap-2",children:[c.jsx("button",{className:"w-12 h-12 bg-blue-500 hover:bg-blue-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors",children:c.jsx(V,{size:20})}),c.jsx("button",{className:"w-12 h-12 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full shadow-lg flex items-center justify-center transition-colors",children:c.jsx(T,{size:20})})]})]})},Ie=Object.freeze(Object.defineProperty({__proto__:null,default:({data:t,onDataChange:a,onAdjustedValuesChange:i})=>{const[l,n]=e.useState("incomeStatement"),[r,o]=e.useState({}),[d,m]=e.useState(!1),x=O.useMemo(()=>({periods:Array.isArray(t?.periods)?t.periods:[],statements:{incomeStatement:t?.statements?.incomeStatement||{},balanceSheet:t?.statements?.balanceSheet||{},cashFlow:t?.statements?.cashFlow||{}}}),[t]),{elementRef:u}=Ce("spreadsheet"),[h,g]=e.useState({revenue:!0,costOfGoodsSold:!0,operatingExpenses:!0,salariesBenefits:!0,grossProfit:!0,operatingIncome:!0,incomeBeforeTax:!0,otherIncomeExpense:!0,currentAssets:!0,nonCurrentAssets:!0,currentLiabilities:!0,nonCurrentLiabilities:!0,equity:!0,operatingActivities:!0,investingActivities:!0,financingActivities:!0}),[b,p]=e.useState(null),[f,y]=e.useState(""),v=e.useRef(null);e.useEffect(()=>{if(0===Object.keys(r).length){const e=x?.statements?.[l];if(e){const s={},t=Math.max(0,(x?.periods?.length||0)-1);Object.keys(e).forEach(a=>{const i=e[a]?.[t];void 0!==i&&(s[a]=i)}),o(s),i&&i(s)}}},[x,l,r,i]);const w={revenue:{title:"Revenue",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"energyDevices",label:"Energy Devices",level:1},{key:"injectables",label:"Injectables",level:1},{key:"wellness",label:"Wellness",level:1},{key:"weightloss",label:"Weightloss",level:1},{key:"retailSales",label:"Retail Sales",level:1},{key:"surgery",label:"Surgery",level:1},{key:"totalRevenue",label:"Total Revenue",level:0,bold:!0,formula:!0}]},costOfGoodsSold:{title:"Cost of Goods Sold",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"energyDeviceSupplies",label:"Energy Device Supplies",level:1},{key:"injectablesCogs",label:"Injectables",level:1},{key:"wellnessCogs",label:"Wellness",level:1},{key:"weightlossCogs",label:"Weightloss",level:1},{key:"retailProducts",label:"Retail Products",level:1},{key:"surgicalSupplies",label:"Surgical Supplies",level:1},{key:"totalCostOfGoodsSold",label:"Total Cost of Goods Sold",level:0,bold:!0,formula:!0}]},grossProfit:{title:"Gross Profit",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"grossProfit",label:"Gross Profit",level:0,bold:!0,formula:!0}]},salariesBenefits:{title:"Salaries & Benefits",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"employeeBenefits",label:"Employee Benefits",level:1},{key:"payroll",label:"Payroll",level:1},{key:"payrollTaxes",label:"Payroll Taxes",level:1},{key:"totalSalariesBenefits",label:"Total Salaries & Benefits",level:0,bold:!0,formula:!0}]},operatingExpenses:{title:"Operating Expenses",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"marketing",label:"Marketing",level:1},{key:"automobile",label:"Automobile",level:1},{key:"creditCardBankCharges",label:"Credit Card and Bank Charges",level:1},{key:"donations",label:"Donations",level:1},{key:"computerTelephoneUtilities",label:"Computer, Telephone, and Utilities",level:1},{key:"depreciation",label:"Depreciation",level:1},{key:"duesSubscriptions",label:"Dues & Subscriptions",level:1},{key:"education",label:"Education",level:1},{key:"equipmentRental",label:"Equipment Rental",level:1},{key:"insurance",label:"Insurance",level:1},{key:"interestExpense",label:"Interest Expense",level:1},{key:"travelMealsEntertainment",label:"Travel, Meals, and Entertainment",level:1},{key:"rent",label:"Rent",level:1},{key:"officeExpenses",label:"Office Expenses",level:1},{key:"professionalFees",label:"Professional Fees",level:1},{key:"repairsMaintenance",label:"Repairs & Maintenance",level:1},{key:"localTax",label:"Local Tax",level:1},{key:"stateTax",label:"State Tax",level:1},{key:"totalOperatingExpense",label:"Total Operating Expense",level:0,bold:!0,formula:!0}]},operatingIncome:{title:"Operating Income",color:"bg-teal-50 border-teal-300",headerBg:"bg-teal-600",textColor:"text-teal-900",items:[{key:"operatingIncome",label:"Operating Income",level:0,bold:!0}]},otherIncomeExpense:{title:"Other Income / (Expense)",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-600",textColor:"text-slate-900",items:[{key:"gainOnAssetSale",label:"Gain (Loss) On Asset Sale",level:1},{key:"interestIncome",label:"Interest Income",level:1},{key:"otherExpenses",label:"Other Expenses",level:1},{key:"totalOtherIncomeExpense",label:"Total Other Income / (Expenses)",level:0,bold:!0,formula:!0}]},incomeBeforeTax:{title:"Net Income Before Taxes",color:"bg-amber-50 border-amber-300",headerBg:"bg-amber-600",textColor:"text-amber-900",items:[{key:"incomeBeforeTax",label:"Net Income Before Taxes",level:0,bold:!0}]}},C={currentAssets:{title:"Current Assets",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"cash",label:"Cash and Cash Equivalents",level:1},{key:"receivables",label:"Accounts Receivable",level:1},{key:"inventory",label:"Inventory",level:1},{key:"prepaidExpenses",label:"Prepaid Expenses",level:1},{key:"otherCurrentAssets",label:"Other Current Assets",level:1},{key:"totalCurrentAssets",label:"Total Current Assets",level:0,formula:!0,bold:!0}]},nonCurrentAssets:{title:"Non-Current Assets",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"ppe",label:"Property, Plant & Equipment",level:1},{key:"accumulatedDepreciation",label:"Less: Accumulated Depreciation",level:1},{key:"netPPE",label:"Net Property, Plant & Equipment",level:1,formula:!0},{key:"intangibleAssets",label:"Intangible Assets",level:1},{key:"goodwill",label:"Goodwill",level:1},{key:"otherNonCurrentAssets",label:"Other Non-Current Assets",level:1},{key:"totalNonCurrentAssets",label:"Total Non-Current Assets",level:0,formula:!0,bold:!0}]},totalAssets:{title:"Total Assets",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalAssets",label:"Total Assets",level:0,formula:!0,bold:!0}]},currentLiabilities:{title:"Current Liabilities",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"accountsPayable",label:"Accounts Payable",level:1},{key:"accruedExpenses",label:"Accrued Expenses",level:1},{key:"shortTermDebt",label:"Short-term Debt",level:1},{key:"currentPortionLongTermDebt",label:"Current Portion of Long-term Debt",level:1},{key:"otherCurrentLiabilities",label:"Other Current Liabilities",level:1},{key:"totalCurrentLiabilities",label:"Total Current Liabilities",level:0,formula:!0,bold:!0}]},nonCurrentLiabilities:{title:"Non-Current Liabilities",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"longTermDebt",label:"Long-term Debt",level:1},{key:"deferredTaxLiabilities",label:"Deferred Tax Liabilities",level:1},{key:"otherNonCurrentLiabilities",label:"Other Non-Current Liabilities",level:1},{key:"totalNonCurrentLiabilities",label:"Total Non-Current Liabilities",level:0,formula:!0,bold:!0}]},totalLiabilities:{title:"Total Liabilities",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilities",label:"Total Liabilities",level:0,formula:!0,bold:!0}]},equity:{title:"Shareholders' Equity",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"commonStock",label:"Common Stock",level:1},{key:"retainedEarnings",label:"Retained Earnings",level:1},{key:"otherEquity",label:"Other Comprehensive Income",level:1},{key:"totalEquity",label:"Total Shareholders' Equity",level:0,formula:!0,bold:!0}]},totalLiabilitiesEquity:{title:"Total Liabilities and Equity",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilitiesEquity",label:"Total Liabilities and Shareholders' Equity",level:0,formula:!0,bold:!0}]}},k={operatingActivities:{title:"Operating Activities",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"netIncome",label:"Net Income",level:1},{key:"depreciation",label:"Depreciation and Amortization",level:1},{key:"receivablesChange",label:"Change in Accounts Receivable",level:1},{key:"inventoryChange",label:"Change in Inventory",level:1},{key:"payablesChange",label:"Change in Accounts Payable",level:1},{key:"otherOperatingChanges",label:"Other Operating Changes",level:1},{key:"netCashFromOperating",label:"Net Cash from Operating Activities",level:0,formula:!0,bold:!0}]},investingActivities:{title:"Investing Activities",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"capex",label:"Capital Expenditures",level:1},{key:"acquisitions",label:"Acquisitions",level:1},{key:"assetSales",label:"Asset Sales",level:1},{key:"otherInvestingActivities",label:"Other Investing Activities",level:1},{key:"netCashFromInvesting",label:"Net Cash from Investing Activities",level:0,formula:!0,bold:!0}]},financingActivities:{title:"Financing Activities",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"debtIssuance",label:"Debt Issuance",level:1},{key:"debtRepayment",label:"Debt Repayment",level:1},{key:"equityIssuance",label:"Equity Issuance",level:1},{key:"dividends",label:"Dividends Paid",level:1},{key:"otherFinancingActivities",label:"Other Financing Activities",level:1},{key:"netCashFromFinancing",label:"Net Cash from Financing Activities",level:0,formula:!0,bold:!0}]},netCashFlow:{title:"Net Cash Flow",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"netCashFlow",label:"Net Change in Cash",level:0,formula:!0,bold:!0},{key:"beginningCash",label:"Cash at Beginning of Period",level:1},{key:"endingCash",label:"Cash at End of Period",level:0,formula:!0,bold:!0}]}},S=(()=>{switch(l){case"balanceSheet":return C;case"cashFlow":return k;default:return w}})(),F=x.statements[l]||{},M=(e,s,t=!1)=>{p({rowKey:e,periodIndex:s,isAdjusted:t});let a="";a=t?r[e]||"":F[e]?.[s]||"",y(a.toString())},A=()=>{if(b){const{rowKey:e,periodIndex:s,isAdjusted:n}=b,c=parseFloat(f),d=isNaN(c)?0:c;if(n){const s={...r,[e]:d};o(s),i&&i(s)}else{const i={...t};i.statements={...i.statements||{}};const n=l||"incomeStatement";i.statements[n]={...i.statements[n]||{}};const r=i.statements[n][e]||{};i.statements[n][e]={...r,[s]:d},a(i)}p(null),y("")}},R=e=>{"Enter"===e.key?(e.preventDefault(),A()):"Escape"===e.key?(e.preventDefault(),p(null),y("")):"Tab"===e.key&&(e.preventDefault(),A())},E=e=>/^-?\d*\.?\d*$/.test(e)||""===e,D=e=>{if(!e&&0!==e)return"";const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"";const t=Math.abs(s);let a;return t>=1e6?(a=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(s/1e6),a+="M"):a=t>=1e3?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s):new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s),a};return e.useEffect(()=>{b&&v.current&&(v.current.focus(),v.current.select())},[b]),e.useEffect(()=>{const e=()=>{m(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),d?c.jsx(Re,{data:t,onDataChange:a,onAdjustedValuesChange:i}):c.jsxs("div",{ref:u,role:"main",className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 pb-8",children:[c.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:c.jsx("div",{className:"max-w-full mx-auto px-8 py-6",children:c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsxs("div",{className:"flex items-center gap-4",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(s,{className:"w-6 h-6 text-blue-600"})}),c.jsxs("div",{children:[c.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Financial Spreadsheet"}),c.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Professional financial modeling workspace"})]})]}),c.jsxs("div",{className:"flex items-center gap-3",children:[c.jsxs("button",{onClick:()=>{const e=prompt('Enter period label (e.g., "Year 5"):');if(e){const s={...t};s.periods=[...s.periods||[],e],a(s)}},className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium",children:[c.jsx(I,{size:16}),"Add Period"]}),c.jsxs("select",{value:l,onChange:e=>n(e.target.value),className:"px-4 py-2.5 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium shadow-sm",children:[c.jsx("option",{value:"incomeStatement",children:"Income Statement"}),c.jsx("option",{value:"balanceSheet",children:"Balance Sheet"}),c.jsx("option",{value:"cashFlow",children:"Cash Flow Statement"})]})]})]})})}),c.jsxs("div",{className:"max-w-full mx-auto p-8",children:[c.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-lg",children:c.jsx(ne,{className:"responsive-financial-table",enableVirtualization:!1,mobileStackedView:!1,showDeviceToggle:!0,children:c.jsxs("table",{className:"w-full",children:[c.jsx("thead",{className:"bg-gradient-to-r from-slate-800 to-slate-900 text-white",children:c.jsxs("tr",{children:[c.jsx("th",{className:"min-w-[320px] px-6 py-4 text-left text-sm font-semibold tracking-wider",children:c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(P,{size:16,className:"text-slate-300"}),"Account Description"]})}),c.jsx("th",{className:"w-20 px-4 py-4 text-center text-sm font-semibold",children:"Units"}),x.periods.map((e,s)=>c.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{children:e}),c.jsx("span",{className:"text-xs text-slate-300 font-normal",children:"Actual"})]})},s)),c.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold bg-gradient-to-r from-amber-600 to-yellow-600 border-l-2 border-amber-400",children:c.jsxs("div",{className:"flex flex-col",children:[c.jsx("span",{children:"Adjusted"}),c.jsx("span",{className:"text-xs text-amber-100 font-normal",children:"Modified"})]})}),c.jsx("th",{className:"w-28 px-4 py-4 text-center text-sm font-semibold",children:c.jsxs("div",{className:"flex items-center justify-center gap-1",children:[c.jsx(T,{size:14}),"Type"]})})]})}),c.jsx("tbody",{className:"divide-y divide-slate-100",children:Object.entries(S).map(([e,s])=>c.jsxs(O.Fragment,{children:[c.jsx("tr",{className:`${s.headerBg||"bg-slate-600"} border-b-2 border-slate-300`,children:c.jsx("td",{colSpan:x.periods.length+4,className:"py-4 px-6",children:c.jsxs("div",{className:"flex items-center gap-3 text-white w-full text-left group",children:[c.jsxs("button",{onClick:()=>(e=>{g(s=>({...s,[e]:!s[e]}))})(e),className:"flex items-center gap-3 text-white hover:text-slate-200 transition-colors flex-1",children:[c.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/20 group-hover:bg-white/30 transition-colors",children:h[e]?c.jsx(j,{size:14}):c.jsx(N,{size:14})}),c.jsx("span",{className:"font-bold text-lg",children:s.title})]}),c.jsx("button",{onClick:e=>{e.stopPropagation(),(()=>{if(prompt("Enter row label:")){const e={...t};a(e)}})()},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Add custom row",children:c.jsx(I,{size:16})})]})})}),h[e]&&s.items.map(e=>(e=>{const{key:s,label:t,level:a,formula:i,bold:l}=e,n=1===a?"pl-8":2===a?"pl-12":"pl-4",o=l?"font-bold":0===a?"font-semibold":"font-medium",d=0===a?"text-slate-900":"text-slate-700",m=0===a?"bg-slate-50/70":"bg-white",u=0===a?"border-slate-200":"border-slate-100";return c.jsxs("tr",{className:`${m} border-b ${u} hover:bg-slate-50 transition-all duration-150 group`,children:[c.jsx("td",{className:`px-6 py-4 ${n} ${o} text-sm ${d}`,children:c.jsxs("div",{className:"flex items-center gap-3",children:[0===a&&c.jsx("div",{className:"w-1.5 h-4 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full flex-shrink-0 shadow-sm"}),c.jsx("span",{className:"leading-tight",children:t}),i&&c.jsxs("div",{className:"flex items-center gap-1",children:[c.jsx(T,{size:14,className:"text-blue-500/80 flex-shrink-0"}),c.jsx("span",{className:"text-xs text-blue-600 font-medium px-1.5 py-0.5 bg-blue-50 rounded-md",children:"AUTO"})]})]})}),c.jsx("td",{className:"px-4 py-4 text-center",children:c.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide bg-slate-100 px-2 py-1 rounded-md",children:"$ 000s"})}),x.periods.map((e,t)=>c.jsx("td",{className:"px-4 py-4 text-right",children:b?.rowKey!==s||b?.periodIndex!==t||b?.isAdjusted?c.jsxs("div",{onClick:()=>!i&&M(s,t),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(i?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),children:[c.jsx("span",{className:i?"text-blue-900":"text-slate-700",children:D(F[s]?.[t])||"—"}),!i&&c.jsx(V,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-slate-400 transition-opacity"})]}):c.jsxs("div",{className:"relative",children:[c.jsx("input",{ref:v,type:"text",value:f,onChange:e=>{const s=e.target.value;E(s)&&y(s)},onBlur:A,onKeyDown:R,className:"w-full px-3 py-2.5 bg-white border-2 border-blue-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-blue-100 focus:border-blue-500 shadow-lg",placeholder:"0.00"}),c.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[c.jsx("button",{onClick:A,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),c.jsx("button",{onClick:()=>{p(null),y("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]})},t)),c.jsx("td",{className:"px-4 py-4 text-right bg-gradient-to-r from-amber-50 to-yellow-50 border-l-2 border-amber-300",children:b?.rowKey===s&&b?.isAdjusted?c.jsxs("div",{className:"relative","data-testid":`adjusted-cell-${s}`,children:[c.jsx("input",{ref:v,type:"text",value:f,"data-testid":`adjusted-input-${s}`,onChange:e=>{const s=e.target.value;E(s)&&y(s)},onBlur:A,onKeyDown:R,className:"w-full px-3 py-2.5 bg-white border-2 border-amber-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-amber-100 focus:border-amber-500 shadow-lg",placeholder:"0.00"}),c.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[c.jsx("button",{onClick:A,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),c.jsx("button",{onClick:()=>{p(null),y("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]}):c.jsxs("div",{onClick:()=>!i&&M(s,null,!0),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(i?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),"data-testid":`adjusted-cell-${s}`,children:[c.jsx("span",{className:i?"text-amber-900":"text-slate-700",children:D(r[s])||"—"}),!i&&c.jsx(V,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-amber-500 transition-opacity"})]})}),c.jsx("td",{className:"px-4 py-4 text-center",children:c.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium "+(i?"bg-blue-100 text-blue-800 border border-blue-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:i?c.jsxs(c.Fragment,{children:[c.jsx(T,{size:10,className:"mr-1"}),"Auto"]}):c.jsxs(c.Fragment,{children:[c.jsx(V,{size:10,className:"mr-1"}),"Manual"]})})})]},s)})(e))]},e))})]})})}),c.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:c.jsx(T,{className:"w-5 h-5 text-blue-600"})}),c.jsx("h3",{className:"font-bold text-slate-900",children:"How to Use"})]}),c.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Click any editable cell to modify values with enhanced input controls"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Use Enter to save changes or Escape to cancel editing"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Expand/collapse sections using the arrow controls"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Formula cells automatically calculate based on inputs"]})]})]}),c.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[c.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[c.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:c.jsx(s,{className:"w-5 h-5 text-green-600"})}),c.jsx("h3",{className:"font-bold text-slate-900",children:"Professional Features"})]}),c.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Color-coded sections for easy visual navigation"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Adjusted column for scenario analysis and modifications"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Professional number formatting with proper alignment"]}),c.jsxs("li",{className:"flex items-start gap-2",children:[c.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Enhanced editing experience with save/cancel controls"]})]})]})]})]})]})}},Symbol.toStringTag,{value:"Module"})),Ee=({dcfData:t,sensitivityData:i,scenarioData:l,formatCurrency:n,formatPercent:r})=>{const[o,d]=e.useState("dcf-waterfall"),[x,u]=e.useState(!0),h=[{id:"dcf-waterfall",label:"DCF Waterfall",icon:a,category:"dcf"},{id:"cashflow-trend",label:"Cash Flow Trend",icon:s,category:"dcf"},{id:"sensitivity-tornado",label:"Sensitivity Tornado",icon:g,category:"sensitivity"},{id:"scenario-distribution",label:"Scenario Distribution",icon:p,category:"scenario"},{id:"valuation-bridge",label:"Valuation Bridge",icon:a,category:"combined"}],b=e.useMemo(()=>{if(!t?.years)return[];let e=0;const s=[];t.years.forEach((t,a)=>{const i=e;e+=t.presentValue,s.push({name:`Year ${t.year}`,value:t.presentValue,cumulative:e,start:i,freeCashFlow:t.freeCashFlow,category:"operations"})});const a=e;return e+=t.presentValueTerminal,s.push({name:"Terminal Value",value:t.presentValueTerminal,cumulative:e,start:a,category:"terminal"}),s},[t]),f=e.useMemo(()=>t?.years?t.years.map((e,s)=>({year:`Year ${e.year}`,freeCashFlow:e.freeCashFlow,presentValue:e.presentValue,revenue:e.revenue,operatingIncome:e.operatingIncome,workingCapitalChange:e.workingCapitalChange,capex:Math.abs(e.capex)})):[],[t]),y=e.useMemo(()=>i?Object.entries(i).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>e.changeFromBase)),a=Math.min(...s.dataPoints.map(e=>e.changeFromBase));return{variable:s.definition.name,upside:t,downside:Math.abs(a),range:t-a}}).sort((e,s)=>s.range-e.range):[],[i]),v=e.useMemo(()=>l?.length?l.map((e,s)=>({name:e.name,value:e.enterpriseValue,probability:e.probability,weightedValue:e.weightedValue,fill:`hsl(${137.5*s%360}, 70%, 50%)`})):[],[l]),j=({active:e,payload:s,label:t,chartType:a})=>e&&s&&s.length?c.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[c.jsx("p",{className:"font-medium text-gray-800",children:t}),s.map((e,s)=>{return c.jsx("p",{style:{color:e.color},className:"text-sm",children:`${e.dataKey}: ${t=e.value,a=e.dataKey,a?.includes("Percent")||a?.includes("Rate")?r(t):n(t)}`},s);var t,a})]}):null,N=()=>c.jsx(U,{width:"100%",height:400,children:c.jsxs(Z,{data:b,margin:{top:20,right:30,left:20,bottom:5},children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{dataKey:"name"}),c.jsx(Q,{tickFormatter:e=>n(e)}),c.jsx(X,{content:c.jsx(j,{chartType:"waterfall"})}),c.jsx(ee,{dataKey:"value",fill:"#3B82F6"})]})}),w=()=>c.jsx(U,{width:"100%",height:400,children:c.jsxs(K,{data:f,margin:{top:20,right:30,left:20,bottom:5},children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{dataKey:"year"}),c.jsx(Q,{tickFormatter:e=>n(e)}),c.jsx(X,{content:c.jsx(j,{chartType:"trend"})}),c.jsx(ie,{}),c.jsx(J,{type:"monotone",dataKey:"freeCashFlow",stroke:"#10B981",strokeWidth:3,name:"Free Cash Flow"}),c.jsx(J,{type:"monotone",dataKey:"presentValue",stroke:"#3B82F6",strokeWidth:2,name:"Present Value"}),c.jsx(J,{type:"monotone",dataKey:"revenue",stroke:"#8B5CF6",strokeWidth:2,name:"Revenue"})]})}),C=()=>c.jsx(U,{width:"100%",height:400,children:c.jsxs(Z,{data:y,layout:"horizontal",margin:{top:20,right:30,left:100,bottom:5},children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{type:"number",tickFormatter:e=>`${e.toFixed(1)}%`}),c.jsx(Q,{type:"category",dataKey:"variable"}),c.jsx(X,{formatter:(e,s)=>[`${e.toFixed(1)}%`,s],labelFormatter:e=>`Variable: ${e}`}),c.jsx(ee,{dataKey:"upside",fill:"#10B981",name:"Upside Impact"}),c.jsx(ee,{dataKey:"downside",fill:"#EF4444",name:"Downside Impact"})]})}),k=()=>c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsx(U,{width:"100%",height:300,children:c.jsxs(se,{children:[c.jsx(te,{data:v,cx:"50%",cy:"50%",outerRadius:80,dataKey:"probability",label:({name:e,probability:s})=>`${e}: ${s}%`,children:v.map((e,s)=>c.jsx(ae,{fill:e.fill},`cell-${s}`))}),c.jsx(X,{formatter:e=>`${e}%`})]})}),c.jsx(U,{width:"100%",height:300,children:c.jsxs(Z,{data:v,children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{dataKey:"name"}),c.jsx(Q,{tickFormatter:e=>n(e)}),c.jsx(X,{content:c.jsx(j,{chartType:"scenario"})}),c.jsx(ee,{dataKey:"value",fill:"#8B5CF6",name:"Enterprise Value"})]})})]}),S=()=>{const e=[{name:"PV of Operations",value:t?.cumulativePV||0,type:"positive"},{name:"PV of Terminal",value:t?.presentValueTerminal||0,type:"positive"},{name:"Enterprise Value",value:t?.enterpriseValue||0,type:"total"}];return c.jsx(U,{width:"100%",height:400,children:c.jsxs(Z,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[c.jsx(H,{strokeDasharray:"3 3"}),c.jsx(Y,{dataKey:"name"}),c.jsx(Q,{tickFormatter:e=>n(e)}),c.jsx(X,{content:c.jsx(j,{chartType:"bridge"})}),c.jsx(ee,{dataKey:"value",fill:e=>"total"===e.type?"#1F2937":"#3B82F6"})]})})};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[c.jsx(a,{size:20}),"Data Visualization"]}),c.jsx("p",{className:"text-gray-600",children:"Interactive charts and graphs to visualize valuation results and sensitivity analysis."})]}),c.jsxs("button",{onClick:()=>u(!x),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 "+(x?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:[x?c.jsx(q,{size:14}):c.jsx(m,{size:14}),x?"Hide Details":"Show Details"]})]}),c.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:h.map(e=>{const s=e.icon;return c.jsxs(G.button,{onClick:()=>d(e.id),className:"p-3 rounded-lg border-2 transition-all text-center "+(o===e.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:border-gray-300 text-gray-700"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[c.jsx(s,{size:20,className:"mx-auto mb-2"}),c.jsx("div",{className:"text-xs font-medium",children:e.label})]},e.id)})}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h4",{className:"font-semibold text-lg",children:h.find(e=>e.id===o)?.label}),x&&c.jsx("span",{className:"text-sm text-gray-500",children:(()=>{switch(o){case"dcf-waterfall":return"Shows the contribution of each year's cash flows and terminal value to total enterprise value.";case"cashflow-trend":return"Displays the trend of free cash flows, present values, and key financial metrics over time.";case"sensitivity-tornado":return"Illustrates how changes in key variables impact enterprise value, ranked by sensitivity.";case"scenario-distribution":return"Compares different scenarios by probability weights and resulting enterprise values.";case"valuation-bridge":return"Breaks down enterprise value into operating value and terminal value components.";default:return""}})()})]}),c.jsx("div",{className:"min-h-[400px]",children:(()=>{switch(o){case"dcf-waterfall":default:return c.jsx(N,{});case"cashflow-trend":return c.jsx(w,{});case"sensitivity-tornado":return c.jsx(C,{});case"scenario-distribution":return c.jsx(k,{});case"valuation-bridge":return c.jsx(S,{})}})()})]}),x&&c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Key Insights"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["dcf-waterfall"===o&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Operations Contribution"}),c.jsx("div",{className:"text-lg font-bold text-blue-800",children:t?.cumulativePV?`${(t.cumulativePV/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),c.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Terminal Contribution"}),c.jsx("div",{className:"text-lg font-bold text-purple-800",children:t?.presentValueTerminal?`${(t.presentValueTerminal/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),c.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Avg. Annual FCF"}),c.jsx("div",{className:"text-lg font-bold text-green-800",children:t?.freeCashFlows?n(t.freeCashFlows.reduce((e,s)=>e+s,0)/t.freeCashFlows.length):"N/A"})]})]}),"sensitivity-tornado"===o&&y.length>0&&c.jsxs(c.Fragment,{children:[c.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Highest Risk Variable"}),c.jsx("div",{className:"text-lg font-bold text-red-800",children:y[0]?.variable}),c.jsxs("div",{className:"text-sm text-red-600",children:["±",y[0]?.range.toFixed(1),"% impact"]})]}),c.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Medium Risk Variables"}),c.jsx("div",{className:"text-lg font-bold text-yellow-800",children:y.slice(1,3).map(e=>e.variable).join(", ")})]}),c.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Lowest Risk Variable"}),c.jsx("div",{className:"text-lg font-bold text-green-800",children:y[y.length-1]?.variable})]})]})]})]})]})},Pe=({modelInputs:a,onModelInputChange:i,formatPercent:l})=>{const[n,r]=e.useState(!0),[o,d]=e.useState("inputs"),m=a.dcf.wacc||{riskFreeRate:4.5,marketRiskPremium:6,beta:1.2,smallCompanyPremium:3,companySpecificRisk:2,debtInterestRate:6.5,taxRate:25,marketValueEquity:1e5,marketValueDebt:3e4,buildUpMethod:{riskFreeRate:4.5,equityRiskPremium:6,sizeRiskPremium:3,industryRiskPremium:2,companySpecificRisk:2},industryWACC:10.5,industryBeta:1.1,industryDebtEquityRatio:.3},x=e.useMemo(()=>{const e={...m,...a.dcf.wacc},s=e.riskFreeRate+e.beta*e.marketRiskPremium+e.smallCompanyPremium+e.companySpecificRisk,t=e.buildUpMethod.riskFreeRate+e.buildUpMethod.equityRiskPremium+e.buildUpMethod.sizeRiskPremium+e.buildUpMethod.industryRiskPremium+e.buildUpMethod.companySpecificRisk,i=e.debtInterestRate*(1-e.taxRate/100),l=e.marketValueEquity+e.marketValueDebt,n=e.marketValueEquity/l,r=e.marketValueDebt/l,o=s/100*n+i/100*r,c=t/100*n+i/100*r;return{costOfEquityCAPM:s,costOfEquityBuildUp:t,costOfDebtAfterTax:i,equityWeight:100*n,debtWeight:100*r,waccCAPM:100*o,waccBuildUp:100*c,finalWACC:(o+c)/2*100,totalCapital:l,debtToEquityRatio:e.marketValueDebt/e.marketValueEquity}},[m,a.dcf.wacc]),u=(e,s)=>{const t={...m,...a.dcf.wacc,[e]:parseFloat(s)||0};i("dcf","wacc",t)},h=[{id:"inputs",label:"Inputs",icon:F},{id:"calculation",label:"Calculation",icon:T},{id:"benchmarks",label:"Benchmarks",icon:s}];return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[c.jsx(T,{size:20}),"WACC Calculator"]}),c.jsx("p",{className:"text-gray-600",children:"Professional weighted average cost of capital calculation using CAPM and build-up methods."})]}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>{return e=x.finalWACC,void i("dcf","discountRate",e);var e},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Apply to DCF"}),c.jsx("button",{onClick:()=>r(!n),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(n?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-600"),children:n?"Hide Details":"Show Details"})]})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs(G.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(t,{size:20,className:"text-blue-600"}),c.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"FINAL WACC"})]}),c.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l(x.finalWACC)}),c.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Risk-adjusted average"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(s,{size:20,className:"text-green-600"}),c.jsx("span",{className:"text-xs text-green-600 font-medium",children:"COST OF EQUITY"})]}),c.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(x.costOfEquityCAPM)}),c.jsx("div",{className:"text-sm text-green-600 mt-1",children:"CAPM method"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(b,{size:20,className:"text-purple-600"}),c.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"COST OF DEBT"})]}),c.jsx("div",{className:"text-2xl font-bold text-purple-800",children:l(x.costOfDebtAfterTax)}),c.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"After-tax"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(C,{size:20,className:"text-orange-600"}),c.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"DEBT/EQUITY"})]}),c.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[x.debtToEquityRatio.toFixed(2),"x"]}),c.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Capital structure"})]})]}),c.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:h.map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>d(e.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(o===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[c.jsx(s,{size:16}),e.label]},e.id)})}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["inputs"===o&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"WACC Input Parameters"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"Cost of Equity (CAPM Method)"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Risk-Free Rate (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.riskFreeRate||m.riskFreeRate,onChange:e=>u("riskFreeRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"10-year Treasury rate"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Risk Premium (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.marketRiskPremium||m.marketRiskPremium,onChange:e=>u("marketRiskPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Expected market return - risk-free rate"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beta (β)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.beta||m.beta,onChange:e=>u("beta",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Systematic risk relative to market"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Small Company Premium (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium,onChange:e=>u("smallCompanyPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Size-related risk premium"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company-Specific Risk (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.companySpecificRisk||m.companySpecificRisk,onChange:e=>u("companySpecificRisk",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Unsystematic risk premium"})]})]})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium mb-4 text-purple-800",children:"Capital Structure & Cost of Debt"}),c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Equity ($000s)"}),c.jsx("input",{type:"number",value:a.dcf.wacc?.marketValueEquity||m.marketValueEquity,onChange:e=>u("marketValueEquity",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Debt ($000s)"}),c.jsx("input",{type:"number",value:a.dcf.wacc?.marketValueDebt||m.marketValueDebt,onChange:e=>u("marketValueDebt",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre-Tax Cost of Debt (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.debtInterestRate||m.debtInterestRate,onChange:e=>u("debtInterestRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Interest rate on debt"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),c.jsx("input",{type:"number",step:"0.1",value:a.dcf.wacc?.taxRate||a.dcf.taxRate,onChange:e=>u("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),c.jsx("span",{className:"text-xs text-gray-500",children:"Corporate tax rate"})]}),c.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium mb-2",children:"Capital Structure"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Equity Weight:"}),c.jsx("span",{className:"font-medium",children:l(x.equityWeight)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Debt Weight:"}),c.jsx("span",{className:"font-medium",children:l(x.debtWeight)})]}),c.jsxs("div",{className:"flex justify-between border-t pt-2",children:[c.jsx("span",{children:"Total Capital:"}),c.jsxs("span",{className:"font-medium",children:["$",(x.totalCapital/1e3).toFixed(0),"M"]})]})]})]})]})]})]})]}),"calculation"===o&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"WACC Calculation Breakdown"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[c.jsxs("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200",children:[c.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"CAPM Method"}),c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Risk-Free Rate:"}),c.jsx("span",{className:"font-medium",children:l(a.dcf.wacc?.riskFreeRate||m.riskFreeRate)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Beta × Market Risk Premium:"}),c.jsx("span",{className:"font-medium",children:l((a.dcf.wacc?.beta||m.beta)*(a.dcf.wacc?.marketRiskPremium||m.marketRiskPremium))})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Small Company Premium:"}),c.jsx("span",{className:"font-medium",children:l(a.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Company-Specific Risk:"}),c.jsx("span",{className:"font-medium",children:l(a.dcf.wacc?.companySpecificRisk||m.companySpecificRisk)})]}),c.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[c.jsx("span",{children:"Cost of Equity (CAPM):"}),c.jsx("span",{children:l(x.costOfEquityCAPM)})]})]})]}),c.jsxs("div",{className:"p-6 bg-green-50 rounded-lg border border-green-200",children:[c.jsx("h5",{className:"font-medium mb-4 text-green-800",children:"Build-up Method"}),c.jsxs("div",{className:"space-y-3 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Risk-Free Rate:"}),c.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.riskFreeRate)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Equity Risk Premium:"}),c.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.equityRiskPremium)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Size Risk Premium:"}),c.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.sizeRiskPremium)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Industry Risk Premium:"}),c.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.industryRiskPremium)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Company-Specific Risk:"}),c.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.companySpecificRisk)})]}),c.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[c.jsx("span",{children:"Cost of Equity (Build-up):"}),c.jsx("span",{children:l(x.costOfEquityBuildUp)})]})]})]})]}),c.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[c.jsx("h5",{className:"font-medium mb-4",children:"Final WACC Calculation"}),c.jsxs("div",{className:"space-y-4 text-sm",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{children:"WACC (CAPM Method):"}),c.jsx("span",{className:"font-medium",children:l(x.waccCAPM)})]}),c.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityCAPM)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]}),c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between mb-2",children:[c.jsx("span",{children:"WACC (Build-up Method):"}),c.jsx("span",{className:"font-medium",children:l(x.waccBuildUp)})]}),c.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityBuildUp)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]})]}),c.jsxs("div",{className:"border-t pt-4",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("span",{className:"text-lg font-semibold",children:"Risk-Adjusted WACC:"}),c.jsx("span",{className:"text-2xl font-bold text-blue-600",children:l(x.finalWACC)})]}),c.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Average of CAPM and Build-up methods"})]})]})]})]}),"benchmarks"===o&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Industry Benchmarks & Validation"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Your Company"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"WACC:"}),c.jsx("span",{className:"font-semibold",children:l(x.finalWACC)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Beta:"}),c.jsx("span",{className:"font-semibold",children:(a.dcf.wacc?.beta||m.beta).toFixed(2)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"D/E Ratio:"}),c.jsxs("span",{className:"font-semibold",children:[x.debtToEquityRatio.toFixed(2),"x"]})]})]})]}),c.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium text-green-800 mb-2",children:"Industry Average"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"WACC:"}),c.jsx("span",{className:"font-semibold",children:l(m.industryWACC)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Beta:"}),c.jsx("span",{className:"font-semibold",children:m.industryBeta.toFixed(2)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"D/E Ratio:"}),c.jsxs("span",{className:"font-semibold",children:[m.industryDebtEquityRatio.toFixed(2),"x"]})]})]})]}),c.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Variance"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"WACC Diff:"}),c.jsxs("span",{className:"font-semibold "+(x.finalWACC>m.industryWACC?"text-red-600":"text-green-600"),children:[x.finalWACC>m.industryWACC?"+":"",l(x.finalWACC-m.industryWACC)]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Beta Diff:"}),c.jsxs("span",{className:"font-semibold "+((a.dcf.wacc?.beta||m.beta)>m.industryBeta?"text-red-600":"text-green-600"),children:[(a.dcf.wacc?.beta||m.beta)>m.industryBeta?"+":"",((a.dcf.wacc?.beta||m.beta)-m.industryBeta).toFixed(2)]})]})]})]})]}),c.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(B,{size:16,className:"text-blue-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Validation Guidelines"}),c.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[c.jsx("li",{children:"• WACC should be within ±2% of industry average for similar companies"}),c.jsx("li",{children:"• Beta should reflect business risk relative to market (typically 0.8-1.5 for most companies)"}),c.jsx("li",{children:"• Cost of equity should exceed risk-free rate by at least 4-6% for private companies"}),c.jsx("li",{children:"• Debt/equity ratio should align with industry norms and company strategy"}),c.jsx("li",{children:"• Consider economic conditions and company-specific factors"})]})]})]})})]})]})]})},De=({data:t,formatCurrency:l,formatPercent:n})=>{const[r,o]=e.useState("multiples"),[d,m]=e.useState("ev_revenue"),[x,u]=e.useState(!1),[g,p]=e.useState([{id:1,name:"MedSpa Corp",ticker:"MSPA",marketCap:45e4,enterpriseValue:52e4,revenue:18e4,ebitda:45e3,netIncome:28e3,employees:1200,founded:2015,geography:"US",businessModel:"B2C Medical Spa Chain"},{id:2,name:"Wellness Holdings",ticker:"WELL",marketCap:68e4,enterpriseValue:75e4,revenue:22e4,ebitda:55e3,netIncome:35e3,employees:1800,founded:2012,geography:"US",businessModel:"Integrated Wellness Platform"},{id:3,name:"Aesthetic Solutions Inc",ticker:"AEST",marketCap:32e4,enterpriseValue:38e4,revenue:125e3,ebitda:32e3,netIncome:18e3,employees:850,founded:2018,geography:"US",businessModel:"Medical Device & Services"},{id:4,name:"Premium Health Group",ticker:"PHG",marketCap:92e4,enterpriseValue:105e4,revenue:31e4,ebitda:78e3,netIncome:48e3,employees:2500,founded:2010,geography:"US",businessModel:"Premium Healthcare Services"}]),f=e.useMemo(()=>g.map(e=>({...e,multiples:{ev_revenue:e.enterpriseValue/e.revenue,ev_ebitda:e.enterpriseValue/e.ebitda,pe_ratio:e.marketCap/e.netIncome,revenue_per_employee:e.revenue/e.employees,market_cap_revenue:e.marketCap/e.revenue}})),[g]),y=e.useMemo(()=>{const e=f.map(e=>e.multiples),s=e=>({mean:e.reduce((e,s)=>e+s,0)/e.length,median:e.sort((e,s)=>e-s)[Math.floor(e.length/2)],min:Math.min(...e),max:Math.max(...e),p25:e.sort((e,s)=>e-s)[Math.floor(.25*e.length)],p75:e.sort((e,s)=>e-s)[Math.floor(.75*e.length)]});return{ev_revenue:s(e.map(e=>e.ev_revenue)),ev_ebitda:s(e.map(e=>e.ev_ebitda)),pe_ratio:s(e.map(e=>e.pe_ratio)),revenue_per_employee:s(e.map(e=>e.revenue_per_employee)),market_cap_revenue:s(e.map(e=>e.market_cap_revenue))}},[f]),v=e.useMemo(()=>{const e=t.statements.incomeStatement.totalRevenue?.[1]||1e5,s=1.15*(t.statements.incomeStatement.operatingIncome?.[1]||5e4),a=.7*(t.statements.incomeStatement.operatingIncome?.[1]||5e4);return{ev_revenue:{mean:e*y.ev_revenue.mean,median:e*y.ev_revenue.median,p25:e*y.ev_revenue.p25,p75:e*y.ev_revenue.p75},ev_ebitda:{mean:s*y.ev_ebitda.mean,median:s*y.ev_ebitda.median,p25:s*y.ev_ebitda.p25,p75:s*y.ev_ebitda.p75},pe_ratio:{mean:a*y.pe_ratio.mean,median:a*y.pe_ratio.median,p25:a*y.pe_ratio.p25,p75:a*y.pe_ratio.p75}}},[t,y]),j={ev_revenue:{name:"EV/Revenue",description:"Enterprise Value / Annual Revenue"},ev_ebitda:{name:"EV/EBITDA",description:"Enterprise Value / EBITDA"},pe_ratio:{name:"P/E Ratio",description:"Market Cap / Net Income"},revenue_per_employee:{name:"Revenue/Employee",description:"Revenue per Employee"},market_cap_revenue:{name:"Market Cap/Revenue",description:"Market Cap / Revenue"}},N=[{id:"multiples",label:"Trading Multiples",icon:a},{id:"analysis",label:"Valuation Analysis",icon:i},{id:"companies",label:"Comparable Set",icon:h}];return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[c.jsx(h,{size:20}),"Comparable Company Analysis"]}),c.jsx("p",{className:"text-gray-600",children:"Market-based valuation using trading multiples from similar public companies."})]}),c.jsx("div",{className:"flex gap-2",children:c.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",children:[c.jsx(I,{size:16}),"Add Comparable"]})})]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs(G.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(a,{size:20,className:"text-blue-600"}),c.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EV/REVENUE"})]}),c.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[y.ev_revenue.median.toFixed(1),"x"]}),c.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Median multiple"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(s,{size:20,className:"text-green-600"}),c.jsx("span",{className:"text-xs text-green-600 font-medium",children:"IMPLIED VALUE"})]}),c.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(v.ev_revenue.median)}),c.jsx("div",{className:"text-sm text-green-600 mt-1",children:"EV/Revenue basis"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(b,{size:20,className:"text-purple-600"}),c.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"VALUATION RANGE"})]}),c.jsxs("div",{className:"text-lg font-bold text-purple-800",children:[l(v.ev_revenue.p25)," - ",l(v.ev_revenue.p75)]}),c.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"25th - 75th percentile"})]}),c.jsxs(G.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx(h,{size:20,className:"text-orange-600"}),c.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"PEER COUNT"})]}),c.jsx("div",{className:"text-2xl font-bold text-orange-800",children:g.length}),c.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Comparable companies"})]})]}),c.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:N.map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>o(e.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(r===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[c.jsx(s,{size:16}),e.label]},e.id)})}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["multiples"===r&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Trading Multiples Analysis"}),c.jsx("select",{value:d,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(j).map(([e,s])=>c.jsx("option",{value:e,children:s.name},e))})]}),c.jsx("div",{className:"overflow-x-auto",children:c.jsxs("table",{className:"w-full text-sm",children:[c.jsx("thead",{children:c.jsxs("tr",{className:"border-b bg-gray-50",children:[c.jsx("th",{className:"text-left p-3 font-medium",children:"Company"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"Market Cap"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"Enterprise Value"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"EV/Revenue"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"EV/EBITDA"}),c.jsx("th",{className:"text-right p-3 font-medium",children:"P/E Ratio"})]})}),c.jsxs("tbody",{children:[f.map((e,s)=>c.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[c.jsx("td",{className:"p-3",children:c.jsxs("div",{children:[c.jsx("div",{className:"font-medium",children:e.name}),c.jsx("div",{className:"text-xs text-gray-500",children:e.ticker})]})}),c.jsx("td",{className:"p-3 text-right",children:l(e.marketCap)}),c.jsx("td",{className:"p-3 text-right",children:l(e.enterpriseValue)}),c.jsx("td",{className:"p-3 text-right",children:l(e.revenue)}),c.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.ev_revenue.toFixed(1),"x"]}),c.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.ev_ebitda.toFixed(1),"x"]}),c.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.pe_ratio.toFixed(1),"x"]})]},e.id)),c.jsxs("tr",{className:"border-t-2 border-gray-300 bg-blue-50 font-semibold",children:[c.jsx("td",{className:"p-3",children:"Market Statistics"}),c.jsx("td",{className:"p-3"}),c.jsx("td",{className:"p-3"}),c.jsx("td",{className:"p-3"}),c.jsxs("td",{className:"p-3 text-right",children:[y.ev_revenue.median.toFixed(1),"x"]}),c.jsxs("td",{className:"p-3 text-right",children:[y.ev_ebitda.median.toFixed(1),"x"]}),c.jsxs("td",{className:"p-3 text-right",children:[y.pe_ratio.median.toFixed(1),"x"]})]})]})]})}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium mb-3",children:"Multiple Distribution"}),c.jsx("div",{className:"space-y-3",children:Object.entries(y).slice(0,3).map(([e,s])=>c.jsxs("div",{children:[c.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[c.jsx("span",{children:j[e].name}),c.jsxs("span",{className:"font-medium",children:[s.median.toFixed(1),"x"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:(s.median-s.min)/(s.max-s.min)*100+"%"}})}),c.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[c.jsxs("span",{children:[s.min.toFixed(1),"x"]}),c.jsxs("span",{children:[s.max.toFixed(1),"x"]})]})]},e))})]}),c.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[c.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Companies Analyzed:"}),c.jsx("span",{className:"font-medium",children:g.length})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Median Market Cap:"}),c.jsx("span",{className:"font-medium",children:l(g.sort((e,s)=>e.marketCap-s.marketCap)[Math.floor(g.length/2)]?.marketCap||0)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Median Revenue:"}),c.jsx("span",{className:"font-medium",children:l(g.sort((e,s)=>e.revenue-s.revenue)[Math.floor(g.length/2)]?.revenue||0)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Avg Founded Year:"}),c.jsx("span",{className:"font-medium",children:Math.round(g.reduce((e,s)=>e+s.founded,0)/g.length)})]})]})]})]})]}),"analysis"===r&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Valuation Analysis"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium mb-4",children:"Implied Valuation by Multiple"}),c.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([e,s])=>c.jsxs("div",{className:"p-4 border rounded-lg",children:[c.jsxs("div",{className:"flex justify-between items-center mb-2",children:[c.jsx("span",{className:"font-medium",children:j[e].name}),c.jsxs("span",{className:"text-sm text-gray-500",children:[y[e].median.toFixed(1),"x median"]})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"25th Percentile:"}),c.jsx("span",{className:"font-medium",children:l(s.p25)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Median:"}),c.jsx("span",{className:"font-bold text-blue-600",children:l(s.median)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"75th Percentile:"}),c.jsx("span",{className:"font-medium",children:l(s.p75)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Mean:"}),c.jsx("span",{className:"font-medium",children:l(s.mean)})]})]})]},e))})]}),c.jsxs("div",{children:[c.jsx("h5",{className:"font-medium mb-4",children:"Valuation Summary"}),c.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Recommended Range"}),c.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[l((v.ev_revenue.p25+v.ev_ebitda.p25)/2)," -",l((v.ev_revenue.p75+v.ev_ebitda.p75)/2)]}),c.jsx("div",{className:"text-sm text-blue-600",children:"Blended 25th-75th percentile"})]}),c.jsxs("div",{children:[c.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Midpoint Valuation"}),c.jsx("div",{className:"text-xl font-bold text-blue-800",children:l((v.ev_revenue.median+v.ev_ebitda.median)/2)}),c.jsx("div",{className:"text-sm text-blue-600",children:"Average of median multiples"})]})]})}),c.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:c.jsxs("div",{className:"flex items-start gap-2",children:[c.jsx(i,{size:16,className:"text-yellow-600 mt-0.5"}),c.jsxs("div",{children:[c.jsx("h6",{className:"font-medium text-yellow-800 mb-1",children:"Valuation Considerations"}),c.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[c.jsx("li",{children:"• Consider company-specific growth and margin profiles"}),c.jsx("li",{children:"• Adjust for differences in business model and scale"}),c.jsx("li",{children:"• Factor in market conditions and sector trends"}),c.jsx("li",{children:"• Apply appropriate discount for private company liquidity"})]})]})]})})]})]})]}),"companies"===r&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Comparable Company Set"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsxs("div",{className:"relative",children:[c.jsx(L,{size:16,className:"absolute left-3 top-3 text-gray-400"}),c.jsx("input",{type:"text",placeholder:"Search companies...",className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("button",{className:"px-3 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[c.jsx(z,{size:16}),"Filter"]})]})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:g.map(e=>c.jsxs(G.div,{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[c.jsxs("div",{className:"flex justify-between items-start mb-3",children:[c.jsxs("div",{children:[c.jsx("h6",{className:"font-semibold text-gray-800",children:e.name}),c.jsxs("div",{className:"text-sm text-gray-500",children:[e.ticker," • ",e.geography]})]}),c.jsx("button",{onClick:()=>{return s=e.id,void p(g.filter(e=>e.id!==s));var s},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:"×"})]}),c.jsxs("div",{className:"space-y-2 text-sm",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Market Cap:"}),c.jsx("span",{className:"font-medium",children:l(e.marketCap)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Revenue:"}),c.jsx("span",{className:"font-medium",children:l(e.revenue)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"EV/Revenue:"}),c.jsxs("span",{className:"font-medium",children:[(e.enterpriseValue/e.revenue).toFixed(1),"x"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Founded:"}),c.jsx("span",{className:"font-medium",children:e.founded})]})]}),c.jsx("div",{className:"mt-3 pt-3 border-t",children:c.jsx("div",{className:"text-xs text-gray-600",children:e.businessModel})})]},e.id))})]})]}),x&&c.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:c.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[c.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Add Comparable Company"}),c.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=new FormData(e.target);(e=>{const s={id:Date.now(),...e,marketCap:parseFloat(e.marketCap)||0,enterpriseValue:parseFloat(e.enterpriseValue)||0,revenue:parseFloat(e.revenue)||0,ebitda:parseFloat(e.ebitda)||0,netIncome:parseFloat(e.netIncome)||0,employees:parseInt(e.employees)||0,founded:parseInt(e.founded)||(new Date).getFullYear()};p([...g,s]),u(!1)})(Object.fromEntries(s))},children:[c.jsxs("div",{className:"space-y-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),c.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker"}),c.jsx("input",{name:"ticker",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Cap ($000s)"}),c.jsx("input",{name:"marketCap",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enterprise Value ($000s)"}),c.jsx("input",{name:"enterpriseValue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue ($000s)"}),c.jsx("input",{name:"revenue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA ($000s)"}),c.jsx("input",{name:"ebitda",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Model"}),c.jsx("input",{name:"businessModel",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsxs("div",{className:"flex gap-3 mt-6",children:[c.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Company"}),c.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})},Te=({data:t,modelInputs:i,onModelInputChange:l,calculateDCF:n,formatCurrency:r,formatPercent:o})=>{const[d,m]=e.useState(!1),x=i.scenario?.scenarios||[],u=e.useMemo(()=>x.map(e=>{try{const s={...t.statements.incomeStatement},a=s.totalRevenue||{},i={};Object.keys(a).forEach(s=>{const t=parseInt(s);if(0===t)i[s]=a[s];else{const l=1+e.revenueGrowth/100;i[s]=a[0]*Math.pow(l,t)}});const l=s.operatingIncome||{},r={};Object.keys(l).forEach(s=>{if(0===parseInt(s))r[s]=l[s];else{const t=a[s]||0,n=i[s]||0,o=l[s]||0;if(t>0){const a=o/t+e.marginImprovement/100;r[s]=n*a}else r[s]=o}});const o={...t,statements:{...t.statements,incomeStatement:{...s,totalRevenue:i,operatingIncome:r}}},c=n(o);return{...e,...c,weightedValue:c.enterpriseValue*(e.probability/100)}}catch(s){return{...e,enterpriseValue:0,equityValue:0,weightedValue:0}}}),[x,t,n]),h=u.reduce((e,s)=>e+s.weightedValue,0),g=(e,s,t)=>{const a=x.map((a,i)=>i===e?{...a,[s]:t}:a);l("scenario","scenarios",a)},b=({scenario:e,index:s})=>c.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name"}),c.jsx("input",{type:"text",value:e.name,onChange:e=>g(s,"name",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter scenario name"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probability (%)"}),c.jsx("input",{type:"number",min:"0",max:"100",value:e.probability,onChange:e=>g(s,"probability",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue Growth (%)"}),c.jsx("input",{type:"number",step:"0.1",value:e.revenueGrowth,onChange:e=>g(s,"revenueGrowth",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margin Change (%)"}),c.jsx("input",{type:"number",step:"0.1",value:e.marginImprovement,onChange:e=>g(s,"marginImprovement",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),c.jsx("div",{className:"flex justify-end mt-4 gap-2",children:c.jsxs("button",{onClick:()=>(e=>{const s=x.filter((s,t)=>t!==e);l("scenario","scenarios",s)})(s),className:"px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-1",children:[c.jsx(_,{size:16}),"Delete"]})})]});return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-center",children:[c.jsx("div",{children:c.jsx("p",{className:"text-gray-600",children:"Create and compare multiple financial scenarios with different assumptions and probabilities."})}),c.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[c.jsx(I,{size:16}),"Add Scenario"]})]}),c.jsxs("div",{className:"space-y-4",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Assumptions"}),x.map((e,s)=>c.jsx(b,{scenario:e,index:s},s)),d&&c.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-4",children:c.jsxs("div",{className:"flex justify-between items-center mb-4",children:[c.jsx("h5",{className:"font-medium",children:"Add New Scenario"}),c.jsxs("div",{className:"flex gap-2",children:[c.jsx("button",{onClick:()=>{const e={name:`Scenario ${x.length+1}`,probability:Math.max(0,100-x.reduce((e,s)=>e+s.probability,0)),revenueGrowth:10,marginImprovement:0};l("scenario","scenarios",[...x,e]),m(!1)},className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add"}),c.jsx("button",{onClick:()=>m(!1),className:"px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})]}),u.length>0&&c.jsxs("div",{className:"space-y-6",children:[c.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Analysis Results"}),c.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[c.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[c.jsx(a,{size:20,className:"text-blue-600"}),c.jsx("h5",{className:"font-semibold text-blue-800",children:"Probability-Weighted Valuation"})]}),c.jsx("div",{className:"text-3xl font-bold text-blue-800",children:r(h)}),c.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Expected value based on scenario probabilities"})]}),c.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:u.map((e,t)=>c.jsxs(G.div,{className:"bg-white rounded-lg border p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[c.jsx("div",{className:"flex items-start justify-between mb-3",children:c.jsxs("div",{children:[c.jsx("h6",{className:"font-semibold text-gray-800",children:e.name}),c.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[c.jsxs("span",{children:[e.probability,"% probability"]}),e.revenueGrowth>15?c.jsx(s,{size:14,className:"text-green-500"}):e.revenueGrowth<5?c.jsx(y,{size:14,className:"text-red-500"}):c.jsx(k,{size:14,className:"text-gray-500"})]})]})}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[c.jsx("div",{className:"text-sm text-gray-600",children:"Enterprise Value"}),c.jsx("div",{className:"text-xl font-bold text-gray-800",children:r(e.enterpriseValue)})]}),c.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Revenue Growth:"}),c.jsx("span",{className:"font-medium",children:o(e.revenueGrowth)})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Margin Change:"}),c.jsxs("span",{className:"font-medium "+(e.marginImprovement>=0?"text-green-600":"text-red-600"),children:[e.marginImprovement>=0?"+":"",o(e.marginImprovement)]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{children:"Weighted Value:"}),c.jsx("span",{className:"font-medium",children:r(e.weightedValue)})]})]})]})]},t))}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsx("h5",{className:"font-semibold mb-4",children:"Scenario Statistics"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-green-600",children:r(Math.max(...u.map(e=>e.enterpriseValue)))}),c.jsx("div",{className:"text-sm text-gray-600",children:"Best Case"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-red-600",children:r(Math.min(...u.map(e=>e.enterpriseValue)))}),c.jsx("div",{className:"text-sm text-gray-600",children:"Worst Case"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:r(h)}),c.jsx("div",{className:"text-sm text-gray-600",children:"Expected Value"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-gray-800",children:r(Math.max(...u.map(e=>e.enterpriseValue))-Math.min(...u.map(e=>e.enterpriseValue)))}),c.jsx("div",{className:"text-sm text-gray-600",children:"Value Range"})]})]}),c.jsx("div",{className:"mt-4 pt-4 border-t",children:c.jsxs("div",{className:"text-sm text-gray-600",children:[c.jsx("strong",{children:"Total Probability:"})," ",x.reduce((e,s)=>e+s.probability,0),"%",100!==x.reduce((e,s)=>e+s.probability,0)&&c.jsx("span",{className:"text-orange-600 ml-2",children:"⚠ Probabilities should sum to 100%"})]})})]})]}),0===x.length&&c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx(a,{size:48,className:"mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"No scenarios created yet."}),c.jsx("p",{className:"text-sm mt-2",children:'Click "Add Scenario" to get started with scenario modeling.'})]})]})},Ve=({data:s,modelInputs:t,onModelInputChange:i,calculateDCF:l,formatCurrency:n,formatPercent:r})=>{const[o,d]=e.useState(null),m=t.sensitivity||{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},x={revenue:{name:"Revenue Growth",unit:"%",description:"Annual revenue growth rate",baseValue:15,isPercentage:!0},grossMargin:{name:"Gross Margin",unit:"%",description:"Gross profit margin improvement",baseValue:45,isPercentage:!0},discountRate:{name:"Discount Rate (WACC)",unit:"%",description:"Weighted average cost of capital",baseValue:t.dcf?.discountRate||10,isPercentage:!0},terminalGrowthRate:{name:"Terminal Growth Rate",unit:"%",description:"Long-term growth rate assumption",baseValue:t.dcf?.terminalGrowthRate||2.5,isPercentage:!0},taxRate:{name:"Tax Rate",unit:"%",description:"Corporate tax rate",baseValue:t.dcf?.taxRate||25,isPercentage:!0}},u=e.useMemo(()=>l(),[s,t,l]),h=e.useMemo(()=>{const e={};return m.variables.forEach(a=>{const i=m.ranges[a],l=x[a];if(!i||!l)return;const n=(i.max-i.min)/8,r=[];for(let e=0;e<9;e++){const o=i.min+n*e;let c={...s};const d={...t.dcf,[a]:(l.isPercentage,o)};if("revenue"===a||"grossMargin"===a){const e={...s.statements.incomeStatement};if("revenue"===a){const s=e.totalRevenue||{},t={};Object.keys(s).forEach(e=>{const a=parseInt(e);if(0===a)t[e]=s[e];else{const i=1+o/100;t[e]=s[0]*Math.pow(i,a)}}),e.totalRevenue=t}if("grossMargin"===a){const s=e.operatingIncome||{},t=e.totalRevenue||{},a={};Object.keys(s).forEach(e=>{const i=t[e]||0,l=s[e]||0;if(i>0){const s=l/i+o/100;a[e]=i*s}else a[e]=l}),e.operatingIncome=a}c={...s,statements:{...s.statements,incomeStatement:e}}}const m=(()=>{try{const e={discountRate:d.discountRate||10,terminalGrowthRate:d.terminalGrowthRate||2.5,projectionYears:d.projectionYears||5,taxRate:d.taxRate||25},s=c.statements.incomeStatement.operatingIncome||{},t=[];if(Object.keys(s).forEach(e=>{parseInt(e)>=0&&t.push(s[e]||0)}),0===t.length)return{enterpriseValue:0,equityValue:0};let a=0;const i=1+e.discountRate/100;t.forEach((s,t)=>{if(t>0&&t<=e.projectionYears){const l=s*(1-e.taxRate/100)/Math.pow(i,t);a+=l}});const l=(t[t.length-1]||0)*(1+e.terminalGrowthRate/100)*(1-e.taxRate/100)/((e.discountRate-e.terminalGrowthRate)/100),n=l/Math.pow(i,e.projectionYears),r=a+n;return{enterpriseValue:r,equityValue:r,presentValueOperations:a,presentValueTerminal:n,terminalValue:l}}catch(e){return{enterpriseValue:0,equityValue:0}}})();r.push({variable:o,valuation:m.enterpriseValue,changeFromBase:(m.enterpriseValue-u.enterpriseValue)/u.enterpriseValue*100})}e[a]={definition:l,range:i,dataPoints:r}}),e},[s,t,m,u,l]),b=e.useMemo(()=>Object.entries(h).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>Math.abs(e.changeFromBase)));return{variable:e,definition:s.definition,maxImpact:t,positiveImpact:Math.max(...s.dataPoints.map(e=>e.changeFromBase)),negativeImpact:Math.min(...s.dataPoints.map(e=>e.changeFromBase))}}).sort((e,s)=>s.maxImpact-e.maxImpact),[h]),p=(e,s,t)=>{const a={...m.ranges,[e]:{...m.ranges[e],[s]:parseFloat(t)}};i("sensitivity","ranges",a)};return c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"flex justify-between items-start",children:[c.jsxs("div",{children:[c.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze how changes in key variables impact enterprise valuation. Higher sensitivity indicates greater risk and importance for due diligence."}),c.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),c.jsxs("span",{children:["Base Case: ",n(u.enterpriseValue)]})]}),c.jsxs("div",{className:"flex items-center gap-2",children:[c.jsx(g,{size:14}),c.jsxs("span",{children:[m.variables.length," variables analyzed"]})]})]})]}),c.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[c.jsx(F,{size:16}),"Configure"]})]}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsxs("h4",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[c.jsx(a,{size:20}),"Impact Ranking (Tornado Chart)"]}),c.jsx("div",{className:"space-y-3",children:b.map((e,s)=>c.jsxs("div",{className:"relative",children:[c.jsxs("div",{className:"flex items-center justify-between mb-1",children:[c.jsxs("span",{className:"text-sm font-medium",children:[s+1,". ",e.definition.name]}),c.jsxs("span",{className:"text-xs text-gray-500",children:["±",e.maxImpact.toFixed(1),"%"]})]}),c.jsxs("div",{className:"relative h-8 bg-gray-100 rounded",children:[c.jsx("div",{className:"absolute left-1/2 h-full bg-red-400 rounded-l",style:{width:Math.abs(e.negativeImpact)/Math.max(Math.abs(e.negativeImpact),e.positiveImpact)*50+"%",transform:"translateX(-100%)"}}),c.jsx("div",{className:"absolute left-1/2 h-full bg-green-400 rounded-r",style:{width:e.positiveImpact/Math.max(Math.abs(e.negativeImpact),e.positiveImpact)*50+"%"}}),c.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-400 transform -translate-x-0.5"}),c.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-2 text-xs font-medium text-white",children:[c.jsxs("span",{children:[e.negativeImpact.toFixed(1),"%"]}),c.jsxs("span",{children:["+",e.positiveImpact.toFixed(1),"%"]})]})]})]},e.variable))})]}),c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Variable Configuration"}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.variables.map(e=>{const s=h[e];return s?c.jsxs("div",{className:"border rounded-lg p-4",children:[c.jsxs("div",{className:"flex items-center justify-between mb-3",children:[c.jsxs("div",{children:[c.jsx("h6",{className:"font-medium",children:s.definition.name}),c.jsx("p",{className:"text-xs text-gray-500",children:s.definition.description})]}),c.jsx("button",{onClick:()=>(e=>{const s=m.variables.filter(s=>s!==e),{[e]:t,...a}=m.ranges;i("sensitivity","variables",s),i("sensitivity","ranges",a)})(e),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:c.jsx(k,{size:16})})]}),c.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Min Value (",s.definition.unit,")"]}),c.jsx("input",{type:"number",step:"0.1",value:s.range.min,onChange:s=>p(e,"min",s.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),c.jsxs("div",{children:[c.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Max Value (",s.definition.unit,")"]}),c.jsx("input",{type:"number",step:"0.1",value:s.range.max,onChange:s=>p(e,"max",s.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),c.jsxs("div",{className:"h-16 bg-gray-50 rounded p-2",children:[c.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Valuation Sensitivity"}),c.jsx("div",{className:"flex items-end justify-between h-8",children:s.dataPoints.map((e,t)=>c.jsx("div",{className:"w-1 rounded-t "+(e.changeFromBase>0?"bg-green-400":e.changeFromBase<0?"bg-red-400":"bg-blue-400"),style:{height:Math.abs(e.changeFromBase)/50*100+"%",minHeight:"2px"},title:`${e.variable}${s.definition.unit}: ${n(e.valuation)}`},t))})]})]},e):null}),c.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center",children:c.jsxs("div",{className:"text-center",children:[c.jsx(I,{size:24,className:"mx-auto mb-2 text-gray-400"}),c.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add Variable"}),c.jsx("div",{className:"space-y-2",children:Object.keys(x).filter(e=>!m.variables.includes(e)).map(e=>c.jsx("button",{onClick:()=>(e=>{if(!m.variables.includes(e)&&x[e]){const s=[...m.variables,e],t={...m.ranges,[e]:{min:-10,max:10}};i("sensitivity","variables",s),i("sensitivity","ranges",t)}})(e),className:"block w-full px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:x[e].name},e))})]})})]})]}),o&&h[o]&&c.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[c.jsxs("h4",{className:"font-semibold text-lg mb-4",children:["Detailed Analysis: ",h[o].definition.name]}),c.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[c.jsxs("div",{children:[c.jsx("h6",{className:"font-medium mb-3",children:"Data Points"}),c.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:h[o].dataPoints.map((e,s)=>c.jsxs("div",{className:"flex justify-between items-center text-sm p-2 bg-gray-50 rounded",children:[c.jsxs("span",{children:[e.variable,h[o].definition.unit]}),c.jsx("span",{className:"font-medium",children:n(e.valuation)}),c.jsxs("span",{className:"font-medium "+(e.changeFromBase>0?"text-green-600":e.changeFromBase<0?"text-red-600":"text-gray-600"),children:[e.changeFromBase>0?"+":"",e.changeFromBase.toFixed(1),"%"]})]},s))})]}),c.jsxs("div",{children:[c.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),c.jsxs("div",{className:"space-y-3",children:[c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Range Impact:"}),c.jsxs("span",{className:"font-medium",children:["±",Math.max(...h[o].dataPoints.map(e=>Math.abs(e.changeFromBase))).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Max Upside:"}),c.jsxs("span",{className:"font-medium text-green-600",children:["+",Math.max(...h[o].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]}),c.jsxs("div",{className:"flex justify-between",children:[c.jsx("span",{className:"text-sm text-gray-600",children:"Max Downside:"}),c.jsxs("span",{className:"font-medium text-red-600",children:[Math.min(...h[o].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]})]})]})]})]})]})},Oe=Object.freeze(Object.defineProperty({__proto__:null,default:({data:s,adjustedValues:t,onDataChange:l})=>{const[n,o]=e.useState("dcf"),[d,m]=e.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,terminalValueMultiple:10,taxRate:25,sharesOutstanding:1e3,workingCapital:{receivablesDays:45,inventoryDays:60,payablesDays:30,receivablesGrowth:2,inventoryGrowth:1.5,payablesGrowth:1.8},capex:{capexAsPercentOfRevenue:3.5,depreciationRate:7,maintenanceCapex:2}},ratios:{compareToIndustry:!0,industryAverages:{grossMargin:45,operatingMargin:15,netMargin:8,currentRatio:2.1,debtToEquity:.5}},sensitivity:{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},scenario:{scenarios:[{name:"Base Case",probability:50,revenueGrowth:15,marginImprovement:0},{name:"Bull Case",probability:25,revenueGrowth:25,marginImprovement:2},{name:"Bear Case",probability:25,revenueGrowth:5,marginImprovement:-2}]}}),x=e.useMemo(()=>{const e=s.statements.incomeStatement,a=s.periods,i={revenue:[],grossProfit:[],operatingIncome:[],margins:{gross:[],operating:[],net:[]},growth:{revenue:[],operating:[]}};return a.forEach((s,l)=>{const n=l===a.length-1,r=n&&t?.totalRevenue?t.totalRevenue:e.totalRevenue?.[l]||0,o=n&&t?.totalCostOfGoodsSold?t.totalCostOfGoodsSold:e.totalCostOfGoodsSold?.[l]||0,c=n&&t?.grossProfit?t.grossProfit:e.grossProfit?.[l]||r-o,d=n&&t?.operatingIncome?t.operatingIncome:e.operatingIncome?.[l]||0;if(i.revenue.push(r),i.grossProfit.push(c),i.operatingIncome.push(d),i.margins.gross.push(r?c/r*100:0),i.margins.operating.push(r?d/r*100:0),l>0){const s=e.totalRevenue?.[l-1]||0,t=e.operatingIncome?.[l-1]||0;i.growth.revenue.push(s?(r-s)/s*100:0),i.growth.operating.push(t?(d-t)/t*100:0)}}),i},[s]),u=(e=null)=>{const{discountRate:t,terminalGrowthRate:a,projectionYears:i,taxRate:l}=d.dcf,n=e||s;let r;if(e?(r=[],n.periods.forEach((e,s)=>{s>0&&s<=i&&r.push(n.statements.incomeStatement.operatingIncome?.[s]||0)})):r=x.operatingIncome.slice(1,i+1),0===r.length)return{enterpriseValue:0,equityValue:0,sharePrice:0};let o=0;const c=1+t/100;r.forEach((e,s)=>{const t=e*(1-l/100)/Math.pow(c,s+1);o+=t});const m=(r[r.length-1]||0)*(1+a/100)*(1-l/100)/((t-a)/100),u=m/Math.pow(c,i),h=o+u;return{enterpriseValue:h,equityValue:h,presentValueOperations:o,presentValueTerminal:u,terminalValue:m}};u();const p=[{id:"dcf",label:"DCF Valuation",icon:b,description:"Discounted Cash Flow analysis"},{id:"ratios",label:"Ratio Analysis",icon:a,description:"Financial ratio comparison"},{id:"sensitivity",label:"Sensitivity Analysis",icon:g,description:"Variable impact analysis"},{id:"scenario",label:"Scenario Modeling",icon:i,description:"Multi-scenario projections"},{id:"comparable",label:"Comparable Analysis",icon:h,description:"Market-based valuation"},{id:"montecarlo",label:"Monte Carlo",icon:r,description:"Probabilistic risk analysis"}],f=(e,s,t)=>{m(a=>({...a,[e]:{...a[e],[s]:t}}))},y=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e),v=e=>`${e.toFixed(1)}%`;return c.jsxs("div",{className:"h-full bg-gray-900 text-white p-6",children:[c.jsxs("div",{className:"mb-8",children:[c.jsx("div",{className:"flex items-center justify-between mb-6",children:c.jsxs("div",{children:[c.jsx("h2",{className:"text-xl font-semibold text-white",children:"Financial Modeling"}),c.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a modeling approach to analyze your financial data"})]})}),c.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:p.map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>o(e.id),className:(n===e.id?"bg-blue-600 text-white border-blue-500 shadow-lg":"bg-gray-800 text-gray-300 border-gray-700 hover:bg-gray-700 hover:text-white hover:border-gray-600")+" flex items-center gap-3 px-4 py-3 rounded-lg border transition-all duration-200",children:[c.jsx(s,{size:18,className:n===e.id?"text-white":"text-blue-400"}),c.jsx("span",{className:"font-medium",children:e.label})]},e.id)})}),c.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:c.jsxs("div",{className:"flex items-center gap-3",children:[O.createElement(p.find(e=>e.id===n)?.icon,{size:20,className:"text-blue-400"}),c.jsxs("div",{children:[c.jsx("h3",{className:"font-medium text-white",children:p.find(e=>e.id===n)?.label}),c.jsx("p",{className:"text-gray-400 text-sm",children:p.find(e=>e.id===n)?.description})]})]})})]}),c.jsxs("div",{children:["dcf"===n&&c.jsxs("div",{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[c.jsx(b,{size:20,className:"text-blue-400"}),"DCF Valuation Model"]}),c.jsx(re,{data:s,modelInputs:d,onModelInputChange:f,formatCurrency:y,formatPercent:v})]}),"ratios"===n&&c.jsxs("div",{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[c.jsx(a,{size:20}),"Financial Ratio Analysis"]}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Profitability Ratios"}),c.jsxs("div",{className:"space-y-3",children:[x.margins.gross.map((e,t)=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{className:"text-sm",children:[s.periods[t+1]," Gross Margin:"]}),c.jsx("span",{className:"font-medium",children:v(e)})]},t)),x.margins.operating.map((e,t)=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{className:"text-sm",children:[s.periods[t+1]," Operating Margin:"]}),c.jsx("span",{className:"font-medium",children:v(e)})]},t))]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Growth Rates"}),c.jsxs("div",{className:"space-y-3",children:[x.growth.revenue.map((e,t)=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{className:"text-sm",children:[s.periods[t+1]," Revenue Growth:"]}),c.jsx("span",{className:"font-medium "+(e>=0?"text-green-600":"text-red-600"),children:v(e)})]},t)),x.growth.operating.map((e,t)=>c.jsxs("div",{className:"flex justify-between",children:[c.jsxs("span",{className:"text-sm",children:[s.periods[t+1]," Operating Growth:"]}),c.jsx("span",{className:"font-medium "+(e>=0?"text-green-600":"text-red-600"),children:v(e)})]},t))]})]}),c.jsxs("div",{children:[c.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Industry Comparison"}),c.jsx("div",{className:"space-y-3",children:c.jsxs("div",{className:"p-3 bg-gray-700 rounded-lg",children:[c.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Industry Avg"}),c.jsxs("div",{className:"text-sm",children:["Gross Margin: ",v(d.ratios.industryAverages.grossMargin)]}),c.jsxs("div",{className:"text-sm",children:["Operating Margin: ",v(d.ratios.industryAverages.operatingMargin)]}),c.jsxs("div",{className:"text-sm",children:["Net Margin: ",v(d.ratios.industryAverages.netMargin)]})]})})]})]})]}),"sensitivity"===n&&c.jsxs("div",{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[c.jsx(g,{size:20}),"Sensitivity Analysis"]}),c.jsx(Ve,{data:s,modelInputs:d,onModelInputChange:f,calculateDCF:u,formatCurrency:y,formatPercent:v})]}),"scenario"===n&&c.jsxs("div",{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[c.jsx(i,{size:20}),"Scenario Modeling"]}),c.jsx(Te,{data:s,modelInputs:d,onModelInputChange:f,calculateDCF:u,formatCurrency:y,formatPercent:v})]}),"comparable"===n&&c.jsx("div",{className:"p-6",children:c.jsx(De,{data:s,formatCurrency:y,formatPercent:v})}),"montecarlo"===n&&c.jsxs("div",{className:"p-6",children:[c.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[c.jsx(r,{size:20}),"Monte Carlo Simulation"]}),c.jsx(oe,{data:s,onDataChange:l})]})]})]})}},Symbol.toStringTag,{value:"Module"})),qe=Object.freeze(Object.defineProperty({__proto__:null,default:({data:t,dcfResults:a,lboResults:l,financialModel:n,scenarioResults:o,onDataChange:d})=>{const[m,x]=e.useState("unified"),[u,h]=e.useState({iterations:1e4,confidenceLevel:.95,correlationsEnabled:!0,crossModelAnalysis:!0,riskMetrics:["var","cvar","downside"]}),[b,p]=e.useState(null),[f,y]=e.useState(!1),[v,j]=e.useState(0),N=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",[]),w=e.useCallback(e=>`${(100*e).toFixed(1)}%`,[]),C=e.useCallback(async()=>{y(!0),j(0);try{const e={dcf:null,lbo:null,correlation:null,portfolio:null,riskMetrics:null};if(a&&u.crossModelAnalysis){const s={revenueGrowthRate:{type:"normal",parameters:{mean:.05,stdDev:.02},enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.1,mode:.15,max:.2},enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},enabled:!0}},i={currentRevenue:1e3*t?.statements?.incomeStatement?.totalRevenue?.[0]||1e6,currentPrice:100,sharesOutstanding:1e6,...a};j(25),e.dcf=await ce.runDCFSimulation(i,s,{iterations:u.iterations,confidenceLevel:u.confidenceLevel,onProgress:e=>j(25+.25*e)})}if(l&&u.crossModelAnalysis){const s={ebitdaGrowthRate:{type:"normal",parameters:{mean:.06,stdDev:.02},enabled:!0},exitMultiple:{type:"triangular",parameters:{min:8,mode:10,max:12},enabled:!0},leverageRatio:{type:"normal",parameters:{mean:5.5,stdDev:.5},enabled:!0}};j(50),e.lbo=await ce.runLBOSimulation(l.inputs||{},s,{iterations:u.iterations,confidenceLevel:u.confidenceLevel,onProgress:e=>j(50+.25*e)})}e.dcf&&e.lbo&&u.correlationsEnabled&&(j(75),e.correlation=k(e.dcf,e.lbo)),j(90),e.riskMetrics=F(e),o&&o.scenarios&&(e.portfolio=M(e,o)),j(100),p(e),d&&d({monteCarloIntegrated:{settings:u,results:e,timestamp:(new Date).toISOString()}})}catch(e){alert(`Simulation error: ${e.message}`)}finally{y(!1),j(0)}},[a,l,o,u,t,d]),k=e.useCallback((e,s)=>{const t=e.simulations?.map(e=>e.pricePerShare)||[],a=s.simulations?.map(e=>e.irr)||[];if(0===t.length||0===a.length)return null;const i=S(t,a);return{dcfLboCorrelation:i,interpretation:Math.abs(i)>.7?"Strong":Math.abs(i)>.4?"Moderate":"Weak",riskImplication:i>0?"Aligned Risk":"Hedged Risk"}},[]),S=(e,s)=>{const t=Math.min(e.length,s.length);if(0===t)return 0;const a=e.slice(0,t).reduce((e,s)=>e+s,0),i=s.slice(0,t).reduce((e,s)=>e+s,0),l=e.slice(0,t).reduce((e,t,a)=>e+t*s[a],0),n=e.slice(0,t).reduce((e,s)=>e+s*s,0),r=s.slice(0,t).reduce((e,s)=>e+s*s,0),o=t*l-a*i,c=Math.sqrt((t*n-a*a)*(t*r-i*i));return 0===c?0:o/c},F=e.useCallback(e=>{const s={};return e.dcf?.analysis&&(s.dcf={var95:e.dcf.analysis.percentiles?.pricePerShare?.p5||0,expectedValue:e.dcf.analysis.summary?.mean||0,volatility:e.dcf.analysis.summary?.standardDeviation||0}),e.lbo?.analysis&&(s.lbo={var95:e.lbo.analysis.percentiles?.irr?.p5||0,expectedValue:e.lbo.analysis.summary?.mean||0,volatility:e.lbo.analysis.summary?.standardDeviation||0}),s},[]),M=e.useCallback((e,s)=>s.scenarios.reduce((s,t)=>{const a=t.probability/100;return e.dcf&&(s.dcfWeighted=(s.dcfWeighted||0)+(e.dcf.analysis?.summary?.mean||0)*a),e.lbo&&(s.lboWeighted=(s.lboWeighted||0)+(e.lbo.analysis?.summary?.mean||0)*a),s},{}),[]),A=[{id:"unified",label:"Unified Analysis",icon:r},{id:"dcf",label:"DCF Monte Carlo",icon:s},{id:"lbo",label:"LBO Monte Carlo",icon:i},{id:"correlation",label:"Cross-Model Risk",icon:g}];return c.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-6",children:[c.jsxs("div",{className:"flex items-center space-x-3",children:[c.jsx(r,{className:"text-purple-600",size:28}),c.jsxs("div",{children:[c.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Monte Carlo Integration Hub"}),c.jsx("p",{className:"text-gray-600",children:"Cross-model risk analysis & unified simulations"})]})]}),c.jsx("div",{className:"flex space-x-3",children:c.jsxs(G.button,{onClick:C,disabled:f,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(f?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),whileHover:f?{}:{scale:1.02},whileTap:f?{}:{scale:.98},children:[c.jsx($,{size:18}),c.jsx("span",{children:f?"Running...":"Run Integrated Simulation"})]})})]}),f&&c.jsxs("div",{className:"mb-6",children:[c.jsxs("div",{className:"flex items-center justify-between mb-2",children:[c.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Simulation Progress"}),c.jsxs("span",{className:"text-sm text-gray-500",children:[v.toFixed(0),"%"]})]}),c.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:c.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${v}%`}})})]}),c.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[c.jsx("h3",{className:"font-semibold mb-3",children:"Simulation Settings"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Iterations"}),c.jsx("input",{type:"number",value:u.iterations,onChange:e=>h(s=>({...s,iterations:parseInt(e.target.value)||1e4})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),c.jsxs("div",{children:[c.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confidence Level"}),c.jsxs("select",{value:u.confidenceLevel,onChange:e=>h(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[c.jsx("option",{value:.9,children:"90%"}),c.jsx("option",{value:.95,children:"95%"}),c.jsx("option",{value:.99,children:"99%"})]})]}),c.jsx("div",{className:"flex items-end",children:c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:u.correlationsEnabled,onChange:e=>h(s=>({...s,correlationsEnabled:e.target.checked})),className:"mr-2"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Correlations"})]})}),c.jsx("div",{className:"flex items-end",children:c.jsxs("label",{className:"flex items-center",children:[c.jsx("input",{type:"checkbox",checked:u.crossModelAnalysis,onChange:e=>h(s=>({...s,crossModelAnalysis:e.target.checked})),className:"mr-2"}),c.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Analysis"})]})})]})]}),c.jsx("div",{className:"border-b border-gray-200 mb-6",children:c.jsx("nav",{className:"-mb-px flex space-x-8",children:A.map(e=>{const s=e.icon;return c.jsxs("button",{onClick:()=>x(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(m===e.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[c.jsx(s,{size:16}),c.jsx("span",{children:e.label})]},e.id)})})}),b?c.jsxs(G.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:["unified"===m&&c.jsxs("div",{className:"space-y-6",children:[c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[b.dcf&&c.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:N(b.dcf.analysis?.summary?.mean||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"DCF Expected Value"})]}),b.lbo&&c.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-green-600",children:w(b.lbo.analysis?.summary?.mean||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"LBO Expected IRR"})]}),b.correlation&&c.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(b.correlation.dcfLboCorrelation||0).toFixed(2)}),c.jsx("div",{className:"text-sm text-gray-600",children:"DCF-LBO Correlation"})]}),c.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[c.jsx("div",{className:"text-2xl font-bold text-orange-600",children:u.iterations.toLocaleString()}),c.jsx("div",{className:"text-sm text-gray-600",children:"Simulations Run"})]})]}),b.correlation&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cross-Model Risk Analysis"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[c.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Correlation Strength"}),c.jsx("div",{className:"text-2xl font-bold text-purple-600",children:b.correlation.interpretation}),c.jsx("div",{className:"text-sm text-gray-600",children:b.correlation.riskImplication})]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[c.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Risk Diversification"}),c.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.abs(b.correlation.dcfLboCorrelation)<.5?"High":"Low"}),c.jsx("div",{className:"text-sm text-gray-600",children:"Portfolio benefit"})]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[c.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Confidence Level"}),c.jsx("div",{className:"text-2xl font-bold text-green-600",children:w(u.confidenceLevel)}),c.jsx("div",{className:"text-sm text-gray-600",children:"Statistical confidence"})]})]})]}),b.portfolio&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Portfolio-Weighted Analysis"}),c.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[c.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[c.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted DCF"}),c.jsx("div",{className:"text-xl font-bold text-blue-600",children:N(b.portfolio.dcfWeighted||0)})]}),c.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[c.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted LBO IRR"}),c.jsx("div",{className:"text-xl font-bold text-green-600",children:w(b.portfolio.lboWeighted||0)})]})]})]})]}),"dcf"===m&&b.dcf&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"DCF Monte Carlo Results"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-blue-600",children:N(b.dcf.analysis?.summary?.mean||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"Mean Value"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-green-600",children:N(b.dcf.analysis?.percentiles?.pricePerShare?.p95||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-red-600",children:N(b.dcf.analysis?.percentiles?.pricePerShare?.p5||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-purple-600",children:N(b.dcf.analysis?.summary?.standardDeviation||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"Std Deviation"})]})]})]}),"lbo"===m&&b.lbo&&c.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[c.jsx("h3",{className:"text-lg font-semibold mb-4",children:"LBO Monte Carlo Results"}),c.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-green-600",children:w(b.lbo.analysis?.summary?.mean||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"Mean IRR"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-blue-600",children:w(b.lbo.analysis?.percentiles?.irr?.p95||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile IRR"})]}),c.jsxs("div",{className:"text-center",children:[c.jsx("div",{className:"text-lg font-bold text-red-600",children:w(b.lbo.analysis?.percentiles?.irr?.p5||0)}),c.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile IRR"})]}),c.jsxs("div",{className:"text-center",children:[c.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[((b.lbo.analysis?.percentiles?.moic?.p95||0)+(b.lbo.analysis?.percentiles?.moic?.p5||0))/2,"x"]}),c.jsx("div",{className:"text-sm text-gray-600",children:"Avg MOIC"})]})]})]})]}):c.jsxs("div",{className:"text-center py-12 text-gray-500",children:[c.jsx(r,{size:48,className:"mx-auto mb-4 opacity-50"}),c.jsx("p",{children:"Configure settings and run integrated simulation to see cross-model analysis"}),c.jsx("p",{className:"text-sm mt-2",children:a||l?"Ready to run comprehensive Monte Carlo analysis":"Run DCF and/or LBO analysis first to enable Monte Carlo integration"})]})]})}},Symbol.toStringTag,{value:"Module"}));export{Se as A,Fe as C,Ee as D,Me as E,Ae as F,Oe as M,Pe as W,Ce as a,Ie as b,qe as c,we as g,xe as i,ke as u};
//# sourceMappingURL=private-analysis-CjCiuYvO.js.map
