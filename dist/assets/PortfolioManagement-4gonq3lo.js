import{r as e,R as s,j as a,h as t,l as r,m as l,i,ax as n,at as o,I as c,af as d,ak as m,x,T as h,ac as g,am as u,a5 as p,ab as b,D as j,a7 as y,z as f}from"./react-vendor-CaXMqa0k.js";import{S as v}from"./SEOHead-DhiHNgzz.js";import{s as N,a as w,f as k,b as C}from"./index-DPdPN0n0.js";import{U as M,V as S,W as P,X as A,Y as D,Z as T,_ as L,$ as B,a0 as V,a1 as R,a2 as I,a3 as E}from"./vendor-zO7HU-o7.js";import{p as F}from"./portfolioCommands-CQmWdDO4.js";import{ResponsiveContainer as G,LineChart as O,CartesianGrid as Y,XAxis as z,YAxis as U,Tooltip as W,Line as K,BarChart as J,Bar as $}from"./charts-vendor-DVkUTdXq.js";import"./data-vendor-DpIj8wd6.js";import"./ui-vendor-DOXsx3JB.js";import"./utils-vendor-Cj_bvvWu.js";import"./state-vendor-DL0PFC30.js";import"./apiLogger-BNPwdfUB.js";import"./lboModelingEngine-DdqVJUup.js";const H=({portfolio:x,onPortfolioUpdate:h,marketData:g})=>{const[u,p]=e.useState("allocation"),[b,j]=e.useState(""),[y,f]=e.useState([]),[v,k]=e.useState(!1),[C,P]=e.useState({}),[A,D]=e.useState({objective:"max_sharpe",constraints:{maxWeight:50,minWeight:0,maxSectorWeight:30}}),[T,I]=e.useState({threshold:5,cashBuffer:2e3,minimumTrade:100}),[E,F]=e.useState(!1);s.useEffect(()=>{if(x&&!Object.keys(C).length){const e={};x.holdings.forEach(s=>{e[s.symbol]=s.allocation||0}),P(e)}},[x,C]);const G=e.useCallback(async e=>{if(!e||e.length<2)f([]);else{k(!0);try{const s=[{symbol:"AAPL",name:"Apple Inc.",sector:"Technology",marketCap:3e12},{symbol:"MSFT",name:"Microsoft Corporation",sector:"Technology",marketCap:28e11},{symbol:"GOOGL",name:"Alphabet Inc.",sector:"Technology",marketCap:17e11},{symbol:"AMZN",name:"Amazon.com Inc.",sector:"Consumer Discretionary",marketCap:15e11},{symbol:"TSLA",name:"Tesla Inc.",sector:"Consumer Discretionary",marketCap:8e11},{symbol:"NVDA",name:"NVIDIA Corporation",sector:"Technology",marketCap:12e11},{symbol:"META",name:"Meta Platforms Inc.",sector:"Technology",marketCap:9e11},{symbol:"JPM",name:"JPMorgan Chase & Co.",sector:"Financials",marketCap:5e11},{symbol:"JNJ",name:"Johnson & Johnson",sector:"Healthcare",marketCap:45e10},{symbol:"V",name:"Visa Inc.",sector:"Technology",marketCap:5e11}].filter(s=>s.symbol.toLowerCase().includes(e.toLowerCase())||s.name.toLowerCase().includes(e.toLowerCase()));f(s)}catch(s){f([])}finally{k(!1)}}},[]);s.useEffect(()=>{const e=setTimeout(()=>G(b),300);return()=>clearTimeout(e)},[b,G]);const O=e.useMemo(()=>{const e=x?.holdings||[],s=Object.values(C).reduce((e,s)=>e+(s||0),0),a=Math.max(0,100-s),t=e.map(e=>{const s=e.allocation||0,a=C[e.symbol]||0,t=Math.abs(s-a);return{symbol:e.symbol,current:s,target:a,deviation:t}}),r=Math.max(...t.map(e=>e.deviation),0),l=t.reduce((e,s)=>e+s.deviation,0)/Math.max(t.length,1);return{totalTarget:s,cashAllocation:a,deviations:t,maxDeviation:r,avgDeviation:l,isValid:s<=100,needsRebalancing:r>T.threshold}},[x,C,T.threshold]),Y=e.useCallback(async e=>{try{const s=await N.getQuote(e.symbol),a={symbol:e.symbol,name:e.name,shares:0,currentPrice:s.currentPrice||100,allocation:0,value:0,costBasis:s.currentPrice||100},t={...x,holdings:[...x.holdings,a]};h(t),P(s=>({...s,[e.symbol]:0})),F(!0),j(""),f([])}catch(s){}},[x,h]),z=e.useCallback(e=>{const s={...x,holdings:x.holdings.filter(s=>s.symbol!==e)};h(s),P(s=>{const a={...s};return delete a[e],a}),F(!0)},[x,h]),U=e.useCallback((e,s)=>{P(a=>({...a,[e]:Math.max(0,Math.min(100,s))})),F(!0)},[]),W=e.useCallback(()=>{if(!x||!O.needsRebalancing)return[];const e=[],s=x.totalValue||1e5;return O.deviations.forEach(({symbol:a,current:t,target:r,deviation:l})=>{if(l>T.threshold){const l=x.holdings.find(e=>e.symbol===a);if(!l)return;const i=r/100*s-l.value,n=Math.round(i/l.currentPrice);Math.abs(i)>=T.minimumTrade&&e.push({symbol:a,action:i>0?"BUY":"SELL",shares:Math.abs(n),dollarAmount:Math.abs(i),currentPrice:l.currentPrice,reason:`Rebalance from ${t.toFixed(1)}% to ${r.toFixed(1)}%`})}}),e},[x,O,T]),K=M(S(V),S(B,{coordinateGetter:L}));return x?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{value:"allocation",label:"Allocation",icon:t},{value:"optimization",label:"Optimization",icon:r},{value:"rebalancing",label:"Rebalancing",icon:l}].map(({value:e,label:s,icon:t})=>a.jsxs("button",{onClick:()=>p(e),className:"flex items-center space-x-2 px-4 py-2 rounded-md text-sm font-medium transition-colors "+(u===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[a.jsx(t,{className:"w-4 h-4"}),a.jsx("span",{children:s})]},e))}),a.jsxs("div",{className:"flex items-center space-x-3",children:[E&&a.jsxs("span",{className:"flex items-center space-x-1 text-sm text-orange-600",children:[a.jsx(i,{className:"w-4 h-4"}),a.jsx("span",{children:"Unsaved changes"})]}),a.jsxs("button",{onClick:()=>F(!1),className:"flex items-center space-x-2 px-3 py-1.5 text-sm border border-gray-300 rounded-md hover:bg-gray-50",children:[a.jsx(n,{className:"w-4 h-4"}),a.jsx("span",{children:"Reset"})]}),a.jsxs("button",{className:"flex items-center space-x-2 px-3 py-1.5 bg-blue-600 text-white text-sm rounded-md hover:bg-blue-700",children:[a.jsx(o,{className:"w-4 h-4"}),a.jsx("span",{children:"Save"})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:["allocation"===u&&a.jsx(_,{portfolio:x,targetAllocation:C,onUpdateAllocation:U,onRemoveStock:z,allocationAnalysis:O,handleDragEnd:e=>{const{active:s,over:a}=e;if(s.id!==a.id){const e=x.holdings.findIndex(e=>e.symbol===s.id),t=x.holdings.findIndex(e=>e.symbol===a.id),r={...x,holdings:R(x.holdings,e,t)};h(r),F(!0)}},sensors:K}),"optimization"===u&&a.jsx(Q,{portfolio:x,optimizationSettings:A,onSettingsChange:D}),"rebalancing"===u&&a.jsx(X,{portfolio:x,rebalanceSettings:T,onSettingsChange:I,allocationAnalysis:O,generateTrades:W})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Add Securities"}),a.jsxs("div",{className:"relative mb-4",children:[a.jsx(c,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),a.jsx("input",{type:"text",placeholder:"Search stocks by symbol or name...",value:b,onChange:e=>j(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),v&&a.jsx(d,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 animate-spin"})]}),y.length>0&&a.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:y.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.symbol}),a.jsx("div",{className:"text-sm text-gray-500",children:e.name}),a.jsx("div",{className:"text-xs text-gray-400",children:e.sector})]}),a.jsx("button",{onClick:()=>Y(e),disabled:x.holdings.some(s=>s.symbol===e.symbol),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg disabled:opacity-50 disabled:cursor-not-allowed",children:a.jsx(m,{className:"w-4 h-4"})})]},e.symbol))})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Allocation Summary"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total Allocated:"}),a.jsx("span",{className:"font-medium "+(O.isValid?"text-gray-900":"text-red-600"),children:w(O.totalTarget)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Cash:"}),a.jsx("span",{className:"font-medium text-gray-900",children:w(O.cashAllocation)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Max Deviation:"}),a.jsx("span",{className:"font-medium "+(O.maxDeviation>T.threshold?"text-red-600":"text-green-600"),children:w(O.maxDeviation)})]}),!O.isValid&&a.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-red-50 rounded-lg",children:[a.jsx(i,{className:"w-4 h-4 text-red-600"}),a.jsx("span",{className:"text-sm text-red-700",children:"Total allocation exceeds 100%"})]}),O.needsRebalancing&&a.jsxs("div",{className:"flex items-center space-x-2 p-3 bg-orange-50 rounded-lg",children:[a.jsx(i,{className:"w-4 h-4 text-orange-600"}),a.jsx("span",{className:"text-sm text-orange-700",children:"Portfolio needs rebalancing"})]})]})]})]})]})]}):a.jsx("div",{className:"text-center py-8",children:"No portfolio selected"})},_=({portfolio:e,targetAllocation:s,onUpdateAllocation:t,onRemoveStock:r,allocationAnalysis:l,handleDragEnd:i,sensors:n})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[a.jsxs("div",{className:"px-6 py-4 border-b",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Target Allocation"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Drag to reorder â€¢ Set target percentages for each holding"})]}),a.jsx(P,{sensors:n,collisionDetection:A,onDragEnd:i,children:a.jsx(D,{items:e.holdings.map(e=>e.symbol),strategy:T,children:a.jsx("div",{className:"p-6 space-y-4",children:e.holdings.map(e=>a.jsx(q,{holding:e,targetAllocation:s[e.symbol]||0,onUpdateAllocation:t,onRemove:r,deviation:l.deviations.find(s=>s.symbol===e.symbol)?.deviation||0},e.symbol))})})})]}),q=({holding:e,targetAllocation:s,onUpdateAllocation:t,onRemove:r,deviation:l})=>{const{attributes:i,listeners:n,setNodeRef:o,transform:c,transition:d,isDragging:m}=I({id:e.symbol}),x={transform:E.Transform.toString(c),transition:d,opacity:m?.5:1};return a.jsxs("div",{ref:o,style:x,className:"flex items-center space-x-4 p-4 border border-gray-200 rounded-lg hover:border-gray-300 transition-colors",children:[a.jsx("div",{...i,...n,className:"cursor-grab active:cursor-grabbing p-1",children:a.jsx("div",{className:"w-2 h-8 bg-gray-300 rounded-full"})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.symbol}),a.jsx("div",{className:"text-sm text-gray-500",children:e.name})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm text-gray-600",children:["Current: ",w(e.allocation||0)]}),l>0&&a.jsxs("div",{className:"text-xs "+(l>5?"text-red-600":"text-orange-600"),children:["Deviation: ",w(l)]})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"number",value:s,onChange:s=>t(e.symbol,parseFloat(s.target.value)||0),className:"w-20 px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",max:"100",step:"0.1"}),a.jsx("span",{className:"text-sm text-gray-500",children:"%"})]}),a.jsx("button",{onClick:()=>r(e.symbol),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg",children:a.jsx(u,{className:"w-4 h-4"})})]})},Q=({portfolio:e,optimizationSettings:s,onSettingsChange:t})=>a.jsx("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:a.jsxs("div",{className:"text-center py-12",children:[a.jsx(r,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Portfolio Optimization"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Advanced optimization algorithms coming soon"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Features: Mean-variance optimization, risk parity, factor-based optimization"})]})}),X=({portfolio:e,rebalanceSettings:s,onSettingsChange:t,allocationAnalysis:r,generateTrades:l})=>{const i=l();return a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Rebalancing Settings"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Deviation Threshold"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"number",value:s.threshold,onChange:e=>t(s=>({...s,threshold:parseFloat(e.target.value)||0})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0.1",max:"20",step:"0.1"}),a.jsx("span",{className:"text-sm text-gray-500",children:"%"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cash Buffer"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"$"}),a.jsx("input",{type:"number",value:s.cashBuffer,onChange:e=>t(s=>({...s,cashBuffer:parseFloat(e.target.value)||0})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"100"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Minimum Trade"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("span",{className:"text-sm text-gray-500",children:"$"}),a.jsx("input",{type:"number",value:s.minimumTrade,onChange:e=>t(s=>({...s,minimumTrade:parseFloat(e.target.value)||0})),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",min:"0",step:"50"})]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Suggested Trades"}),i.length>0&&a.jsxs("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-sm rounded-full",children:[i.length," trades"]})]})}),a.jsx("div",{className:"p-6",children:0===i.length?a.jsxs("div",{className:"text-center py-8",children:[a.jsx(x,{className:"w-12 h-12 text-green-500 mx-auto mb-3"}),a.jsx("p",{className:"text-gray-600",children:"Portfolio is within rebalancing thresholds"})]}):a.jsx("div",{className:"space-y-3",children:i.map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between p-4 border border-gray-200 rounded-lg",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"p-2 rounded-lg "+("BUY"===e.action?"bg-green-100":"bg-red-100"),children:"BUY"===e.action?a.jsx(h,{className:"w-4 h-4 text-green-600"}):a.jsx(g,{className:"w-4 h-4 text-red-600"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"font-medium text-gray-900",children:[e.action," ",k(e.shares)," shares of ",e.symbol]}),a.jsx("div",{className:"text-sm text-gray-500",children:e.reason})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-medium text-gray-900",children:C(e.dollarAmount)}),a.jsxs("div",{className:"text-sm text-gray-500",children:["@ ",C(e.currentPrice)]})]})]},s))})})]})]})},Z=({portfolio:s,metrics:t,selectedTimeframe:l,onTimeframeChange:i,timeframeOptions:n})=>{const[o,c]=e.useState({riskMetrics:null,correlationMatrix:null,performanceAttribution:null,historicalPerformance:null}),[m,x]=e.useState({risk:!1,correlation:!1,performance:!1}),[g,u]=e.useState("performance"),[y,f]=e.useState("252"),v=e.useCallback(async()=>{if(s&&s.holdings.length&&!m.risk){x(e=>({...e,risk:!0}));try{const e=s.holdings.map(e=>e.symbol),a=s.holdings.map(e=>(e.allocation||0)/100),t=e.map(async e=>{try{const s=F.RISK_METRICS,a={parameters:[e,parseInt(y)]},t=await s.execute(a,{},null);return t.data?.metrics||null}catch(s){return null}}),r=await Promise.all(t),l=r.filter(e=>e),i={portfolioVolatility:ne(l.map(e=>e.volatility||0),a),portfolioBeta:ne(l.map(e=>e.beta||1),a),portfolioSharpe:ne(l.map(e=>e.sharpeRatio||0),a),portfolioVar95:ne(l.map(e=>e.var95||0),a),portfolioVar99:ne(l.map(e=>e.var99||0),a),maxDrawdown:Math.max(...l.map(e=>e.maxDrawdown||0)),concentrationRisk:oe(a),individualMetrics:e.map((e,s)=>({symbol:e,weight:a[s],...r[s]})).filter(e=>e.symbol)};c(e=>({...e,riskMetrics:i}))}catch(e){}finally{x(e=>({...e,risk:!1}))}}},[s,m.risk,y]),N=e.useCallback(async()=>{if(s&&s.holdings.length&&!m.correlation){x(e=>({...e,correlation:!0}));try{const e=s.holdings.map(e=>e.symbol);if(e.length<2)return void c(e=>({...e,correlationMatrix:{message:"Need at least 2 holdings for correlation analysis"}}));const a=F.CORRELATION_MATRIX,t={parameters:[e]},r=await a.execute(t,{},null);"success"===r.type&&c(e=>({...e,correlationMatrix:r.data}))}catch(e){}finally{x(e=>({...e,correlation:!1}))}}},[s,m.correlation]),k=e.useCallback(()=>{if(!t)return;const e=ie(l),s=[],a=.9*t.totalValue;for(let t=0;t<e;t++){const r=new Date;r.setDate(r.getDate()-(e-t));const l=t/e,i=a*(1+.15*l+(.02*Math.sin(.1*t)+.01*Math.random()-.005));s.push({date:r.toISOString().split("T")[0],portfolioValue:i,benchmark:a*(1+.12*l)})}c(e=>({...e,historicalPerformance:s}))},[t,l]),M=e.useCallback(()=>{if(!s||!t)return;const e=s.holdings.map(e=>{const s=(e.allocation||0)*(e.gainLossPercent||0)/100;return{symbol:e.symbol,name:e.name,allocation:e.allocation||0,return:e.gainLossPercent||0,contribution:s,value:e.value||0}});e.sort((e,s)=>Math.abs(s.contribution)-Math.abs(e.contribution)),c(s=>({...s,performanceAttribution:e}))},[s,t]);return e.useEffect(()=>{v()},[v]),e.useEffect(()=>{N()},[N]),e.useEffect(()=>{k()},[k]),e.useEffect(()=>{M()},[M]),s&&t?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{value:"performance",label:"Performance",icon:h},{value:"risk",label:"Risk",icon:p},{value:"correlation",label:"Correlation",icon:b},{value:"attribution",label:"Attribution",icon:r}].map(({value:e,label:s,icon:t})=>a.jsxs("button",{onClick:()=>u(e),className:"flex items-center space-x-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors "+(g===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[a.jsx(t,{className:"w-4 h-4"}),a.jsx("span",{children:s})]},e))}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Timeframe:"}),a.jsx("select",{value:l,onChange:e=>i(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:n.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),a.jsxs("button",{className:"flex items-center space-x-2 px-3 py-1.5 border border-gray-300 rounded-md text-sm hover:bg-gray-50",children:[a.jsx(j,{className:"w-4 h-4"}),a.jsx("span",{children:"Export"})]})]})]}),"performance"===g&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[a.jsx("div",{className:"lg:col-span-2",children:a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Portfolio Performance"}),o.historicalPerformance&&a.jsx(G,{width:"100%",height:300,children:a.jsxs(O,{data:o.historicalPerformance,children:[a.jsx(Y,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(z,{dataKey:"date",stroke:"#6b7280",fontSize:12,tickFormatter:e=>new Date(e).toLocaleDateString()}),a.jsx(U,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>C(e,0)}),a.jsx(W,{formatter:(e,s)=>[C(e),"portfolioValue"===s?"Portfolio":"Benchmark"],labelFormatter:e=>new Date(e).toLocaleDateString()}),a.jsx(K,{type:"monotone",dataKey:"portfolioValue",stroke:"#3B82F6",strokeWidth:2,dot:!1,name:"Portfolio"}),a.jsx(K,{type:"monotone",dataKey:"benchmark",stroke:"#10B981",strokeWidth:2,strokeDasharray:"5 5",dot:!1,name:"Benchmark"})]})})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(ee,{metrics:t}),o.performanceAttribution&&a.jsx(se,{attribution:o.performanceAttribution})]})]}),"risk"===g&&o.riskMetrics&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsx(ae,{riskMetrics:o.riskMetrics,loading:m.risk}),a.jsx(te,{riskMetrics:o.riskMetrics})]}),"correlation"===g&&a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Correlation Matrix"}),m.correlation&&a.jsx(d,{className:"w-4 h-4 text-gray-400 animate-spin"})]}),o.correlationMatrix&&a.jsx(re,{data:o.correlationMatrix})]}),"attribution"===g&&o.performanceAttribution&&a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Performance Attribution"}),a.jsx(G,{width:"100%",height:300,children:a.jsxs(J,{data:o.performanceAttribution,children:[a.jsx(Y,{strokeDasharray:"3 3",stroke:"#f0f0f0"}),a.jsx(z,{dataKey:"symbol",stroke:"#6b7280",fontSize:12}),a.jsx(U,{stroke:"#6b7280",fontSize:12,tickFormatter:e=>w(e)}),a.jsx(W,{formatter:e=>[w(e),"Contribution"]}),a.jsx($,{dataKey:"contribution",fill:"#3B82F6",radius:[2,2,0,0]})]})})]}),a.jsx(le,{attribution:o.performanceAttribution})]})]}):a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},ee=({metrics:e})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Key Metrics"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Total Return:"}),a.jsx("span",{className:"font-medium "+(e.totalGainLossPercent>=0?"text-green-600":"text-red-600"),children:w(e.totalGainLossPercent)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Day Change:"}),a.jsx("span",{className:"font-medium "+(e.dailyChangePercent>=0?"text-green-600":"text-red-600"),children:w(e.dailyChangePercent)})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"Dividend Yield:"}),a.jsx("span",{className:"font-medium text-gray-900",children:w(e.dividendYield)})]})]})]}),se=({attribution:e})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Top Contributors"}),a.jsx("div",{className:"space-y-2",children:e.slice(0,5).map(e=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-sm text-gray-600",children:e.symbol}),a.jsx("span",{className:"text-sm font-medium "+(e.contribution>=0?"text-green-600":"text-red-600"),children:w(e.contribution)})]},e.symbol))})]}),ae=({riskMetrics:e,loading:s})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Risk Metrics"}),s&&a.jsx(d,{className:"w-4 h-4 text-gray-400 animate-spin"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w(100*(e.portfolioVolatility||0))}),a.jsx("div",{className:"text-sm text-blue-700",children:"Volatility"})]}),a.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-green-600",children:k(e.portfolioBeta||0,2)}),a.jsx("div",{className:"text-sm text-green-700",children:"Beta"})]}),a.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-purple-600",children:k(e.portfolioSharpe||0,2)}),a.jsx("div",{className:"text-sm text-purple-700",children:"Sharpe Ratio"})]}),a.jsxs("div",{className:"text-center p-4 bg-orange-50 rounded-lg",children:[a.jsx("div",{className:"text-2xl font-bold text-orange-600",children:w(e.maxDrawdown||0)}),a.jsx("div",{className:"text-sm text-orange-700",children:"Max Drawdown"})]})]})]}),te=({riskMetrics:e})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Risk Decomposition"}),e?.individualMetrics&&a.jsx("div",{className:"space-y-3",children:e.individualMetrics.slice(0,5).map(e=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.symbol}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Weight: ",w(100*e.weight)]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["Vol: ",w(100*(e.volatility||0))]}),a.jsxs("div",{className:"text-sm text-gray-500",children:["Beta: ",k(e.beta||0,2)]})]})]},e.symbol))})]}),re=({data:e})=>e.correlationMatrix?a.jsx("div",{className:"space-y-4",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:e.correlationMatrix.slice(0,6).map((e,s)=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[a.jsx("span",{className:"text-sm text-gray-600",children:e.pair}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"text-sm font-medium "+(Math.abs(e.correlation)>.7?"text-red-600":"text-green-600"),children:k(e.correlation,2)}),a.jsx("div",{className:"text-xs text-gray-500",children:e.strength})]})]},s))})}):a.jsx("div",{className:"text-center py-8 text-gray-500",children:"Insufficient data for correlation analysis"}),le=({attribution:e})=>a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border p-6",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Attribution Breakdown"}),a.jsx("div",{className:"space-y-3",children:e.map(e=>a.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("div",{className:"font-medium text-gray-900",children:e.symbol}),a.jsxs("div",{className:"text-sm text-gray-500",children:[w(e.allocation)," allocation"]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("div",{className:"font-medium "+(e.contribution>=0?"text-green-600":"text-red-600"),children:w(e.contribution)}),a.jsxs("div",{className:"text-sm text-gray-500",children:[w(e.return)," return"]})]})]},e.symbol))})]}),ie=e=>({"1D":1,"1W":7,"1M":30,"3M":90,"6M":180,"1Y":365,YTD:Math.floor((new Date-new Date((new Date).getFullYear(),0,1))/864e5)}[e]||30),ne=(e,s)=>e.reduce((e,a,t)=>e+a*(s[t]||0),0),oe=e=>Math.max(...e),ce=()=>{const[s,i]=e.useState([]),[n,o]=e.useState(null),[c,d]=e.useState(null),[x,h]=e.useState(null),[g,u]=e.useState({}),[p,b]=e.useState({portfolios:!1,performance:!1,risk:!1,market:!1}),[j,f]=e.useState(!1),[w,k]=e.useState("1M"),[C,M]=e.useState("overview");e.useEffect(()=>{const e={id:"sample-portfolio",name:"Growth Portfolio",description:"Technology-focused growth portfolio",totalValue:1e5,cash:5e3,holdings:[{symbol:"AAPL",name:"Apple Inc.",shares:100,currentPrice:175.5,allocation:35,value:17550,costBasis:160},{symbol:"MSFT",name:"Microsoft Corporation",shares:80,currentPrice:335.2,allocation:30,value:26816,costBasis:300},{symbol:"GOOGL",name:"Alphabet Inc.",shares:50,currentPrice:128.45,allocation:15,value:6422.5,costBasis:120},{symbol:"TSLA",name:"Tesla Inc.",shares:30,currentPrice:245.8,allocation:10,value:7374,costBasis:200},{symbol:"NVDA",name:"NVIDIA Corporation",shares:25,currentPrice:425.3,allocation:10,value:10632.5,costBasis:400}]};i([e]),o(e)},[]);const S=e.useCallback(async()=>{if(n&&!p.market){b(e=>({...e,market:!0}));try{const e=n.holdings.map(e=>e.symbol),s=e.map(e=>N.getQuote(e).catch(e=>null)),a=await Promise.all(s),t={};a.forEach((s,a)=>{s&&(t[e[a]]=s)}),u(t)}catch(e){}finally{b(e=>({...e,market:!1}))}}},[n,p.market]),P=e.useMemo(()=>{if(!n||!g)return null;let e=n.cash||0,s=0,a=0,t=0;const r=n.holdings.map(r=>{const l=g[r.symbol],i=l?.currentPrice||r.currentPrice,n=l?.previousClose||r.currentPrice,o=l?.change||0,c=r.shares*i,d=r.shares*r.costBasis,m=r.shares*o;return e+=c,s+=d,a+=m,t+=(l?.dividendYield||0)*(c/1e5),{...r,currentPrice:i,previousClose:n,change:o,value:c,costBasisValue:d,gainLoss:c-d,gainLossPercent:(c-d)/d*100,allocation:c/e*100,dayChange:m}}),l=e-s;return{totalValue:e,totalCostBasis:s,totalGainLoss:l,totalGainLossPercent:l/s*100,dailyChange:a,dailyChangePercent:a/(e-a)*100,dividendYield:t,holdings:r,cashAllocation:(n.cash||0)/e*100}},[n,g]);e.useEffect(()=>{S()},[S]),e.useEffect(()=>{const e=setInterval(S,3e4);return()=>clearInterval(e)},[S]);const A=[{value:"1D",label:"1 Day"},{value:"1W",label:"1 Week"},{value:"1M",label:"1 Month"},{value:"3M",label:"3 Months"},{value:"6M",label:"6 Months"},{value:"1Y",label:"1 Year"},{value:"YTD",label:"YTD"}];return n?a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx(v,{title:"Portfolio Management | FinanceAnalyst Pro",description:"Professional portfolio management tools with real-time tracking, risk analysis, and performance analytics",keywords:"portfolio management, investment tracking, risk analysis, asset allocation"}),a.jsx("div",{className:"bg-white shadow-sm border-b",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center justify-between h-16",children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(t,{className:"w-8 h-8 text-blue-600"}),a.jsxs("div",{children:[a.jsx("h1",{className:"text-xl font-bold text-gray-900",children:"Portfolio Management"}),a.jsx("p",{className:"text-sm text-gray-500",children:"Real-time portfolio tracking & analysis"})]})]}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx("div",{className:"flex bg-gray-100 rounded-lg p-1",children:[{value:"overview",label:"Overview",icon:y},{value:"builder",label:"Builder",icon:r},{value:"analytics",label:"Analytics",icon:l}].map(({value:e,label:s,icon:t})=>a.jsxs("button",{onClick:()=>M(e),className:"flex items-center space-x-2 px-3 py-1.5 rounded-md text-sm font-medium transition-colors "+(C===e?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-900"),children:[a.jsx(t,{className:"w-4 h-4"}),a.jsx("span",{children:s})]},e))}),a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:[a.jsx(m,{className:"w-4 h-4"}),a.jsx("span",{children:"New Portfolio"})]})]})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===C&&a.jsx(de,{portfolio:n,metrics:P,marketData:g,loading:p,selectedTimeframe:w,onTimeframeChange:k,timeframeOptions:A}),"builder"===C&&a.jsx(H,{portfolio:n,onPortfolioUpdate:o,marketData:g}),"analytics"===C&&a.jsx(Z,{portfolio:n,metrics:P,selectedTimeframe:w,onTimeframeChange:k,timeframeOptions:A})]})]}):a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx(t,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Portfolio Selected"}),a.jsx("p",{className:"text-gray-600 mb-4",children:"Create or select a portfolio to get started"}),a.jsx("button",{onClick:()=>f(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Create Portfolio"})]})})},de=({portfolio:e,metrics:s,marketData:t,loading:l,selectedTimeframe:i,onTimeframeChange:n,timeframeOptions:o})=>s?a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Portfolio Value"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:C(s.totalValue)})]}),a.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:a.jsx(f,{className:"w-6 h-6 text-blue-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Gain/Loss"}),a.jsx("p",{className:"text-2xl font-bold "+(s.totalGainLoss>=0?"text-green-600":"text-red-600"),children:C(s.totalGainLoss)}),a.jsx("p",{className:"text-sm "+(s.totalGainLossPercent>=0?"text-green-600":"text-red-600"),children:w(s.totalGainLossPercent)})]}),a.jsx("div",{className:"p-3 rounded-lg "+(s.totalGainLoss>=0?"bg-green-100":"bg-red-100"),children:s.totalGainLoss>=0?a.jsx(h,{className:"w-6 h-6 text-green-600"}):a.jsx(g,{className:"w-6 h-6 text-red-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Day Change"}),a.jsx("p",{className:"text-2xl font-bold "+(s.dailyChange>=0?"text-green-600":"text-red-600"),children:C(s.dailyChange)}),a.jsx("p",{className:"text-sm "+(s.dailyChangePercent>=0?"text-green-600":"text-red-600"),children:w(s.dailyChangePercent)})]}),a.jsx("div",{className:"p-3 rounded-lg "+(s.dailyChange>=0?"bg-green-100":"bg-red-100"),children:s.dailyChange>=0?a.jsx(h,{className:"w-6 h-6 text-green-600"}):a.jsx(g,{className:"w-6 h-6 text-red-600"})})]})}),a.jsx("div",{className:"bg-white rounded-xl shadow-sm p-6 border",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dividend Yield"}),a.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w(s.dividendYield)}),a.jsx("p",{className:"text-sm text-gray-500",children:"Weighted Average"})]}),a.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:a.jsx(r,{className:"w-6 h-6 text-purple-600"})})]})})]}),a.jsxs("div",{className:"bg-white rounded-xl shadow-sm border",children:[a.jsx("div",{className:"px-6 py-4 border-b",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Holdings"}),a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Timeframe:"}),a.jsx("select",{value:i,onChange:e=>n(e.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500",children:o.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))})]}),l.market&&a.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Symbol / Name"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Shares"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Market Value"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Allocation"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Day Change"}),a.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total Gain/Loss"})]})}),a.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[s.holdings.map(e=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.symbol}),a.jsx("div",{className:"text-sm text-gray-500",children:e.name})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:k(e.shares)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:C(e.currentPrice)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:C(e.value)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:w(e.allocation)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm "+(e.dayChange>=0?"text-green-600":"text-red-600"),children:C(e.dayChange)}),a.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm "+(e.gainLoss>=0?"text-green-600":"text-red-600"),children:[a.jsx("div",{children:C(e.gainLoss)}),a.jsxs("div",{className:"text-xs",children:["(",w(e.gainLossPercent),")"]})]})]},e.symbol)),e.cash>0&&a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{children:[a.jsx("div",{className:"text-sm font-medium text-gray-900",children:"CASH"}),a.jsx("div",{className:"text-sm text-gray-500",children:"Cash & Cash Equivalents"})]})}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:C(e.cash)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-900",children:w(s.cashAllocation)}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-500",children:"-"}),a.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm text-gray-500",children:"-"})]})]})]})})]})]}):a.jsx("div",{className:"flex items-center justify-center py-12",children:a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})});export{ce as default};
//# sourceMappingURL=PortfolioManagement-4gonq3lo.js.map
