import{j as e,I as s}from"./index-BBZS0tJJ.js";import{r as a}from"./react-vendor-BaLqnLcQ.js";import{C as t}from"./Card-BqDhuqcn.js";import{B as r}from"./Button-DrWX1msp.js";import{c as l,a as n}from"./dcfCalculations-jtFyFocw.js";import{A as i,c,d,e as o,f as x,m,D as h,S as u,g,B as p,h as b,i as y,j,M as f,X as v,P as N,k as w,l as C}from"./ui-vendor-BKcgCImL.js";import{R as k,d as R,C as F,X as P,Y as T,T as D,e as S,L as M}from"./charts-vendor-sFhs1sQW.js";import{I as $}from"./Input-spewUQTq.js";import"./Select-Ba8ifliZ.js";import{r as A}from"./realTimeDataService-CLEDQDSD.js";import"./utils-vendor-Cj_bvvWu.js";const G=({inputs:s,setInputs:t})=>{const[r,l]=a.useState("simple"),n=(e,s)=>{t(a=>({...a,[e]:parseFloat(s)||0}))},i=(e,a,r)=>{const l=s.yearlyData||{},n={...l,[e]:{...l[e],[a]:parseFloat(r)||0}};t(e=>({...e,yearlyData:n}))},c=(e,a)=>{const r=s.balanceSheet||{};t(s=>({...s,balanceSheet:{...r,[e]:parseFloat(a)||0}}))};a.useEffect(()=>{if(s.projectionYears&&!s.yearlyData){const e={};for(let a=1;a<=s.projectionYears;a++)e[a]={revenueGrowth:100*s.revenueGrowthRate||10,ebitdaMargin:100*s.ebitdaMargin||20,taxRate:100*s.taxRate||25,capexPercent:100*s.capexPercent||3,workingCapitalChange:100*s.workingCapitalPercent||2,daPercent:3};t(s=>({...s,yearlyData:e}))}},[s.projectionYears,s.yearlyData,t]),a.useEffect(()=>{s.balanceSheet||t(e=>({...e,balanceSheet:{cash:1e7,totalDebt:5e6,sharesOutstanding:1e6}}))},[s.balanceSheet,t]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"DCF Model Assumptions"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>l("simple"),className:"px-4 py-2 text-sm rounded-lg transition-colors "+("simple"===r?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Simple"}),e.jsx("button",{onClick:()=>l("detailed"),className:"px-4 py-2 text-sm rounded-lg transition-colors "+("detailed"===r?"bg-blue-500 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"),children:"Detailed"})]})]}),"simple"===r?e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"currentRevenue",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Revenue ($)"}),e.jsx("input",{id:"currentRevenue",type:"number",value:s.currentRevenue||0,onChange:e=>n("currentRevenue",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"revenueGrowthRate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue Growth Rate (%)"}),e.jsx("input",{id:"revenueGrowthRate",type:"number",step:"0.01",value:100*(s.revenueGrowthRate||0),onChange:e=>n("revenueGrowthRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"ebitdaMargin",className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA Margin (%)"}),e.jsx("input",{id:"ebitdaMargin",type:"number",step:"0.01",value:100*(s.ebitdaMargin||0),onChange:e=>n("ebitdaMargin",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"taxRate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),e.jsx("input",{id:"taxRate",type:"number",step:"0.01",value:100*(s.taxRate||0),onChange:e=>n("taxRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"terminalGrowthRate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Terminal Growth Rate (%)"}),e.jsx("input",{id:"terminalGrowthRate",type:"number",step:"0.01",value:100*(s.terminalGrowthRate||0),onChange:e=>n("terminalGrowthRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"discountRate",className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Rate (WACC) (%)"}),e.jsx("input",{id:"discountRate",type:"number",step:"0.01",value:100*(s.discountRate||0),onChange:e=>n("discountRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"projectionYears",className:"block text-sm font-medium text-gray-700 mb-1",children:"Projection Years"}),e.jsx("input",{id:"projectionYears",type:"number",min:"3",max:"10",value:s.projectionYears||5,onChange:e=>n("projectionYears",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}):(()=>{const a=Array.from({length:s.projectionYears||5},(e,s)=>s+1),t=s.yearlyData||{},r=s.balanceSheet||{};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Base Year (Current)"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Revenue ($)"}),e.jsx("input",{type:"number",value:s.currentRevenue||0,onChange:e=>n("currentRevenue",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terminal Growth Rate (%)"}),e.jsx("input",{type:"number",step:"0.01",value:100*(s.terminalGrowthRate||0),onChange:e=>n("terminalGrowthRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Rate (WACC) (%)"}),e.jsx("input",{type:"number",step:"0.01",value:100*(s.discountRate||0),onChange:e=>n("discountRate",e.target.value/100),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-4 py-3 border-b border-gray-200",children:e.jsx("h4",{className:"text-md font-semibold text-gray-900",children:"Annual Projections"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Metric"}),a.map(s=>e.jsxs("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Year ",s]},s))]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"Revenue Growth (%)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.revenueGrowth||0,onChange:e=>i(s,"revenueGrowth",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"EBITDA Margin (%)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.ebitdaMargin||0,onChange:e=>i(s,"ebitdaMargin",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"Tax Rate (%)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.taxRate||0,onChange:e=>i(s,"taxRate",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"CapEx (% of Revenue)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.capexPercent||0,onChange:e=>i(s,"capexPercent",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"D&A (% of Revenue)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.daPercent||0,onChange:e=>i(s,"daPercent",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:"Δ Working Capital (% of Rev)"}),a.map(s=>e.jsx("td",{className:"px-4 py-3",children:e.jsx("input",{type:"number",step:"0.1",value:t[s]?.workingCapitalChange||0,onChange:e=>i(s,"workingCapitalChange",e.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:ring-1 focus:ring-blue-500 focus:border-transparent"})},s))]})]})]})})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Balance Sheet Items"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cash ($)"}),e.jsx("input",{type:"number",value:r.cash||0,onChange:e=>c("cash",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Total Debt ($)"}),e.jsx("input",{type:"number",value:r.totalDebt||0,onChange:e=>c("totalDebt",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shares Outstanding"}),e.jsx("input",{type:"number",value:r.sharesOutstanding||0,onChange:e=>c("sharesOutstanding",e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]})]})]})})()]})},Y=({onBack:s})=>{const[t,r]=a.useState({currentRevenue:1e8,projectionYears:5,terminalGrowthRate:.025,discountRate:.12,yearlyData:{},balanceSheet:{}}),[u,g]=a.useState(null),[p,b]=a.useState(null),[y,j]=a.useState("inputs"),[f,v]=a.useState(!1);a.useEffect(()=>{const e=setTimeout(()=>{N()},500);return()=>clearTimeout(e)},[t]);const N=async()=>{if(!t.currentRevenue||t.currentRevenue<=0)return g(null),void b(null);v(!0);try{const e=l(t);g(e);const s=n(t);b(s)}catch(e){g(null),b(null)}v(!1)},w=e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",C=e=>e||0===e?`${e.toFixed(1)}%`:"0%",$=[{id:"inputs",name:"Model Inputs",icon:c},{id:"results",name:"Results",icon:d},{id:"charts",name:"Charts",icon:o},{id:"sensitivity",name:"Sensitivity",icon:x}];return e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-6 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center mb-4",children:s&&e.jsxs("button",{onClick:s,className:"flex items-center text-gray-600 hover:text-gray-900 mr-4",children:[e.jsx(i,{className:"w-5 h-5 mr-1"}),"Back to Overview"]})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Enhanced DCF Analysis Tool"}),e.jsx("p",{className:"text-gray-600",children:"Professional discounted cash flow modeling with year-by-year projections and sensitivity analysis"})]}),e.jsx("div",{className:"border-b border-gray-200 mb-8",children:e.jsx("nav",{className:"-mb-px flex space-x-8",children:$.map(s=>{const a=s.icon;return e.jsxs("button",{onClick:()=>j(s.id),className:"flex items-center py-2 px-1 border-b-2 font-medium text-sm transition-colors "+(y===s.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),children:[e.jsx(a,{className:"w-4 h-4 mr-2"}),s.name]},s.id)})})}),e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-8",children:["inputs"===y&&e.jsx("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:e.jsx(G,{inputs:t,setInputs:r})}),"results"===y&&e.jsxs("div",{className:"space-y-6",children:[f&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Calculating..."})]}),u&&!f&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Enterprise Value"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:w(u.enterpriseValue)})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Equity Value"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:w(u.equityValue)})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Share Price"}),e.jsxs("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:["$",u.impliedSharePrice.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500",children:"Terminal Value"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900 mt-1",children:w(u.presentValueTerminal)})]})]}),u?.projectionTable?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Financial Projections"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Metric"}),u.projectionTable.map((s,a)=>e.jsxs("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:["Year ",s.year]},a))]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Revenue"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.revenue)},a))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Revenue Growth %"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:C(s.revenueGrowth)},a))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"EBITDA"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.ebitda)},a))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"EBIT"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.ebit)},a))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"NOPAT"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.nopat)},a))]}),e.jsxs("tr",{className:"bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"CapEx"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.capex)},a))]}),e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"Δ Working Capital"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900 text-right",children:w(s.deltaWorkingCapital)},a))]}),e.jsxs("tr",{className:"bg-blue-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900",children:"Free Cash Flow"}),u.projectionTable.map((s,a)=>e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-bold text-blue-900 text-right",children:w(s.freeCashFlow)},a))]})]})]})})]}):null,e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Valuation Bridge"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"PV of Projection Period FCFs"}),e.jsx("span",{className:"font-semibold",children:w(u.cumulativePV)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"PV of Terminal Value"}),e.jsx("span",{className:"font-semibold",children:w(u.presentValueTerminal)})]}),e.jsxs("div",{className:"border-t pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-900 font-semibold",children:"Enterprise Value"}),e.jsx("span",{className:"font-bold text-lg",children:w(u.enterpriseValue)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Less: Net Debt"}),e.jsx("span",{className:"font-semibold",children:w(u.netDebt)})]}),e.jsxs("div",{className:"border-t pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-900 font-semibold",children:"Equity Value"}),e.jsx("span",{className:"font-bold text-lg text-blue-600",children:w(u.equityValue)})]})]})]})]})]}),"charts"===y&&e.jsx("div",{className:"space-y-6",children:u&&e.jsx(e.Fragment,{children:e.jsxs("div",{className:"bg-white p-6 rounded-lg border border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Cash Flow Projections"}),e.jsx("div",{className:"h-96",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(R,{data:u?u.years.map((e,s)=>({year:`Year ${e}`,freeCashFlow:u.freeCashFlows[s],presentValue:u.presentValues[s]})):[],children:[e.jsx(F,{strokeDasharray:"3 3"}),e.jsx(P,{dataKey:"year"}),e.jsx(T,{tickFormatter:e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",notation:"compact"}).format(e)}),e.jsx(D,{formatter:e=>[new Intl.NumberFormat("en-US",{style:"currency",currency:"USD"}).format(e)]}),e.jsx(S,{}),e.jsx(M,{type:"monotone",dataKey:"freeCashFlow",stroke:"#3b82f6",strokeWidth:2,name:"Free Cash Flow"}),e.jsx(M,{type:"monotone",dataKey:"presentValue",stroke:"#10b981",strokeWidth:2,name:"Present Value"})]})})})]})})}),"sensitivity"===y&&e.jsx("div",{className:"space-y-6",children:p&&(()=>{if(!p)return null;const{matrix:s,waccRange:a,terminalGrowthRange:t}=p;return e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b border-gray-200",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sensitivity Analysis - Implied Share Price"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Impact of WACC and Terminal Growth Rate changes on valuation"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 bg-gray-50",children:"WACC \\ Terminal Growth"}),t.map(s=>e.jsx("th",{className:"px-4 py-3 text-center text-xs font-medium text-gray-500 bg-gray-50",children:C(s)},s))]})}),e.jsx("tbody",{children:s.map((t,r)=>e.jsxs("tr",{className:r%2==0?"bg-white":"bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 text-sm font-medium text-gray-900",children:C(a[r])}),t.map((a,l)=>{const n=r===Math.floor(s.length/2)&&l===Math.floor(t.length/2);return e.jsxs("td",{className:"px-4 py-3 text-sm text-center "+(n?"bg-blue-100 font-bold text-blue-900":"text-gray-900"),children:["$",a.sharePrice.toFixed(2)]},l)})]},r))})]})})]})})()})]},y),u&&e.jsx("div",{className:"mt-8 text-center",children:e.jsxs("button",{className:"inline-flex items-center px-6 py-3 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700 transition-colors",onClick:()=>{},children:[e.jsx(h,{className:"w-5 h-5 mr-2"}),"Export Results"]})})]})})},I=({initialYears:r=5,minYears:l=1,maxYears:n=15,onYearsChange:i,className:c=""})=>{const[d,o]=a.useState(r),[x,m]=a.useState(!1),[h,u]=a.useState(0),[g,p]=a.useState(0),b=a.useCallback(e=>{const s=Math.max(l,Math.min(n,Math.round(e)));s!==d&&(o(s),i?.(s))},[d,l,n,i]),y=a.useCallback(e=>{e.preventDefault(),m(!0),u(e.clientX),p(d),document.body.style.cursor="ew-resize"},[d]),j=a.useCallback(e=>{if(!x)return;const s=e.clientX-h;b(g+.02*s)},[x,h,g,b]),f=a.useCallback(()=>{m(!1),document.body.style.cursor="default"},[]);a.useEffect(()=>{if(x)return document.addEventListener("mousemove",j),document.addEventListener("mouseup",f),()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",f)}},[x,j,f]);return e.jsxs(t,{className:`bg-gray-800 border-gray-700 p-6 ${c}`,children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(s,{name:"Clock",className:"w-5 h-5 text-blue-400"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Projection Period"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Years:"}),e.jsx("span",{className:"text-xl font-bold text-blue-400",children:d})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"relative h-12",children:[e.jsx("div",{className:"absolute top-4 left-0 right-0 h-2 bg-gray-700 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-blue-600 to-blue-400 rounded-full transition-all duration-200",style:{width:d/n*100+"%"}})}),e.jsx("div",{className:"absolute top-2 w-6 h-6 bg-blue-500 rounded-full border-2 border-white shadow-lg cursor-ew-resize transform -translate-x-1/2 hover:bg-blue-400 transition-colors duration-200",style:{left:d/n*100+"%"},onMouseDown:y,children:e.jsx("div",{className:"absolute inset-0 rounded-full animate-pulse bg-blue-400 opacity-30"})}),(()=>{const s=[],a=d<=5?1:d<=10?2:3;for(let t=1;t<=d;t+=a){const a=t/d*100;s.push(e.jsxs("div",{className:"absolute flex flex-col items-center transform -translate-x-1/2",style:{left:`${a}%`},children:[e.jsx("div",{className:"w-px h-3 bg-blue-400"}),e.jsxs("span",{className:"text-xs text-gray-400 mt-1",children:["Y",t]})]},t))}return s})()]}),e.jsx("div",{className:"px-2",children:e.jsx("input",{type:"range",min:l,max:n,value:d,onChange:e=>{const s=parseInt(e.target.value);b(s)},className:"w-full h-2 bg-gray-700 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, #3b82f6 0%, #3b82f6 ${d/n*100}%, #374151 ${d/n*100}%, #374151 100%)`}})})]}),e.jsx("div",{className:"flex justify-center space-x-2",children:[3,5,7,10,12,15].filter(e=>e>=l&&e<=n).map(s=>e.jsxs("button",{onClick:()=>{b(s)},className:"px-3 py-1 rounded-full text-sm font-medium transition-all duration-200 "+(d===s?"bg-blue-600 text-white shadow-lg":"bg-gray-700 text-gray-300 hover:bg-gray-600 hover:text-white"),children:[s,"Y"]},s))}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-sm text-gray-400",children:[d<=3&&"Short-term focus with higher accuracy",d>3&&d<=7&&"Balanced projection period for most analyses",d>7&&d<=10&&"Extended projection for growth companies",d>10&&"Long-term strategic planning horizon"]})}),e.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-gray-500",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{children:"Model updates automatically"})]})]}),e.jsx("style",{jsx:!0,children:"\n        .slider::-webkit-slider-thumb {\n          appearance: none;\n          width: 20px;\n          height: 20px;\n          border-radius: 50%;\n          background: #3b82f6;\n          border: 2px solid white;\n          cursor: pointer;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n          transition: all 0.2s ease;\n        }\n        \n        .slider::-webkit-slider-thumb:hover {\n          background: #2563eb;\n          transform: scale(1.1);\n        }\n        \n        .slider::-webkit-slider-track {\n          height: 8px;\n          border-radius: 4px;\n          background: transparent;\n        }\n        \n        .slider::-moz-range-thumb {\n          width: 20px;\n          height: 20px;\n          border-radius: 50%;\n          background: #3b82f6;\n          border: 2px solid white;\n          cursor: pointer;\n          box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);\n        }\n        \n        .slider::-moz-range-track {\n          height: 8px;\n          border-radius: 4px;\n        }\n      "})]})};const E=new class{constructor(){this.modelSubscriptions=new Map,this.calculationQueue=[],this.isProcessing=!1,this.lastCalculationTime=0,this.throttleDelay=50,this.calculationTimes=[],this.maxCalculationHistory=100}createReactiveModel(e,s,a,t){const r={id:e,type:s,inputs:{...a},result:null,callback:t,realTimeFeeds:new Map,lastUpdate:Date.now(),dependencies:new Set};return this.modelSubscriptions.set(e,r),this.calculateModel(r),this.setupRealTimeFeeds(r),{updateInput:(s,a)=>this.updateModelInput(e,s,a),updateInputs:s=>this.updateModelInputs(e,s),getResult:()=>r.result,destroy:()=>this.destroyModel(e),addDependency:(s,a)=>this.addModelDependency(e,s,a)}}updateModelInput(e,s,a){const t=this.modelSubscriptions.get(e);t&&(this.setNestedValue(t.inputs,s,a),t.lastUpdate=Date.now(),this.queueCalculation(t))}updateModelInputs(e,s){const a=this.modelSubscriptions.get(e);a&&(Object.entries(s).forEach(([e,s])=>{this.setNestedValue(a.inputs,e,s)}),a.lastUpdate=Date.now(),this.queueCalculation(a))}addModelDependency(e,s,a){const t=this.modelSubscriptions.get(e);if(!t)return;const r=`${s}_${a}`;t.dependencies.add(r);const l=A.subscribe(s,a,t=>{this.handleRealTimeUpdate(e,s,a,t)});t.realTimeFeeds.set(r,l)}handleRealTimeUpdate(e,s,a,t){if(this.modelSubscriptions.get(e))switch(s){case"stock_price":this.updateModelInput(e,"currentStockPrice",t.price);break;case"interest_rates":this.updateModelInput(e,"discountRate",t.rate/100);break;case"bond_yields":this.updateModelInput(e,"riskFreeRate",t.yield/100);break;default:this.updateModelInput(e,`realTimeData.${s}.${a}`,t)}}queueCalculation(e){this.calculationQueue.includes(e)||this.calculationQueue.push(e),this.isProcessing||this.processCalculationQueue()}async processCalculationQueue(){if(!this.isProcessing){for(this.isProcessing=!0;this.calculationQueue.length>0;){const e=Date.now()-this.lastCalculationTime;e<this.throttleDelay&&await new Promise(s=>setTimeout(s,this.throttleDelay-e));const s=this.calculationQueue.shift();s&&(await this.calculateModel(s),this.lastCalculationTime=Date.now())}this.isProcessing=!1}}async calculateModel(e){const s=performance.now();try{let a=null;switch(e.type){case"dcf":a=l(e.inputs);break;case"sensitivity":a=n(e.inputs);break;default:return}e.result=a;const t=performance.now()-s;this.trackCalculationPerformance(t),e.callback&&"function"==typeof e.callback&&e.callback(a,e.inputs)}catch(a){e.callback&&"function"==typeof e.callback&&e.callback(null,e.inputs,a)}}setupRealTimeFeeds(e){e.inputs.symbol&&this.addModelDependency(e.id,"stock_price",e.inputs.symbol),!1!==e.inputs.trackInterestRates&&this.addModelDependency(e.id,"interest_rates","USD_10Y")}destroyModel(e){const s=this.modelSubscriptions.get(e);s&&(s.realTimeFeeds.forEach(e=>e()),this.modelSubscriptions.delete(e))}setNestedValue(e,s,a){const t=s.split(".");let r=e;for(let l=0;l<t.length-1;l++){const e=t[l];e in r&&"object"==typeof r[e]||(r[e]={}),r=r[e]}r[t[t.length-1]]=a}trackCalculationPerformance(e){this.calculationTimes.push(e),this.calculationTimes.length>this.maxCalculationHistory&&this.calculationTimes.shift()}getPerformanceStats(){if(0===this.calculationTimes.length)return{avgTime:0,maxTime:0,minTime:0,totalCalculations:0};const e=this.calculationTimes,s=e.reduce((e,s)=>e+s,0)/e.length,a=Math.max(...e),t=Math.min(...e);return{avgTime:Math.round(100*s)/100,maxTime:Math.round(100*a)/100,minTime:Math.round(100*t)/100,totalCalculations:e.length}}getActiveModels(){return Array.from(this.modelSubscriptions.keys())}getModel(e){return this.modelSubscriptions.get(e)}},B=({symbol:l,onBack:n})=>{const[i]=a.useState(`dcf_${Date.now()}`),[c,d]=a.useState(null),[o,x]=a.useState(!1),[m,h]=a.useState(null),[u,g]=a.useState({}),[p,b]=a.useState(null),y=a.useRef(null),[j,f]=a.useState({currentRevenue:1e10,projectionYears:5,terminalGrowthRate:.025,discountRate:.12,symbol:l||"AAPL",trackRealTime:!0,yearlyData:{1:{revenueGrowth:15,ebitdaMargin:25,taxRate:25,capexPercent:4,daPercent:3,workingCapitalChange:2},2:{revenueGrowth:12,ebitdaMargin:24,taxRate:25,capexPercent:4,daPercent:3,workingCapitalChange:2},3:{revenueGrowth:10,ebitdaMargin:23,taxRate:25,capexPercent:3,daPercent:3,workingCapitalChange:1},4:{revenueGrowth:8,ebitdaMargin:22,taxRate:25,capexPercent:3,daPercent:3,workingCapitalChange:1},5:{revenueGrowth:6,ebitdaMargin:21,taxRate:25,capexPercent:3,daPercent:3,workingCapitalChange:1}},balanceSheet:{cash:1e8,totalDebt:5e7,sharesOutstanding:1e9}});a.useEffect(()=>{const e=E.createReactiveModel(i,"dcf",j,(e,s,a)=>{d(e),h(a),b(new Date),x(!1)});return y.current=e,j.trackRealTime&&j.symbol&&(e.addDependency("stock_price",j.symbol),e.addDependency("interest_rates","USD_10Y"),e.addDependency("bond_yields","US10Y")),()=>{y.current&&y.current.destroy()}},[i]),a.useEffect(()=>{if(!j.trackRealTime||!j.symbol)return;const e=[{dataType:"stock_price",symbol:j.symbol},{dataType:"interest_rates",symbol:"USD_10Y"},{dataType:"bond_yields",symbol:"US10Y"},{dataType:"volatility_index",symbol:"VIX"}];return A.subscribeMultiple(e.map(({dataType:e,symbol:s})=>({dataType:e,symbol:s,callback:a=>{g(t=>({...t,[`${e}_${s}`]:a}))}})))},[j.trackRealTime,j.symbol]);const v=a.useCallback((e,s)=>{x(!0),y.current&&y.current.updateInput(e,s),f(a=>{const t={...a},r=e.split(".");let l=t;for(let e=0;e<r.length-1;e++)r[e]in l||(l[r[e]]={}),l=l[r[e]];return l[r[r.length-1]]=s,t})},[]),N=a.useCallback((e,s,a)=>{v(`yearlyData.${e}.${s}`,parseFloat(a)||0)},[v]),w=a.useCallback(e=>{v("projectionYears",e),f(s=>{const a={...s};a.projectionYears=e;for(let t=Object.keys(s.yearlyData).length+1;t<=e;t++)if(!a.yearlyData[t]){const e=a.yearlyData[t-1]||a.yearlyData[Object.keys(a.yearlyData).pop()];a.yearlyData[t]={revenueGrowth:Math.max(2,(e?.revenueGrowth||10)-2),ebitdaMargin:e?.ebitdaMargin||20,taxRate:e?.taxRate||25,capexPercent:e?.capexPercent||3,daPercent:e?.daPercent||3,workingCapitalChange:e?.workingCapitalChange||1}}return Object.keys(a.yearlyData).forEach(s=>{parseInt(s)>e&&delete a.yearlyData[s]}),a})},[v]),C=a.useCallback(()=>{const e=!j.trackRealTime;v("trackRealTime",e),e&&j.symbol&&y.current&&(y.current.addDependency("stock_price",j.symbol),y.current.addDependency("interest_rates","USD_10Y"))},[j.trackRealTime,j.symbol,v]),k=(e,s=0)=>{if(!e)return"$0";const a=Math.abs(e);return a>=1e12?`$${(e/1e12).toFixed(s)}T`:a>=1e9?`$${(e/1e9).toFixed(s)}B`:a>=1e6?`$${(e/1e6).toFixed(s)}M`:a>=1e3?`$${(e/1e3).toFixed(s)}K`:`$${e.toFixed(s)}`},R=(s,a)=>{const t=u[`${s}_${a}`];return t?e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full animate-pulse"}),e.jsxs("span",{className:"text-gray-300",children:["stock_price"===s&&`$${t.price?.toFixed(2)}`,"interest_rates"===s&&`${t.rate?.toFixed(2)}%`,"bond_yields"===s&&`${t.yield?.toFixed(2)}%`,"volatility_index"===s&&`${t.volatility?.toFixed(1)}`]})]}):null};return e.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(r,{onClick:n,className:"bg-gray-700 hover:bg-gray-600",size:"sm",children:[e.jsx(s,{name:"ArrowLeft",className:"w-4 h-4 mr-2"}),"Back"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Living Model DCF"}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsx("p",{className:"text-gray-400",children:"Real-time, reactive financial modeling"}),p&&e.jsxs("span",{className:"text-xs text-green-400",children:["Updated: ",p.toLocaleTimeString()]})]})]})]}),e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 rounded-lg transition-colors "+(j.trackRealTime?"bg-green-600 hover:bg-green-700 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"),children:[e.jsx(s,{name:j.trackRealTime?"Zap":"ZapOff",className:"w-4 h-4"}),e.jsxs("span",{children:["Real-time: ",j.trackRealTime?"ON":"OFF"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[e.jsxs(t,{className:"bg-gray-800 border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(s,{name:"Building",className:"w-5 h-5 mr-2 text-blue-400"}),"Company Basics"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Symbol"}),e.jsx($,{value:j.symbol,onChange:e=>v("symbol",e.target.value.toUpperCase()),className:"bg-gray-700 border-gray-600",placeholder:"AAPL"}),j.trackRealTime&&R("stock_price",j.symbol)]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Current Revenue"}),e.jsx($,{type:"number",value:j.currentRevenue,onChange:e=>v("currentRevenue",parseFloat(e.target.value)||0),className:"bg-gray-700 border-gray-600",step:"1000000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Discount Rate (WACC)"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{type:"number",value:(100*j.discountRate).toFixed(1),onChange:e=>v("discountRate",parseFloat(e.target.value)/100||0),className:"bg-gray-700 border-gray-600",step:"0.1",min:"0",max:"50"}),e.jsx("span",{className:"text-gray-400",children:"%"})]}),j.trackRealTime&&R("interest_rates","USD_10Y")]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-300 mb-2",children:"Terminal Growth Rate"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{type:"number",value:(100*j.terminalGrowthRate).toFixed(1),onChange:e=>v("terminalGrowthRate",parseFloat(e.target.value)/100||0),className:"bg-gray-700 border-gray-600",step:"0.1",min:"0",max:"10"}),e.jsx("span",{className:"text-gray-400",children:"%"})]})]})]})]}),e.jsx(I,{initialYears:j.projectionYears,onYearsChange:w}),j.trackRealTime&&e.jsxs(t,{className:"bg-gray-800 border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(s,{name:"Activity",className:"w-5 h-5 mr-2 text-green-400"}),"Live Market Data"]}),e.jsxs("div",{className:"space-y-3",children:[R("stock_price",j.symbol)&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Stock Price:"}),R("stock_price",j.symbol)]}),R("bond_yields","US10Y")&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"10Y Treasury:"}),R("bond_yields","US10Y")]}),R("volatility_index","VIX")&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"VIX:"}),R("volatility_index","VIX")]})]})]})]}),e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(t,{className:"bg-gray-800 border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(s,{name:"Calendar",className:"w-5 h-5 mr-2 text-blue-400"}),"Year-by-Year Projections"]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:Array.from({length:j.projectionYears},(e,s)=>s+1).map(s=>e.jsxs("div",{className:"border border-gray-700 rounded-lg p-4",children:[e.jsxs("h4",{className:"font-semibold text-blue-400 mb-3",children:["Year ",s]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Rev Growth %"}),e.jsx($,{type:"number",value:j.yearlyData[s]?.revenueGrowth||0,onChange:e=>N(s,"revenueGrowth",e.target.value),className:"bg-gray-700 border-gray-600 text-sm",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"EBITDA Margin %"}),e.jsx($,{type:"number",value:j.yearlyData[s]?.ebitdaMargin||0,onChange:e=>N(s,"ebitdaMargin",e.target.value),className:"bg-gray-700 border-gray-600 text-sm",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"Tax Rate %"}),e.jsx($,{type:"number",value:j.yearlyData[s]?.taxRate||0,onChange:e=>N(s,"taxRate",e.target.value),className:"bg-gray-700 border-gray-600 text-sm",step:"0.1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-400 mb-1",children:"CapEx % Rev"}),e.jsx($,{type:"number",value:j.yearlyData[s]?.capexPercent||0,onChange:e=>N(s,"capexPercent",e.target.value),className:"bg-gray-700 border-gray-600 text-sm",step:"0.1"})]})]})]},s))})]})}),e.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[o&&e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-400",children:"Calculating..."})]}),m&&e.jsxs(t,{className:"bg-red-900/20 border-red-700 p-6",children:[e.jsxs("div",{className:"flex items-center text-red-400",children:[e.jsx(s,{name:"AlertCircle",className:"w-5 h-5 mr-2"}),e.jsx("span",{children:"Calculation Error"})]}),e.jsx("p",{className:"text-red-300 mt-2 text-sm",children:m.message})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs(t,{className:"bg-gray-800 border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(s,{name:"TrendingUp",className:"w-5 h-5 mr-2 text-green-400"}),"Key Results"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Enterprise Value:"}),e.jsx("span",{className:"font-semibold text-lg text-blue-400",children:k(c.enterpriseValue,1)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Equity Value:"}),e.jsx("span",{className:"font-semibold text-lg text-green-400",children:k(c.equityValue,1)})]}),e.jsxs("div",{className:"flex justify-between items-center border-t border-gray-700 pt-4",children:[e.jsx("span",{className:"text-gray-400",children:"Share Price:"}),e.jsxs("span",{className:"font-bold text-xl text-yellow-400",children:["$",c.impliedSharePrice?.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-gray-400",children:"Terminal Value:"}),e.jsx("span",{className:"font-semibold",children:k(c.terminalValue,1)})]})]})]}),e.jsxs(t,{className:"bg-gray-800 border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center",children:[e.jsx(s,{name:"DollarSign",className:"w-5 h-5 mr-2 text-blue-400"}),"Cash Flow Summary"]}),e.jsxs("div",{className:"space-y-2",children:[c.years?.map((s,a)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{className:"text-gray-400",children:["Year ",s," FCF:"]}),e.jsx("span",{className:"font-mono",children:k(c.freeCashFlows[a],1)})]},s)),e.jsx("div",{className:"border-t border-gray-700 pt-2 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center text-sm font-semibold",children:[e.jsx("span",{className:"text-gray-300",children:"PV of FCFs:"}),e.jsx("span",{children:k(c.cumulativePV,1)})]})})]})]})]})]})]})]})})},L=({onCompanySelect:s})=>{const[t,r]=a.useState(""),[l,n]=a.useState([]),[i,c]=a.useState(!1),o=[{id:"AAPL",name:"Apple Inc.",ticker:"AAPL",sector:"Technology",marketCap:3e12,price:175.84,change:2.34,changePercent:1.35,financials:{revenue:[274515e6,294135e6,365817e6,383285e6,394328e6],years:[2019,2020,2021,2022,2023]}},{id:"MSFT",name:"Microsoft Corporation",ticker:"MSFT",sector:"Technology",marketCap:28e11,price:378.85,change:-1.23,changePercent:-.32,financials:{revenue:[125843e6,143015e6,168088e6,19827e7,211915e6],years:[2019,2020,2021,2022,2023]}},{id:"GOOGL",name:"Alphabet Inc.",ticker:"GOOGL",sector:"Technology",marketCap:21e11,price:142.56,change:3.21,changePercent:2.3,financials:{revenue:[161857e6,182527e6,257637e6,282836e6,307394e6],years:[2019,2020,2021,2022,2023]}},{id:"JNJ",name:"Johnson & Johnson",ticker:"JNJ",sector:"Healthcare",marketCap:45e10,price:156.78,change:.89,changePercent:.57,financials:{revenue:[82059e6,82584e6,93775e6,94943e6,85159e6],years:[2019,2020,2021,2022,2023]}},{id:"PFE",name:"Pfizer Inc.",ticker:"PFE",sector:"Healthcare",marketCap:32e10,price:28.95,change:-.45,changePercent:-1.53,financials:{revenue:[5175e7,41908e6,81288e6,10033e7,58496e6],years:[2019,2020,2021,2022,2023]}}];a.useEffect(()=>{if(t.length>0){c(!0);const e=setTimeout(()=>{const e=o.filter(e=>e.name.toLowerCase().includes(t.toLowerCase())||e.ticker.toLowerCase().includes(t.toLowerCase()));n(e),c(!1)},300);return()=>clearTimeout(e)}n([]),c(!1)},[t]);const x=e=>{s(e),r(""),n([])};return e.jsxs("div",{className:"relative max-w-lg mx-auto",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:e.jsx(u,{className:"h-5 w-5 text-gray-400"})}),e.jsx("input",{type:"text",value:t,onChange:e=>r(e.target.value),className:"block w-full pl-10 pr-3 py-4 border border-gray-200 rounded-2xl leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg",placeholder:"Search companies (e.g., Apple, AAPL)"})]}),e.jsx(g,{children:(l.length>0||i)&&e.jsx(m.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-10 mt-2 w-full bg-white rounded-2xl shadow-xl border border-gray-100 overflow-hidden",children:i?e.jsxs("div",{className:"p-4 text-center text-gray-500",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("p",{className:"mt-2 text-sm",children:"Searching..."})]}):e.jsx("div",{className:"max-h-80 overflow-y-auto",children:l.map(s=>{return e.jsx(m.button,{onClick:()=>x(s),whileHover:{backgroundColor:"rgba(59, 130, 246, 0.05)"},className:"w-full p-4 text-left border-b border-gray-50 last:border-b-0 focus:outline-none focus:bg-blue-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(p,{className:"w-5 h-5 text-white"})})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("span",{className:"text-xs font-mono text-gray-500 bg-gray-100 px-2 py-0.5 rounded",children:s.ticker})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-0.5",children:[s.sector," • Market Cap: ",(a=s.marketCap,a>=1e12?`$${(a/1e12).toFixed(1)}T`:a>=1e9?`$${(a/1e9).toFixed(1)}B`:a>=1e6?`$${(a/1e6).toFixed(1)}M`:`$${a.toFixed(2)}`)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-sm font-medium text-gray-900",children:["$",s.price]}),e.jsxs("div",{className:"text-xs flex items-center "+(s.changePercent>=0?"text-green-600":"text-red-600"),children:[e.jsx(d,{className:"w-3 h-3 mr-1 "+(s.changePercent<0?"rotate-180":"")}),s.changePercent>=0?"+":"",s.changePercent.toFixed(2),"%"]})]})]})},s.id);var a})})})}),!t&&e.jsxs(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-8",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Popular Companies"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:o.slice(0,4).map(s=>e.jsx(m.button,{onClick:()=>x(s),whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-3 bg-white border border-gray-200 rounded-xl hover:border-blue-300 transition-all text-left",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center",children:e.jsx(p,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.ticker}),e.jsx("div",{className:"text-xs text-gray-500 truncate",children:s.name})]})]})},s.id))})]})]})},V=({company:s,compact:a=!1})=>{if(!s)return null;const t=e=>e>=1e12?`$${(e/1e12).toFixed(1)}T`:e>=1e9?`$${(e/1e9).toFixed(1)}B`:e>=1e6?`$${(e/1e6).toFixed(1)}M`:`$${e.toFixed(2)}`,r=s.financials?.revenue?.map((e,a)=>({year:s.financials.years[a],revenue:e/1e9}))||[],l=(e=>{if(!e||e.length<2)return 0;const s=e[e.length-1],a=e[e.length-2];return(s-a)/a*100})(s.financials?.revenue);return a?e.jsx(m.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-2xl p-6 border border-gray-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:e.jsx(p,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s.name}),e.jsx("p",{className:"text-sm text-gray-500",children:s.sector})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-semibold text-gray-900",children:["$",s.price]}),e.jsxs("div",{className:"text-sm flex items-center justify-end "+(s.changePercent>=0?"text-green-600":"text-red-600"),children:[e.jsx(d,{className:"w-4 h-4 mr-1 "+(s.changePercent<0?"rotate-180":"")}),s.changePercent>=0?"+":"",s.changePercent.toFixed(2),"%"]})]})]})}):e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-3xl p-8 border border-gray-100 shadow-sm",children:[e.jsxs("div",{className:"flex items-start justify-between mb-8",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center",children:e.jsx(p,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-light text-gray-900 mb-1",children:s.name}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-500",children:[e.jsx("span",{className:"font-mono bg-gray-100 px-2 py-1 rounded",children:s.ticker}),e.jsx("span",{children:s.sector}),e.jsxs("span",{children:["Market Cap: ",t(s.marketCap)]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-4xl font-light text-gray-900 mb-1",children:["$",s.price]}),e.jsxs("div",{className:"text-lg flex items-center justify-end "+(s.changePercent>=0?"text-green-600":"text-red-600"),children:[e.jsx(d,{className:"w-5 h-5 mr-2 "+(s.changePercent<0?"rotate-180":"")}),s.changePercent>=0?"+":"",s.change.toFixed(2)," (",s.changePercent.toFixed(2),"%)"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Revenue Trend"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsxs("span",{children:[s.financials?.years?.[0]," - ",s.financials?.years?.slice(-1)]})]})]}),e.jsx("div",{className:"h-48",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(R,{data:r,children:[e.jsx(P,{dataKey:"year",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#6B7280"}}),e.jsx(T,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#6B7280"},tickFormatter:e=>`$${e}B`}),e.jsx(M,{type:"monotone",dataKey:"revenue",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",strokeWidth:0,r:4},activeDot:{r:6,stroke:"#3B82F6",strokeWidth:2,fill:"#fff"}})]})})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Latest Revenue"}),e.jsx(y,{className:"w-4 h-4 text-gray-400"})]}),e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:t(s.financials?.revenue?.slice(-1)[0]||0)}),e.jsxs("div",{className:"text-sm mt-1 "+(l>=0?"text-green-600":"text-red-600"),children:[l>=0?"+":"",l.toFixed(1),"% YoY"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Market Cap"}),e.jsx(d,{className:"w-4 h-4 text-gray-400"})]}),e.jsx("div",{className:"text-2xl font-semibold text-gray-900",children:t(s.marketCap)}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Public Market"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-2xl p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Sector"}),e.jsx(p,{className:"w-4 h-4 text-gray-400"})]}),e.jsx("div",{className:"text-lg font-medium text-gray-900",children:s.sector}),e.jsx("div",{className:"text-sm text-gray-500 mt-1",children:"Industry Classification"})]})]})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-2xl p-4",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Financial data loaded • Ready for analysis"})]})})]})},_=({moduleId:s,companyData:t,inputs:r,results:l,onInputChange:n,onFocus:i,onRemove:x,isCompact:h=!1,isFullscreen:u=!1})=>{const[g,p]=a.useState("assumptions"),w={dcf:{name:"DCF Analysis",icon:c,color:"blue",description:"Discounted cash flow valuation model"},comparables:{name:"Comparable Analysis",icon:o,color:"green",description:"Peer group valuation analysis"},lbo:{name:"LBO Analysis",icon:j,color:"purple",description:"Leveraged buyout return analysis"}}[s],C=w.icon,S=({label:s,value:a,min:t,max:r,step:l,suffix:n="",onChange:i})=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:s}),e.jsxs("span",{className:"text-sm font-mono text-gray-900 bg-gray-100 px-2 py-1 rounded",children:[a.toFixed(l<1?1:0),n]})]}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"range",min:t,max:r,step:l,value:a,onChange:e=>i(parseFloat(e.target.value)),className:"w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider",style:{background:`linear-gradient(to right, rgb(59 130 246) 0%, rgb(59 130 246) ${(a-t)/(r-t)*100}%, rgb(229 231 235) ${(a-t)/(r-t)*100}%, rgb(229 231 235) 100%)`}})})]});return e.jsx(m.div,{layout:!0,className:""+(u?"":"bg-white border border-gray-100 rounded-2xl overflow-hidden"),children:(()=>{switch(s){case"dcf":return(()=>{if(!r)return null;const s=(e,s)=>{n({[e]:s})},t=(e,s,a)=>{const t={...r.yearlyData,[e]:{...r.yearlyData?.[e],[s]:a}};n({yearlyData:t})},c=a.useMemo(()=>l?.freeCashFlows?l.years.map((e,s)=>({year:`Y${e}`,fcf:l.freeCashFlows[s]/1e6,pv:l.presentValues[s]/1e6})):[],[l]);return h?e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:`w-10 h-10 bg-${w.color}-100 rounded-lg flex items-center justify-center`,children:e.jsx(C,{className:`w-5 h-5 text-${w.color}-600`})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:w.name}),e.jsx("p",{className:"text-sm text-gray-500",children:w.description})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:i,className:"p-2 text-gray-400 hover:text-blue-600 transition-colors",children:e.jsx(f,{className:"w-4 h-4"})}),e.jsx("button",{onClick:x,className:"p-2 text-gray-400 hover:text-red-600 transition-colors",children:e.jsx(v,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(S,{label:"Terminal Growth Rate",value:100*(r.terminalGrowthRate||.025),min:0,max:5,step:.1,suffix:"%",onChange:e=>s("terminalGrowthRate",e/100)}),e.jsx(S,{label:"Discount Rate (WACC)",value:100*(r.discountRate||.12),min:5,max:20,step:.1,suffix:"%",onChange:e=>s("discountRate",e/100)})]}),l&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Enterprise Value"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",(l.enterpriseValue/1e9).toFixed(1),"B"]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-3",children:[e.jsx("div",{className:"text-sm text-gray-600 mb-1",children:"Implied Price"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-900",children:["$",l.impliedSharePrice?.toFixed(2)||"0.00"]})]})]}),c.length>0&&e.jsx("div",{className:"h-32",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(R,{data:c,children:[e.jsx(M,{type:"monotone",dataKey:"fcf",stroke:"#3B82F6",strokeWidth:2,dot:!1}),e.jsx(P,{dataKey:"year",tick:{fontSize:10}}),e.jsx(T,{tick:{fontSize:10}}),e.jsx(D,{formatter:e=>[`$${e.toFixed(0)}M`,"FCF"],labelStyle:{color:"#374151"}})]})})})]}):e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:"Model Assumptions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{label:"Current Revenue",value:r.currentRevenue||0,min:1e6,max:1e12,step:1e6,suffix:"",onChange:e=>s("currentRevenue",e)}),e.jsx(S,{label:"Terminal Growth Rate",value:100*(r.terminalGrowthRate||.025),min:0,max:5,step:.1,suffix:"%",onChange:e=>s("terminalGrowthRate",e/100)}),e.jsx(S,{label:"Discount Rate (WACC)",value:100*(r.discountRate||.12),min:5,max:20,step:.1,suffix:"%",onChange:e=>s("discountRate",e/100)})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(S,{label:"Projection Years",value:r.projectionYears||5,min:3,max:10,step:1,suffix:" years",onChange:e=>s("projectionYears",e)}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Year 1 Assumptions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsx(S,{label:"Revenue Growth",value:r.yearlyData?.[1]?.revenueGrowth||10,min:-10,max:50,step:.5,suffix:"%",onChange:e=>t(1,"revenueGrowth",e)}),e.jsx(S,{label:"EBITDA Margin",value:r.yearlyData?.[1]?.ebitdaMargin||20,min:0,max:50,step:.5,suffix:"%",onChange:e=>t(1,"ebitdaMargin",e)})]})]})]})]})]}),l&&e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-1 space-y-4",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Valuation Results"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(y,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-blue-900",children:"Enterprise Value"})]}),e.jsxs("span",{className:"text-lg font-bold text-blue-900",children:["$",(l.enterpriseValue/1e9).toFixed(1),"B"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(d,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-medium text-green-900",children:"Equity Value"})]}),e.jsxs("span",{className:"text-lg font-bold text-green-900",children:["$",(l.equityValue/1e9).toFixed(1),"B"]})]}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-purple-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(N,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"text-sm font-medium text-purple-900",children:"Implied Price"})]}),e.jsxs("span",{className:"text-lg font-bold text-purple-900",children:["$",l.impliedSharePrice?.toFixed(2)||"0.00"]})]})]})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-100 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Free Cash Flow Projection"}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-500",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsxs("span",{children:[r.projectionYears||5," Year Model"]})]})]}),e.jsx("div",{className:"h-64",children:e.jsx(k,{width:"100%",height:"100%",children:e.jsxs(R,{data:c,children:[e.jsx(F,{strokeDasharray:"3 3",stroke:"#f1f5f9"}),e.jsx(P,{dataKey:"year",axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#64748b"}}),e.jsx(T,{axisLine:!1,tickLine:!1,tick:{fontSize:12,fill:"#64748b"},tickFormatter:e=>`$${e}M`}),e.jsx(D,{formatter:(e,s)=>[`$${e.toFixed(0)}M`,"fcf"===s?"Free Cash Flow":"Present Value"],labelStyle:{color:"#374151"},contentStyle:{backgroundColor:"#ffffff",border:"1px solid #e5e7eb",borderRadius:"8px"}}),e.jsx(M,{type:"monotone",dataKey:"fcf",stroke:"#3B82F6",strokeWidth:3,dot:{fill:"#3B82F6",strokeWidth:0,r:4},name:"fcf"}),e.jsx(M,{type:"monotone",dataKey:"pv",stroke:"#10B981",strokeWidth:3,dot:{fill:"#10B981",strokeWidth:0,r:4},name:"pv"})]})})})]})})]})]})})();case"comparables":return e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx(o,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Comparable analysis module coming soon"})]});case"lbo":return e.jsxs("div",{className:"p-6 text-center text-gray-500",children:[e.jsx(j,{className:"w-12 h-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"LBO analysis module coming soon"})]});default:return null}})()})},U={type:"spring",stiffness:400,damping:25},O=()=>{const[s,t]=a.useState(null),[r,n]=a.useState([]),[i,d]=a.useState("overview"),[x,h]=a.useState(null),[p,b]=a.useState({profile:null,financials:null,marketData:null,consensus:null}),[y,f]=a.useState({dcf:{currentRevenue:0,projectionYears:5,terminalGrowthRate:.025,discountRate:.12,yearlyData:{},balanceSheet:{}}}),[v,N]=a.useState({}),k=[{id:"dcf",name:"DCF Analysis",icon:c,description:"Discounted Cash Flow valuation",color:"blue",isPrimary:!0},{id:"comparables",name:"Comparable Analysis",icon:o,description:"Peer comparison analysis",color:"green",isPrimary:!0},{id:"lbo",name:"LBO Analysis",icon:j,description:"Leveraged buyout modeling",color:"purple",isPrimary:!1}],R=a.useCallback(async e=>{if(t(e),d("analysis"),e.financials?.revenue){const s=e.financials.revenue[e.financials.revenue.length-1],a=F(e.financials.revenue);f(t=>({...t,dcf:{...t.dcf,currentRevenue:s,yearlyData:P(a,e.sector)}}))}n(["dcf"])},[]),F=e=>{if(!e||e.length<2)return[];const s=[];for(let a=1;a<e.length;a++){const t=(e[a]-e[a-1])/e[a-1]*100;s.push(t)}return s},P=(e,s)=>{const a=e.length>0?e.reduce((e,s)=>e+s,0)/e.length:10,t=T(s),r={};for(let l=1;l<=5;l++){const e=Math.max(a*(1-.1*(l-1)),t.terminalGrowth);r[l]={revenueGrowth:e,ebitdaMargin:t.ebitdaMargin,taxRate:t.taxRate,capexPercent:t.capexPercent,daPercent:t.daPercent,workingCapitalChange:t.workingCapitalChange}}return r},T=e=>{const s={Technology:{ebitdaMargin:25,taxRate:21,capexPercent:3,daPercent:5,workingCapitalChange:1,terminalGrowth:3},Healthcare:{ebitdaMargin:20,taxRate:25,capexPercent:4,daPercent:4,workingCapitalChange:2,terminalGrowth:2.5},default:{ebitdaMargin:18,taxRate:25,capexPercent:5,daPercent:4,workingCapitalChange:2,terminalGrowth:2.5}};return s[e]||s.default},D=e=>{n(s=>s.filter(s=>s!==e)),x===e&&(h(null),d("analysis"))},S=a.useCallback((e,s)=>{if(f(a=>({...a,[e]:{...a[e],...s}})),"dcf"===e){const e=l({...y.dcf,...s});N(s=>({...s,dcf:e}))}},[y]),M={overview:{scale:1,y:0,transition:U},analysis:{scale:1,y:0,transition:U},focused:{scale:1.02,y:-20,transition:U}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-gray-50 to-white",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-gray-100",children:e.jsx("div",{className:"max-w-7xl mx-auto px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[s?e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>{t(null),d("overview"),n([])},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(w,{size:20})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-light text-gray-900",children:s.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[s.sector," • ",s.ticker]})]})]}):e.jsx("h1",{className:"text-2xl font-light text-gray-900",children:"Analysis Canvas"}),s&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>d("analysis"),className:"px-3 py-1.5 text-sm rounded-full transition-all "+("analysis"===i?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"),children:"Analysis"}),x&&e.jsx("button",{onClick:()=>d("focused"),className:"px-3 py-1.5 text-sm rounded-full transition-all "+("focused"===i?"bg-blue-100 text-blue-700":"text-gray-500 hover:text-gray-700"),children:"Focus"})]})]})})}),e.jsx(m.div,{variants:M,animate:i,className:"max-w-7xl mx-auto px-6 py-8",children:e.jsx(g,{mode:"wait",children:s?"focused"===i&&x?e.jsxs(m.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:U,className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>d("analysis"),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(C,{className:"w-5 h-5 rotate-180"})}),e.jsx("h2",{className:"text-2xl font-light text-gray-900",children:k.find(e=>e.id===x)?.name})]}),e.jsx("button",{onClick:()=>D(x),className:"text-gray-400 hover:text-red-500 transition-colors",children:"Remove"})]}),e.jsx(_,{moduleId:x,companyData:s,inputs:y[x],results:v[x],onInputChange:e=>S(x,e),isFullscreen:!0})]},"focused-module"):e.jsxs(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:U,className:"space-y-8",children:[e.jsx(V,{company:s,compact:r.length>0}),r.length>0&&e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:r.map(a=>e.jsx(m.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},transition:U,className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden hover:shadow-md transition-shadow duration-300",children:e.jsx(_,{moduleId:a,companyData:s,inputs:y[a],results:v[a],onInputChange:e=>S(a,e),onFocus:()=>(e=>{h(e),d("focused")})(a),onRemove:()=>D(a),isCompact:!0})},a))}),e.jsxs("div",{className:"border-t border-gray-100 pt-8",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Available Analysis Tools"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:k.filter(e=>!r.includes(e.id)).map(s=>{const a=s.icon;return e.jsxs(m.button,{onClick:()=>{return e=s.id,void(r.includes(e)||n(s=>[...s,e]));var e},whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-6 bg-white rounded-xl border border-gray-200 hover:border-gray-300 transition-all duration-200 text-left group",children:[e.jsx("div",{className:`inline-flex items-center justify-center w-12 h-12 bg-${s.color}-50 rounded-lg mb-3 group-hover:bg-${s.color}-100 transition-colors`,children:e.jsx(a,{className:`w-6 h-6 text-${s.color}-600`})}),e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.description})]},s.id)})})]})]},"analysis-canvas"):e.jsx(m.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:U,className:"text-center py-12",children:e.jsxs("div",{className:"max-w-2xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-50 rounded-full mb-4",children:e.jsx(u,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h2",{className:"text-3xl font-light text-gray-900 mb-3",children:"Begin Your Analysis"}),e.jsx("p",{className:"text-lg text-gray-600",children:"Select a company to start building your financial model"})]}),e.jsx(L,{onCompanySelect:R})]})},"company-selection")})})]})},W=()=>{const[l,n]=a.useState("overview");return"dcf"===l?e.jsx(Y,{onBack:()=>n("overview")}):"living-dcf"===l?e.jsx(B,{onBack:()=>n("overview")}):"canvas"===l?e.jsx(O,{}):e.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-6",children:e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Valuation Tool"}),e.jsx("p",{className:"text-gray-400",children:"Professional valuation models and analysis tools"})]}),e.jsx("div",{className:"mb-8",children:e.jsx(t,{className:"bg-gradient-to-r from-emerald-900 to-teal-900 border-emerald-700",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"Zap",className:"w-10 h-10 text-emerald-300 mr-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"The Living Model"}),e.jsx("div",{className:"ml-3 px-2 py-1 bg-emerald-600 text-emerald-100 text-xs font-semibold rounded-full",children:"NEW"})]}),e.jsx("p",{className:"text-emerald-100 mb-6 text-lg leading-relaxed",children:"Experience financial modeling transformed. Real-time data integration, instantaneous calculations, and fluid time period adjustments create a living, breathing analysis that evolves with every input change."}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsx("span",{className:"px-3 py-1 bg-emerald-800/50 text-emerald-200 rounded-full text-sm",children:"Real-Time Data Feeds"}),e.jsx("span",{className:"px-3 py-1 bg-emerald-800/50 text-emerald-200 rounded-full text-sm",children:"Instantaneous Calculations"}),e.jsx("span",{className:"px-3 py-1 bg-emerald-800/50 text-emerald-200 rounded-full text-sm",children:"Dynamic Time Periods"}),e.jsx("span",{className:"px-3 py-1 bg-emerald-800/50 text-emerald-200 rounded-full text-sm",children:'No "Run" Button'})]}),e.jsx(r,{className:"bg-white text-emerald-900 hover:bg-emerald-50 font-semibold px-8 py-3",onClick:()=>n("living-dcf"),children:"Experience The Living Model"})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsxs("div",{className:"w-32 h-32 bg-emerald-800/30 rounded-2xl flex items-center justify-center relative",children:[e.jsx(s,{name:"Activity",className:"w-16 h-16 text-emerald-300"}),e.jsx("div",{className:"absolute inset-0 rounded-2xl bg-emerald-400/20 animate-pulse"})]})})]})})})}),e.jsx("div",{className:"mb-8",children:e.jsx(t,{className:"bg-gradient-to-r from-blue-900 to-indigo-900 border-blue-700",children:e.jsx("div",{className:"p-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"Sparkles",className:"w-10 h-10 text-blue-300 mr-4"}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Analysis Canvas"})]}),e.jsx("p",{className:"text-blue-100 mb-6 text-lg leading-relaxed",children:"A unified workspace that reimagines financial analysis. Start with any company and seamlessly flow between DCF modeling, comparable analysis, and scenario planning—all in one integrated environment."}),e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6",children:[e.jsx("span",{className:"px-3 py-1 bg-blue-800/50 text-blue-200 rounded-full text-sm",children:"Company-Centric Workflow"}),e.jsx("span",{className:"px-3 py-1 bg-blue-800/50 text-blue-200 rounded-full text-sm",children:"Intelligent Defaults"}),e.jsx("span",{className:"px-3 py-1 bg-blue-800/50 text-blue-200 rounded-full text-sm",children:"Interactive Analysis"}),e.jsx("span",{className:"px-3 py-1 bg-blue-800/50 text-blue-200 rounded-full text-sm",children:"Minimal Design"})]}),e.jsx(r,{className:"bg-white text-blue-900 hover:bg-blue-50 font-semibold px-8 py-3",onClick:()=>n("canvas"),children:"Enter Analysis Canvas"})]}),e.jsx("div",{className:"hidden lg:block",children:e.jsx("div",{className:"w-32 h-32 bg-blue-800/30 rounded-2xl flex items-center justify-center",children:e.jsx(s,{name:"BarChart3",className:"w-16 h-16 text-blue-300"})})})]})})})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs(t,{className:"bg-gray-800 border-gray-700 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-20 h-20 bg-emerald-500/10 rounded-full -translate-y-10 translate-x-10"}),e.jsxs("div",{className:"p-6 relative",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"Zap",className:"w-8 h-8 text-emerald-400 mr-3"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Living Model DCF"}),e.jsx("div",{className:"ml-2 px-2 py-1 bg-emerald-600 text-emerald-100 text-xs font-semibold rounded-full",children:"NEW"})]}),e.jsx("p",{className:"text-gray-400 mb-4",children:'Real-time, reactive DCF modeling with live data feeds and instantaneous calculations. No more "run" buttons—watch your model come alive.'}),e.jsx(r,{className:"w-full bg-emerald-600 hover:bg-emerald-700",onClick:()=>n("living-dcf"),children:"Experience The Living Model"})]})]}),e.jsx(t,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"TrendingUp",className:"w-8 h-8 text-blue-400 mr-3"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Enhanced DCF Analysis"})]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Professional DCF modeling with year-by-year projections, sensitivity analysis, and detailed financial statements"}),e.jsx(r,{className:"w-full",onClick:()=>n("dcf"),children:"Launch Enhanced DCF Tool"})]})}),e.jsx(t,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"BarChart3",className:"w-8 h-8 text-green-400 mr-3"}),e.jsx("h3",{className:"text-xl font-semibold",children:"Comparable Analysis"})]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Peer comparison and relative valuation metrics"}),e.jsx(r,{className:"w-full",disabled:!0,children:"Coming Soon"})]})}),e.jsx(t,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(s,{name:"Calculator",className:"w-8 h-8 text-purple-400 mr-3"}),e.jsx("h3",{className:"text-xl font-semibold",children:"LBO Analysis"})]}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Leveraged buyout modeling and returns analysis"}),e.jsx(r,{className:"w-full",disabled:!0,children:"Coming Soon"})]})})]}),e.jsx("div",{className:"mt-8",children:e.jsx(t,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Enhanced DCF Features"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-blue-400 mb-2",children:"Year-by-Year Modeling"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"• Individual assumptions for each projection year"}),e.jsx("li",{children:"• Revenue growth, margins, tax rates, and capex"}),e.jsx("li",{children:"• Working capital and D&A projections"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-green-400 mb-2",children:"Professional Calculations"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"• Proper Unlevered Free Cash Flow calculation"}),e.jsx("li",{children:"• Enterprise to Equity value bridge"}),e.jsx("li",{children:"• Balance sheet integration"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-purple-400 mb-2",children:"Advanced Analytics"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"• WACC and terminal growth sensitivity analysis"}),e.jsx("li",{children:"• Interactive projection tables"}),e.jsx("li",{children:"• Cash flow visualization charts"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-orange-400 mb-2",children:"User Experience"}),e.jsxs("ul",{className:"text-gray-400 text-sm space-y-1",children:[e.jsx("li",{children:"• Simple and detailed input modes"}),e.jsx("li",{children:"• Real-time calculation updates"}),e.jsx("li",{children:"• Export capabilities"})]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx(r,{className:"bg-blue-600 hover:bg-blue-700",onClick:()=>n("dcf"),children:"Try Enhanced DCF Tool"})})]})})}),e.jsx("div",{className:"mt-8",children:e.jsx(t,{className:"bg-gray-800 border-gray-700",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-semibold mb-4",children:"Quick Access Terminal"}),e.jsx("p",{className:"text-gray-400 mb-4",children:"Use the enhanced terminal interface for advanced valuation commands:"}),e.jsxs("div",{className:"bg-gray-900 rounded-lg p-4 font-mono text-sm",children:[e.jsx("div",{className:"text-green-400",children:"$ DCF(AAPL)"}),e.jsx("div",{className:"text-green-400",children:"$ LBO(TSLA)"}),e.jsx("div",{className:"text-green-400",children:"$ COMP(MSFT)"}),e.jsx("div",{className:"text-green-400",children:'$ HELP("VALUATION")'})]}),e.jsx("div",{className:"mt-4",children:e.jsx(r,{disabled:!0,children:"Terminal Interface - Coming Soon"})})]})})})]})})};export{W as default};
//# sourceMappingURL=ValuationTool-ZOqNbORz.js.map
