import{j as e,W as t,K as s,i as a,w as r,x as n,r as i,y as o}from"./react-vendor-CaXMqa0k.js";import{s as c,I as l,u as d}from"./index-DPdPN0n0.js";import{B as m}from"./Button-DP1W3JTY.js";import{H as u}from"./Header-BiC9vSZ5.js";import{a as h}from"./apiLogger-BNPwdfUB.js";import{B as p,P as x,A as g,a as y}from"./Progress-BgtNI-d-.js";import{C as f,a as b,b as v,c as j}from"./Card-CWZtCt1D.js";import{I as w}from"./Input-Cd7DyeLJ.js";import"./vendor-zO7HU-o7.js";import"./data-vendor-DpIj8wd6.js";import"./ui-vendor-DOXsx3JB.js";import"./utils-vendor-Cj_bvvWu.js";import"./state-vendor-DL0PFC30.js";const N=new class{constructor(){this.validationRules=this.initializeValidationRules(),this.qualityMetrics=new Map,this.anomalyDetection=new Map}initializeValidationRules(){return{marketData:{required:["symbol","currentPrice","volume"],numeric:["currentPrice","previousClose","change","changePercent","volume","marketCap"],ranges:{currentPrice:{min:0,max:1e5},volume:{min:0,max:1e12},changePercent:{min:-50,max:50}},formats:{symbol:/^[A-Z]{1,5}$/,timestamp:/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}/}},financialStatements:{required:["revenue","netIncome"],numeric:["revenue","netIncome","totalDebt","cashAndCashEquivalents"],ranges:{revenue:{min:0,max:1e12},netIncome:{min:-1e11,max:1e11}}},companyProfile:{required:["symbol","companyName","sector"],numeric:["mktCap","pe","pb","beta"],ranges:{pe:{min:0,max:1e3},pb:{min:0,max:100},beta:{min:-5,max:5}}},dcfModel:{required:["cashFlows","discountRate"],numeric:["discountRate","terminalGrowthRate","years"],custom:e=>{const t=[];return Array.isArray(e.cashFlows)&&0!==e.cashFlows.length||t.push("Cash flows must be a non-empty array"),e.discountRate<0&&t.push("Discount rate must be non-negative"),{errors:t,warnings:[]}}},lboModel:{required:["purchasePrice","debtFinancing","equityFinancing"],numeric:["purchasePrice","debtFinancing","equityFinancing","exitMultiple","holdingPeriod"],custom:e=>{const t=[],s=[];if(e.debtFinancing&&e.equityFinancing&&e.purchasePrice){const a=e.debtFinancing+e.equityFinancing;Math.abs(a-e.purchasePrice)>.01&&t.push("Debt + Equity must equal purchase price");e.debtFinancing/e.purchasePrice>.9&&s.push("High leverage ratio detected")}return{errors:t,warnings:s}}},stockData:{required:["symbol","price"],numeric:["price","volume","change","changePercent"],custom:e=>{const t=[];return e.symbol&&"string"==typeof e.symbol&&""!==e.symbol.trim()||t.push("Symbol is required and must be a non-empty string"),("number"!=typeof e.price||e.price<0)&&t.push("Price must be a positive number"),{errors:t,warnings:[]}}}}}validateData(e,t){try{const s=this.validationRules[t];if(!s)return{isValid:!1,errors:[`Unknown data type: ${t}`]};const a=[],r=[];for(const t of s.required||[])void 0!==e[t]&&null!==e[t]||a.push(`Missing required field: ${t}`);for(const t of s.numeric||[])if(void 0!==e[t]&&null!==e[t]){const n=parseFloat(e[t]);if(isNaN(n))a.push(`Field ${t} must be numeric, got: ${e[t]}`);else{const e=s.ranges?.[t];e&&(n<e.min||n>e.max)&&r.push(`Field ${t} value ${n} outside expected range [${e.min}, ${e.max}]`)}}for(const[t,o]of Object.entries(s.formats||{}))e[t]&&!o.test(e[t])&&a.push(`Field ${t} format invalid: ${e[t]}`);const n=this.validateBusinessLogic(e,t);if(a.push(...n.errors),r.push(...n.warnings),s.custom){const t=s.custom(e);a.push(...t.errors||[]),r.push(...t.warnings||[])}const i=0===a.length;return i?r.length>0&&h.log("WARN",`Data validation warnings for ${t}`,{warnings:r}):h.log("ERROR",`Data validation failed for ${t}`,{errors:a,warnings:r}),{isValid:i,errors:a,warnings:r,qualityScore:this.calculateQualityScore(a,r)}}catch(s){return{isValid:!1,errors:["An unexpected error occurred during validation."],warnings:[]}}}validateBusinessLogic(e,t){const s=[],a=[];switch(t){case"marketData":if(e.currentPrice&&e.previousClose){const t=e.currentPrice-e.previousClose,s=t/e.previousClose*100;e.change&&Math.abs(e.change-t)>.01&&a.push(`Price change inconsistency: reported ${e.change}, calculated ${t.toFixed(2)}`),e.changePercent&&Math.abs(e.changePercent-s)>.1&&a.push(`Change percent inconsistency: reported ${e.changePercent}%, calculated ${s.toFixed(2)}%`)}e.currentPrice&&e.dayHigh&&e.dayLow&&(e.currentPrice>e.dayHigh&&a.push(`Current price ${e.currentPrice} exceeds day high ${e.dayHigh}`),e.currentPrice<e.dayLow&&a.push(`Current price ${e.currentPrice} below day low ${e.dayLow}`),e.dayLow>e.dayHigh&&s.push(`Day low ${e.dayLow} greater than day high ${e.dayHigh}`));break;case"financialStatements":if(e.revenue&&e.netIncome){const t=e.netIncome/e.revenue*100;(t<-100||t>100)&&a.push(`Unusual net profit margin: ${t.toFixed(2)}%`)}if(e.totalCurrentAssets&&e.totalCurrentLiabilities){const t=e.totalCurrentAssets/e.totalCurrentLiabilities;(t<.1||t>20)&&a.push(`Unusual current ratio: ${t.toFixed(2)}`)}break;case"companyProfile":e.pe&&(e.pe<0||e.pe>500)&&a.push(`Unusual P/E ratio: ${e.pe}`),e.pb&&(e.pb<0||e.pb>50)&&a.push(`Unusual P/B ratio: ${e.pb}`)}return{errors:s,warnings:a}}calculateQualityScore(e,t){return e.length>0?Math.max(0,50-10*e.length):Math.max(70,100-5*t.length)}crossValidateData(e,t){if(e.length<2)return{isConsistent:!0,discrepancies:[],recommendedSource:e[0]?.source};const s=[],a=this.validationRules[t]?.numeric||[];for(const i of a){const t=e.filter(e=>void 0!==e[i]&&null!==e[i]).map(e=>({value:parseFloat(e[i]),source:e.source}));if(t.length>1){const e=t.reduce((e,t)=>e+t.value,0)/t.length,a=Math.max(...t.map(t=>Math.abs(t.value-e))),r=.05*e;a>r&&s.push({field:i,values:t,mean:e,maxDeviation:a,threshold:r})}}const r=e.map(e=>{const s=this.validateData(e,t);return{source:e.source,qualityScore:s.qualityScore,errorCount:s.errors.length,warningCount:s.warnings.length}}),n=r.sort((e,t)=>t.qualityScore-e.qualityScore)[0]?.source;return{isConsistent:0===s.length,discrepancies:s,sourceQuality:r,recommendedSource:n}}detectAnomalies(e,t){if(e.length<10)return[];const s=e.map(e=>parseFloat(e[t])).filter(e=>!isNaN(e)),a=s.reduce((e,t)=>e+t,0)/s.length,r=s.reduce((e,t)=>e+Math.pow(t-a,2),0)/s.length,n=Math.sqrt(r),i=[];return e.forEach((e,s)=>{const r=parseFloat(e[t]);if(!isNaN(r)){const t=Math.abs((r-a)/n);t>2.5&&i.push({index:s,timestamp:e.timestamp,value:r,zScore:t,deviation:r-a,severity:t>3?"high":"medium"})}}),i}getValidationSummary(e,t){const s=this.validateData(e,t);return{dataType:t,timestamp:(new Date).toISOString(),isValid:s.isValid,qualityScore:s.qualityScore,errorCount:s.errors.length,warningCount:s.warnings.length,completeness:this.calculateCompleteness(e,t),freshness:this.calculateFreshness(e),source:e.source||"unknown"}}calculateCompleteness(e,t){const s=this.validationRules[t];if(!s)return 0;const a=[...s.required||[],...s.numeric||[],...Object.keys(s.formats||{})],r=[...new Set(a)];return r.filter(t=>void 0!==e[t]&&null!==e[t]&&""!==e[t]).length/r.length*100}calculateFreshness(e){if(!e.timestamp)return 50;const t=new Date(e.timestamp),s=(new Date-t)/6e4;return s<5?100:s<15?90:s<60?80:s<240?70:s<1440?60:40}sanitizeInput(e){if(null==e)return"";return String(e).replace(/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,"").replace(/<[^>]*>/g,"").replace(/javascript:/gi,"").replace(/on\w+\s*=/gi,"")}isInRange(e,t,s){return"number"==typeof e&&e>=t&&e<=s}isValidPercentage(e){return"number"==typeof e&&e>=0&&e<=1}isValidNumber(e){return"number"==typeof e&&!isNaN(e)&&isFinite(e)}isValidArray(e){return Array.isArray(e)}isValidObject(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}validateFinancialRatios(e){const t=[],s=[];return e.currentRatio<1&&s.push("Current ratio below 1.0 indicates potential liquidity issues"),e.debtToEquity>2&&s.push("High debt-to-equity ratio indicates high leverage"),e.returnOnEquity<0&&s.push("Negative return on equity indicates poor performance"),{isValid:0===t.length,errors:t,warnings:s}}};class A{constructor(e,t){this.requestsPerInterval=e,this.interval=t,this.requestTimestamps=[]}async acquire(){const e=Date.now();if(this.requestTimestamps=this.requestTimestamps.filter(t=>e-t<this.interval),this.requestTimestamps.length>=this.requestsPerInterval){const t=this.interval-(e-this.requestTimestamps[0]);return await new Promise(e=>setTimeout(e,t)),this.acquire()}this.requestTimestamps.push(e)}}const S=new class{constructor(){this.rateLimiters=new Map,this.sourceHealth=new Map,this.lastRequests=new Map,this.cache=new Map,this.rateLimitInfo={remaining:null,reset:null},this.initializeSecureClient(),this.initializeSourceHealth(),this.rateLimiters.set("default",new A(5,1e3))}initializeSecureClient(){this.client=c,h.log("INFO","EnhancedApiService initialized with secure backend proxy")}initializeSourceHealth(){["BACKEND_PROXY","ALPHA_VANTAGE","FMP","YAHOO_FINANCE","SEC_EDGAR","QUANDL","FRED"].forEach(e=>{this.sourceHealth.set(e,{status:"unknown",successRate:1,avgResponseTime:0,lastError:null,requestCount:0,errorCount:0,lastHealthCheck:null})})}hasValidApiKey(e){return!0}getBestSource(e){return"BACKEND_PROXY"}requiresApiKey(e){return["ALPHA_VANTAGE","FMP","QUANDL","FRED"].includes(e)}async fetchRealTimeMarketData(e,t={}){const s=Date.now();try{const t=await this.client.getQuote(e);return this.updateSourceHealth("BACKEND_PROXY",!0,Date.now()-s),t}catch(a){throw this.updateSourceHealth("BACKEND_PROXY",!1,Date.now()-s,a),h.log("ERROR","Failed to fetch real-time market data",{symbol:e,error:a.message}),a}}async fetchHistoricalMarketData(e,t={}){const s=t.range||"1mo",a=t.interval||"1d",r=new URLSearchParams({range:s,interval:a}).toString(),n=Date.now();try{const t=await this.request(`/market-data/historical/${e.toUpperCase()}?${r}`),i={..."object"==typeof t?t:{data:t},symbol:t?.symbol||e.toUpperCase(),range:s,interval:a,source:(t?.source||"backend_proxy").toUpperCase()};return this.updateSourceHealth("BACKEND_PROXY",!0,Date.now()-n),i}catch(i){this.updateSourceHealth("BACKEND_PROXY",!1,Date.now()-n,i),h.log("WARN","Backend historical data failed, falling back to direct sources",{error:i.message})}try{const t=await this.fetchFromYahooFinance(e,{range:s,interval:a}),r=t.timestamp||[],n=t.indicators?.quote?.[0]||{},i=r.map((e,t)=>({timestamp:new Date(1e3*e).toISOString(),open:n.open?.[t]??null,high:n.high?.[t]??null,low:n.low?.[t]??null,close:n.close?.[t]??null,volume:n.volume?.[t]??null}));return{symbol:t.meta?.symbol||e.toUpperCase(),range:s,interval:a,data:i,meta:t.meta,source:"YAHOO_FINANCE"}}catch(o){this.updateSourceHealth("YAHOO_FINANCE",!1,Date.now(),o),h.log("WARN","Yahoo Finance historical fallback failed, trying Alpha Vantage",{error:o.message})}try{const a=await this.fetchFromAlphaVantage(e,"TIME_SERIES_DAILY_ADJUSTED",t),r=a["Time Series (Daily)"]||a["Time Series (Daily)".toLowerCase()];if(!r)throw new Error("Alpha Vantage daily series missing");const n=Object.entries(r).map(([e,t])=>({timestamp:new Date(e).toISOString(),open:parseFloat(t["1. open"]),high:parseFloat(t["2. high"]),low:parseFloat(t["3. low"]),close:parseFloat(t["4. close"]),volume:parseInt(t["6. volume"])})).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));return{symbol:e.toUpperCase(),range:s,interval:"1d",data:n,source:"ALPHA_VANTAGE"}}catch(c){throw this.updateSourceHealth("ALPHA_VANTAGE",!1,Date.now(),c),c}}async fetchIntradayMarketData(e,t={}){const s=t.interval||"5min",a=new URLSearchParams({interval:s}).toString(),r=Date.now();try{const t=await this.request(`/market-data/intraday/${e.toUpperCase()}?${a}`),n={..."object"==typeof t?t:{data:t},symbol:t?.symbol||e.toUpperCase(),interval:s,source:(t?.source||"backend_proxy").toUpperCase()};return this.updateSourceHealth("BACKEND_PROXY",!0,Date.now()-r),n}catch(n){this.updateSourceHealth("BACKEND_PROXY",!1,Date.now()-r,n),h.log("WARN","Backend intraday data failed, falling back to direct sources",{error:n.message})}try{const t="1d",a=await this.fetchFromYahooFinance(e,{range:t,interval:s.replace("min","m")}),r=a.timestamp||[],n=a.indicators?.quote?.[0]||{},i=r.map((e,t)=>({timestamp:new Date(1e3*e).toISOString(),open:n.open?.[t]??null,high:n.high?.[t]??null,low:n.low?.[t]??null,close:n.close?.[t]??null,volume:n.volume?.[t]??null}));return{symbol:a.meta?.symbol||e.toUpperCase(),range:t,interval:s,data:i,meta:a.meta,source:"YAHOO_FINANCE"}}catch(i){this.updateSourceHealth("YAHOO_FINANCE",!1,Date.now(),i),h.log("WARN","Yahoo Finance intraday fallback failed, trying Alpha Vantage",{error:i.message})}try{const t=await this.fetchFromAlphaVantage(e,"TIME_SERIES_INTRADAY",{params:{interval:s}}),a=t[Object.keys(t).find(e=>e.startsWith("Time Series"))];if(!a)throw new Error("Alpha Vantage intraday series missing");const r=Object.entries(a).map(([e,t])=>({timestamp:new Date(e).toISOString(),open:parseFloat(t["1. open"]),high:parseFloat(t["2. high"]),low:parseFloat(t["3. low"]),close:parseFloat(t["4. close"]),volume:parseInt(t["5. volume"])})).sort((e,t)=>new Date(e.timestamp)-new Date(t.timestamp));return{symbol:e.toUpperCase(),interval:s,data:r,source:"ALPHA_VANTAGE"}}catch(o){throw this.updateSourceHealth("ALPHA_VANTAGE",!1,Date.now(),o),o}}async fetchFromYahooFinance(e,t={}){const s=`/v8/finance/chart/${e}`,a={range:t.range||"1d",interval:t.interval||"1m",includePrePost:!0,events:"div,splits"},r=new URL(s,"http://localhost:3000");r.search=new URLSearchParams(a).toString();const n=await fetch(r.pathname+r.search,{signal:AbortSignal.timeout(1e4),headers:{"User-Agent":"FinanceAnalyst-Pro/1.0"}});if(!n.ok)throw new Error(`Yahoo Finance API request failed with status ${n.status}`);const i=await n.json();if(!i?.chart?.result?.[0])throw new Error(`No data found for symbol: ${e}`);return i.chart.result[0]}async fetchFromAlphaVantage(e,t,s={}){if(!this.hasValidApiKey("ALPHA_VANTAGE"))throw new Error("Alpha Vantage API key not available");const a=API_CONFIG.ALPHA_VANTAGE,r={function:t,symbol:e,apikey:this.apiKeys.ALPHA_VANTAGE,...s.params},n=new URL(a.baseURL);n.search=new URLSearchParams(r).toString();const i=await fetch(n,{signal:AbortSignal.timeout(15e3)});if(!i.ok)throw new Error(`Alpha Vantage API request failed with status ${i.status}`);const o=await i.json();if(o["Error Message"])throw new Error(`Alpha Vantage error: ${o["Error Message"]}`);if(o.Note)throw new Error(`Alpha Vantage rate limit: ${o.Note}`);return o}async fetchComprehensiveData(e){const t={},s={},a=[{key:"marketData",method:"getQuote"},{key:"profile",method:"getCompanyProfile"},{key:"financials",method:"getIncomeStatement"},{key:"peers",method:"getPeerCompanies"}].map(async({key:a,method:r})=>{try{t[a]=await this.client[r](e)}catch(n){s[a]=n.message,h.log("ERROR",`Failed to fetch ${a} for ${e}`,{error:n.message})}});return await Promise.allSettled(a),{symbol:e,timestamp:(new Date).toISOString(),data:t,errors:Object.keys(s).length>0?s:null,sources:["BACKEND_PROXY"]}}normalizeMarketData(e,t){switch(t){case"YAHOO_FINANCE":return this.normalizeYahooData(e);case"ALPHA_VANTAGE":return this.normalizeAlphaVantageData(e);default:return e}}normalizeYahooData(e){const t=e.meta,s=e.indicators?.quote?.[0],a=s?{open:s.open[s.open.length-1],high:s.high[s.high.length-1],low:s.low[s.low.length-1],close:s.close[s.close.length-1],volume:s.volume[s.volume.length-1]}:{};return{symbol:t.symbol,currentPrice:t.regularMarketPrice||a.close,previousClose:t.previousClose,change:t.regularMarketPrice-t.previousClose,changePercent:(t.regularMarketPrice-t.previousClose)/t.previousClose*100,dayHigh:t.regularMarketDayHigh||a.high,dayLow:t.regularMarketDayLow||a.low,volume:t.regularMarketVolume||a.volume,marketCap:t.marketCap,currency:t.currency,exchangeName:t.exchangeName,timestamp:new Date(1e3*t.regularMarketTime).toISOString(),source:"YAHOO_FINANCE"}}normalizeAlphaVantageData(e){const t=e["Global Quote"];if(!t)throw new Error("Invalid Alpha Vantage response format");return{symbol:t["01. symbol"],currentPrice:parseFloat(t["05. price"]),previousClose:parseFloat(t["08. previous close"]),change:parseFloat(t["09. change"]),changePercent:parseFloat(t["10. change percent"].replace("%","")),dayHigh:parseFloat(t["03. high"]),dayLow:parseFloat(t["04. low"]),volume:parseInt(t["06. volume"]),timestamp:t["07. latest trading day"],source:"ALPHA_VANTAGE"}}updateSourceHealth(e,t,s,a=null){const r=this.sourceHealth.get(e);r&&(r.requestCount++,t?(r.status="healthy",r.lastError=null):(r.errorCount++,r.lastError=a?.message||"Unknown error",r.status="error"),r.successRate=(r.requestCount-r.errorCount)/r.requestCount,r.avgResponseTime=(r.avgResponseTime+s)/2,r.lastHealthCheck=(new Date).toISOString(),this.sourceHealth.set(e,r))}getSourceHealthStatus(){const e={};for(const[t,s]of this.sourceHealth.entries())e[t]={...s,hasValidApiKey:this.hasValidApiKey(t),requiresApiKey:this.requiresApiKey(t)};return e}getSourcesUsed(e){const t=new Set;return Object.values(e).forEach(e=>{e?.source&&t.add(e.source)}),Array.from(t)}baseUrl="https://api.financeanalyst.pro";defaultHeaders={};timeout=1e4;authToken=null;cacheTTL=3e5;requestInterceptors=[];responseInterceptors=[];metrics={totalRequests:0,successfulRequests:0,failedRequests:0,avgResponseTime:0};async request(e,t={}){const s=Date.now();this.metrics.totalRequests++;const a=this.rateLimiters.get("default");await a.acquire();const r=e.startsWith("http")?e:`${this.baseUrl}${e}`,n=r;if(this.cache.has(n)){const e=this.cache.get(n);if(Date.now()-e.timestamp<this.cacheTTL)return this.metrics.successfulRequests++,e.data}try{let e={method:"GET",headers:{...this.defaultHeaders},...t};this.authToken&&(e.headers.Authorization=`Bearer ${this.authToken}`);for(const t of this.requestInterceptors)e=await t(e);const a=new AbortController,i=setTimeout(()=>a.abort(),this.timeout);e.signal=a.signal;const o=await fetch(r,e);if(clearTimeout(i),!o.ok){const e=await o.text();throw new Error(`HTTP error! status: ${o.status}, body: ${e}`)}this.rateLimitInfo.remaining=parseInt(o.headers.get("X-RateLimit-Remaining"),10),this.rateLimitInfo.reset=parseInt(o.headers.get("X-RateLimit-Reset"),10);let c=await o.json();for(const t of this.responseInterceptors)c=await t(c,o);this.cache.set(n,{data:c,timestamp:Date.now()});const l=Date.now()-s;return this.metrics.successfulRequests++,this.metrics.avgResponseTime=(this.metrics.avgResponseTime+l)/2,c}catch(i){throw this.metrics.failedRequests++,i}}setAuthToken(e){this.authToken=e}setCacheTTL(e){this.cacheTTL=e}async batchRequests(e){const t=e.map(e=>"string"==typeof e?this.request(e):this.request(e.url,e.options));return(await Promise.allSettled(t)).map(e=>"fulfilled"===e.status?e.value:e.reason)}addRequestInterceptor(e){this.requestInterceptors.push(e)}addResponseInterceptor(e){this.responseInterceptors.push(e)}async requestWithRetry(e,t={},s=3){let a;for(let n=0;n<=s;n++)try{return await this.request(e,t)}catch(r){if(a=r,n<s){const e=100*Math.pow(2,n);await new Promise(t=>setTimeout(t,e))}}throw a}setBaseUrl(e){this.baseUrl=e}getBaseUrl(){return this.baseUrl}setDefaultHeaders(e){this.defaultHeaders={...e}}getDefaultHeaders(){return{...this.defaultHeaders}}setTimeout(e){this.timeout=e}getTimeout(){return this.timeout}getMetrics(){return{...this.metrics}}resetMetrics(){this.metrics={totalRequests:0,successfulRequests:0,failedRequests:0,avgResponseTime:0}}getRateLimitInfo(){return this.rateLimitInfo}clearCache(){this.cache.clear()}},D=({apiHealthStatus:i={},realDataEnabled:o=!1,dataSources:c=[],dataQuality:l={}})=>{const d=t=>{switch(t){case"healthy":case"connected":return e.jsx(n,{className:"h-4 w-4 text-green-500"});case"error":case"disconnected":return e.jsx(r,{className:"h-4 w-4 text-red-500"});case"warning":return e.jsx(a,{className:"h-4 w-4 text-yellow-500"});default:return e.jsx(a,{className:"h-4 w-4 text-gray-400"})}},m=e=>{switch(e){case"healthy":case"connected":return"bg-green-100 text-green-800";case"error":case"disconnected":return"bg-red-100 text-red-800";case"warning":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},u=c.filter(e=>"connected"===e.status).length,h=c.length,w=h>0?u/h*100:0;return e.jsxs(f,{children:[e.jsx(b,{children:e.jsxs(v,{className:"flex items-center gap-2",children:[e.jsx(t,{className:"h-5 w-5"}),"API Status & Data Quality"]})}),e.jsxs(j,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d(o?"connected":"disconnected"),e.jsxs("span",{className:"font-medium",children:["Real Data: ",o?"Enabled":"Disabled"]})]}),e.jsx(p,{className:m(o?"connected":"disconnected"),children:o?"Live":"Demo Mode"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:"Connection Health"}),e.jsxs("span",{children:[u,"/",h," sources"]})]}),e.jsx(x,{value:w,className:"h-2"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Data Sources"}),e.jsx("div",{className:"space-y-2",children:c.map(t=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[d(t.status),e.jsx("span",{children:t.name}),t.requiresKey&&e.jsx(s,{className:"h-3 w-3 text-gray-400",title:"Requires API Key"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(p,{variant:"outline",className:`text-xs ${m(t.status)}`,children:t.status}),"connected"===t.status&&e.jsxs("span",{className:"text-xs text-gray-500",children:[t.latency,"ms"]})]})]},t.id))})]}),Object.keys(i).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"API Health Details"}),e.jsx("div",{className:"space-y-1 text-xs",children:Object.entries(i).map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"capitalize",children:t.toLowerCase().replace("_"," ")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{children:["Success: ",(100*s.successRate).toFixed(1),"%"]}),e.jsxs("span",{children:["Avg: ",s.avgResponseTime.toFixed(0),"ms"]})]})]},t))})]}),Object.keys(l).length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium",children:"Data Quality"}),e.jsx("div",{className:"space-y-1",children:Object.entries(l).map(([t,s])=>e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{children:t}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(x,{value:s,className:"h-1 w-16"}),e.jsxs("span",{className:"text-xs",children:[s,"%"]})]})]},t))})]}),!o&&e.jsxs(g,{children:[e.jsx(a,{className:"h-4 w-4"}),e.jsxs(y,{className:"text-sm",children:["Running in demo mode. Add API keys to enable real-time data.",e.jsx("br",{}),e.jsx("span",{className:"text-xs text-gray-600",children:"Set VITE_ALPHA_VANTAGE_API_KEY or VITE_FMP_API_KEY in your .env file"})]})]}),o&&u<h&&e.jsxs(g,{children:[e.jsx(a,{className:"h-4 w-4"}),e.jsx(y,{className:"text-sm",children:"Some data sources are unavailable. Check your API keys and network connection."})]})]})]})},P=({selectedSymbols:t,onBulkExport:s,onBulkAlert:a,onBulkHistorical:r})=>{const[n,o]=i.useState(!1),[c,d]=i.useState("csv"),[u,h]=i.useState(""),[p,x]=i.useState("1y");return 0===t.length?null:e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-elevation-1",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>o(!n),children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-8 h-8 bg-primary rounded-lg flex items-center justify-center",children:e.jsx(l,{name:"Layers",size:16,color:"white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Bulk Operations"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.length," symbol",1!==t.length?"s":""," selected"]})]})]}),e.jsx(l,{name:n?"ChevronUp":"ChevronDown",size:20,className:"text-muted-foreground"})]}),n&&e.jsxs("div",{className:"border-t border-border",children:[e.jsxs("div",{className:"p-4 border-b border-border",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Selected Symbols:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[t.slice(0,10).map(t=>e.jsx("span",{className:"px-2 py-1 bg-muted text-muted-foreground text-xs rounded",children:t},t)),t.length>10&&e.jsxs("span",{className:"px-2 py-1 bg-muted text-muted-foreground text-xs rounded",children:["+",t.length-10," more"]})]})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Data Export"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-2 border border-border rounded-lg text-sm bg-input text-foreground",children:[e.jsx("option",{value:"csv",children:"CSV Format"}),e.jsx("option",{value:"xlsx",children:"Excel Format"}),e.jsx("option",{value:"json",children:"JSON Format"}),e.jsx("option",{value:"pdf",children:"PDF Report"})]}),e.jsx(m,{variant:"outline",size:"sm",iconName:"Download",onClick:()=>{s({symbols:t,format:c,timestamp:(new Date).toISOString()})},children:"Export Data"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Price Alerts"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w,{type:"number",placeholder:"Threshold %",value:u,onChange:e=>h(e.target.value),className:"flex-1"}),e.jsx(m,{variant:"outline",size:"sm",iconName:"Bell",onClick:()=>{u&&(a({symbols:t,threshold:parseFloat(u),type:"price_change"}),h(""))},disabled:!u,children:"Set Alerts"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h4",{className:"text-sm font-medium text-foreground",children:"Historical Data"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("select",{value:p,onChange:e=>x(e.target.value),className:"px-3 py-2 border border-border rounded-lg text-sm bg-input text-foreground",children:[e.jsx("option",{value:"1d",children:"1 Day"}),e.jsx("option",{value:"1w",children:"1 Week"}),e.jsx("option",{value:"1m",children:"1 Month"}),e.jsx("option",{value:"3m",children:"3 Months"}),e.jsx("option",{value:"6m",children:"6 Months"}),e.jsx("option",{value:"1y",children:"1 Year"}),e.jsx("option",{value:"5y",children:"5 Years"})]}),e.jsx(m,{variant:"outline",size:"sm",iconName:"BarChart3",onClick:()=>{r({symbols:t,period:p})},children:"Get Historical"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-border bg-muted/30",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:t.length}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Symbols"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-lg font-semibold text-foreground",children:Math.min(50*t.length,1e3)}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Data Points"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-lg font-semibold text-foreground",children:["~",Math.ceil(t.length/10),"s"]}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Est. Time"})]})]})})]})]})},C=({connectionHealth:t,lastUpdate:s})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{name:(e=>{switch(e){case"excellent":case"good":default:return"Wifi";case"warning":return"WifiOff";case"error":return"AlertTriangle"}})(t.overall),size:16,className:(e=>{switch(e){case"excellent":return"text-success";case"good":return"text-primary";case"warning":return"text-warning";case"error":return"text-error";default:return"text-muted-foreground"}})(t.overall)}),e.jsxs("span",{className:"text-sm font-medium text-foreground",children:["Connection: ",t.overall]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-muted-foreground",children:[e.jsx(l,{name:"Clock",size:14}),e.jsxs("span",{children:["Last update: ",s]})]}),e.jsx("div",{className:"flex items-center space-x-1",children:Object.entries(t.sources).map(([t,s])=>e.jsx("div",{className:"w-3 h-3 rounded-full "+("connected"===s?"bg-success":"warning"===s?"bg-warning":"bg-error"),title:`${t}: ${s}`},t))})]}),k=({dataSources:t,onToggle:s})=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{className:"text-sm font-medium text-foreground",children:"Data Sources:"}),e.jsx("div",{className:"flex items-center space-x-2",children:t.map(t=>e.jsxs("button",{onClick:()=>s(t.id),className:`\n              flex items-center space-x-2 px-3 py-2 rounded-lg text-sm font-medium transition-smooth\n              ${t.enabled?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground hover:bg-muted/80"}\n            `,children:[e.jsx("div",{className:"w-2 h-2 rounded-full "+("connected"===t.status?"bg-success":"warning"===t.status?"bg-warning":"bg-error")}),e.jsx("span",{children:t.name}),e.jsxs("span",{className:"text-xs opacity-75",children:[t.latency,"ms"]})]},t.id))})]}),R=({widget:t,onResize:s,onRemove:a})=>{const r=(e,t)=>{switch(t){case"currency":return`$${e.toLocaleString("en-US",{minimumFractionDigits:2})}`;case"percentage":return`${e.toFixed(2)}%`;case"number":return e.toLocaleString("en-US",{minimumFractionDigits:2});default:return e}};return e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4 shadow-elevation-1 hover:shadow-elevation-2 transition-smooth",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("span",{className:"text-sm text-muted-foreground",children:t.name}),e.jsx("div",{className:`w-2 h-2 rounded-full ${(e=>{const t=(new Date-new Date(e))/1e3;return t<5?"bg-success":t<30?"bg-warning":"bg-error"})(t.lastUpdate)}`,title:`Last updated: ${new Date(t.lastUpdate).toLocaleTimeString()}`})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("button",{onClick:()=>s(t.id),className:"p-1 text-muted-foreground hover:text-foreground transition-smooth",title:"Resize widget",children:e.jsx(l,{name:"Maximize2",size:14})}),e.jsx("button",{onClick:()=>a(t.id),className:"p-1 text-muted-foreground hover:text-error transition-smooth",title:"Remove widget",children:e.jsx(l,{name:"X",size:14})})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("div",{className:"text-2xl font-bold text-foreground",children:r(t.currentValue,t.valueType)}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm "+(n=t.change,n>0?"text-success":n<0?"text-error":"text-muted-foreground"),children:[e.jsx(l,{name:(e=>e>0?"TrendingUp":e<0?"TrendingDown":"Minus")(t.change),size:14}),e.jsx("span",{children:r(Math.abs(t.change),t.valueType)}),e.jsxs("span",{children:["(",t.changePercent>0?"+":"",t.changePercent.toFixed(2),"%)"]})]})]}),e.jsx("div",{className:"mb-3",children:e.jsx("div",{className:"h-16 bg-muted rounded flex items-end space-x-1 p-2",children:t.sparklineData.map((s,a)=>e.jsx("div",{className:"flex-1 rounded-sm "+(s>t.sparklineData[0]?"bg-success":"bg-error"),style:{height:s/Math.max(...t.sparklineData)*100+"%",minHeight:"2px"}},a))})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"High:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:r(t.dayHigh,t.valueType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Low:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:r(t.dayLow,t.valueType)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Volume:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:t.volume?t.volume.toLocaleString():"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted-foreground",children:"Source:"}),e.jsx("span",{className:"ml-1 font-medium text-foreground",children:t.source})]})]})]});var n},F=({onSymbolSelect:t,watchlist:s,onAddToWatchlist:a})=>{const[r,n]=i.useState(""),[o,c]=i.useState([]),[d,m]=i.useState(!1),[u,h]=i.useState(-1),p=i.useRef(null),x=[{symbol:"AAPL",name:"Apple Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"MSFT",name:"Microsoft Corporation",exchange:"NASDAQ",sector:"Technology"},{symbol:"GOOGL",name:"Alphabet Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"AMZN",name:"Amazon.com Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary"},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary"},{symbol:"META",name:"Meta Platforms Inc.",exchange:"NASDAQ",sector:"Technology"},{symbol:"NVDA",name:"NVIDIA Corporation",exchange:"NASDAQ",sector:"Technology"},{symbol:"JPM",name:"JPMorgan Chase & Co.",exchange:"NYSE",sector:"Financial Services"},{symbol:"JNJ",name:"Johnson & Johnson",exchange:"NYSE",sector:"Healthcare"},{symbol:"V",name:"Visa Inc.",exchange:"NYSE",sector:"Financial Services"}];i.useEffect(()=>{if(r.length>0){const e=x.filter(e=>e.symbol.toLowerCase().includes(r.toLowerCase())||e.name.toLowerCase().includes(r.toLowerCase())).slice(0,8);c(e),m(!0),h(-1)}else c([]),m(!1)},[r]);const g=e=>{t(e),n(""),m(!1),h(-1)};return e.jsxs("div",{className:"relative",ref:p,children:[e.jsxs("div",{className:"relative",children:[e.jsx(w,{type:"text",placeholder:"Search symbols (e.g., AAPL, Apple)...",value:r,onChange:e=>n(e.target.value),onKeyDown:e=>{if(d)switch(e.key){case"ArrowDown":e.preventDefault(),h(e=>e<o.length-1?e+1:e);break;case"ArrowUp":e.preventDefault(),h(e=>e>0?e-1:-1);break;case"Enter":e.preventDefault(),u>=0&&g(o[u]);break;case"Escape":m(!1),h(-1)}},className:"pl-10 pr-4"}),e.jsx(l,{name:"Search",size:18,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"})]}),d&&o.length>0&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-popover border border-border rounded-lg shadow-elevation-2 z-50 max-h-64 overflow-y-auto",children:o.map((t,r)=>{return e.jsxs("div",{className:`\n                flex items-center justify-between p-3 cursor-pointer transition-smooth\n                ${r===u?"bg-muted":"hover:bg-muted"}\n              `,onClick:()=>g(t),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("span",{className:"text-xs px-2 py-1 bg-muted rounded text-muted-foreground",children:t.exchange})]}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.name}),e.jsx("div",{className:"text-xs text-muted-foreground",children:t.sector})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[(n=t.symbol,!s.some(e=>e.symbol===n)&&e.jsx("button",{onClick:e=>{e.stopPropagation(),a(t)},className:"p-1 text-muted-foreground hover:text-primary transition-smooth",title:"Add to watchlist",children:e.jsx(l,{name:"Star",size:16})})),e.jsx(l,{name:"Plus",size:16,className:"text-muted-foreground"})]})]},t.symbol);var n})}),d&&r.length>0&&0===o.length&&e.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-popover border border-border rounded-lg shadow-elevation-2 z-50 p-4 text-center",children:e.jsxs("div",{className:"text-muted-foreground",children:[e.jsx(l,{name:"Search",size:24,className:"mx-auto mb-2"}),e.jsxs("p",{children:['No symbols found for "',r,'"']})]})})]})},T=({watchlist:t,onRemoveFromWatchlist:s,onSelectSymbol:a})=>{const[r,n]=i.useState("symbol"),[o,c]=i.useState("asc"),d=[...t].sort((e,t)=>{let s=e[r],a=t[r];return"string"==typeof s&&(s=s.toLowerCase(),a=a.toLowerCase()),"asc"===o?s<a?-1:s>a?1:0:s>a?-1:s<a?1:0}),u=(e,t)=>{switch(t){case"currency":return`$${e.toLocaleString("en-US",{minimumFractionDigits:2})}`;case"percentage":return`${e.toFixed(2)}%`;default:return e}};return e.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-elevation-1",children:[e.jsx("div",{className:"p-4 border-b border-border",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-foreground",children:"Watchlist"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.length," symbols"]}),e.jsx(m,{variant:"ghost",size:"sm",iconName:"MoreVertical","aria-label":"Watchlist options"})]})]})}),e.jsx("div",{className:"p-3 border-b border-border bg-muted/30",children:e.jsxs("div",{className:"flex items-center space-x-2 text-xs",children:[e.jsx("span",{className:"text-muted-foreground",children:"Sort by:"}),["symbol","name","price","change"].map(t=>e.jsxs("button",{onClick:()=>(e=>{r===e?c("asc"===o?"desc":"asc"):(n(e),c("asc"))})(t),className:`\n                flex items-center space-x-1 px-2 py-1 rounded transition-smooth\n                ${r===t?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"}\n              `,children:[e.jsx("span",{className:"capitalize",children:t}),r===t&&e.jsx(l,{name:"asc"===o?"ChevronUp":"ChevronDown",size:12})]},t))]})}),e.jsx("div",{className:"max-h-96 overflow-y-auto",children:0===d.length?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(l,{name:"Star",size:32,className:"mx-auto mb-3 text-muted-foreground"}),e.jsx("p",{className:"text-muted-foreground",children:"No symbols in watchlist"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Search and add symbols to track them here"})]}):d.map(t=>{return e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-border last:border-b-0 hover:bg-muted/50 cursor-pointer transition-smooth",onClick:()=>a(t),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-semibold text-foreground",children:t.symbol}),e.jsx("span",{className:"text-xs px-2 py-1 bg-muted rounded text-muted-foreground",children:t.exchange})]}),e.jsx("div",{className:"text-sm text-muted-foreground truncate",children:t.name})]}),e.jsxs("div",{className:"text-right mr-3",children:[e.jsx("div",{className:"font-semibold text-foreground",children:u(t.price||150.25,"currency")}),e.jsxs("div",{className:"text-sm "+(r=t.change||2.15,r>0?"text-success":r<0?"text-error":"text-muted-foreground"),children:[t.change>0?"+":"",u(Math.abs(t.change||2.15),"currency"),"(",t.changePercent>0?"+":"",(t.changePercent||1.45).toFixed(2),"%)"]})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),s(t.symbol)},className:"p-1 text-muted-foreground hover:text-error transition-smooth",title:"Remove from watchlist",children:e.jsx(l,{name:"X",size:16})})]},t.symbol);var r})}),t.length>0&&e.jsx("div",{className:"p-3 border-t border-border bg-muted/30",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(m,{variant:"ghost",size:"sm",iconName:"Download",children:"Export"}),e.jsx(m,{variant:"ghost",size:"sm",iconName:"Bell",children:"Set Alerts"})]})})]})},E=()=>{d("market-data-center");const[t,s]=i.useState([{id:"yahoo",name:"Yahoo Finance",enabled:!0,status:"connected",latency:12,requiresKey:!1},{id:"alpha_vantage",name:"Alpha Vantage",enabled:!1,status:"disconnected",latency:25,requiresKey:!0},{id:"fmp",name:"Financial Modeling Prep",enabled:!1,status:"disconnected",latency:18,requiresKey:!0},{id:"sec_edgar",name:"SEC EDGAR",enabled:!0,status:"connected",latency:45,requiresKey:!1}]),[a,r]=i.useState({overall:"good",sources:{yahoo:"connected",alpha_vantage:"disconnected",fmp:"disconnected",sec_edgar:"connected"}}),[n,c]=i.useState(!1),[h,p]=i.useState({}),[x,g]=i.useState({}),[y,f]=i.useState([{id:"widget-1",symbol:"AAPL",name:"Apple Inc.",currentValue:182.52,change:2.15,changePercent:1.19,valueType:"currency",dayHigh:184.3,dayLow:180.15,volume:52847392,source:"Bloomberg",lastUpdate:new Date(Date.now()-2e3),sparklineData:[180.25,181.15,180.95,182.1,181.85,182.52]},{id:"widget-2",symbol:"MSFT",name:"Microsoft Corporation",currentValue:378.85,change:-1.25,changePercent:-.33,valueType:"currency",dayHigh:381.2,dayLow:377.5,volume:28394751,source:"FactSet",lastUpdate:new Date(Date.now()-1500),sparklineData:[380.15,379.85,378.95,379.4,378.2,378.85]},{id:"widget-3",symbol:"GOOGL",name:"Alphabet Inc.",currentValue:2847.35,change:15.8,changePercent:.56,valueType:"currency",dayHigh:2855,dayLow:2830.15,volume:1847392,source:"Bloomberg",lastUpdate:new Date(Date.now()-3e3),sparklineData:[2835.25,2841.15,2838.95,2845.1,2843.85,2847.35]},{id:"widget-4",symbol:"US10Y",name:"US 10-Year Treasury",currentValue:4.285,change:.025,changePercent:.59,valueType:"percentage",dayHigh:4.295,dayLow:4.26,volume:null,source:"Refinitiv",lastUpdate:new Date(Date.now()-5e3),sparklineData:[4.26,4.27,4.275,4.28,4.285,4.285]}]),[b,v]=i.useState([{symbol:"AAPL",name:"Apple Inc.",exchange:"NASDAQ",sector:"Technology",price:182.52,change:2.15,changePercent:1.19},{symbol:"MSFT",name:"Microsoft Corporation",exchange:"NASDAQ",sector:"Technology",price:378.85,change:-1.25,changePercent:-.33},{symbol:"TSLA",name:"Tesla Inc.",exchange:"NASDAQ",sector:"Consumer Discretionary",price:248.42,change:5.67,changePercent:2.34}]),[j,w]=i.useState([]),[A,E]=i.useState("2 min ago"),[q,M]=i.useState(5e3),[L,H]=i.useState(!0);i.useEffect(()=>{(async()=>{try{const e="https://api.financeanalyst.pro";S.setBaseUrl(e);const t=S.getSourceHealthStatus();p(t),s(e=>e.map(e=>{const s=t[e.id.toUpperCase()];return s?{...e,enabled:s.hasValidApiKey||!s.requiresApiKey,status:s.hasValidApiKey||!s.requiresApiKey?"connected":"disconnected"}:e}));const a=Object.values(t).some(e=>e.hasValidApiKey||!e.requiresApiKey);c(a)}catch(e){}})()},[]),i.useEffect(()=>{if(!L)return;const e=setInterval(async()=>{if(n){const e=await Promise.all(y.map(async e=>{try{const t=await S.fetchRealTimeMarketData(e.symbol),s=N.validateData(t,"marketData");return{...e,currentValue:t.currentPrice,change:t.change,changePercent:t.changePercent,dayHigh:t.dayHigh,dayLow:t.dayLow,volume:t.volume,lastUpdate:new Date,source:t.source,dataQuality:s.qualityScore,sparklineData:[...e.sparklineData.slice(1),t.currentPrice]}}catch(t){return{...e,currentValue:e.currentValue+2*(Math.random()-.5),change:5*(Math.random()-.5),changePercent:2*(Math.random()-.5),lastUpdate:new Date,source:"Simulation",sparklineData:[...e.sparklineData.slice(1),e.currentValue+2*(Math.random()-.5)]}}}));f(e)}else f(e=>e.map(e=>({...e,currentValue:e.currentValue+2*(Math.random()-.5),change:5*(Math.random()-.5),changePercent:2*(Math.random()-.5),lastUpdate:new Date,source:"Simulation",sparklineData:[...e.sparklineData.slice(1),e.currentValue+2*(Math.random()-.5)]})));E("Just now")},q);return()=>clearInterval(e)},[q,L,n,y]);const I=async e=>{try{let s,a="Simulation",r=75;if(n)try{s=await S.fetchRealTimeMarketData(e.symbol);const t=N.validateData(s,"marketData");a=s.source,r=t.qualityScore}catch(t){s=null}const i={id:`widget-${Date.now()}`,symbol:e.symbol,name:e.name,currentValue:s?.currentPrice||1e3*Math.random()+50,change:s?.change||10*(Math.random()-.5),changePercent:s?.changePercent||5*(Math.random()-.5),valueType:"currency",dayHigh:s?.dayHigh||1e3*Math.random()+60,dayLow:s?.dayLow||1e3*Math.random()+40,volume:s?.volume||Math.floor(1e8*Math.random()),source:a,dataQuality:r,lastUpdate:new Date,sparklineData:Array.from({length:6},()=>s?.currentPrice||1e3*Math.random()+50)};f(e=>[...e,i]),n&&o.subscribe(e.symbol,"marketData",t=>{f(s=>s.map(s=>s.symbol===e.symbol?{...s,currentValue:t.currentPrice,change:t.change,changePercent:t.changePercent,lastUpdate:new Date(t.timestamp),source:t.source}:s))})}catch(t){}},V=e=>{},$=e=>{f(t=>t.filter(t=>t.id!==e))},O=e=>{e.ctrlKey&&"f"===e.key&&(e.preventDefault(),document.querySelector('input[placeholder*="Search symbols"]')?.focus())};return i.useEffect(()=>(document.addEventListener("keydown",O),()=>document.removeEventListener("keydown",O)),[]),e.jsxs("div",{className:"min-h-screen bg-background",children:[e.jsx(u,{}),e.jsxs("div",{className:"pt-[60px]",children:[e.jsx("div",{className:"bg-card border-b border-border p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-6",children:[e.jsx(k,{dataSources:t,onToggle:e=>{s(t=>t.map(t=>t.id===e?{...t,enabled:!t.enabled}:t))}}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",iconName:"RefreshCw",onClick:()=>{E("Just now")},className:L?"animate-spin":"",children:"Refresh"}),e.jsx(m,{variant:L?"default":"outline",size:"sm",iconName:L?"Pause":"Play",onClick:()=>H(!L),children:L?"Pause":"Resume"})]})]}),e.jsx(C,{connectionHealth:a,lastUpdate:A})]})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-12 gap-6",children:[e.jsxs("div",{className:"col-span-3 space-y-6",children:[e.jsxs("div",{className:"bg-card border border-border rounded-lg p-4 shadow-elevation-1",children:[e.jsx("h3",{className:"font-semibold text-foreground mb-4",children:"Add Symbols"}),e.jsx(F,{onSymbolSelect:I,watchlist:b,onAddToWatchlist:e=>{b.some(t=>t.symbol===e.symbol)||v(t=>[...t,{...e,price:1e3*Math.random()+50,change:10*(Math.random()-.5),changePercent:5*(Math.random()-.5)}])}}),e.jsx("div",{className:"mt-3 text-xs text-muted-foreground",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(l,{name:"Keyboard",size:12}),e.jsx("span",{children:"Ctrl+F to focus search"})]})})]}),e.jsx(T,{watchlist:b,onRemoveFromWatchlist:e=>{v(t=>t.filter(t=>t.symbol!==e))},onSelectSymbol:I}),e.jsx(P,{selectedSymbols:j,onBulkExport:e=>{alert(`Exporting ${e.symbols.length} symbols in ${e.format.toUpperCase()} format`)},onBulkAlert:e=>{alert(`Setting ${e.threshold}% alerts for ${e.symbols.length} symbols`)},onBulkHistorical:e=>{alert(`Fetching ${e.period} historical data for ${e.symbols.length} symbols`)}}),e.jsx(D,{apiHealthStatus:h,realDataEnabled:n,dataSources:t,dataQuality:x})]}),e.jsxs("div",{className:"col-span-9",children:[e.jsxs("div",{className:"mb-4 flex items-center justify-between",children:[e.jsxs("h2",{className:"text-xl font-semibold text-foreground",children:["Market Data Widgets (",y.length,")"]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m,{variant:"outline",size:"sm",iconName:"Settings",children:"Layout"}),e.jsx(m,{variant:"outline",size:"sm",iconName:"Save",children:"Save Dashboard"})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:y.map(t=>e.jsx(R,{widget:t,onResize:V,onRemove:$},t.id))}),0===y.length&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(l,{name:"BarChart3",size:48,className:"mx-auto mb-4 text-muted-foreground"}),e.jsx("h3",{className:"text-lg font-semibold text-foreground mb-2",children:"No Data Widgets"}),e.jsx("p",{className:"text-muted-foreground mb-4",children:"Search and add symbols to start monitoring market data"}),e.jsx(m,{variant:"outline",iconName:"Plus",children:"Add Your First Widget"})]})]})]})}),e.jsx("div",{className:"fixed bottom-0 left-0 right-0 bg-card border-t border-border p-2",children:e.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{children:["Active Widgets: ",y.length]}),e.jsxs("span",{children:["Watchlist: ",b.length]}),e.jsxs("span",{children:["Auto-refresh: ",L?"ON":"OFF"]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("span",{children:"Market Hours: OPEN"}),e.jsxs("span",{children:["Last Update: ",A]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-2 h-2 bg-success rounded-full"}),e.jsx("span",{children:"All systems operational"})]})]})]})})]})]})};export{E as default};
//# sourceMappingURL=index-Df24Vyn4.js.map
