const e={CLS:null,FID:null,FCP:null,LCP:null,TTFB:null,INP:null};function t(){!function(){let t=0;const o=[];new PerformanceObserver(r=>{for(const e of r.getEntries())e.hadRecentInput||(t+=e.value,o.push(e));e.CLS=t,n("CLS",t,o)}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(t=>{for(const o of t.getEntries())if("first-input-delay"===o.name&&(e.FID=o.processingStart-o.startTime,n("FID",e.FID,[o])),o.interactionId){const t=o.processingEnd-o.startTime;(!e.INP||t>e.INP)&&(e.INP=t,n("INP",t,[o]))}}).observe({type:"event",buffered:!0}),new PerformanceObserver(t=>{for(const o of t.getEntries())"first-contentful-paint"===o.name&&(e.FCP=o.startTime,n("FCP",o.startTime,[o]))}).observe({type:"paint",buffered:!0}),new PerformanceObserver(t=>{const o=t.getEntries(),r=o[o.length-1];e.LCP=r.startTime,n("LCP",r.startTime,[r])}).observe({type:"largest-contentful-paint",buffered:!0});const r=performance.getEntriesByType("navigation")[0];r&&(e.TTFB=r.responseStart-r.requestStart,n("TTFB",e.TTFB,[r]))}(),["financial-spreadsheet","dcf-calculator","chart-rendering","market-data-fetch"].forEach(e=>{performance.mark(`${e}-start`)}),window.trackComponentRender=(e,t)=>{performance.mark(`${e}-end`),performance.measure(`${e}-render`,`${e}-start`,`${e}-end`),o("component-render",{component:e,renderTime:t,timestamp:Date.now()})},window.trackCalculationPerformance=(e,t,n)=>{o("financial-calculation",{type:e,duration:t,complexity:n,timestamp:Date.now()})},window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];var t;e&&(t={dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,ssl:e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,ttfb:e.responseStart-e.requestStart,download:e.responseEnd-e.responseStart,domProcessing:e.domComplete-e.domLoading,totalLoadTime:e.loadEventEnd-e.fetchStart},c("navigation-timing",{...t,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:s()}))},0)}),new PerformanceObserver(e=>{for(const t of e.getEntries())if("script"===t.initiatorType||"css"===t.initiatorType||"img"===t.initiatorType||"fetch"===t.initiatorType){const e={name:t.name,type:t.initiatorType,size:t.transferSize||t.encodedBodySize,duration:t.duration,cached:0===t.transferSize&&t.encodedBodySize>0,timestamp:Date.now()};(e.size>5e4||e.duration>1e3)&&r(e)}}).observe({entryTypes:["resource"]}),function(){let e=0,t=0;["click","keydown","touchstart"].forEach(n=>{document.addEventListener(n,o=>{const r=performance.now();requestAnimationFrame(()=>{const a=performance.now()-r;e++,t+=a,a>100&&c("slow-interaction",{type:n,target:o.target.tagName,duration:a,timestamp:Date.now()})})},{passive:!0})}),setInterval(()=>{e>0&&(c("interaction-summary",{count:e,averageTime:t/e,timestamp:Date.now()}),e=0,t=0)},3e4)}()}function n(e,t,n){const o={metric:e,value:Math.round(t),entries:n.map(e=>({startTime:e.startTime,duration:e.duration||0})),url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:s()};var r;window.Sentry&&(window.Sentry.addBreadcrumb({category:"performance",message:`Web Vital ${e}: ${Math.round(t)}`,level:t>(r=e,{LCP:2500,FID:100,CLS:.1,FCP:1800,TTFB:800,INP:200}[r]||1e3)?"warning":"info",data:{metric:e,value:Math.round(t)}}),window.Sentry.setMeasurement(e,Math.round(t),"CLS"===e?"":"millisecond")),c("web-vital",o)}function o(e,t){c("custom-metric",{type:e,...t,url:window.location.href,userAgent:navigator.userAgent})}function r(e){c("resource-timing",e)}function a(e,t){c("error",{message:e.message,stack:e.stack,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,componentStack:t?.componentStack,errorBoundary:t?.errorBoundary})}function i(){const t=[];return Object.entries({LCP:2500,FID:100,CLS:.1,FCP:1800,TTFB:800}).forEach(([n,o])=>{const r=e[n];null!==r&&r>o&&t.push({metric:n,value:r,budget:o,overBy:r-o})}),t.length>0&&c("budget-violations",{violations:t,timestamp:Date.now(),url:window.location.href}),t}function s(){return"connection"in navigator?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt}:null}function c(e,t){try{const n={type:e,data:t,sessionId:u(),userId:m()},o=JSON.parse(localStorage.getItem("analytics-queue")||"[]");o.push(n),o.length>100&&o.splice(0,o.length-100),localStorage.setItem("analytics-queue",JSON.stringify(o)),o.length>=10&&l()}catch(n){}}function l(){try{const e=JSON.parse(localStorage.getItem("analytics-queue")||"[]");if(0===e.length)return;window.gtag&&e.forEach(e=>{window.gtag("event",e.type,{custom_parameter:JSON.stringify(e.data)})}),localStorage.removeItem("analytics-queue")}catch(e){}}function u(){let e=sessionStorage.getItem("session-id");return e||(e=Date.now()+"-"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("session-id",e)),e}function m(){let e=localStorage.getItem("user-id");return e||(e="anonymous-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),localStorage.setItem("user-id",e)),e}function d(e,t){c("performance-metric",{type:e,...t,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()})}function g(e){const t={violations:e.violations?.length||0,passes:e.passes?.length||0,incomplete:e.incomplete?.length||0,score:e.score||0,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent};c("accessibility-results",t);try{const e=JSON.parse(localStorage.getItem("accessibility-history")||"[]");e.push(t),e.length>50&&e.splice(0,e.length-50),localStorage.setItem("accessibility-history",JSON.stringify(e))}catch(n){}}function p(e,t){c("financial-component-performance",{component:e,...t,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent})}function f(){const t=JSON.parse(localStorage.getItem("accessibility-history")||"[]"),n=JSON.parse(localStorage.getItem("analytics-queue")||"[]"),o=t.slice(-10),r=o.reduce((e,t)=>e+t.score,0)/o.length||0,a=o.reduce((e,t)=>e+t.violations,0)/o.length||0,s=n.filter(e=>"performance-metric"===e.type).slice(-20).map(e=>e.data),c=n.filter(e=>"web-vital"===e.type).slice(-10).map(e=>e.data);return{webVitals:e,budgetViolations:i(),accessibility:{currentScore:o[o.length-1]?.score||0,averageScore:Math.round(r),averageViolations:Math.round(a),history:o,trends:{scoreImproving:o.length>=2&&o[o.length-1].score>o[o.length-2].score}},performance:{recentMetrics:s,webVitalHistory:c},timestamp:Date.now()}}function w(){return{webVitals:e,budgetViolations:i(),timestamp:Date.now()}}setInterval(l,6e4),window.addEventListener("beforeunload",()=>{l()});export{i as checkPerformanceBudgets,f as getPerformanceDashboardData,w as getPerformanceData,t as initializePerformanceMonitoring,d as reportPerformanceMetric,g as trackAccessibilityResults,a as trackError,p as trackFinancialComponentPerformance};
//# sourceMappingURL=performanceMonitoring-CCrMyQEC.js.map
