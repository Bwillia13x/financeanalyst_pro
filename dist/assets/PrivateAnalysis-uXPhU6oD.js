import{j as e}from"./index-DGF3HSb_.js";import{r as s,R as t}from"./react-vendor-BaLqnLcQ.js";import{H as a}from"./Header-CQFIp0qY.js";import{B as r}from"./Button-5a7spVg3.js";import{d as i,P as l,F as n,c as o,e as c,f as d,g as m,h as x,m as u,i as h,M as p,j as g,k as b,S as f,E as j,l as v,n as y,o as N,D as w,I as C,B as k,U as R,p as M,q as S,r as F,Z as A,s as I,t as P,u as V,v as E,T as D,w as O,x as T,y as q,z as B,G as z,b as G,H as L,C as $,J as W,N as _,O as U,Q as K,R as H}from"./ui-vendor-HtFP23NJ.js";import{R as Y,B as Q,C as J,X,Y as Z,T as ee,a as se,d as te,e as ae,f as re,g as ie,h as le,L as ne,A as oe,c as ce,S as de,b as me}from"./charts-vendor-h_g8xRFq.js";import{a as xe}from"./apiLogger-BNPwdfUB.js";import{g as ue,b as he,f as pe}from"./defaultFinancialData-BqNGcy_-.js";import"./utils-vendor-Cj_bvvWu.js";const ge=new class{constructor(){this.workers=[],this.isRunning=!1,this.currentSimulation=null}async runDCFSimulation(e,s,t={}){const{iterations:a=1e4,confidenceLevel:r=.95,correlationMatrix:i=null,randomSeed:l=null}=t;xe.log("INFO","Starting DCF Monte Carlo simulation",{iterations:a,variables:Object.keys(s).length}),this.isRunning=!0;const n=Date.now();try{l&&this.setSeed(l);const o=this.generateCorrelatedSamples(s,a,i),c=[],d=t.onProgress;for(let t=0;t<a;t++){if(!this.isRunning)throw new Error("Simulation cancelled");const r=this.createScenarioInputs(e,o[t],s),i=this.calculateDCFScenario(r);c.push({iteration:t+1,pricePerShare:i.pricePerShare,enterpriseValue:i.enterpriseValue,upside:i.upside,inputs:r}),d&&t%Math.floor(a/100)===0&&d(t/a*100)}const m=this.analyzeResults(c,r),x=Date.now();return xe.log("INFO","DCF Monte Carlo simulation completed",{iterations:a,duration:x-n,meanPrice:m.statistics.mean}),{type:"DCF_MONTE_CARLO",timestamp:(new Date).toISOString(),parameters:{iterations:a,confidenceLevel:r,randomSeed:l},results:c,analysis:m,duration:x-n}}catch(o){throw this.isRunning=!1,xe.log("ERROR","DCF Monte Carlo simulation failed",{error:o.message}),o}finally{this.isRunning=!1}}async runLBOSimulation(e,s,t={}){const{iterations:a=1e4,confidenceLevel:r=.95,correlationMatrix:i=null,randomSeed:l=null}=t;xe.log("INFO","Starting LBO Monte Carlo simulation",{iterations:a,variables:Object.keys(s).length}),this.isRunning=!0;const n=Date.now();try{l&&this.setSeed(l);const o=this.generateCorrelatedSamples(s,a,i),c=[],d=t.onProgress;for(let t=0;t<a;t++){if(!this.isRunning)throw new Error("Simulation cancelled");const r=this.createScenarioInputs(e,o[t],s),i=this.calculateLBOScenario(r);c.push({iteration:t+1,irr:i.irr,moic:i.moic,totalReturn:i.totalReturn,inputs:r}),d&&t%Math.floor(a/100)===0&&d(t/a*100)}const m=this.analyzeResults(c,r,["irr","moic","totalReturn"]),x=Date.now();return xe.log("INFO","LBO Monte Carlo simulation completed",{iterations:a,duration:x-n,meanIRR:m.statistics.irr?.mean}),{type:"LBO_MONTE_CARLO",timestamp:(new Date).toISOString(),parameters:{iterations:a,confidenceLevel:r,randomSeed:l},results:c,analysis:m,duration:x-n}}catch(o){throw this.isRunning=!1,xe.log("ERROR","LBO Monte Carlo simulation failed",{error:o.message}),o}finally{this.isRunning=!1}}generateCorrelatedSamples(e,s,t){const a=Object.keys(e),r=a.length,i=[],l=[];for(let n=0;n<s;n++){const s={};a.forEach(t=>{const a=e[t];s[t]=this.sampleFromDistribution(a)}),l.push(s)}if(t&&t.length===r){const e=this.choleskyDecomposition(t);for(let t=0;t<s;t++){const s={},r=a.map(e=>l[t][e]),n=this.applyCorrelation(r,e);a.forEach((e,t)=>{s[e]=n[t]}),i.push(s)}}else i.push(...l);return i}sampleFromDistribution(e){const{type:s,parameters:t}=e;switch(s){case"normal":return this.normalRandom(t.mean,t.stdDev);case"lognormal":const e=this.normalRandom(t.mu,t.sigma);return Math.exp(e);case"uniform":return t.min+Math.random()*(t.max-t.min);case"triangular":return this.triangularRandom(t.min,t.mode,t.max);case"beta":return this.betaRandom(t.alpha,t.beta);case"exponential":return this.exponentialRandom(t.lambda);case"weibull":return this.weibullRandom(t.shape,t.scale);case"pareto":return this.paretoRandom(t.scale,t.shape);case"student_t":return this.studentTRandom(t.df);case"chi_squared":return this.chiSquaredRandom(t.df);default:throw new Error(`Unsupported distribution type: ${s}`)}}exponentialRandom(e){return-Math.log(1-Math.random())/e}weibullRandom(e,s){const t=Math.random();return s*Math.pow(-Math.log(1-t),1/e)}paretoRandom(e,s){const t=Math.random();return e/Math.pow(t,1/s)}studentTRandom(e){if(e<=0)throw new Error("Degrees of freedom must be positive");const s=this.normalRandom(0,1),t=this.chiSquaredRandom(e);return s/Math.sqrt(t/e)}chiSquaredRandom(e){if(e<=0)throw new Error("Degrees of freedom must be positive");return 2*this.gammaRandom(e/2)}normalRandom(e=0,s=1){if(void 0!==this.spareNormal){const t=this.spareNormal;return this.spareNormal=void 0,t*s+e}const t=Math.random(),a=Math.random(),r=Math.sqrt(-2*Math.log(t))*Math.cos(2*Math.PI*a),i=Math.sqrt(-2*Math.log(t))*Math.sin(2*Math.PI*a);return this.spareNormal=i,r*s+e}triangularRandom(e,s,t){const a=Math.random();return a<(s-e)/(t-e)?e+Math.sqrt(a*(t-e)*(s-e)):t-Math.sqrt((1-a)*(t-e)*(t-s))}betaRandom(e,s){const t=this.gammaRandom(e);return t/(t+this.gammaRandom(s))}gammaRandom(e){if(!(e>=1))return this.gammaRandom(e+1)*Math.pow(Math.random(),1/e);{const s=e-1/3,t=1/Math.sqrt(9*s);for(;;){let e,a;do{e=this.normalRandom(),a=1+t*e}while(a<=0);a*=a*a;const r=Math.random();if(r<1-.0331*e*e*e*e)return s*a;if(Math.log(r)<.5*e*e+s*(1-a+Math.log(a)))return s*a}}}choleskyDecomposition(e){const s=e.length,t=Array(s).fill().map(()=>Array(s).fill(0));for(let a=0;a<s;a++)for(let s=0;s<=a;s++)if(a===s){let a=0;for(let e=0;e<s;e++)a+=t[s][e]*t[s][e];t[s][s]=Math.sqrt(e[s][s]-a)}else{let r=0;for(let e=0;e<s;e++)r+=t[a][e]*t[s][e];t[a][s]=(e[a][s]-r)/t[s][s]}return t}applyCorrelation(e,s){const t=e.length,a=Array(t).fill(0);for(let r=0;r<t;r++)for(let t=0;t<=r;t++)a[r]+=s[r][t]*e[t];return a}createScenarioInputs(e,s,t){const a={...e};return Object.entries(s).forEach(([e,s])=>{const r=t[e];r.applyTo?a[r.applyTo]=s:a[e]=s}),a}calculateDCFScenario(e){const{currentRevenue:s=1e9,revenueGrowthRate:t=.1,fcfMargin:a=.15,wacc:r=.1,terminalGrowthRate:i=.025,sharesOutstanding:l=1e8,currentPrice:n=100}=e;let o=0,c=s;for(let x=1;x<=5;x++){c*=1+t;o+=c*a/Math.pow(1+r,x)}const d=o+c*a*(1+i)/(r-i)/Math.pow(1+r,5),m=d/l;return{pricePerShare:m,enterpriseValue:d,upside:(m-n)/n*100}}calculateLBOScenario(e){const{ebitda:s=1e8,ebitdaGrowthRate:t=.05,exitMultiple:a=10,debtMultiple:r=5,holdingPeriod:i=5}=e,l=s*r,n=10*s-l,o=s*Math.pow(1+t,i)*a-.5*l,c=o/n;return{irr:Math.pow(c,1/i)-1,moic:c,totalReturn:o}}analyzeResults(e,s,t=["pricePerShare","enterpriseValue","upside"]){const a={statistics:{},percentiles:{},confidenceIntervals:{},riskMetrics:{},distributionTests:{},correlations:{}};return t.forEach(t=>{const r=e.map(e=>e[t]).filter(e=>null!==e&&!isNaN(e)).sort((e,s)=>e-s);if(0===r.length)return;const i=r.reduce((e,s)=>e+s,0)/r.length,l=r.reduce((e,s)=>e+Math.pow(s-i,2),0)/r.length,n=Math.sqrt(l),o=Math.sqrt(l*r.length/(r.length-1));a.statistics[t]={mean:i,median:this.percentile(r,.5),mode:this.calculateMode(r),stdDev:n,sampleStdDev:o,variance:l,min:r[0],max:r[r.length-1],range:r[r.length-1]-r[0],count:r.length,trimmedMean:this.calculateTrimmedMean(r,.1),mad:this.calculateMAD(r),iqr:this.percentile(r,.75)-this.percentile(r,.25)},a.percentiles[t]={p1:this.percentile(r,.01),p5:this.percentile(r,.05),p10:this.percentile(r,.1),p25:this.percentile(r,.25),p50:this.percentile(r,.5),p75:this.percentile(r,.75),p90:this.percentile(r,.9),p95:this.percentile(r,.95),p99:this.percentile(r,.99)};const c=1-s,d=this.percentile(r,c/2),m=this.percentile(r,1-c/2);a.confidenceIntervals[t]={level:s,lowerBound:d,upperBound:m,width:m-d,bootstrapCI:this.calculateBootstrapCI(r,s)};const x=this.percentile(r,.05),u=this.percentile(r,.01),h=r.slice(0,Math.floor(.05*r.length)).reduce((e,s)=>e+s,0)/Math.floor(.05*r.length),p=r.slice(0,Math.floor(.01*r.length)).reduce((e,s)=>e+s,0)/Math.floor(.01*r.length);a.riskMetrics[t]={var95:x,var99:u,cvar95:h,cvar99:p,skewness:this.calculateSkewness(r,i,n),kurtosis:this.calculateKurtosis(r,i,n),excessKurtosis:this.calculateKurtosis(r,i,n)-3,expectedShortfall:h,maxDrawdown:this.calculateMaxDrawdown(r),sharpeRatio:this.calculateSharpeRatio(r,.02),sortinoRatio:this.calculateSortinoRatio(r,i)},a.distributionTests[t]={jarqueBera:this.jarqueBeraTest(r),kolmogorovSmirnov:this.ksTestNormality(r),shapiroWilk:r.length<=5e3?this.shapiroWilkTest(r):null}}),t.length>1&&(a.correlations=this.calculateCorrelationMatrix(e,t)),a}calculateMode(e){const s={};e.forEach(e=>{const t=Math.round(100*e)/100;s[t]=(s[t]||0)+1});const t=Math.max(...Object.values(s)),a=Object.keys(s).filter(e=>s[e]===t);return 1===a.length?parseFloat(a[0]):null}calculateTrimmedMean(e,s=.1){const t=Math.floor(e.length*s),a=e.slice(t,-t||void 0);return a.reduce((e,s)=>e+s,0)/a.length}calculateMAD(e){const s=this.percentile(e,.5),t=e.map(e=>Math.abs(e-s)).sort((e,s)=>e-s);return this.percentile(t,.5)}calculateBootstrapCI(e,s,t=1e3){const a=[];for(let i=0;i<t;i++){const s=[];for(let t=0;t<e.length;t++)s.push(e[Math.floor(Math.random()*e.length)]);a.push(s.reduce((e,s)=>e+s,0)/s.length)}a.sort((e,s)=>e-s);const r=1-s;return{lowerBound:this.percentile(a,r/2),upperBound:this.percentile(a,1-r/2)}}calculateMaxDrawdown(e){let s=e[0],t=0;for(const a of e){a>s&&(s=a);const e=(s-a)/s;e>t&&(t=e)}return t}calculateSharpeRatio(e,s=.02){const t=e.reduce((e,s)=>e+s,0)/e.length,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/e.length,r=Math.sqrt(a);return r>0?(t-s)/r:0}calculateSortinoRatio(e,s){const t=e.map(e=>e-s),a=t.filter(e=>e<0);if(0===a.length)return 1/0;const r=Math.sqrt(a.reduce((e,s)=>e+s*s,0)/a.length),i=t.reduce((e,s)=>e+s,0)/t.length;return r>0?i/r:0}jarqueBeraTest(e){const s=e.length,t=e.reduce((e,s)=>e+s,0)/s,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/s,r=Math.sqrt(a),i=this.calculateSkewness(e,t,r),l=this.calculateKurtosis(e,t,r),n=s/6*(Math.pow(i,2)+Math.pow(l-3,2)/4),o=1-this.chiSquaredCDF(n,2);return{statistic:n,pValue:o,isNormal:o>.05}}chiSquaredCDF(e,s){return e<=0?0:this.incompleteGamma(s/2,e/2)}incompleteGamma(e,s){if(0===s)return 0;if(s<e+1){let t=1/e,a=1/e;for(let r=1;r<100&&(a*=s/(e+r),t+=a,!(a<1e-15));r++);return Math.exp(-s+e*Math.log(s)-this.logGamma(e))*t}return 1-this.incompleteGamma(e,s)}logGamma(e){const s=[76.18009172947146,-86.50532032941678,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18];let t=0;const a=1.000000000190015;let r=e,i=r=e,l=e+5.5;for(l-=(e+.5)*Math.log(l);t<6;t++)a+=s[t]/++i;return-l+Math.log(2.5066282746310007*a/r)}ksTestNormality(e){const s=e.length,t=e.reduce((e,s)=>e+s,0)/s,a=e.reduce((e,s)=>e+Math.pow(s-t,2),0)/s,r=Math.sqrt(a);let i=0;for(let n=0;n<s;n++){const a=(n+1)/s,l=this.normalCDF((e[n]-t)/r),o=Math.abs(a-l);o>i&&(i=o)}const l=1.36/Math.sqrt(s);return{statistic:i,critical:l,isNormal:i<l}}normalCDF(e){return.5*(1+this.erf(e/Math.sqrt(2)))}erf(e){const s=e<0?-1:1,t=1/(1+.3275911*(e=Math.abs(e)));return s*(1-((((1.061405429*t-1.453152027)*t+1.421413741)*t-.284496736)*t+.254829592)*t*Math.exp(-e*e))}shapiroWilkTest(e){const s=e.length;if(s<3||s>5e3)return null;const t=[...e].sort((e,s)=>e-s),a=e.reduce((e,s)=>e+s,0)/s;let r=0;for(let l=0;l<s;l++)r+=Math.pow(t[l]-a,2);const i=0/r;return{statistic:i,isNormal:i>.9}}calculateCorrelationMatrix(e,s){const t={};for(let a=0;a<s.length;a++){t[s[a]]={};for(let r=0;r<s.length;r++)if(a===r)t[s[a]][s[r]]=1;else{const i=e.map(e=>e[s[a]]).filter(e=>null!==e&&!isNaN(e)),l=e.map(e=>e[s[r]]).filter(e=>null!==e&&!isNaN(e));t[s[a]][s[r]]=this.calculateCorrelation(i,l)}}return t}calculateCorrelation(e,s){if(e.length!==s.length||0===e.length)return 0;const t=e.length,a=e.reduce((e,s)=>e+s,0)/t,r=s.reduce((e,s)=>e+s,0)/t;let i=0,l=0,n=0;for(let c=0;c<t;c++){const t=e[c]-a,o=s[c]-r;i+=t*o,l+=t*t,n+=o*o}const o=Math.sqrt(l*n);return o>0?i/o:0}percentile(e,s){const t=s*(e.length-1),a=Math.floor(t),r=Math.ceil(t),i=t-a;return a===r?e[a]:e[a]*(1-i)+e[r]*i}calculateSkewness(e,s,t){const a=e.length;return a/((a-1)*(a-2))*e.reduce((e,a)=>e+Math.pow((a-s)/t,3),0)}calculateKurtosis(e,s,t){const a=e.length;return a*(a+1)/((a-1)*(a-2)*(a-3))*e.reduce((e,a)=>e+Math.pow((a-s)/t,4),0)-3*Math.pow(a-1,2)/((a-2)*(a-3))}setSeed(e){this.seed=e,this.random=()=>(this.seed=(9301*this.seed+49297)%233280,this.seed/233280),Math.random=this.random}stopSimulation(){this.isRunning=!1}isSimulationRunning(){return this.isRunning}},be=({data:a,onDataChange:r,onAdjustedValuesChange:x})=>{const[u,h]=s.useState("incomeStatement"),[p,g]=s.useState({}),[b,f]=s.useState({revenue:!0,costOfGoodsSold:!0,operatingExpenses:!0,salariesBenefits:!0,grossProfit:!0,operatingIncome:!0,incomeBeforeTax:!0,otherIncomeExpense:!0,currentAssets:!0,nonCurrentAssets:!0,currentLiabilities:!0,nonCurrentLiabilities:!0,equity:!0,operatingActivities:!0,investingActivities:!0,financingActivities:!0}),[j,v]=s.useState(null),[y,N]=s.useState(""),w=s.useRef(null);s.useEffect(()=>{if(a?.statements?.incomeStatement&&0===Object.keys(p).length){const e={},s=a.statements.incomeStatement;Object.keys(s).forEach(t=>{s[t]&&void 0!==s[t][2]&&(e[t]=s[t][2])}),g(e),x&&x(e)}},[a,p,x]);const C={revenue:{title:"Revenue",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"energyDevices",label:"Energy Devices",level:1},{key:"injectables",label:"Injectables",level:1},{key:"wellness",label:"Wellness",level:1},{key:"weightloss",label:"Weightloss",level:1},{key:"retailSales",label:"Retail Sales",level:1},{key:"surgery",label:"Surgery",level:1},{key:"totalRevenue",label:"Total Revenue",level:0,bold:!0,formula:!0}]},costOfGoodsSold:{title:"Cost of Goods Sold",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"energyDeviceSupplies",label:"Energy Device Supplies",level:1},{key:"injectablesCogs",label:"Injectables",level:1},{key:"wellnessCogs",label:"Wellness",level:1},{key:"weightlossCogs",label:"Weightloss",level:1},{key:"retailProducts",label:"Retail Products",level:1},{key:"surgicalSupplies",label:"Surgical Supplies",level:1},{key:"totalCostOfGoodsSold",label:"Total Cost of Goods Sold",level:0,bold:!0,formula:!0}]},grossProfit:{title:"Gross Profit",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"grossProfit",label:"Gross Profit",level:0,bold:!0,formula:!0}]},salariesBenefits:{title:"Salaries & Benefits",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"employeeBenefits",label:"Employee Benefits",level:1},{key:"payroll",label:"Payroll",level:1},{key:"payrollTaxes",label:"Payroll Taxes",level:1},{key:"totalSalariesBenefits",label:"Total Salaries & Benefits",level:0,bold:!0,formula:!0}]},operatingExpenses:{title:"Operating Expenses",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"marketing",label:"Marketing",level:1},{key:"automobile",label:"Automobile",level:1},{key:"creditCardBankCharges",label:"Credit Card and Bank Charges",level:1},{key:"donations",label:"Donations",level:1},{key:"computerTelephoneUtilities",label:"Computer, Telephone, and Utilities",level:1},{key:"depreciation",label:"Depreciation",level:1},{key:"duesSubscriptions",label:"Dues & Subscriptions",level:1},{key:"education",label:"Education",level:1},{key:"equipmentRental",label:"Equipment Rental",level:1},{key:"insurance",label:"Insurance",level:1},{key:"interestExpense",label:"Interest Expense",level:1},{key:"travelMealsEntertainment",label:"Travel, Meals, and Entertainment",level:1},{key:"rent",label:"Rent",level:1},{key:"officeExpenses",label:"Office Expenses",level:1},{key:"professionalFees",label:"Professional Fees",level:1},{key:"repairsMaintenance",label:"Repairs & Maintenance",level:1},{key:"localTax",label:"Local Tax",level:1},{key:"stateTax",label:"State Tax",level:1},{key:"totalOperatingExpense",label:"Total Operating Expense",level:0,bold:!0,formula:!0}]},operatingIncome:{title:"Operating Income",color:"bg-teal-50 border-teal-300",headerBg:"bg-teal-600",textColor:"text-teal-900",items:[{key:"operatingIncome",label:"Operating Income",level:0,bold:!0}]},otherIncomeExpense:{title:"Other Income / (Expense)",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-600",textColor:"text-slate-900",items:[{key:"gainOnAssetSale",label:"Gain (Loss) On Asset Sale",level:1},{key:"interestIncome",label:"Interest Income",level:1},{key:"otherExpenses",label:"Other Expenses",level:1},{key:"totalOtherIncomeExpense",label:"Total Other Income / (Expenses)",level:0,bold:!0,formula:!0}]},incomeBeforeTax:{title:"Net Income Before Taxes",color:"bg-amber-50 border-amber-300",headerBg:"bg-amber-600",textColor:"text-amber-900",items:[{key:"incomeBeforeTax",label:"Net Income Before Taxes",level:0,bold:!0}]}},k={currentAssets:{title:"Current Assets",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"cash",label:"Cash and Cash Equivalents",level:1},{key:"receivables",label:"Accounts Receivable",level:1},{key:"inventory",label:"Inventory",level:1},{key:"prepaidExpenses",label:"Prepaid Expenses",level:1},{key:"otherCurrentAssets",label:"Other Current Assets",level:1},{key:"totalCurrentAssets",label:"Total Current Assets",level:0,formula:!0,bold:!0}]},nonCurrentAssets:{title:"Non-Current Assets",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"ppe",label:"Property, Plant & Equipment",level:1},{key:"accumulatedDepreciation",label:"Less: Accumulated Depreciation",level:1},{key:"netPPE",label:"Net Property, Plant & Equipment",level:1,formula:!0},{key:"intangibleAssets",label:"Intangible Assets",level:1},{key:"goodwill",label:"Goodwill",level:1},{key:"otherNonCurrentAssets",label:"Other Non-Current Assets",level:1},{key:"totalNonCurrentAssets",label:"Total Non-Current Assets",level:0,formula:!0,bold:!0}]},totalAssets:{title:"Total Assets",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalAssets",label:"Total Assets",level:0,formula:!0,bold:!0}]},currentLiabilities:{title:"Current Liabilities",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"accountsPayable",label:"Accounts Payable",level:1},{key:"accruedExpenses",label:"Accrued Expenses",level:1},{key:"shortTermDebt",label:"Short-term Debt",level:1},{key:"currentPortionLongTermDebt",label:"Current Portion of Long-term Debt",level:1},{key:"otherCurrentLiabilities",label:"Other Current Liabilities",level:1},{key:"totalCurrentLiabilities",label:"Total Current Liabilities",level:0,formula:!0,bold:!0}]},nonCurrentLiabilities:{title:"Non-Current Liabilities",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"longTermDebt",label:"Long-term Debt",level:1},{key:"deferredTaxLiabilities",label:"Deferred Tax Liabilities",level:1},{key:"otherNonCurrentLiabilities",label:"Other Non-Current Liabilities",level:1},{key:"totalNonCurrentLiabilities",label:"Total Non-Current Liabilities",level:0,formula:!0,bold:!0}]},totalLiabilities:{title:"Total Liabilities",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilities",label:"Total Liabilities",level:0,formula:!0,bold:!0}]},equity:{title:"Shareholders' Equity",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"commonStock",label:"Common Stock",level:1},{key:"retainedEarnings",label:"Retained Earnings",level:1},{key:"otherEquity",label:"Other Comprehensive Income",level:1},{key:"totalEquity",label:"Total Shareholders' Equity",level:0,formula:!0,bold:!0}]},totalLiabilitiesEquity:{title:"Total Liabilities and Equity",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilitiesEquity",label:"Total Liabilities and Shareholders' Equity",level:0,formula:!0,bold:!0}]}},R={operatingActivities:{title:"Operating Activities",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"netIncome",label:"Net Income",level:1},{key:"depreciation",label:"Depreciation and Amortization",level:1},{key:"receivablesChange",label:"Change in Accounts Receivable",level:1},{key:"inventoryChange",label:"Change in Inventory",level:1},{key:"payablesChange",label:"Change in Accounts Payable",level:1},{key:"otherOperatingChanges",label:"Other Operating Changes",level:1},{key:"netCashFromOperating",label:"Net Cash from Operating Activities",level:0,formula:!0,bold:!0}]},investingActivities:{title:"Investing Activities",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"capex",label:"Capital Expenditures",level:1},{key:"acquisitions",label:"Acquisitions",level:1},{key:"assetSales",label:"Asset Sales",level:1},{key:"otherInvestingActivities",label:"Other Investing Activities",level:1},{key:"netCashFromInvesting",label:"Net Cash from Investing Activities",level:0,formula:!0,bold:!0}]},financingActivities:{title:"Financing Activities",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"debtIssuance",label:"Debt Issuance",level:1},{key:"debtRepayment",label:"Debt Repayment",level:1},{key:"equityIssuance",label:"Equity Issuance",level:1},{key:"dividends",label:"Dividends Paid",level:1},{key:"otherFinancingActivities",label:"Other Financing Activities",level:1},{key:"netCashFromFinancing",label:"Net Cash from Financing Activities",level:0,formula:!0,bold:!0}]},netCashFlow:{title:"Net Cash Flow",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"netCashFlow",label:"Net Change in Cash",level:0,formula:!0,bold:!0},{key:"beginningCash",label:"Cash at Beginning of Period",level:1},{key:"endingCash",label:"Cash at End of Period",level:0,formula:!0,bold:!0}]}},M=(()=>{switch(u){case"balanceSheet":return k;case"cashFlow":return R;default:return C}})(),S=(e,s,t=!1)=>{v({rowKey:e,periodIndex:s,isAdjusted:t});let r="";r=t?p[e]||"":a.statements.incomeStatement[e]?.[s]||"",N(r.toString())},F=()=>{if(j){const{rowKey:e,periodIndex:s,isAdjusted:t}=j,i=parseFloat(y)||0;if(t){const s={...p,[e]:i};g(s),x&&x(s)}else{const t={...a};t.statements.incomeStatement[e]||(t.statements.incomeStatement[e]={}),t.statements.incomeStatement[e][s]=i,r(t)}v(null),N("")}},A=e=>{"Enter"===e.key?(e.preventDefault(),F()):"Escape"===e.key?(e.preventDefault(),v(null),N("")):"Tab"===e.key&&(e.preventDefault(),F())},I=e=>/^-?\d*\.?\d*$/.test(e)||""===e,P=e=>{if(!e&&0!==e)return"";const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"";const t=Math.abs(s);let a;return t>=1e6?(a=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(s/1e6),a+="M"):a=t>=1e3?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s):new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s),a};s.useEffect(()=>{j&&w.current&&(w.current.focus(),w.current.select())},[j]);return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 pb-8",children:[e.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:e.jsx("div",{className:"max-w-full mx-auto px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(i,{className:"w-6 h-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Financial Spreadsheet"}),e.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Professional financial modeling workspace"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:()=>{const e=prompt('Enter period label (e.g., "Year 5"):');if(e){const s={...a};s.periods=[...s.periods,e],r(s)}},className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium",children:[e.jsx(l,{size:16}),"Add Period"]}),e.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:"px-4 py-2.5 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium shadow-sm",children:[e.jsx("option",{value:"incomeStatement",children:"Income Statement"}),e.jsx("option",{value:"balanceSheet",children:"Balance Sheet"}),e.jsx("option",{value:"cashFlow",children:"Cash Flow Statement"})]})]})]})})}),e.jsxs("div",{className:"max-w-full mx-auto p-8",children:[e.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-lg",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gradient-to-r from-slate-800 to-slate-900 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"min-w-[320px] px-6 py-4 text-left text-sm font-semibold tracking-wider",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(n,{size:16,className:"text-slate-300"}),"Account Description"]})}),e.jsx("th",{className:"w-20 px-4 py-4 text-center text-sm font-semibold",children:"Units"}),a.periods.map((s,t)=>e.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:s}),e.jsx("span",{className:"text-xs text-slate-300 font-normal",children:"Actual"})]})},t)),e.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold bg-gradient-to-r from-amber-600 to-yellow-600 border-l-2 border-amber-400",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{children:"Adjusted"}),e.jsx("span",{className:"text-xs text-amber-100 font-normal",children:"Modified"})]})}),e.jsx("th",{className:"w-28 px-4 py-4 text-center text-sm font-semibold",children:e.jsxs("div",{className:"flex items-center justify-center gap-1",children:[e.jsx(o,{size:14}),"Type"]})})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100",children:Object.entries(M).map(([s,i])=>e.jsxs(t.Fragment,{children:[e.jsx("tr",{className:`${i.headerBg||"bg-slate-600"} border-b-2 border-slate-300`,children:e.jsx("td",{colSpan:a.periods.length+4,className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3 text-white w-full text-left group",children:[e.jsxs("button",{onClick:()=>(e=>{f(s=>({...s,[e]:!s[e]}))})(s),className:"flex items-center gap-3 text-white hover:text-slate-200 transition-colors flex-1",children:[e.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/20 group-hover:bg-white/30 transition-colors",children:b[s]?e.jsx(c,{size:14}):e.jsx(d,{size:14})}),e.jsx("span",{className:"font-bold text-lg",children:i.title})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),(()=>{if(prompt("Enter row label:")){const e={...a};r(e)}})()},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Add custom row",children:e.jsx(l,{size:16})})]})})}),b[s]&&i.items.map(s=>(s=>{const{key:t,label:r,level:i,formula:l,bold:n}=s,c=1===i?"pl-8":2===i?"pl-12":"pl-4",d=n?"font-bold":0===i?"font-semibold":"font-medium",x=0===i?"text-slate-900":"text-slate-700",u=0===i?"bg-slate-50/70":"bg-white",h=0===i?"border-slate-200":"border-slate-100";return e.jsxs("tr",{className:`${u} border-b ${h} hover:bg-slate-50 transition-all duration-150 group`,children:[e.jsx("td",{className:`px-6 py-4 ${c} ${d} text-sm ${x}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[0===i&&e.jsx("div",{className:"w-1.5 h-4 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full flex-shrink-0 shadow-sm"}),e.jsx("span",{className:"leading-tight",children:r}),l&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(o,{size:14,className:"text-blue-500/80 flex-shrink-0"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium px-1.5 py-0.5 bg-blue-50 rounded-md",children:"AUTO"})]})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide bg-slate-100 px-2 py-1 rounded-md",children:"$ 000s"})}),a.periods.map((s,r)=>e.jsx("td",{className:"px-4 py-4 text-right",children:j?.rowKey!==t||j?.periodIndex!==r||j?.isAdjusted?e.jsxs("div",{onClick:()=>!l&&S(t,r),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(l?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),children:[e.jsx("span",{className:l?"text-blue-900":"text-slate-700",children:P(a.statements.incomeStatement[t]?.[r])||"—"}),!l&&e.jsx(m,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-slate-400 transition-opacity"})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:w,type:"text",value:y,onChange:e=>{const s=e.target.value;I(s)&&N(s)},onBlur:F,onKeyDown:A,className:"w-full px-3 py-2.5 bg-white border-2 border-blue-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-blue-100 focus:border-blue-500 shadow-lg",placeholder:"0.00"}),e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[e.jsx("button",{onClick:F,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),e.jsx("button",{onClick:()=>{v(null),N("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]})},r)),e.jsx("td",{className:"px-4 py-4 text-right bg-gradient-to-r from-amber-50 to-yellow-50 border-l-2 border-amber-300",children:j?.rowKey===t&&j?.isAdjusted?e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:w,type:"text",value:y,onChange:e=>{const s=e.target.value;I(s)&&N(s)},onBlur:F,onKeyDown:A,className:"w-full px-3 py-2.5 bg-white border-2 border-amber-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-amber-100 focus:border-amber-500 shadow-lg",placeholder:"0.00"}),e.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[e.jsx("button",{onClick:F,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),e.jsx("button",{onClick:()=>{v(null),N("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]}):e.jsxs("div",{onClick:()=>!l&&S(t,null,!0),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(l?"bg-gradient-to-r from-amber-100 to-yellow-100 text-amber-800 font-semibold border border-amber-300 shadow-sm":"hover:bg-amber-100 text-slate-800 cursor-pointer border border-transparent hover:border-amber-300 hover:shadow-sm"),children:[e.jsx("span",{className:l?"text-amber-900":"text-slate-700",children:P(p[t]||0)||"—"}),!l&&e.jsx(m,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-amber-500 transition-opacity"})]})}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium "+(l?"bg-blue-100 text-blue-800 border border-blue-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:l?e.jsxs(e.Fragment,{children:[e.jsx(o,{size:10,className:"mr-1"}),"Auto"]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{size:10,className:"mr-1"}),"Manual"]})})})]},t)})(s))]},s))})]})})}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(o,{className:"w-5 h-5 text-blue-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"How to Use"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Click any editable cell to modify values with enhanced input controls"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Use Enter to save changes or Escape to cancel editing"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Expand/collapse sections using the arrow controls"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Formula cells automatically calculate based on inputs"]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(i,{className:"w-5 h-5 text-green-600"})}),e.jsx("h3",{className:"font-bold text-slate-900",children:"Professional Features"})]}),e.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Color-coded sections for easy visual navigation"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Adjusted column for scenario analysis and modifications"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Professional number formatting with proper alignment"]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Enhanced editing experience with save/cancel controls"]})]})]})]})]})]})},fe=({data:t,modelInputs:a,onModelInputChange:r,calculateDCF:n,formatCurrency:o,formatPercent:c})=>{const[d,m]=s.useState(!1),b=a.scenario?.scenarios||[],f=s.useMemo(()=>b.map(e=>{try{const s={...t.statements.incomeStatement},a=s.totalRevenue||{},r={};Object.keys(a).forEach(s=>{const t=parseInt(s);if(0===t)r[s]=a[s];else{const i=1+e.revenueGrowth/100;r[s]=a[0]*Math.pow(i,t)}});const i=s.operatingIncome||{},l={};Object.keys(i).forEach(s=>{if(0===parseInt(s))l[s]=i[s];else{const t=a[s]||0,n=r[s]||0,o=i[s]||0;if(t>0){const a=o/t+e.marginImprovement/100;l[s]=n*a}else l[s]=o}});const o={...t,statements:{...t.statements,incomeStatement:{...s,totalRevenue:r,operatingIncome:l}}},c=n(o);return{...e,...c,weightedValue:c.enterpriseValue*(e.probability/100)}}catch(s){return{...e,enterpriseValue:0,equityValue:0,weightedValue:0}}}),[b,t,n]),j=f.reduce((e,s)=>e+s.weightedValue,0),v=(e,s,t)=>{const a=b.map((a,r)=>r===e?{...a,[s]:t}:a);r("scenario","scenarios",a)},y=({scenario:s,index:t})=>e.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name"}),e.jsx("input",{type:"text",value:s.name,onChange:e=>v(t,"name",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter scenario name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probability (%)"}),e.jsx("input",{type:"number",min:"0",max:"100",value:s.probability,onChange:e=>v(t,"probability",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue Growth (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.revenueGrowth,onChange:e=>v(t,"revenueGrowth",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margin Change (%)"}),e.jsx("input",{type:"number",step:"0.1",value:s.marginImprovement,onChange:e=>v(t,"marginImprovement",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsx("div",{className:"flex justify-end mt-4 gap-2",children:e.jsxs("button",{onClick:()=>(e=>{const s=b.filter((s,t)=>t!==e);r("scenario","scenarios",s)})(t),className:"px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-1",children:[e.jsx(g,{size:16}),"Delete"]})})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{children:e.jsx("p",{className:"text-gray-600",children:"Create and compare multiple financial scenarios with different assumptions and probabilities."})}),e.jsxs("button",{onClick:()=>m(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[e.jsx(l,{size:16}),"Add Scenario"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Assumptions"}),b.map((s,t)=>e.jsx(y,{scenario:s,index:t},t)),d&&e.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-4",children:e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h5",{className:"font-medium",children:"Add New Scenario"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{const e={name:`Scenario ${b.length+1}`,probability:Math.max(0,100-b.reduce((e,s)=>e+s.probability,0)),revenueGrowth:10,marginImprovement:0};r("scenario","scenarios",[...b,e]),m(!1)},className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add"}),e.jsx("button",{onClick:()=>m(!1),className:"px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})]}),f.length>0&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Analysis Results"}),e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(x,{size:20,className:"text-blue-600"}),e.jsx("h5",{className:"font-semibold text-blue-800",children:"Probability-Weighted Valuation"})]}),e.jsx("div",{className:"text-3xl font-bold text-blue-800",children:o(j)}),e.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Expected value based on scenario probabilities"})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:f.map((s,t)=>e.jsxs(u.div,{className:"bg-white rounded-lg border p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsxs("span",{children:[s.probability,"% probability"]}),s.revenueGrowth>15?e.jsx(i,{size:14,className:"text-green-500"}):s.revenueGrowth<5?e.jsx(h,{size:14,className:"text-red-500"}):e.jsx(p,{size:14,className:"text-gray-500"})]})]})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Enterprise Value"}),e.jsx("div",{className:"text-xl font-bold text-gray-800",children:o(s.enterpriseValue)})]}),e.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Revenue Growth:"}),e.jsx("span",{className:"font-medium",children:c(s.revenueGrowth)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Margin Change:"}),e.jsxs("span",{className:"font-medium "+(s.marginImprovement>=0?"text-green-600":"text-red-600"),children:[s.marginImprovement>=0?"+":"",c(s.marginImprovement)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Weighted Value:"}),e.jsx("span",{className:"font-medium",children:o(s.weightedValue)})]})]})]})]},t))}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h5",{className:"font-semibold mb-4",children:"Scenario Statistics"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o(Math.max(...f.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Best Case"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o(Math.min(...f.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Worst Case"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o(j)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Expected Value"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-800",children:o(Math.max(...f.map(e=>e.enterpriseValue))-Math.min(...f.map(e=>e.enterpriseValue)))}),e.jsx("div",{className:"text-sm text-gray-600",children:"Value Range"})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t",children:e.jsxs("div",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Total Probability:"})," ",b.reduce((e,s)=>e+s.probability,0),"%",100!==b.reduce((e,s)=>e+s.probability,0)&&e.jsx("span",{className:"text-orange-600 ml-2",children:"⚠ Probabilities should sum to 100%"})]})})]})]}),0===b.length&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(x,{size:48,className:"mx-auto mb-4 opacity-50"}),e.jsx("p",{children:"No scenarios created yet."}),e.jsx("p",{className:"text-sm mt-2",children:'Click "Add Scenario" to get started with scenario modeling.'})]})]})},je=({data:t,modelInputs:a,onModelInputChange:r,calculateDCF:i,formatCurrency:n,formatPercent:o})=>{const[c,d]=s.useState(null),m=a.sensitivity||{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},u={revenue:{name:"Revenue Growth",unit:"%",description:"Annual revenue growth rate",baseValue:15,isPercentage:!0},grossMargin:{name:"Gross Margin",unit:"%",description:"Gross profit margin improvement",baseValue:45,isPercentage:!0},discountRate:{name:"Discount Rate (WACC)",unit:"%",description:"Weighted average cost of capital",baseValue:a.dcf?.discountRate||10,isPercentage:!0},terminalGrowthRate:{name:"Terminal Growth Rate",unit:"%",description:"Long-term growth rate assumption",baseValue:a.dcf?.terminalGrowthRate||2.5,isPercentage:!0},taxRate:{name:"Tax Rate",unit:"%",description:"Corporate tax rate",baseValue:a.dcf?.taxRate||25,isPercentage:!0}},h=s.useMemo(()=>i(),[t,a,i]),g=s.useMemo(()=>{const e={};return m.variables.forEach(s=>{const r=m.ranges[s],i=u[s];if(!r||!i)return;const l=(r.max-r.min)/8,n=[];for(let e=0;e<9;e++){const o=r.min+l*e;let c={...t},d={...a.dcf,[s]:(i.isPercentage,o)};if("revenue"===s||"grossMargin"===s){const e={...t.statements.incomeStatement};if("revenue"===s){const s=e.totalRevenue||{},t={};Object.keys(s).forEach(e=>{const a=parseInt(e);if(0===a)t[e]=s[e];else{const r=1+o/100;t[e]=s[0]*Math.pow(r,a)}}),e.totalRevenue=t}if("grossMargin"===s){const s=e.operatingIncome||{},t=e.totalRevenue||{},a={};Object.keys(s).forEach(e=>{const r=t[e]||0,i=s[e]||0;if(r>0){const s=i/r+o/100;a[e]=r*s}else a[e]=i}),e.operatingIncome=a}c={...t,statements:{...t.statements,incomeStatement:e}}}const m=(()=>{try{const e={discountRate:d.discountRate||10,terminalGrowthRate:d.terminalGrowthRate||2.5,projectionYears:d.projectionYears||5,taxRate:d.taxRate||25},s=c.statements.incomeStatement.operatingIncome||{};let t=[];if(Object.keys(s).forEach(e=>{parseInt(e)>=0&&t.push(s[e]||0)}),0===t.length)return{enterpriseValue:0,equityValue:0};let a=0;const r=1+e.discountRate/100;t.forEach((s,t)=>{if(t>0&&t<=e.projectionYears){const i=s*(1-e.taxRate/100)/Math.pow(r,t);a+=i}});const i=t[t.length-1]||0,l=i*(1+e.terminalGrowthRate/100)*(1-e.taxRate/100)/((e.discountRate-e.terminalGrowthRate)/100),n=l/Math.pow(r,e.projectionYears),o=a+n;return{enterpriseValue:o,equityValue:o,presentValueOperations:a,presentValueTerminal:n,terminalValue:l}}catch(e){return{enterpriseValue:0,equityValue:0}}})();n.push({variable:o,valuation:m.enterpriseValue,changeFromBase:(m.enterpriseValue-h.enterpriseValue)/h.enterpriseValue*100})}e[s]={definition:i,range:r,dataPoints:n}}),e},[t,a,m,h,i]),j=s.useMemo(()=>Object.entries(g).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>Math.abs(e.changeFromBase)));return{variable:e,definition:s.definition,maxImpact:t,positiveImpact:Math.max(...s.dataPoints.map(e=>e.changeFromBase)),negativeImpact:Math.min(...s.dataPoints.map(e=>e.changeFromBase))}}).sort((e,s)=>s.maxImpact-e.maxImpact),[g]),v=(e,s,t)=>{const a={...m.ranges,[e]:{...m.ranges[e],[s]:parseFloat(t)}};r("sensitivity","ranges",a)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze how changes in key variables impact enterprise valuation. Higher sensitivity indicates greater risk and importance for due diligence."}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),e.jsxs("span",{children:["Base Case: ",n(h.enterpriseValue)]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:14}),e.jsxs("span",{children:[m.variables.length," variables analyzed"]})]})]})]}),e.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[e.jsx(f,{size:16}),"Configure"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("h4",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[e.jsx(x,{size:20}),"Impact Ranking (Tornado Chart)"]}),e.jsx("div",{className:"space-y-3",children:j.map((s,t)=>e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsxs("span",{className:"text-sm font-medium",children:[t+1,". ",s.definition.name]}),e.jsxs("span",{className:"text-xs text-gray-500",children:["±",s.maxImpact.toFixed(1),"%"]})]}),e.jsxs("div",{className:"relative h-8 bg-gray-100 rounded",children:[e.jsx("div",{className:"absolute left-1/2 h-full bg-red-400 rounded-l",style:{width:Math.abs(s.negativeImpact)/Math.max(Math.abs(s.negativeImpact),s.positiveImpact)*50+"%",transform:"translateX(-100%)"}}),e.jsx("div",{className:"absolute left-1/2 h-full bg-green-400 rounded-r",style:{width:s.positiveImpact/Math.max(Math.abs(s.negativeImpact),s.positiveImpact)*50+"%"}}),e.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-400 transform -translate-x-0.5"}),e.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-2 text-xs font-medium text-white",children:[e.jsxs("span",{children:[s.negativeImpact.toFixed(1),"%"]}),e.jsxs("span",{children:["+",s.positiveImpact.toFixed(1),"%"]})]})]})]},s.variable))})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Variable Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[m.variables.map(s=>{const t=g[s];return t?e.jsxs("div",{className:"border rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium",children:t.definition.name}),e.jsx("p",{className:"text-xs text-gray-500",children:t.definition.description})]}),e.jsx("button",{onClick:()=>(e=>{const s=m.variables.filter(s=>s!==e),{[e]:t,...a}=m.ranges;r("sensitivity","variables",s),r("sensitivity","ranges",a)})(s),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:e.jsx(p,{size:16})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Min Value (",t.definition.unit,")"]}),e.jsx("input",{type:"number",step:"0.1",value:t.range.min,onChange:e=>v(s,"min",e.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Max Value (",t.definition.unit,")"]}),e.jsx("input",{type:"number",step:"0.1",value:t.range.max,onChange:e=>v(s,"max",e.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"h-16 bg-gray-50 rounded p-2",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Valuation Sensitivity"}),e.jsx("div",{className:"flex items-end justify-between h-8",children:t.dataPoints.map((s,a)=>e.jsx("div",{className:"w-1 rounded-t "+(s.changeFromBase>0?"bg-green-400":s.changeFromBase<0?"bg-red-400":"bg-blue-400"),style:{height:Math.abs(s.changeFromBase)/50*100+"%",minHeight:"2px"},title:`${s.variable}${t.definition.unit}: ${n(s.valuation)}`},a))})]})]},s):null}),e.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{size:24,className:"mx-auto mb-2 text-gray-400"}),e.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add Variable"}),e.jsx("div",{className:"space-y-2",children:Object.keys(u).filter(e=>!m.variables.includes(e)).map(s=>e.jsx("button",{onClick:()=>(e=>{if(!m.variables.includes(e)&&u[e]){const s=[...m.variables,e],t={...m.ranges,[e]:{min:-10,max:10}};r("sensitivity","variables",s),r("sensitivity","ranges",t)}})(s),className:"block w-full px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:u[s].name},s))})]})})]})]}),c&&g[c]&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("h4",{className:"font-semibold text-lg mb-4",children:["Detailed Analysis: ",g[c].definition.name]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium mb-3",children:"Data Points"}),e.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:g[c].dataPoints.map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center text-sm p-2 bg-gray-50 rounded",children:[e.jsxs("span",{children:[s.variable,g[c].definition.unit]}),e.jsx("span",{className:"font-medium",children:n(s.valuation)}),e.jsxs("span",{className:"font-medium "+(s.changeFromBase>0?"text-green-600":s.changeFromBase<0?"text-red-600":"text-gray-600"),children:[s.changeFromBase>0?"+":"",s.changeFromBase.toFixed(1),"%"]})]},t))})]}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Range Impact:"}),e.jsxs("span",{className:"font-medium",children:["±",Math.max(...g[c].dataPoints.map(e=>Math.abs(e.changeFromBase))).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max Upside:"}),e.jsxs("span",{className:"font-medium text-green-600",children:["+",Math.max(...g[c].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Max Downside:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[Math.min(...g[c].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]})]})]})]})]})]})},ve=({dcfData:t,sensitivityData:a,scenarioData:r,formatCurrency:l,formatPercent:n})=>{const[o,c]=s.useState("dcf-waterfall"),[d,m]=s.useState(!0),h=[{id:"dcf-waterfall",label:"DCF Waterfall",icon:x,category:"dcf"},{id:"cashflow-trend",label:"Cash Flow Trend",icon:i,category:"dcf"},{id:"sensitivity-tornado",label:"Sensitivity Tornado",icon:b,category:"sensitivity"},{id:"scenario-distribution",label:"Scenario Distribution",icon:y,category:"scenario"},{id:"valuation-bridge",label:"Valuation Bridge",icon:x,category:"combined"}],p=s.useMemo(()=>{if(!t?.years)return[];let e=0;const s=[];t.years.forEach((t,a)=>{const r=e;e+=t.presentValue,s.push({name:`Year ${t.year}`,value:t.presentValue,cumulative:e,start:r,freeCashFlow:t.freeCashFlow,category:"operations"})});const a=e;return e+=t.presentValueTerminal,s.push({name:"Terminal Value",value:t.presentValueTerminal,cumulative:e,start:a,category:"terminal"}),s},[t]),g=s.useMemo(()=>t?.years?t.years.map((e,s)=>({year:`Year ${e.year}`,freeCashFlow:e.freeCashFlow,presentValue:e.presentValue,revenue:e.revenue,operatingIncome:e.operatingIncome,workingCapitalChange:e.workingCapitalChange,capex:Math.abs(e.capex)})):[],[t]),f=s.useMemo(()=>a?Object.entries(a).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>e.changeFromBase)),a=Math.min(...s.dataPoints.map(e=>e.changeFromBase));return{variable:s.definition.name,upside:t,downside:Math.abs(a),range:t-a}}).sort((e,s)=>s.range-e.range):[],[a]),N=s.useMemo(()=>r?.length?r.map((e,s)=>({name:e.name,value:e.enterpriseValue,probability:e.probability,weightedValue:e.weightedValue,fill:`hsl(${137.5*s%360}, 70%, 50%)`})):[],[r]),w=({active:s,payload:t,label:a,chartType:r})=>{if(!s||!t||!t.length)return null;return e.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[e.jsx("p",{className:"font-medium text-gray-800",children:a}),t.map((s,t)=>{return e.jsx("p",{style:{color:s.color},className:"text-sm",children:`${s.dataKey}: ${a=s.value,r=s.dataKey,r?.includes("Percent")||r?.includes("Rate")?n(a):l(a)}`},t);var a,r})]})},C=()=>e.jsx(Y,{width:"100%",height:400,children:e.jsxs(Q,{data:p,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"name"}),e.jsx(Z,{tickFormatter:e=>l(e)}),e.jsx(ee,{content:e.jsx(w,{chartType:"waterfall"})}),e.jsx(se,{dataKey:"value",fill:"#3B82F6"})]})}),k=()=>e.jsx(Y,{width:"100%",height:400,children:e.jsxs(ie,{data:g,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"year"}),e.jsx(Z,{tickFormatter:e=>l(e)}),e.jsx(ee,{content:e.jsx(w,{chartType:"trend"})}),e.jsx(le,{}),e.jsx(ne,{type:"monotone",dataKey:"freeCashFlow",stroke:"#10B981",strokeWidth:3,name:"Free Cash Flow"}),e.jsx(ne,{type:"monotone",dataKey:"presentValue",stroke:"#3B82F6",strokeWidth:2,name:"Present Value"}),e.jsx(ne,{type:"monotone",dataKey:"revenue",stroke:"#8B5CF6",strokeWidth:2,name:"Revenue"})]})}),R=()=>e.jsx(Y,{width:"100%",height:400,children:e.jsxs(Q,{data:f,layout:"horizontal",margin:{top:20,right:30,left:100,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{type:"number",tickFormatter:e=>`${e.toFixed(1)}%`}),e.jsx(Z,{type:"category",dataKey:"variable"}),e.jsx(ee,{formatter:(e,s)=>[`${e.toFixed(1)}%`,s],labelFormatter:e=>`Variable: ${e}`}),e.jsx(se,{dataKey:"upside",fill:"#10B981",name:"Upside Impact"}),e.jsx(se,{dataKey:"downside",fill:"#EF4444",name:"Downside Impact"})]})}),M=()=>e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(Y,{width:"100%",height:300,children:e.jsxs(te,{children:[e.jsx(ae,{data:N,cx:"50%",cy:"50%",outerRadius:80,dataKey:"probability",label:({name:e,probability:s})=>`${e}: ${s}%`,children:N.map((s,t)=>e.jsx(re,{fill:s.fill},`cell-${t}`))}),e.jsx(ee,{formatter:e=>`${e}%`})]})}),e.jsx(Y,{width:"100%",height:300,children:e.jsxs(Q,{data:N,children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"name"}),e.jsx(Z,{tickFormatter:e=>l(e)}),e.jsx(ee,{content:e.jsx(w,{chartType:"scenario"})}),e.jsx(se,{dataKey:"value",fill:"#8B5CF6",name:"Enterprise Value"})]})})]}),S=()=>{const s=[{name:"PV of Operations",value:t?.cumulativePV||0,type:"positive"},{name:"PV of Terminal",value:t?.presentValueTerminal||0,type:"positive"},{name:"Enterprise Value",value:t?.enterpriseValue||0,type:"total"}];return e.jsx(Y,{width:"100%",height:400,children:e.jsxs(Q,{data:s,margin:{top:20,right:30,left:20,bottom:5},children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"name"}),e.jsx(Z,{tickFormatter:e=>l(e)}),e.jsx(ee,{content:e.jsx(w,{chartType:"bridge"})}),e.jsx(se,{dataKey:"value",fill:e=>"total"===e.type?"#1F2937":"#3B82F6"})]})})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(x,{size:20}),"Data Visualization"]}),e.jsx("p",{className:"text-gray-600",children:"Interactive charts and graphs to visualize valuation results and sensitivity analysis."})]}),e.jsxs("button",{onClick:()=>m(!d),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 "+(d?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:[d?e.jsx(j,{size:14}):e.jsx(v,{size:14}),d?"Hide Details":"Show Details"]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:h.map(s=>{const t=s.icon;return e.jsxs(u.button,{onClick:()=>c(s.id),className:"p-3 rounded-lg border-2 transition-all text-center "+(o===s.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:border-gray-300 text-gray-700"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(t,{size:20,className:"mx-auto mb-2"}),e.jsx("div",{className:"text-xs font-medium",children:s.label})]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:h.find(e=>e.id===o)?.label}),d&&e.jsx("span",{className:"text-sm text-gray-500",children:(()=>{switch(o){case"dcf-waterfall":return"Shows the contribution of each year's cash flows and terminal value to total enterprise value.";case"cashflow-trend":return"Displays the trend of free cash flows, present values, and key financial metrics over time.";case"sensitivity-tornado":return"Illustrates how changes in key variables impact enterprise value, ranked by sensitivity.";case"scenario-distribution":return"Compares different scenarios by probability weights and resulting enterprise values.";case"valuation-bridge":return"Breaks down enterprise value into operating value and terminal value components.";default:return""}})()})]}),e.jsx("div",{className:"min-h-[400px]",children:(()=>{switch(o){case"dcf-waterfall":default:return e.jsx(C,{});case"cashflow-trend":return e.jsx(k,{});case"sensitivity-tornado":return e.jsx(R,{});case"scenario-distribution":return e.jsx(M,{});case"valuation-bridge":return e.jsx(S,{})}})()})]}),d&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Key Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["dcf-waterfall"===o&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Operations Contribution"}),e.jsx("div",{className:"text-lg font-bold text-blue-800",children:t?.cumulativePV?`${(t.cumulativePV/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Terminal Contribution"}),e.jsx("div",{className:"text-lg font-bold text-purple-800",children:t?.presentValueTerminal?`${(t.presentValueTerminal/t.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Avg. Annual FCF"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:t?.freeCashFlows?l(t.freeCashFlows.reduce((e,s)=>e+s,0)/t.freeCashFlows.length):"N/A"})]})]}),"sensitivity-tornado"===o&&f.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Highest Risk Variable"}),e.jsx("div",{className:"text-lg font-bold text-red-800",children:f[0]?.variable}),e.jsxs("div",{className:"text-sm text-red-600",children:["±",f[0]?.range.toFixed(1),"% impact"]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Medium Risk Variables"}),e.jsx("div",{className:"text-lg font-bold text-yellow-800",children:f.slice(1,3).map(e=>e.variable).join(", ")})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Lowest Risk Variable"}),e.jsx("div",{className:"text-lg font-bold text-green-800",children:f[f.length-1]?.variable})]})]})]})]})]})},ye=({modelInputs:t,onModelInputChange:a,formatPercent:r})=>{const[l,n]=s.useState(!0),[c,d]=s.useState("inputs"),m=t.dcf.wacc||{riskFreeRate:4.5,marketRiskPremium:6,beta:1.2,smallCompanyPremium:3,companySpecificRisk:2,debtInterestRate:6.5,taxRate:25,marketValueEquity:1e5,marketValueDebt:3e4,buildUpMethod:{riskFreeRate:4.5,equityRiskPremium:6,sizeRiskPremium:3,industryRiskPremium:2,companySpecificRisk:2},industryWACC:10.5,industryBeta:1.1,industryDebtEquityRatio:.3},x=s.useMemo(()=>{const e={...m,...t.dcf.wacc},s=e.riskFreeRate+e.beta*e.marketRiskPremium+e.smallCompanyPremium+e.companySpecificRisk,a=e.buildUpMethod.riskFreeRate+e.buildUpMethod.equityRiskPremium+e.buildUpMethod.sizeRiskPremium+e.buildUpMethod.industryRiskPremium+e.buildUpMethod.companySpecificRisk,r=e.debtInterestRate*(1-e.taxRate/100),i=e.marketValueEquity+e.marketValueDebt,l=e.marketValueEquity/i,n=e.marketValueDebt/i,o=s/100*l+r/100*n,c=a/100*l+r/100*n;return{costOfEquityCAPM:s,costOfEquityBuildUp:a,costOfDebtAfterTax:r,equityWeight:100*l,debtWeight:100*n,waccCAPM:100*o,waccBuildUp:100*c,finalWACC:100*((o+c)/2),totalCapital:i,debtToEquityRatio:e.marketValueDebt/e.marketValueEquity}},[m,t.dcf.wacc]),h=(e,s)=>{const r={...m,...t.dcf.wacc,[e]:parseFloat(s)||0};a("dcf","wacc",r)},p=[{id:"inputs",label:"Inputs",icon:f},{id:"calculation",label:"Calculation",icon:o},{id:"benchmarks",label:"Benchmarks",icon:i}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(o,{size:20}),"WACC Calculator"]}),e.jsx("p",{className:"text-gray-600",children:"Professional weighted average cost of capital calculation using CAPM and build-up methods."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{return e=x.finalWACC,void a("dcf","discountRate",e);var e},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Apply to DCF"}),e.jsx("button",{onClick:()=>n(!l),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(l?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-600"),children:l?"Hide Details":"Show Details"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(N,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"FINAL WACC"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:r(x.finalWACC)}),e.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Risk-adjusted average"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"COST OF EQUITY"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:r(x.costOfEquityCAPM)}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"CAPM method"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"COST OF DEBT"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:r(x.costOfDebtAfterTax)}),e.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"After-tax"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"DEBT/EQUITY"})]}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[x.debtToEquityRatio.toFixed(2),"x"]}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Capital structure"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:p.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>d(s.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(c===s.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[e.jsx(t,{size:16}),s.label]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["inputs"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"WACC Input Parameters"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"Cost of Equity (CAPM Method)"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Risk-Free Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.riskFreeRate||m.riskFreeRate,onChange:e=>h("riskFreeRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"10-year Treasury rate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Risk Premium (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.marketRiskPremium||m.marketRiskPremium,onChange:e=>h("marketRiskPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Expected market return - risk-free rate"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beta (β)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.beta||m.beta,onChange:e=>h("beta",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Systematic risk relative to market"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Small Company Premium (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium,onChange:e=>h("smallCompanyPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Size-related risk premium"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company-Specific Risk (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.companySpecificRisk||m.companySpecificRisk,onChange:e=>h("companySpecificRisk",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Unsystematic risk premium"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4 text-purple-800",children:"Capital Structure & Cost of Debt"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Equity ($000s)"}),e.jsx("input",{type:"number",value:t.dcf.wacc?.marketValueEquity||m.marketValueEquity,onChange:e=>h("marketValueEquity",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Debt ($000s)"}),e.jsx("input",{type:"number",value:t.dcf.wacc?.marketValueDebt||m.marketValueDebt,onChange:e=>h("marketValueDebt",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre-Tax Cost of Debt (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.debtInterestRate||m.debtInterestRate,onChange:e=>h("debtInterestRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Interest rate on debt"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),e.jsx("input",{type:"number",step:"0.1",value:t.dcf.wacc?.taxRate||t.dcf.taxRate,onChange:e=>h("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-xs text-gray-500",children:"Corporate tax rate"})]}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-2",children:"Capital Structure"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Equity Weight:"}),e.jsx("span",{className:"font-medium",children:r(x.equityWeight)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Debt Weight:"}),e.jsx("span",{className:"font-medium",children:r(x.debtWeight)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{children:"Total Capital:"}),e.jsxs("span",{className:"font-medium",children:["$",(x.totalCapital/1e3).toFixed(0),"M"]})]})]})]})]})]})]})]}),"calculation"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"WACC Calculation Breakdown"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"CAPM Method"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Risk-Free Rate:"}),e.jsx("span",{className:"font-medium",children:r(t.dcf.wacc?.riskFreeRate||m.riskFreeRate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta × Market Risk Premium:"}),e.jsx("span",{className:"font-medium",children:r((t.dcf.wacc?.beta||m.beta)*(t.dcf.wacc?.marketRiskPremium||m.marketRiskPremium))})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Small Company Premium:"}),e.jsx("span",{className:"font-medium",children:r(t.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Company-Specific Risk:"}),e.jsx("span",{className:"font-medium",children:r(t.dcf.wacc?.companySpecificRisk||m.companySpecificRisk)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[e.jsx("span",{children:"Cost of Equity (CAPM):"}),e.jsx("span",{children:r(x.costOfEquityCAPM)})]})]})]}),e.jsxs("div",{className:"p-6 bg-green-50 rounded-lg border border-green-200",children:[e.jsx("h5",{className:"font-medium mb-4 text-green-800",children:"Build-up Method"}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Risk-Free Rate:"}),e.jsx("span",{className:"font-medium",children:r(m.buildUpMethod.riskFreeRate)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Equity Risk Premium:"}),e.jsx("span",{className:"font-medium",children:r(m.buildUpMethod.equityRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Size Risk Premium:"}),e.jsx("span",{className:"font-medium",children:r(m.buildUpMethod.sizeRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Industry Risk Premium:"}),e.jsx("span",{className:"font-medium",children:r(m.buildUpMethod.industryRiskPremium)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Company-Specific Risk:"}),e.jsx("span",{className:"font-medium",children:r(m.buildUpMethod.companySpecificRisk)})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[e.jsx("span",{children:"Cost of Equity (Build-up):"}),e.jsx("span",{children:r(x.costOfEquityBuildUp)})]})]})]})]}),e.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[e.jsx("h5",{className:"font-medium mb-4",children:"Final WACC Calculation"}),e.jsxs("div",{className:"space-y-4 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"WACC (CAPM Method):"}),e.jsx("span",{className:"font-medium",children:r(x.waccCAPM)})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["[",r(x.costOfEquityCAPM)," × ",r(x.equityWeight),"] + [",r(x.costOfDebtAfterTax)," × ",r(x.debtWeight),"]"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between mb-2",children:[e.jsx("span",{children:"WACC (Build-up Method):"}),e.jsx("span",{className:"font-medium",children:r(x.waccBuildUp)})]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["[",r(x.costOfEquityBuildUp)," × ",r(x.equityWeight),"] + [",r(x.costOfDebtAfterTax)," × ",r(x.debtWeight),"]"]})]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold",children:"Risk-Adjusted WACC:"}),e.jsx("span",{className:"text-2xl font-bold text-blue-600",children:r(x.finalWACC)})]}),e.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Average of CAPM and Build-up methods"})]})]})]})]}),"benchmarks"===c&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Industry Benchmarks & Validation"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Your Company"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC:"}),e.jsx("span",{className:"font-semibold",children:r(x.finalWACC)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta:"}),e.jsx("span",{className:"font-semibold",children:(t.dcf.wacc?.beta||m.beta).toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"D/E Ratio:"}),e.jsxs("span",{className:"font-semibold",children:[x.debtToEquityRatio.toFixed(2),"x"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-green-800 mb-2",children:"Industry Average"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC:"}),e.jsx("span",{className:"font-semibold",children:r(m.industryWACC)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta:"}),e.jsx("span",{className:"font-semibold",children:m.industryBeta.toFixed(2)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"D/E Ratio:"}),e.jsxs("span",{className:"font-semibold",children:[m.industryDebtEquityRatio.toFixed(2),"x"]})]})]})]}),e.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Variance"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"WACC Diff:"}),e.jsxs("span",{className:"font-semibold "+(x.finalWACC>m.industryWACC?"text-red-600":"text-green-600"),children:[x.finalWACC>m.industryWACC?"+":"",r(x.finalWACC-m.industryWACC)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Beta Diff:"}),e.jsxs("span",{className:"font-semibold "+((t.dcf.wacc?.beta||m.beta)>m.industryBeta?"text-red-600":"text-green-600"),children:[(t.dcf.wacc?.beta||m.beta)>m.industryBeta?"+":"",((t.dcf.wacc?.beta||m.beta)-m.industryBeta).toFixed(2)]})]})]})]})]}),e.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(k,{size:16,className:"text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Validation Guidelines"}),e.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[e.jsx("li",{children:"• WACC should be within ±2% of industry average for similar companies"}),e.jsx("li",{children:"• Beta should reflect business risk relative to market (typically 0.8-1.5 for most companies)"}),e.jsx("li",{children:"• Cost of equity should exceed risk-free rate by at least 4-6% for private companies"}),e.jsx("li",{children:"• Debt/equity ratio should align with industry norms and company strategy"}),e.jsx("li",{children:"• Consider economic conditions and company-specific factors"})]})]})]})})]})]})]})},Ne=({data:t,modelInputs:a,onModelInputChange:r,formatCurrency:l,formatPercent:n})=>{const[c,d]=s.useState(!1),[m,h]=s.useState(!0),[p,g]=s.useState("results"),b=s.useMemo(()=>{const{discountRate:e,terminalGrowthRate:s,projectionYears:r,taxRate:i}=a.dcf,l=t.statements,n=a.dcf.workingCapital||{receivablesDays:45,inventoryDays:60,payablesDays:30},o=a.dcf.capex||{capexAsPercentOfRevenue:3.5,depreciationRate:7},c={years:[],freeCashFlows:[],presentValues:[],workingCapitalChanges:[],capexAmounts:[],unleveredFreeCashFlow:[],cumulativePV:0,terminalValue:0,presentValueTerminal:0,enterpriseValue:0,equityValue:0,impliedShare:0},d=l.incomeStatement.totalRevenue?.[0]||1e5;for(let t=1;t<=r;t++){const s={year:t,revenue:l.incomeStatement.totalRevenue?.[t]||0,operatingIncome:l.incomeStatement.operatingIncome?.[t]||0,nopat:0,workingCapitalChange:0,capex:0,depreciation:0,freeCashFlow:0,presentValue:0};s.nopat=s.operatingIncome*(1-i/100);const a=s.revenue,r=t>1?l.incomeStatement.totalRevenue?.[t-1]||0:d,m=a*n.receivablesDays/365,x=a*n.inventoryDays/365,u=a*n.payablesDays/365,h=m-r*n.receivablesDays/365,p=x-r*n.inventoryDays/365,g=u-r*n.payablesDays/365;s.workingCapitalChange=-(h+p-g),s.capex=-a*o.capexAsPercentOfRevenue/100,s.depreciation=Math.abs(s.capex)/o.depreciationRate,s.freeCashFlow=s.nopat+s.depreciation+s.capex+s.workingCapitalChange;const b=Math.pow(1+e/100,t);s.presentValue=s.freeCashFlow/b,c.years.push(s),c.freeCashFlows.push(s.freeCashFlow),c.presentValues.push(s.presentValue),c.workingCapitalChanges.push(s.workingCapitalChange),c.capexAmounts.push(s.capex),c.unleveredFreeCashFlow.push(s.freeCashFlow),c.cumulativePV+=s.presentValue}const m=(c.years[c.years.length-1]?.freeCashFlow||0)*(1+s/100);c.terminalValue=m/((e-s)/100);const x=Math.pow(1+e/100,r);c.presentValueTerminal=c.terminalValue/x,c.enterpriseValue=c.cumulativePV+c.presentValueTerminal;c.equityValue=c.enterpriseValue-0;const u=a.dcf.sharesOutstanding||1e3;return c.impliedShare=c.equityValue/u,c},[t,a]),j=(e,s,t)=>{const i={...a.dcf,[e]:{...a.dcf[e],[s]:parseFloat(t)||0}};r("dcf",e,i[e])},v=(e,s)=>{r("dcf",e,parseFloat(s)||0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(o,{size:20}),"Advanced DCF Valuation"]}),e.jsx("p",{className:"text-gray-600",children:"Professional-grade DCF with working capital analysis, capex modeling, and detailed cash flow projections."})]}),e.jsx("div",{className:"flex gap-2",children:["results","charts","wacc","assumptions"].map(s=>e.jsxs("button",{onClick:()=>g(s),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-1 "+(p===s?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:["results"===s&&e.jsx(w,{size:14}),"charts"===s&&e.jsx(x,{size:14}),"wacc"===s&&e.jsx(o,{size:14}),"assumptions"===s&&e.jsx(f,{size:14}),s.charAt(0).toUpperCase()+s.slice(1)]},s))})]}),"results"===p&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"ENTERPRISE VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(b.enterpriseValue)}),e.jsxs("div",{className:"text-sm text-green-600 mt-1",children:["PV Operations: ",l(b.cumulativePV)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EQUITY VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l(b.equityValue)}),e.jsxs("div",{className:"text-sm text-blue-600 mt-1",children:["Per Share: ",l(b.impliedShare)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(x,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"TERMINAL VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-purple-800",children:l(b.terminalValue)}),e.jsxs("div",{className:"text-sm text-purple-600 mt-1",children:["PV: ",l(b.presentValueTerminal)]})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(C,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"IMPLIED MULTIPLE"})]}),e.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[(b.enterpriseValue/(t.statements.incomeStatement.totalRevenue?.[1]||1)).toFixed(1),"x"]}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"EV/Revenue (Year 1)"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Detailed Cash Flow Analysis"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Year"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Operating Income"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"NOPAT"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Depreciation"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Capex"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"ΔWorking Capital"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Free Cash Flow"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Present Value"})]})}),e.jsxs("tbody",{children:[b.years.map((s,t)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3 font-medium",children:s.year}),e.jsx("td",{className:"p-3 text-right",children:l(s.revenue)}),e.jsx("td",{className:"p-3 text-right",children:l(s.operatingIncome)}),e.jsx("td",{className:"p-3 text-right",children:l(s.nopat)}),e.jsxs("td",{className:"p-3 text-right text-green-600",children:["+",l(s.depreciation)]}),e.jsx("td",{className:"p-3 text-right text-red-600",children:l(s.capex)}),e.jsxs("td",{className:"p-3 text-right "+(s.workingCapitalChange>=0?"text-green-600":"text-red-600"),children:[s.workingCapitalChange>=0?"+":"",l(s.workingCapitalChange)]}),e.jsx("td",{className:"p-3 text-right font-medium",children:l(s.freeCashFlow)}),e.jsx("td",{className:"p-3 text-right font-medium",children:l(s.presentValue)})]},t)),e.jsxs("tr",{className:"border-b-2 border-gray-300 bg-blue-50",children:[e.jsx("td",{className:"p-3 font-bold",children:"Terminal"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3 text-right font-bold",children:l(b.terminalValue)}),e.jsx("td",{className:"p-3 text-right font-bold",children:l(b.presentValueTerminal)})]}),e.jsxs("tr",{className:"bg-gray-100 font-bold",children:[e.jsx("td",{className:"p-3",children:"TOTAL"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3 text-right text-lg",children:l(b.enterpriseValue)})]})]})]})})]})]}),"charts"===p&&e.jsx(ve,{dcfData:b,sensitivityData:null,scenarioData:null,formatCurrency:l,formatPercent:n}),"wacc"===p&&e.jsx(ye,{modelInputs:a,onModelInputChange:r,formatPercent:n}),"assumptions"===p&&e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Model Assumptions"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Core Assumptions"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Discount Rate (WACC) %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.discountRate,onChange:e=>v("discountRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Terminal Growth Rate %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.terminalGrowthRate,onChange:e=>v("terminalGrowthRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate %"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.taxRate,onChange:e=>v("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Working Capital"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Receivables (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.receivablesDays||45,onChange:e=>j("workingCapital","receivablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Inventory (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.inventoryDays||60,onChange:e=>j("workingCapital","inventoryDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payables (Days)"}),e.jsx("input",{type:"number",value:a.dcf.workingCapital?.payablesDays||30,onChange:e=>j("workingCapital","payablesDays",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-3 text-gray-800",children:"Capital Expenditure"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capex (% of Revenue)"}),e.jsx("input",{type:"number",step:"0.1",value:a.dcf.capex?.capexAsPercentOfRevenue||3.5,onChange:e=>j("capex","capexAsPercentOfRevenue",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Depreciation Period (Years)"}),e.jsx("input",{type:"number",value:a.dcf.capex?.depreciationRate||7,onChange:e=>j("capex","depreciationRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Shares Outstanding (000s)"}),e.jsx("input",{type:"number",value:a.dcf.sharesOutstanding||1e3,onChange:e=>v("sharesOutstanding",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]})]})]})]})},we=({data:t,formatCurrency:a,formatPercent:r})=>{const[n,o]=s.useState("multiples"),[c,d]=s.useState("ev_revenue"),[m,h]=s.useState(!1),[p,g]=s.useState([{id:1,name:"MedSpa Corp",ticker:"MSPA",marketCap:45e4,enterpriseValue:52e4,revenue:18e4,ebitda:45e3,netIncome:28e3,employees:1200,founded:2015,geography:"US",businessModel:"B2C Medical Spa Chain"},{id:2,name:"Wellness Holdings",ticker:"WELL",marketCap:68e4,enterpriseValue:75e4,revenue:22e4,ebitda:55e3,netIncome:35e3,employees:1800,founded:2012,geography:"US",businessModel:"Integrated Wellness Platform"},{id:3,name:"Aesthetic Solutions Inc",ticker:"AEST",marketCap:32e4,enterpriseValue:38e4,revenue:125e3,ebitda:32e3,netIncome:18e3,employees:850,founded:2018,geography:"US",businessModel:"Medical Device & Services"},{id:4,name:"Premium Health Group",ticker:"PHG",marketCap:92e4,enterpriseValue:105e4,revenue:31e4,ebitda:78e3,netIncome:48e3,employees:2500,founded:2010,geography:"US",businessModel:"Premium Healthcare Services"}]),b=s.useMemo(()=>p.map(e=>({...e,multiples:{ev_revenue:e.enterpriseValue/e.revenue,ev_ebitda:e.enterpriseValue/e.ebitda,pe_ratio:e.marketCap/e.netIncome,revenue_per_employee:e.revenue/e.employees,market_cap_revenue:e.marketCap/e.revenue}})),[p]),f=s.useMemo(()=>{const e=b.map(e=>e.multiples),s=e=>({mean:e.reduce((e,s)=>e+s,0)/e.length,median:e.sort((e,s)=>e-s)[Math.floor(e.length/2)],min:Math.min(...e),max:Math.max(...e),p25:e.sort((e,s)=>e-s)[Math.floor(.25*e.length)],p75:e.sort((e,s)=>e-s)[Math.floor(.75*e.length)]});return{ev_revenue:s(e.map(e=>e.ev_revenue)),ev_ebitda:s(e.map(e=>e.ev_ebitda)),pe_ratio:s(e.map(e=>e.pe_ratio)),revenue_per_employee:s(e.map(e=>e.revenue_per_employee)),market_cap_revenue:s(e.map(e=>e.market_cap_revenue))}},[b]),j=s.useMemo(()=>{const e=t.statements.incomeStatement.totalRevenue?.[1]||1e5,s=1.15*(t.statements.incomeStatement.operatingIncome?.[1]||5e4),a=.7*(t.statements.incomeStatement.operatingIncome?.[1]||5e4);return{ev_revenue:{mean:e*f.ev_revenue.mean,median:e*f.ev_revenue.median,p25:e*f.ev_revenue.p25,p75:e*f.ev_revenue.p75},ev_ebitda:{mean:s*f.ev_ebitda.mean,median:s*f.ev_ebitda.median,p25:s*f.ev_ebitda.p25,p75:s*f.ev_ebitda.p75},pe_ratio:{mean:a*f.pe_ratio.mean,median:a*f.pe_ratio.median,p25:a*f.pe_ratio.p25,p75:a*f.pe_ratio.p75}}},[t,f]),v={ev_revenue:{name:"EV/Revenue",description:"Enterprise Value / Annual Revenue"},ev_ebitda:{name:"EV/EBITDA",description:"Enterprise Value / EBITDA"},pe_ratio:{name:"P/E Ratio",description:"Market Cap / Net Income"},revenue_per_employee:{name:"Revenue/Employee",description:"Revenue per Employee"},market_cap_revenue:{name:"Market Cap/Revenue",description:"Market Cap / Revenue"}},y=[{id:"multiples",label:"Trading Multiples",icon:x},{id:"analysis",label:"Valuation Analysis",icon:M},{id:"companies",label:"Comparable Set",icon:R}];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[e.jsx(R,{size:20}),"Comparable Company Analysis"]}),e.jsx("p",{className:"text-gray-600",children:"Market-based valuation using trading multiples from similar public companies."})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs("button",{onClick:()=>h(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",children:[e.jsx(l,{size:16}),"Add Comparable"]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(u.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(x,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EV/REVENUE"})]}),e.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[f.ev_revenue.median.toFixed(1),"x"]}),e.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Median multiple"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(i,{size:20,className:"text-green-600"}),e.jsx("span",{className:"text-xs text-green-600 font-medium",children:"IMPLIED VALUE"})]}),e.jsx("div",{className:"text-2xl font-bold text-green-800",children:a(j.ev_revenue.median)}),e.jsx("div",{className:"text-sm text-green-600 mt-1",children:"EV/Revenue basis"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(w,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"VALUATION RANGE"})]}),e.jsxs("div",{className:"text-lg font-bold text-purple-800",children:[a(j.ev_revenue.p25)," - ",a(j.ev_revenue.p75)]}),e.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"25th - 75th percentile"})]}),e.jsxs(u.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(R,{size:20,className:"text-orange-600"}),e.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"PEER COUNT"})]}),e.jsx("div",{className:"text-2xl font-bold text-orange-800",children:p.length}),e.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Comparable companies"})]})]}),e.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:y.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>o(s.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(n===s.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[e.jsx(t,{size:16}),s.label]},s.id)})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["multiples"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Trading Multiples Analysis"}),e.jsx("select",{value:c,onChange:e=>d(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(v).map(([s,t])=>e.jsx("option",{value:s,children:t.name},s))})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left p-3 font-medium",children:"Company"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Market Cap"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Enterprise Value"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"EV/Revenue"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"EV/EBITDA"}),e.jsx("th",{className:"text-right p-3 font-medium",children:"P/E Ratio"})]})}),e.jsxs("tbody",{children:[b.map((s,t)=>e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"p-3",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:s.name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.ticker})]})}),e.jsx("td",{className:"p-3 text-right",children:a(s.marketCap)}),e.jsx("td",{className:"p-3 text-right",children:a(s.enterpriseValue)}),e.jsx("td",{className:"p-3 text-right",children:a(s.revenue)}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.ev_revenue.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.ev_ebitda.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right font-medium",children:[s.multiples.pe_ratio.toFixed(1),"x"]})]},s.id)),e.jsxs("tr",{className:"border-t-2 border-gray-300 bg-blue-50 font-semibold",children:[e.jsx("td",{className:"p-3",children:"Market Statistics"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsx("td",{className:"p-3"}),e.jsxs("td",{className:"p-3 text-right",children:[f.ev_revenue.median.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right",children:[f.ev_ebitda.median.toFixed(1),"x"]}),e.jsxs("td",{className:"p-3 text-right",children:[f.pe_ratio.median.toFixed(1),"x"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-3",children:"Multiple Distribution"}),e.jsx("div",{className:"space-y-3",children:Object.entries(f).slice(0,3).map(([s,t])=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[e.jsx("span",{children:v[s].name}),e.jsxs("span",{className:"font-medium",children:[t.median.toFixed(1),"x"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:(t.median-t.min)/(t.max-t.min)*100+"%"}})}),e.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[e.jsxs("span",{children:[t.min.toFixed(1),"x"]}),e.jsxs("span",{children:[t.max.toFixed(1),"x"]})]})]},s))})]}),e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Companies Analyzed:"}),e.jsx("span",{className:"font-medium",children:p.length})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median Market Cap:"}),e.jsx("span",{className:"font-medium",children:a(p.sort((e,s)=>e.marketCap-s.marketCap)[Math.floor(p.length/2)]?.marketCap||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median Revenue:"}),e.jsx("span",{className:"font-medium",children:a(p.sort((e,s)=>e.revenue-s.revenue)[Math.floor(p.length/2)]?.revenue||0)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Avg Founded Year:"}),e.jsx("span",{className:"font-medium",children:Math.round(p.reduce((e,s)=>e+s.founded,0)/p.length)})]})]})]})]})]}),"analysis"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Valuation Analysis"}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4",children:"Implied Valuation by Multiple"}),e.jsx("div",{className:"space-y-4",children:Object.entries(j).map(([s,t])=>e.jsxs("div",{className:"p-4 border rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:v[s].name}),e.jsxs("span",{className:"text-sm text-gray-500",children:[f[s].median.toFixed(1),"x median"]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"25th Percentile:"}),e.jsx("span",{className:"font-medium",children:a(t.p25)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Median:"}),e.jsx("span",{className:"font-bold text-blue-600",children:a(t.median)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"75th Percentile:"}),e.jsx("span",{className:"font-medium",children:a(t.p75)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Mean:"}),e.jsx("span",{className:"font-medium",children:a(t.mean)})]})]})]},s))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-4",children:"Valuation Summary"}),e.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Recommended Range"}),e.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[a((j.ev_revenue.p25+j.ev_ebitda.p25)/2)," -",a((j.ev_revenue.p75+j.ev_ebitda.p75)/2)]}),e.jsx("div",{className:"text-sm text-blue-600",children:"Blended 25th-75th percentile"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Midpoint Valuation"}),e.jsx("div",{className:"text-xl font-bold text-blue-800",children:a((j.ev_revenue.median+j.ev_ebitda.median)/2)}),e.jsx("div",{className:"text-sm text-blue-600",children:"Average of median multiples"})]})]})}),e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(M,{size:16,className:"text-yellow-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-medium text-yellow-800 mb-1",children:"Valuation Considerations"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[e.jsx("li",{children:"• Consider company-specific growth and margin profiles"}),e.jsx("li",{children:"• Adjust for differences in business model and scale"}),e.jsx("li",{children:"• Factor in market conditions and sector trends"}),e.jsx("li",{children:"• Apply appropriate discount for private company liquidity"})]})]})]})})]})]})]}),"companies"===n&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Comparable Company Set"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(S,{size:16,className:"absolute left-3 top-3 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search companies...",className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("button",{className:"px-3 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[e.jsx(F,{size:16}),"Filter"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:p.map(s=>e.jsxs(u.div,{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{children:[e.jsx("h6",{className:"font-semibold text-gray-800",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[s.ticker," • ",s.geography]})]}),e.jsx("button",{onClick:()=>{return e=s.id,void g(p.filter(s=>s.id!==e));var e},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:"×"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Market Cap:"}),e.jsx("span",{className:"font-medium",children:a(s.marketCap)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Revenue:"}),e.jsx("span",{className:"font-medium",children:a(s.revenue)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"EV/Revenue:"}),e.jsxs("span",{className:"font-medium",children:[(s.enterpriseValue/s.revenue).toFixed(1),"x"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Founded:"}),e.jsx("span",{className:"font-medium",children:s.founded})]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t",children:e.jsx("div",{className:"text-xs text-gray-600",children:s.businessModel})})]},s.id))})]})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[e.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Add Comparable Company"}),e.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=new FormData(e.target);(e=>{const s={id:Date.now(),...e,marketCap:parseFloat(e.marketCap)||0,enterpriseValue:parseFloat(e.enterpriseValue)||0,revenue:parseFloat(e.revenue)||0,ebitda:parseFloat(e.ebitda)||0,netIncome:parseFloat(e.netIncome)||0,employees:parseInt(e.employees)||0,founded:parseInt(e.founded)||(new Date).getFullYear()};g([...p,s]),h(!1)})(Object.fromEntries(s))},children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),e.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker"}),e.jsx("input",{name:"ticker",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Cap ($000s)"}),e.jsx("input",{name:"marketCap",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enterprise Value ($000s)"}),e.jsx("input",{name:"enterpriseValue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue ($000s)"}),e.jsx("input",{name:"revenue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA ($000s)"}),e.jsx("input",{name:"ebitda",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Model"}),e.jsx("input",{name:"businessModel",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Company"}),e.jsx("button",{type:"button",onClick:()=>h(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})},Ce=({data:t,onDataChange:a})=>{const[r,l]=s.useState("setup"),[o,c]=s.useState(null),[d,m]=s.useState(!1),[h,p]=s.useState(0),[g,b]=s.useState({iterations:1e4,confidenceLevel:.95,randomSeed:null,enableCorrelation:!1}),[j,v]=s.useState({revenueGrowthRate:{type:"normal",parameters:{mean:.1,stdDev:.03},name:"Revenue Growth Rate",enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.12,mode:.15,max:.18},name:"FCF Margin",enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},name:"WACC",enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},name:"Terminal Growth Rate",enabled:!0}}),[y,N]=s.useState([[1,.3,-.2,.1],[.3,1,-.4,.2],[-.2,-.4,1,-.3],[.1,.2,-.3,1]]),w=[{value:"normal",label:"Normal",parameters:["mean","stdDev"]},{value:"triangular",label:"Triangular",parameters:["min","mode","max"]},{value:"uniform",label:"Uniform",parameters:["min","max"]},{value:"lognormal",label:"Log-Normal",parameters:["mu","sigma"]},{value:"beta",label:"Beta",parameters:["alpha","beta"]}],C=s.useCallback(async()=>{try{m(!0),p(0);const e=Object.fromEntries(Object.entries(j).filter(([e,s])=>s.enabled));if(0===Object.keys(e).length)throw new Error("No distributions are enabled. Please enable at least one variable distribution to run the simulation.");const s={iterations:g.iterations,confidenceLevel:g.confidenceLevel,randomSeed:g.randomSeed,correlationMatrix:g.enableCorrelation?y:null,onProgress:p},a=t?.statements?.incomeStatement,r=t?.periods?.length-1||2,i={currentRevenue:1e3*(a?.totalRevenue?.[r]||1e6),currentPrice:100,sharesOutstanding:1e6,currentOperatingIncome:1e3*(a?.operatingIncome?.[r]||15e4),...Object.fromEntries(Object.entries(e).map(([e,s])=>[e,s.parameters.mean||s.parameters.mode||(s.parameters.min+s.parameters.max)/2]))},l=await ge.runDCFSimulation(i,e,s);c(l)}catch(e){alert(`Monte Carlo simulation failed: ${e.message}`)}finally{m(!1),p(0)}},[j,g,y,t]),k=s.useCallback(()=>{ge.stopSimulation(),m(!1)},[]),R=s.useCallback((e,s)=>{v(t=>({...t,[e]:{...t[e],...s}}))},[]),M=s.useCallback((e,s,t)=>{N(a=>{const r=a.map(e=>[...e]);return r[e][s]=t,r[s][e]=t,r})},[]),S=s.useMemo(()=>{if(!o?.results)return[];const e=o.results.map(e=>e.pricePerShare),s=Math.min(...e),t=(Math.max(...e)-s)/50,a=Array(50).fill(0).map((e,a)=>({bin:s+a*t,count:0,frequency:0}));return e.forEach(e=>{const r=Math.min(Math.floor((e-s)/t),49);a[r].count++}),a.forEach(s=>{s.frequency=s.count/e.length}),a},[o]),F=s.useMemo(()=>o?.results?o.results.slice(0,1e3).map((e,s)=>({x:100*e.inputs.revenueGrowthRate,y:e.pricePerShare,upside:e.upside})):[],[o]),O=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),T=[{id:"setup",label:"Setup",icon:f},{id:"run",label:"Run Simulation",icon:I},{id:"results",label:"Results",icon:x},{id:"analysis",label:"Analysis",icon:i}];return e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsx("div",{className:"mb-6",children:e.jsxs(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-2 flex items-center",children:[e.jsx(A,{className:"inline-block mr-2"}),"Monte Carlo Simulation"]}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Advanced risk analysis using probabilistic modeling • Generate thousands of scenarios • Measure uncertainty"})]})}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex space-x-2",children:T.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>l(s.id),className:"px-4 py-2 rounded-lg font-medium transition-colors flex items-center gap-2 "+(r===s.id?"bg-blue-600 text-white":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:[e.jsx(t,{size:16}),s.label]},s.id)})})}),e.jsx("div",{className:"mt-6",children:e.jsxs(P,{mode:"wait",children:["setup"===r&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"🎛️ Simulation Settings"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Iterations"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:g.iterations,onChange:e=>b(s=>({...s,iterations:parseInt(e.target.value)})),min:"1000",max:"100000",step:"1000"}),e.jsx("small",{className:"text-gray-400",children:"Leave empty for random"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Confidence Level"}),e.jsxs("select",{className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:g.confidenceLevel,onChange:e=>b(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),children:[e.jsx("option",{value:.9,children:"90%"}),e.jsx("option",{value:.95,children:"95%"}),e.jsx("option",{value:.99,children:"99%"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Random Seed (Optional)"}),e.jsx("input",{type:"number",className:"w-full px-3 py-2 bg-gray-800 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:g.randomSeed||"",onChange:e=>b(s=>({...s,randomSeed:e.target.value?parseInt(e.target.value):null})),placeholder:"Leave empty for random"})]}),e.jsx("div",{className:"space-y-2",children:e.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[e.jsx("input",{type:"checkbox",className:"w-4 h-4 text-blue-600 bg-gray-800 border-gray-600 rounded focus:ring-blue-500",checked:g.enableCorrelation,onChange:e=>b(s=>({...s,enableCorrelation:e.target.checked}))}),e.jsx("span",{children:"Enable Variable Correlation"})]})})]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"📊 Variable Distributions"}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:Object.entries(j).map(([s,t])=>e.jsxs("div",{className:"bg-gray-800 border border-gray-600 rounded-lg p-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("label",{className:"flex items-center space-x-2 text-gray-200",children:[e.jsx("input",{type:"checkbox",checked:t.enabled,onChange:e=>R(s,{enabled:e.target.checked})}),e.jsx("span",{className:"font-medium",children:t.name})]})}),t.enabled&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-200",children:"Distribution Type"}),e.jsx("select",{className:"w-full px-3 py-2 bg-gray-700 border border-gray-600 rounded-lg text-white focus:outline-none focus:ring-2 focus:ring-blue-500",value:t.type,onChange:e=>{const t=e.target.value;w.find(e=>e.value===t);const a={};"normal"===t?(a.mean=.1,a.stdDev=.02):"triangular"===t?(a.min=.05,a.mode=.1,a.max=.15):"uniform"===t&&(a.min=.05,a.max=.15),R(s,{type:t,parameters:a})},children:w.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))})]}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:w.find(e=>e.value===t.type)?.parameters.map(a=>e.jsxs("div",{className:"space-y-1",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-300",children:a.charAt(0).toUpperCase()+a.slice(1)}),e.jsx("input",{className:"w-full px-2 py-1 bg-gray-700 border border-gray-600 rounded text-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500",type:"number",value:t.parameters[a]||"",onChange:e=>R(s,{parameters:{...t.parameters,[a]:parseFloat(e.target.value)}}),step:"0.001"})]},a))})]})]},s))})]}),g.enableCorrelation&&e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"🔗 Correlation Matrix"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),Object.keys(j).map(s=>e.jsx("th",{children:j[s].name},s))]})}),e.jsx("tbody",{children:Object.keys(j).map((s,t)=>e.jsxs("tr",{children:[e.jsx("td",{className:"font-medium text-gray-200 p-2 border border-gray-600",children:j[s].name}),Object.keys(j).map((s,a)=>e.jsx("td",{className:"p-2 border border-gray-600",children:e.jsx("input",{type:"number",value:y[t][a],onChange:e=>M(t,a,parseFloat(e.target.value)),min:"-1",max:"1",step:"0.1",disabled:t===a,className:"w-full px-2 py-1 bg-gray-800 border border-gray-600 rounded text-white text-sm focus:outline-none focus:ring-1 focus:ring-blue-500 disabled:bg-gray-700 disabled:text-gray-400"})},a))]},s))})]})})]})]})},"setup"),"run"===r&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{children:"🚀 Simulation Control"}),e.jsx("div",{className:"flex items-center space-x-2",children:d?e.jsxs("button",{onClick:k,className:"bg-red-600 hover:bg-red-700 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[e.jsx(V,{size:16}),e.jsx("span",{children:"Stop Simulation"})]}):e.jsxs("button",{onClick:C,className:"bg-blue-600 hover:bg-blue-700 disabled:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",disabled:Object.values(j).every(e=>!e.enabled),children:[e.jsx(I,{size:16}),e.jsx("span",{children:"Run Simulation"})]})})]}),d&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"w-full bg-gray-700 rounded-full h-2 mb-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${h}%`}})}),e.jsxs("div",{className:"text-sm text-gray-400 text-center",children:[h.toFixed(1),"% Complete (",Math.floor(h*g.iterations/100)," / ",g.iterations," iterations)"]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 mt-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"📋 Simulation Preview"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Iterations"}),e.jsx("div",{className:"text-xl font-bold text-white",children:g.iterations.toLocaleString()})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Variables"}),e.jsx("div",{className:"text-xl font-bold text-white",children:Object.values(j).filter(e=>e.enabled).length})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Confidence Level"}),e.jsxs("div",{className:"text-xl font-bold text-white",children:[(100*g.confidenceLevel).toFixed(0),"%"]})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-3 text-center",children:[e.jsx("div",{className:"text-sm text-gray-400 mb-1",children:"Correlation"}),e.jsx("div",{className:"text-xl font-bold text-white",children:g.enableCorrelation?"Enabled":"Disabled"})]})]})]})]})},"run"),"results"===r&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:o?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-xl font-semibold text-white flex items-center",children:"📊 Simulation Results"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("button",{className:"bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[e.jsx(E,{size:16}),"Export Results"]}),e.jsxs("button",{className:"bg-gray-700 hover:bg-gray-600 text-white px-4 py-2 rounded-lg font-medium flex items-center space-x-2 transition-colors",children:[e.jsx(n,{size:16}),"Generate Report"]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(o.analysis.statistics).map(([s,t])=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"pricePerShare"===s?"💰 Price per Share":"enterpriseValue"===s?"🏢 Enterprise Value":"📈 Upside %"}),e.jsx("div",{className:"text-2xl font-bold text-green-400 mb-2",children:"upside"===s?`${t.mean.toFixed(1)}%`:O(t.mean)}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-300",children:[e.jsxs("div",{children:["Median: ","upside"===s?`${t.median.toFixed(1)}%`:O(t.median)]}),e.jsxs("div",{children:["Std Dev: ","upside"===s?`${t.stdDev.toFixed(1)}%`:O(t.stdDev)]}),e.jsxs("div",{children:["Min: ","upside"===s?`${t.min.toFixed(1)}%`:O(t.min)]}),e.jsxs("div",{children:["Max: ","upside"===s?`${t.max.toFixed(1)}%`:O(t.max)]})]})]},s))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{children:"📊 Price Distribution"}),e.jsx(Y,{width:"100%",height:300,children:e.jsxs(oe,{data:S,children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"bin",tickFormatter:O}),e.jsx(Z,{}),e.jsx(ee,{formatter:(e,s)=>[`${(100*e).toFixed(2)}%`,"Frequency"],labelFormatter:e=>`Price: ${O(e)}`}),e.jsx(ce,{type:"monotone",dataKey:"frequency",stroke:"#3B82F6",fill:"#3B82F6",fillOpacity:.6})]})})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h4",{children:"🎯 Sensitivity Scatter Plot"}),e.jsx(Y,{width:"100%",height:300,children:e.jsxs(de,{data:F,children:[e.jsx(J,{strokeDasharray:"3 3"}),e.jsx(X,{dataKey:"x",name:"Revenue Growth Rate",tickFormatter:e=>`${e.toFixed(1)}%`}),e.jsx(Z,{dataKey:"y",name:"Price per Share",tickFormatter:O}),e.jsx(ee,{formatter:(e,s)=>["Revenue Growth Rate"===s?`${e.toFixed(2)}%`:O(e),s]}),e.jsx(me,{name:"Scenarios",fill:"#10B981",children:F.map((s,t)=>e.jsx(re,{fill:s.upside>0?"#10B981":"#EF4444"},`cell-${t}`))})]})})]})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(D,{size:48,className:"text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Results Available"}),e.jsx("p",{className:"text-gray-400",children:"Run a simulation to see results here."})]})},"results"),"analysis"===r&&e.jsx(u.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:o?.analysis?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"⚠️ Risk Metrics"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:Object.entries(o.analysis.riskMetrics).map(([s,t])=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-300 mb-2",children:"var95"===s?"Value at Risk (95%)":"cvar95"===s?"Conditional VaR (95%)":"probabilityOfLoss"===s?"Probability of Loss":"Sharpe Ratio"}),e.jsx("div",{className:"text-xl font-bold text-red-400 mb-1",children:"probabilityOfLoss"===s?`${(100*t).toFixed(1)}%`:O(t)}),e.jsx("div",{className:"text-xs text-gray-400",children:"Risk measure"})]},s))})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:["📊 Confidence Intervals (",(100*o.analysis.confidenceIntervals.pricePerShare?.level).toFixed(0),"%)"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:Object.entries(o.analysis.confidenceIntervals).map(([s,t])=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 border border-gray-600",children:[e.jsx("h4",{className:"text-lg font-semibold text-white mb-3",children:"pricePerShare"===s?"Price per Share":"enterpriseValue"===s?"Enterprise Value":"Upside %"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Lower Bound:"}),e.jsx("span",{className:"font-medium text-white",children:"upside"===s?`${t.lowerBound.toFixed(1)}%`:O(t.lowerBound)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Upper Bound:"}),e.jsx("span",{className:"font-medium text-white",children:"upside"===s?`${t.upperBound.toFixed(1)}%`:O(t.upperBound)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Width:"}),e.jsx("span",{className:"font-medium text-blue-400",children:"upside"===s?`${t.width.toFixed(1)}%`:O(t.width)})]})]})]},s))})]}),e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-4 flex items-center",children:"📊 Percentile Analysis"}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("th",{className:"text-left p-3 text-sm font-medium text-gray-300",children:"Metric"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"5th %ile"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"25th %ile"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"50th %ile"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"75th %ile"}),e.jsx("th",{className:"text-right p-3 text-sm font-medium text-gray-300",children:"95th %ile"})]})}),e.jsx("tbody",{children:Object.entries(o.analysis.percentiles).map(([s,t])=>e.jsxs("tr",{className:"border-b border-gray-600",children:[e.jsx("td",{className:"p-3 text-sm text-white",children:"pricePerShare"===s?"Price per Share":"enterpriseValue"===s?"Enterprise Value":"Upside %"}),e.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===s?`${t.p5.toFixed(1)}%`:O(t.p5)}),e.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===s?`${t.p25.toFixed(1)}%`:O(t.p25)}),e.jsx("td",{className:"p-3 text-sm text-right text-blue-400 font-medium",children:"upside"===s?`${t.p50.toFixed(1)}%`:O(t.p50)}),e.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===s?`${t.p75.toFixed(1)}%`:O(t.p75)}),e.jsx("td",{className:"p-3 text-sm text-right text-gray-300",children:"upside"===s?`${t.p95.toFixed(1)}%`:O(t.p95)})]},s))})]})})]})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-12 text-center",children:[e.jsx(D,{size:48,className:"text-gray-400 mb-4"}),e.jsx("h3",{className:"text-xl font-semibold text-white mb-2",children:"No Analysis Available"}),e.jsx("p",{className:"text-gray-400",children:"Run a simulation to see analysis here."})]})},"analysis")]})})]})},ke=({data:a,adjustedValues:r,onDataChange:i})=>{const[l,n]=s.useState("dcf"),[o,c]=s.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,terminalValueMultiple:10,taxRate:25,sharesOutstanding:1e3,workingCapital:{receivablesDays:45,inventoryDays:60,payablesDays:30,receivablesGrowth:2,inventoryGrowth:1.5,payablesGrowth:1.8},capex:{capexAsPercentOfRevenue:3.5,depreciationRate:7,maintenanceCapex:2}},ratios:{compareToIndustry:!0,industryAverages:{grossMargin:45,operatingMargin:15,netMargin:8,currentRatio:2.1,debtToEquity:.5}},sensitivity:{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},scenario:{scenarios:[{name:"Base Case",probability:50,revenueGrowth:15,marginImprovement:0},{name:"Bull Case",probability:25,revenueGrowth:25,marginImprovement:2},{name:"Bear Case",probability:25,revenueGrowth:5,marginImprovement:-2}]}}),d=s.useMemo(()=>{const e=a.statements.incomeStatement,s=a.periods,t={revenue:[],grossProfit:[],operatingIncome:[],margins:{gross:[],operating:[],net:[]},growth:{revenue:[],operating:[]}};return s.forEach((a,i)=>{const l=i===s.length-1,n=l&&r?.totalRevenue?r.totalRevenue:e.totalRevenue?.[i]||0,o=l&&r?.totalCostOfGoodsSold?r.totalCostOfGoodsSold:e.totalCostOfGoodsSold?.[i]||0,c=l&&r?.grossProfit?r.grossProfit:e.grossProfit?.[i]||n-o,d=l&&r?.operatingIncome?r.operatingIncome:e.operatingIncome?.[i]||0;if(t.revenue.push(n),t.grossProfit.push(c),t.operatingIncome.push(d),t.margins.gross.push(n?c/n*100:0),t.margins.operating.push(n?d/n*100:0),i>0){const s=e.totalRevenue?.[i-1]||0,a=e.operatingIncome?.[i-1]||0;t.growth.revenue.push(s?(n-s)/s*100:0),t.growth.operating.push(a?(d-a)/a*100:0)}}),t},[a]),m=(e=null)=>{const{discountRate:s,terminalGrowthRate:t,projectionYears:r,taxRate:i}=o.dcf,l=e||a;let n;if(e?(n=[],l.periods.forEach((e,s)=>{s>0&&s<=r&&n.push(l.statements.incomeStatement.operatingIncome?.[s]||0)})):n=d.operatingIncome.slice(1,r+1),0===n.length)return{enterpriseValue:0,equityValue:0,sharePrice:0};let c=0;const m=1+s/100;n.forEach((e,s)=>{const t=e*(1-i/100)/Math.pow(m,s+1);c+=t});const x=(n[n.length-1]||0)*(1+t/100)*(1-i/100)/((s-t)/100),u=x/Math.pow(m,r),h=c+u;return{enterpriseValue:h,equityValue:h,presentValueOperations:c,presentValueTerminal:u,terminalValue:x}};m();const u=[{id:"dcf",label:"DCF Valuation",icon:w,description:"Discounted Cash Flow analysis"},{id:"ratios",label:"Ratio Analysis",icon:x,description:"Financial ratio comparison"},{id:"sensitivity",label:"Sensitivity Analysis",icon:b,description:"Variable impact analysis"},{id:"scenario",label:"Scenario Modeling",icon:M,description:"Multi-scenario projections"},{id:"comparable",label:"Comparable Analysis",icon:R,description:"Market-based valuation"},{id:"montecarlo",label:"Monte Carlo",icon:A,description:"Probabilistic risk analysis"}],h=(e,s,t)=>{c(a=>({...a,[e]:{...a[e],[s]:t}}))},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e),g=e=>`${e.toFixed(1)}%`;return e.jsxs("div",{className:"h-full bg-gray-900 text-white p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center justify-between mb-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Financial Modeling"}),e.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a modeling approach to analyze your financial data"})]})}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:u.map(s=>{const t=s.icon;return e.jsxs("button",{onClick:()=>n(s.id),className:(l===s.id?"bg-blue-600 text-white border-blue-500 shadow-lg":"bg-gray-800 text-gray-300 border-gray-700 hover:bg-gray-700 hover:text-white hover:border-gray-600")+" flex items-center gap-3 px-4 py-3 rounded-lg border transition-all duration-200",children:[e.jsx(t,{size:18,className:l===s.id?"text-white":"text-blue-400"}),e.jsx("span",{className:"font-medium",children:s.label})]},s.id)})}),e.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[t.createElement(u.find(e=>e.id===l)?.icon,{size:20,className:"text-blue-400"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-white",children:u.find(e=>e.id===l)?.label}),e.jsx("p",{className:"text-gray-400 text-sm",children:u.find(e=>e.id===l)?.description})]})]})})]}),e.jsxs("div",{children:["dcf"===l&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(w,{size:20,className:"text-blue-400"}),"DCF Valuation Model"]}),e.jsx(Ne,{data:a,modelInputs:o,onModelInputChange:h,formatCurrency:p,formatPercent:g})]}),"ratios"===l&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(x,{size:20}),"Financial Ratio Analysis"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Profitability Ratios"}),e.jsxs("div",{className:"space-y-3",children:[d.margins.gross.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Gross Margin:"]}),e.jsx("span",{className:"font-medium",children:g(s)})]},t)),d.margins.operating.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Operating Margin:"]}),e.jsx("span",{className:"font-medium",children:g(s)})]},t))]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Growth Rates"}),e.jsxs("div",{className:"space-y-3",children:[d.growth.revenue.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Revenue Growth:"]}),e.jsx("span",{className:"font-medium "+(s>=0?"text-green-600":"text-red-600"),children:g(s)})]},t)),d.growth.operating.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-sm",children:[a.periods[t+1]," Operating Growth:"]}),e.jsx("span",{className:"font-medium "+(s>=0?"text-green-600":"text-red-600"),children:g(s)})]},t))]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Industry Comparison"}),e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"p-3 bg-gray-700 rounded-lg",children:[e.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Industry Avg"}),e.jsxs("div",{className:"text-sm",children:["Gross Margin: ",g(o.ratios.industryAverages.grossMargin)]}),e.jsxs("div",{className:"text-sm",children:["Operating Margin: ",g(o.ratios.industryAverages.operatingMargin)]}),e.jsxs("div",{className:"text-sm",children:["Net Margin: ",g(o.ratios.industryAverages.netMargin)]})]})})]})]})]}),"sensitivity"===l&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(b,{size:20}),"Sensitivity Analysis"]}),e.jsx(je,{data:a,modelInputs:o,onModelInputChange:h,calculateDCF:m,formatCurrency:p,formatPercent:g})]}),"scenario"===l&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[e.jsx(M,{size:20}),"Scenario Modeling"]}),e.jsx(fe,{data:a,modelInputs:o,onModelInputChange:h,calculateDCF:m,formatCurrency:p,formatPercent:g})]}),"comparable"===l&&e.jsx("div",{className:"p-6",children:e.jsx(we,{data:a,formatCurrency:p,formatPercent:g})}),"montecarlo"===l&&e.jsxs("div",{className:"p-6",children:[e.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[e.jsx(A,{size:20}),"Monte Carlo Simulation"]}),e.jsx(Ce,{data:a,onDataChange:i})]})]})]})},Re=({data:t,adjustedValues:a,modelInputs:r,calculateDCF:l,formatCurrency:n,formatPercentage:o})=>{const c=s.useMemo(()=>{try{if(!t?.statements?.incomeStatement)return null;const s=t.statements.incomeStatement,r=Object.keys(s.totalRevenue||{}).sort((e,s)=>parseInt(e)-parseInt(s));if(r.length<2)return null;const o=r[r.length-1],c=r[r.length-2],d=r[0],m=a?.totalRevenue||s.totalRevenue?.[o]||0,u=s.totalRevenue?.[c]||0,h=s.totalRevenue?.[d]||0,p=a?.grossProfit||s.grossProfit?.[o]||0,g=s.grossProfit?.[c]||0,b=a?.operatingIncome||s.operatingIncome?.[o]||0,f=s.operatingIncome?.[c]||0,j=(a?.totalCostOfGoodsSold||s.totalCostOfGoodsSold,s.totalCostOfGoodsSold,u?(m-u)/u*100:0),v=h&&r.length>2?100*(Math.pow(m/h,1/(r.length-1))-1):0,y=f?(b-f)/f*100:0,w=m&&0!==m?p/m*100:0,C=u&&0!==u?g/u*100:0,k=m&&0!==m?b/m*100:0,R=u&&0!==u?f/u*100:0,S=isFinite(w)&&isFinite(C)?w-C:0,F=isFinite(k)&&isFinite(R)?k-R:0;let I=null;if(l)try{I=l(t)}catch(e){}const P=[{name:"Energy Devices",value:Number(s.energyDevices?.[o])||0},{name:"Injectables",value:Number(s.injectables?.[o])||0},{name:"Wellness",value:Number(s.wellness?.[o])||0},{name:"Weightloss",value:Number(s.weightloss?.[o])||0},{name:"Retail Sales",value:Number(s.retailSales?.[o])||0},{name:"Surgery",value:Number(s.surgery?.[o])||0}].filter(e=>e.value>0&&isFinite(e.value)),V=s.totalAssets?.[o]||1.2*m,E=s.totalEquity?.[o]||.6*V,D=s.totalDebt?.[o]||.3*V,B=s.currentAssets?.[o]||.4*V,z=s.currentLiabilities?.[o]||.2*V,G=s.inventory?.[o]||.15*m,L=s.accountsReceivable?.[o]||.1*m,$=s.cashAndEquivalents?.[o]||.1*V,W=V&&0!==V?b/V*100:0,_=E&&0!==E?b/E*100:0,U=E&&0!==E?D/E:0,K=z&&0!==z?B/z:0,H=z&&0!==z?(B-G)/z:0,Y=V&&0!==V?m/V:0,Q=G&&0!==G?.7*m/G:0,J=L&&0!==L?m/L:0,X=z&&0!==z?$/z:0,Z=B-z,ee=m&&0!==m?Z/m:0,se=Q>0&&J>0?365/Q+365/J:0,te=se>0?se-30:0,ae=0!==g?y/j:0,re=100*(k-R),ie=E&&0!==E?V/E:0,le=s.interestExpense?.[o]?b/s.interestExpense[o]:0,ne=s.debtService?.[o]?b/s.debtService[o]:0,oe=s.employeeCount?.[o]?m/s.employeeCount[o]:0,ce=s.sharesOutstanding?.[o]?m/s.sharesOutstanding[o]:0,de=s.sharesOutstanding?.[o]&&E?E/s.sharesOutstanding[o]:0,me={grossMargin:65,operatingMargin:18,returnOnAssets:8,returnOnEquity:15,currentRatio:2.5,debtToEquity:.4,assetTurnover:.8,revenueGrowth:8},xe={grossMargin:w-me.grossMargin,operatingMargin:k-me.operatingMargin,returnOnAssets:W-me.returnOnAssets,returnOnEquity:_-me.returnOnEquity,currentRatio:K-me.currentRatio,debtToEquity:me.debtToEquity-U,assetTurnover:Y-me.assetTurnover,revenueGrowth:j-me.revenueGrowth},ue=[{title:"Revenue Growth",value:`${j>0?"+":""}${isFinite(j)?j.toFixed(1):"0.0"}%`,trend:j>0?"up":"down",description:"Year-over-year revenue growth rate",icon:i,benchmark:me.revenueGrowth,performance:xe.revenueGrowth},{title:"Gross Margin",value:`${isFinite(w)?w.toFixed(1):"0.0"}%`,trend:S>0?"up":"down",description:`${S>0?"+":""}${isFinite(S)?S.toFixed(1):"0.0"}% vs prior year`,icon:N,benchmark:me.grossMargin,performance:xe.grossMargin},{title:"Operating Margin",value:`${isFinite(k)?k.toFixed(1):"0.0"}%`,trend:F>0?"up":"down",description:`${F>0?"+":""}${isFinite(F)?F.toFixed(1):"0.0"}% vs prior year`,icon:x,benchmark:me.operatingMargin,performance:xe.operatingMargin},{title:"Return on Assets",value:`${isFinite(W)?W.toFixed(1):"0.0"}%`,trend:W>me.returnOnAssets?"up":"down",description:"Asset utilization efficiency",icon:M,benchmark:me.returnOnAssets,performance:xe.returnOnAssets},{title:"Return on Equity",value:`${isFinite(_)?_.toFixed(1):"0.0"}%`,trend:_>me.returnOnEquity?"up":"down",description:"Shareholder value generation",icon:O,benchmark:me.returnOnEquity,performance:xe.returnOnEquity},{title:"Current Ratio",value:`${isFinite(K)?K.toFixed(1):"0.0"}x`,trend:K>2?"up":K>1.5?"neutral":"down",description:"Short-term liquidity strength",icon:T,benchmark:me.currentRatio,performance:xe.currentRatio},{title:"Asset Turnover",value:`${isFinite(Y)?Y.toFixed(1):"0.0"}x`,trend:Y>me.assetTurnover?"up":"down",description:"Revenue per dollar of assets",icon:A,benchmark:me.assetTurnover,performance:xe.assetTurnover},{title:"Debt-to-Equity",value:`${isFinite(U)?U.toFixed(1):"0.0"}x`,trend:U<me.debtToEquity?"up":"down",description:"Financial leverage position",icon:q,benchmark:me.debtToEquity,performance:xe.debtToEquity}],he=[{name:"Current Ratio",value:K,formatted:`${K.toFixed(2)}x`,benchmark:2.5,status:K>=2.5?"excellent":K>=2?"good":K>=1.5?"fair":"poor"},{name:"Quick Ratio",value:H,formatted:`${H.toFixed(2)}x`,benchmark:1.5,status:H>=1.5?"excellent":H>=1?"good":H>=.8?"fair":"poor"},{name:"Cash Ratio",value:X,formatted:`${X.toFixed(2)}x`,benchmark:.5,status:X>=.5?"excellent":X>=.3?"good":X>=.2?"fair":"poor"},{name:"Working Capital",value:Z,formatted:n(Z),benchmark:.15*m,status:Z>=.15*m?"excellent":Z>=0?"good":"poor"}],pe=[{name:"Asset Turnover",value:Y,formatted:`${Y.toFixed(2)}x`,description:"Revenue generation per asset dollar"},{name:"Inventory Turnover",value:Q,formatted:`${Q.toFixed(1)}x`,description:"Inventory management efficiency"},{name:"Receivables Turnover",value:J,formatted:`${J.toFixed(1)}x`,description:"Collection efficiency"},{name:"Operating Cycle",value:se,formatted:`${se.toFixed(0)} days`,description:"Cash-to-cash cycle duration"}],ge=[{name:"Financial Leverage",value:ie,formatted:`${ie.toFixed(1)}x`,level:ie<2?"low":ie<3?"moderate":"high"},{name:"Debt-to-Equity",value:U,formatted:`${U.toFixed(2)}x`,level:U<.3?"low":U<.6?"moderate":"high"},{name:"Interest Coverage",value:le,formatted:`${le.toFixed(1)}x`,level:le>10?"low":le>5?"moderate":"high"}];return{periods:r,latest:o,previous:c,revenue:{latest:m,previous:u,growth:j,cagr:v},profitability:{grossMargin:w,grossMarginChange:S,operatingMargin:k,operatingMarginChange:F,operatingLeverage:ae,profitabilityTrend:re},financial:{returnOnAssets:W,returnOnEquity:_,assetTurnover:Y,totalAssets:V,totalEquity:E,totalDebt:D,workingCapital:Z,workingCapitalRatio:ee},liquidity:{currentRatio:K,quickRatio:H,cashRatio:X,cashAndEquivalents:$,currentAssets:B,currentLiabilities:z},efficiency:{inventoryTurnover:Q,receivablesTurnover:J,operatingCycle:se,cashConversionCycle:te},risk:{debtToEquity:U,financialLeverage:ie,interestCoverage:le,debtServiceCoverage:ne},market:{revenuePerEmployee:oe,revenuePerShare:ce,bookValuePerShare:de},benchmarks:{industry:me,comparison:xe},dcf:I,revenueBreakdown:P,kpis:ue,liquidityMetrics:he,efficiencyMetrics:pe,riskMetrics:ge}}catch(e){return null}},[t,l]);if(!c)return e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(D,{className:"mx-auto h-12 w-12 text-yellow-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Insufficient Data"}),e.jsx("p",{className:"text-gray-500",children:"Please ensure financial data is loaded to generate analysis results."})]})});const d=({title:s,value:t,trend:a,description:r,icon:l,benchmark:n,performance:o})=>e.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-gray-600 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-lg "+("up"===a?"bg-green-900/30 text-green-400":"down"===a?"bg-red-900/30 text-red-400":"bg-gray-700 text-gray-400"),children:e.jsx(l,{className:"h-5 w-5"})}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-300",children:s}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:r})]})]}),"up"===a&&e.jsx(i,{className:"h-5 w-5 text-green-400 flex-shrink-0"}),"down"===a&&e.jsx(h,{className:"h-5 w-5 text-red-400 flex-shrink-0"})]}),e.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:t}),n&&e.jsxs("div",{className:"border-t border-gray-700 pt-3 mt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs",children:[e.jsx("span",{className:"text-gray-400",children:"Industry Avg:"}),e.jsx("span",{className:"text-gray-300",children:"number"==typeof n?n.toFixed(1)+(s.includes("%")?"%":s.includes("x")?"x":""):n})]}),e.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[e.jsx("span",{className:"text-gray-400",children:"vs Industry:"}),e.jsxs("span",{className:"font-medium "+(o>0?"text-green-400":o<0?"text-red-400":"text-gray-300"),children:[o>0?"+":"",o?.toFixed(1)||"0.0"]})]})]})]});return e.jsxs("div",{className:"space-y-6 p-6 bg-gray-900 text-white h-full",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center",children:[e.jsx(x,{className:"h-6 w-6 text-blue-400 mr-3"}),"Financial Analysis Results"]}),e.jsx("p",{className:"text-gray-400",children:"Comprehensive analysis of your company's financial performance and valuation"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.kpis.map((s,t)=>e.jsx(d,{...s},t))}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[e.jsxs("div",{className:"flex border-b border-gray-700",children:[e.jsx("button",{className:"px-6 py-3 text-sm font-medium text-white bg-blue-600 border-r border-gray-700",children:"Liquidity Analysis"}),e.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Efficiency Metrics"}),e.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Risk Assessment"}),e.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white",children:"Benchmarking"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(T,{className:"h-5 w-5 text-blue-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Liquidity Position Analysis"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.liquidityMetrics.map((s,t)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:s.name}),e.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("excellent"===s.status?"bg-green-900/30 text-green-400":"good"===s.status?"bg-blue-900/30 text-blue-400":"fair"===s.status?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:s.status})]}),e.jsx("div",{className:"text-xl font-bold text-white mb-1",children:s.formatted}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Benchmark: ","number"==typeof s.benchmark?s.benchmark.toFixed(1)+"x":n(s.benchmark)]})]},t))}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[e.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[e.jsx(v,{className:"h-4 w-4 text-blue-400 mr-2"}),"Liquidity Analysis Summary"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Working Capital:"}),e.jsx("span",{className:"text-white ml-2 font-medium",children:n(c.financial.workingCapital)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Cash Position:"}),e.jsx("span",{className:"text-white ml-2 font-medium",children:n(c.liquidity.cashAndEquivalents)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Current Assets:"}),e.jsx("span",{className:"text-white ml-2 font-medium",children:n(c.liquidity.currentAssets)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Current Liabilities:"}),e.jsx("span",{className:"text-white ml-2 font-medium",children:n(c.liquidity.currentLiabilities)})]})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(A,{className:"h-5 w-5 text-orange-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Operational Efficiency Metrics"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.efficiencyMetrics.map((s,t)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[e.jsx("div",{className:"text-sm font-medium text-gray-200 mb-2",children:s.name}),e.jsx("div",{className:"text-xl font-bold text-white mb-1",children:s.formatted}),e.jsx("div",{className:"text-xs text-gray-400",children:s.description})]},t))}),e.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(B,{className:"h-4 w-4 text-orange-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Cash Conversion"})]}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[c.efficiency.cashConversionCycle.toFixed(0)," days"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Time to convert inventory to cash"})]}),e.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(z,{className:"h-4 w-4 text-orange-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Asset Productivity"})]}),e.jsxs("div",{className:"text-lg font-bold text-white",children:[c.financial.assetTurnover.toFixed(2),"x"]}),e.jsx("div",{className:"text-xs text-gray-400",children:"Revenue per dollar of assets"})]}),e.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex items-center mb-2",children:[e.jsx(R,{className:"h-4 w-4 text-orange-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Revenue/Employee"})]}),e.jsx("div",{className:"text-lg font-bold text-white",children:c.market.revenuePerEmployee>0?n(c.market.revenuePerEmployee):"N/A"}),e.jsx("div",{className:"text-xs text-gray-400",children:"Productivity per employee"})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("div",{className:"flex items-center mb-6",children:[e.jsx(D,{className:"h-5 w-5 text-red-400 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-white",children:"Financial Risk Assessment"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:c.riskMetrics.map((s,t)=>e.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-200",children:s.name}),e.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium "+("low"===s.level?"bg-green-900/30 text-green-400":"moderate"===s.level?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:[s.level," risk"]})]}),e.jsx("div",{className:"text-xl font-bold text-white",children:s.formatted})]},t))}),e.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[e.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[e.jsx(T,{className:"h-4 w-4 text-red-400 mr-2"}),"Risk Analysis Summary"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Financial Leverage:"}),e.jsxs("span",{className:"ml-2 font-medium "+(c.risk.financialLeverage<2?"text-green-400":c.risk.financialLeverage<3?"text-yellow-400":"text-red-400"),children:[c.risk.financialLeverage.toFixed(1),"x"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-400",children:"Interest Coverage:"}),e.jsxs("span",{className:"ml-2 font-medium "+(c.risk.interestCoverage>10?"text-green-400":c.risk.interestCoverage>5?"text-yellow-400":"text-red-400"),children:[c.risk.interestCoverage.toFixed(1),"x"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(b,{className:"h-5 w-5 text-purple-400 mr-2"}),"Performance Trends"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Revenue Analysis"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Latest Period:"}),e.jsx("span",{className:"font-semibold text-white",children:n(c.revenue.latest)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"YoY Growth:"}),e.jsxs("span",{className:"font-semibold "+(c.revenue.growth>0?"text-green-400":"text-red-400"),children:[c.revenue.growth>0?"+":"",c.revenue.growth.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"CAGR:"}),e.jsxs("span",{className:"font-semibold text-gray-200",children:[c.revenue.cagr.toFixed(1),"%"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Profitability Margins"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Gross Margin:"}),e.jsxs("span",{className:"font-semibold text-white",children:[c.profitability.grossMargin.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Operating Margin:"}),e.jsxs("span",{className:"font-semibold text-white",children:[c.profitability.operatingMargin.toFixed(1),"%"]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-400",children:"Margin Change:"}),e.jsxs("span",{className:"font-semibold "+(c.profitability.grossMarginChange>0?"text-green-400":"text-red-400"),children:[c.profitability.grossMarginChange>0?"+":"",c.profitability.grossMarginChange.toFixed(1),"pp"]})]})]})]})]})]}),c.dcf&&e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(w,{className:"h-5 w-5 text-green-400 mr-2"}),"DCF Valuation Summary"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center p-4 bg-green-900/30 border border-green-700 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-400",children:n(c.dcf.enterpriseValue)}),e.jsx("div",{className:"text-sm text-green-300",children:"Enterprise Value"})]}),e.jsxs("div",{className:"text-center p-4 bg-blue-900/30 border border-blue-700 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-400",children:n(c.dcf.sharePrice)}),e.jsx("div",{className:"text-sm text-blue-300",children:"Price per Share"})]}),e.jsxs("div",{className:"text-center p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-300",children:n(c.dcf.terminalValue)}),e.jsx("div",{className:"text-sm text-gray-400",children:"Terminal Value"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(y,{className:"h-5 w-5 text-orange-400 mr-2"}),"Business Unit Performance"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:c.revenueBreakdown.map((s,t)=>{const a=c.revenue.latest?s.value/c.revenue.latest*100:0;return e.jsxs("div",{className:"p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium text-gray-200",children:s.name}),e.jsxs("span",{className:"text-sm text-gray-400",children:[a.toFixed(1),"%"]})]}),e.jsx("div",{className:"text-lg font-semibold text-white mb-1",children:n(s.value)}),e.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min(a,100)}%`}})})]},t)})})]}),e.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[e.jsx(G,{className:"h-5 w-5 text-green-400 mr-2"}),"Key Financial Insights"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Strengths"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[c.revenue.growth>0&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 text-green-500 mr-2"}),"Positive revenue growth trajectory"]}),c.profitability.grossMargin>60&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 text-green-500 mr-2"}),"Strong gross margin above 60%"]}),c.profitability.grossMarginChange>0&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 text-green-500 mr-2"}),"Improving profitability margins"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(G,{className:"h-4 w-4 text-green-500 mr-2"}),"Diversified healthcare revenue streams"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Areas for Focus"}),e.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[c.revenue.growth<5&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Revenue growth below industry benchmarks"]}),c.profitability.operatingMargin<20&&e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Operating margin optimization opportunities"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Monitor competitive positioning in key segments"]}),e.jsxs("li",{className:"flex items-center",children:[e.jsx(D,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Consider strategic initiatives for growth acceleration"]})]})]})]})]})]})},Me=({activeStep:t,onStepChange:a,dataCompleteness:r,modelingProgress:l,analysisProgress:n,validationErrors:c={}})=>{const[m,h]=s.useState(null),p=e=>{switch(e){case"data":return r>=80?"completed":r>0?"in-progress":"pending";case"modeling":return r<50?"disabled":l>=80?"completed":l>0?"in-progress":"available";case"analysis":return r<80||l<50?"disabled":n>=80?"completed":n>0?"in-progress":"available";default:return"pending"}},g=[{id:"data",title:"Data Entry",subtitle:"Financial statements & inputs",icon:L,progress:r,description:"Import or manually input your company's financial statements including income statement, balance sheet, and cash flow data.",validationFields:["revenue","expenses","assets"],helpContent:{title:"Data Entry Guidelines",items:["Ensure all financial figures are in the same currency","Use consistent time periods across all statements","Review data for obvious errors or inconsistencies","Include at least 3 years of historical data for better analysis"]}},{id:"modeling",title:"Financial Modeling",subtitle:"DCF, LBO & scenario analysis",icon:o,progress:l,description:"Configure valuation parameters, build financial models, and run scenario analyses to understand value drivers.",validationFields:["discountRate","growthAssumptions","margins"],helpContent:{title:"Modeling Best Practices",items:["Set realistic discount rates based on industry benchmarks","Use conservative growth assumptions for terminal value","Consider multiple scenarios (base, bull, bear cases)","Validate model outputs against comparable companies"]}},{id:"analysis",title:"Analysis & Results",subtitle:"Insights, reports & recommendations",icon:x,progress:n,description:"Review valuation results, sensitivity analysis, and generate comprehensive reports with actionable insights.",validationFields:["valuation","sensitivity","recommendations"],helpContent:{title:"Analysis Interpretation",items:["Compare results across different valuation methods","Pay attention to key value drivers in sensitivity analysis","Consider qualitative factors not captured in models","Document assumptions and limitations in your analysis"]}}],b=e=>{switch(e){case"completed":return"text-emerald-400";case"in-progress":return"text-blue-400";case"available":return"text-slate-300";case"disabled":return"text-slate-500";default:return"text-slate-400"}},f=(e,s)=>{switch(e){case"completed":return"bg-emerald-500/10 border-emerald-400/20";case"in-progress":return"bg-blue-500/10 border-blue-400/20";case"available":return"bg-slate-700/30 border-slate-600/20";case"disabled":return"bg-slate-800/30 border-slate-700/10";default:return"bg-slate-700/20 border-slate-600/10"}},j=(s,t,a)=>{const r=s.icon;return"completed"===t?e.jsx(G,{size:20,className:"text-emerald-400"}):"disabled"===t?e.jsx(r,{size:20,className:"text-slate-500"}):c[s.id]?.length>0?e.jsx(D,{size:20,className:"text-amber-400"}):"in-progress"===t?e.jsx(_,{size:20,className:"text-blue-400"}):e.jsx(r,{size:20,className:a?"text-white":b(t)})},v=(s,t)=>{const a=2*Math.PI*18,r=a,i=a-s/100*a;return e.jsxs("div",{className:"relative",children:[e.jsxs("svg",{className:"w-10 h-10 transform -rotate-90",viewBox:"0 0 40 40",children:[e.jsx("circle",{cx:"20",cy:"20",r:18,stroke:"currentColor",strokeWidth:"2",fill:"none",className:"text-slate-700"}),e.jsx("circle",{cx:"20",cy:"20",r:18,stroke:s>=80?"#10b981":s>=50?"#3b82f6":s>0?"#f59e0b":"#64748b",strokeWidth:"2",fill:"none",strokeDasharray:r,strokeDashoffset:i,className:"transition-all duration-500 ease-in-out",strokeLinecap:"round"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-xs font-medium text-slate-300",children:[Math.round(s),"%"]})})]})},y=({step:s,isVisible:t,onClose:a})=>t?e.jsxs(u.div,{initial:{opacity:0,y:10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:10,scale:.95},className:"absolute top-full left-0 mt-2 w-80 bg-slate-800 border border-slate-600 rounded-lg p-4 shadow-xl z-50",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx($,{size:16,className:"text-blue-400"}),e.jsx("h4",{className:"font-medium text-white",children:s.helpContent.title})]}),e.jsx("p",{className:"text-sm text-slate-300 mb-3",children:s.description}),e.jsx("ul",{className:"space-y-2",children:s.helpContent.items.map((s,t)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-slate-400",children:[e.jsx(d,{size:14,className:"text-blue-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t))}),e.jsx("button",{onClick:a,className:"absolute top-2 right-2 text-slate-400 hover:text-white transition-colors",children:"×"})]}):null;return e.jsxs("div",{className:"relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(i,{size:20,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-white",children:"Analysis Workflow"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Follow these steps to complete your analysis"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm font-medium text-slate-300",children:"Overall Progress"}),e.jsxs("div",{className:"text-xs text-slate-400",children:[Math.round((r+l+n)/3),"% Complete"]})]}),e.jsx("div",{className:"w-16 h-2 bg-slate-700 rounded-full overflow-hidden",children:e.jsx(u.div,{className:"h-full bg-gradient-to-r from-blue-500 to-emerald-500",initial:{width:0},animate:{width:(r+l+n)/3+"%"},transition:{duration:.8,ease:"easeOut"}})})]})]}),e.jsx("div",{className:"grid grid-cols-3 gap-4",children:g.map((s,r)=>{const i=p(s.id),l=t===s.id,n="disabled"===i,o=c[s.id]?.length>0;return e.jsxs("div",{className:"relative",children:[e.jsxs(u.button,{onClick:()=>!n&&a(s.id),disabled:n,className:`\n                  w-full p-4 rounded-xl border transition-all duration-200 text-left relative overflow-hidden\n                  ${l?"bg-blue-600 border-blue-500 shadow-lg shadow-blue-600/20":f(i)}\n                  ${n||l?"":"hover:border-slate-500 hover:bg-slate-700/40"}\n                  ${n?"cursor-not-allowed opacity-60":"cursor-pointer"}\n                  ${o?"border-amber-400/40":"border-slate-600/30"}\n                `,whileHover:n||l?{}:{scale:1.02},whileTap:n?{}:{scale:.98},children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`\n                      flex items-center justify-center w-10 h-10 rounded-lg transition-all\n                      ${l?"bg-white/20":"completed"===i?"bg-emerald-500/20":"bg-slate-600/30"}\n                    `,children:j(s,i,l)}),e.jsxs("div",{className:"text-xs font-medium text-slate-400",children:["Step ",r+1]})]}),s.progress>0&&e.jsx("div",{className:"flex-shrink-0",children:v(s.progress)})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:`font-semibold ${l?"text-white":b(i)}`,children:s.title}),e.jsx("p",{className:"text-sm "+(l?"text-blue-100":"text-slate-400"),children:s.subtitle})]}),o&&e.jsxs("div",{className:"mt-2 text-xs text-amber-400",children:[c[s.id].length," validation issue(s)"]}),l&&e.jsx(u.div,{className:"absolute bottom-0 left-0 right-0 h-1 bg-white/30",layoutId:"activeIndicator"})]}),e.jsx("button",{onClick:e=>{e.stopPropagation(),h(m===s.id?null:s.id)},className:"absolute top-2 right-2 p-1.5 text-slate-400 hover:text-white transition-colors opacity-0 group-hover:opacity-100",children:e.jsx($,{size:14})}),e.jsx(y,{step:s,isVisible:m===s.id,onClose:()=>h(null)}),r<g.length-1&&e.jsx("div",{className:"absolute top-1/2 -right-2 transform -translate-y-1/2 z-10",children:e.jsx(d,{size:16,className:`\n                      ${"disabled"!==p(g[r+1].id)?"text-slate-400":"text-slate-600"}\n                    `})})]},s.id)})}),e.jsxs("div",{className:"mt-6 grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(W,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Data Quality"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[r,"%"]})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(o,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Models Built"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[Math.round(l),"%"]})]}),e.jsxs("div",{className:"bg-slate-800/30 border border-slate-700/50 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(x,{size:14,className:"text-slate-400"}),e.jsx("span",{className:"text-xs font-medium text-slate-400",children:"Analysis Done"})]}),e.jsxs("div",{className:"text-lg font-semibold text-white",children:[Math.round(n),"%"]})]})]})]})},Se=()=>{const[t,i]=s.useState("data"),[l,o]=s.useState(ue),[c,d]=s.useState({}),[m,x]=s.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,taxRate:25},scenario:{scenarios:[]}}),[h,p]=s.useState(()=>{const e=localStorage.getItem("privateAnalyses");return e?JSON.parse(e):[]}),[g,f]=s.useState(!1),[j,v]=s.useState("ready"),[,y]=s.useState(null),[N,w]=s.useState(0),[C,k]=s.useState(0),[R,M]=s.useState({}),S=()=>{if(!l.statements)return 0;let e=0,s=0;["totalRevenue","totalCostOfGoodsSold","operatingIncome","netIncome"].forEach(t=>{s+=3,void 0!==l.statements.incomeStatement?.[t]?.[2]&&(e+=3)});let t=0;["energyDevices","injectables","wellness","weightloss","retailSales","surgery"].forEach(e=>{void 0!==l.statements.incomeStatement?.[e]?.[2]&&t++}),t>=3&&(e+=2,s+=2),["totalAssets","totalLiabilities","totalEquity"].forEach(t=>{s+=1,void 0!==l.statements.balanceSheet?.[t]?.[2]&&(e+=1)}),["operatingCashFlow","investingCashFlow","financingCashFlow"].forEach(t=>{s+=1,void 0!==l.statements.cashFlowStatement?.[t]?.[2]&&(e+=1)});const a=Math.round(e/s*100);return void 0!==l.statements.incomeStatement?.totalRevenue?.[2]&&void 0!==l.statements.incomeStatement?.operatingIncome?.[2]?Math.max(a,80):a},F=()=>{let e=0;m.dcf.discountRate&&m.dcf.terminalGrowthRate&&(e+=40);return S()>=80&&(e+=20),m.scenario.scenarios&&m.scenario.scenarios.length>0&&(e+=20),c&&Object.keys(c).length>0&&(e+=20),Math.min(e,100)};s.useEffect(()=>{v("modified"),w(F()),k((()=>{let e=0;const s=S(),t=F();return s>50&&t>30&&(e=60),s>80&&t>60&&(e=100),e})()),M((()=>{const e={},s=[];l.statements?(l.statements.incomeStatement?.totalRevenue||s.push("Missing revenue data"),l.statements.balanceSheet?.totalAssets||s.push("Missing balance sheet data"),l.statements.cashFlowStatement?.operatingCashFlow||s.push("Missing cash flow data")):s.push("No financial statements found"),s.length>0&&(e.data=s);const t=[];(!m.dcf.discountRate||m.dcf.discountRate<=0)&&t.push("Invalid discount rate"),(!m.dcf.terminalGrowthRate||m.dcf.terminalGrowthRate<0)&&t.push("Invalid terminal growth rate"),t.length>0&&(e.modeling=t);const a=[],r=S(),i=F();return r<50&&a.push("Insufficient data for analysis"),i<30&&a.push("Models not configured"),a.length>0&&(e.analysis=a),e})())},[l,c,m]);const A=({status:s,label:t})=>{const a={ready:{color:"text-green-400",bg:"bg-green-400/10",icon:G},modified:{color:"text-yellow-400",bg:"bg-yellow-400/10",icon:_},saving:{color:"text-blue-400",bg:"bg-blue-400/10",icon:b},error:{color:"text-red-400",bg:"bg-red-400/10",icon:H}},r=a[s]||a.ready,i=r.icon;return e.jsxs("div",{className:`flex items-center gap-2 px-3 py-1.5 rounded-full ${r.bg}`,children:[e.jsx(i,{size:14,className:r.color}),e.jsx("span",{className:`text-sm ${r.color}`,children:t})]})};return e.jsxs("div",{className:"min-h-screen bg-slate-900 text-white",children:[e.jsx(a,{}),e.jsxs("div",{className:"flex flex-col min-h-screen pt-16",children:[e.jsx("div",{className:"bg-slate-800/80 backdrop-blur-sm border-b border-slate-700/50",children:e.jsxs("div",{className:"px-8 py-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-2 bg-blue-500/10 rounded-lg",children:e.jsx(n,{size:24,className:"text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold text-white",children:"Private Analysis"}),e.jsx("p",{className:"text-sm text-slate-400 mt-1",children:"Professional financial modeling and valuation"})]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(A,{status:j,label:"ready"===j?"Data Ready":"modified"===j?"Unsaved Changes":"saving"===j?"Saving...":"Error"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>{const e=prompt("Enter analysis name:");e&&(async e=>{if(e){f(!0),v("saving");try{const s={id:Date.now(),name:e,data:l,adjustedValues:c,modelInputs:m,completeness:S(),createdAt:(new Date).toISOString(),lastModified:(new Date).toISOString()},t=[...h,s];p(t),localStorage.setItem("privateAnalyses",JSON.stringify(t)),v("ready"),y(new Date)}catch(s){v("error")}finally{f(!1)}}})(e)},disabled:g,className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(U,{size:16}),"Save"]}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>{},className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(K,{size:16}),"Import"]}),e.jsxs(r,{variant:"ghost",size:"sm",onClick:()=>{},className:"text-slate-300 hover:text-white border border-slate-600 hover:border-slate-500",children:[e.jsx(E,{size:16}),"Export"]})]})]})]}),e.jsx(Me,{activeStep:(e=>{switch(e){case"data":case"spreadsheet":default:return"data";case"modeling":return"modeling";case"analysis":return"analysis"}})(t),onStepChange:e=>{switch(e){case"data":default:i("spreadsheet");break;case"modeling":i("modeling");break;case"analysis":i("analysis")}},dataCompleteness:S(),modelingProgress:N,analysisProgress:C,validationErrors:R})]})}),e.jsx(P,{children:h.length>0&&e.jsxs(u.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"bg-slate-800/50 border-b border-slate-700/50 px-8 py-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsx(L,{size:16,className:"text-slate-400"}),e.jsx("h3",{className:"text-sm font-medium text-slate-300",children:"Recent Analyses"})]}),e.jsx("div",{className:"flex gap-3 flex-wrap",children:h.slice(-5).map(s=>e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-slate-700/50 rounded-lg border border-slate-600/50",children:[e.jsx("button",{onClick:()=>(e=>{const s=h.find(s=>s.id===e);s&&(o(s.data),d(s.adjustedValues||{}),x(s.modelInputs||m),v("ready"))})(s.id),className:"text-slate-200 hover:text-white font-medium text-sm",children:s.name}),e.jsx("div",{className:"w-px h-4 bg-slate-600"}),e.jsx("button",{onClick:()=>(e=>{const s=h.filter(s=>s.id!==e);p(s),localStorage.setItem("privateAnalyses",JSON.stringify(s))})(s.id),className:"text-slate-400 hover:text-red-400 transition-colors",children:"×"})]},s.id))})]})}),e.jsx("div",{className:"flex-1 bg-slate-900 overflow-auto",children:e.jsxs(u.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{duration:.2,ease:"easeOut"},className:"min-h-full",children:["spreadsheet"===t&&e.jsx(be,{data:l,onDataChange:o,onAdjustedValuesChange:d}),"modeling"===t&&e.jsx(ke,{data:l,adjustedValues:c,onDataChange:o}),"analysis"===t&&e.jsx(Re,{data:l,adjustedValues:c,modelInputs:m,calculateDCF:e=>((e,s=null)=>{if(!e?.statements?.incomeStatement)return null;const t=s?.dcf||{discountRate:12,terminalGrowthRate:2.5,projectionYears:5,taxRate:25,sharesOutstanding:1e3},a=e.statements.incomeStatement,r=Object.keys(a.totalRevenue||{}).sort((e,s)=>parseInt(e)-parseInt(s));if(0===r.length)return null;const i=r[r.length-1],l=a.totalRevenue?.[i]||0,n=a.operatingIncome?.[i]||0;let o=5;if(r.length>=2){const e=r[r.length-2],s=a.totalRevenue?.[i]||0,t=a.totalRevenue?.[e]||0;t>0&&(o=(s-t)/t*100,o=Math.max(-10,Math.min(25,o)))}const c=l>0?n/l*100:0,d={years:[],freeCashFlows:[],presentValues:[],cumulativePV:0,terminalValue:0,presentValueTerminal:0,enterpriseValue:0,equityValue:0,impliedSharePrice:0,impliedValuation:0,assumptions:{discountRate:t.discountRate,terminalGrowthRate:t.terminalGrowthRate,revenueGrowthRate:o,operatingMargin:c,taxRate:t.taxRate}};for(let u=1;u<=t.projectionYears;u++){const e=o*(1-.1*(u-1)),s=l*Math.pow(1+e/100,u)*(c/100)*(1-t.taxRate/100),a=s/Math.pow(1+t.discountRate/100,u);d.years.push(u),d.freeCashFlows.push(s),d.presentValues.push(a),d.cumulativePV+=a}const m=t.projectionYears,x=d.freeCashFlows[m-1]*(1+t.terminalGrowthRate/100);return d.terminalValue=x/((t.discountRate-t.terminalGrowthRate)/100),d.presentValueTerminal=d.terminalValue/Math.pow(1+t.discountRate/100,m),d.enterpriseValue=d.cumulativePV+d.presentValueTerminal,d.equityValue=d.enterpriseValue,d.impliedSharePrice=d.equityValue/t.sharesOutstanding,d.impliedValuation=d.equityValue,d})(e,m),formatCurrency:pe,formatPercentage:he})]},t)})]})]})};export{Se as default};
//# sourceMappingURL=PrivateAnalysis-uXPhU6oD.js.map
