import{r as e,R as s,j as t,T as a,P as i,F as l,C as r,b as n,c,d as o,e as d,f as m,M as x,g as u,h,S as g,E as p,i as b,k as f,l as y,D as v,I as j,B as N,U as w,m as C,n as k,o as S,Z as F,p as R,q as M,s as A,t as I,u as E,G as P,v as D,w as T,x as V,y as O,z as q,H as B,J as L,K as z,X as G,L as $}from"./react-core-LZql00V9.js";import{G as W}from"./vendor-BUoS_Aj_.js";import{m as _,A as U}from"./animations-PwArlWzR.js";import{ResponsiveContainer as K,BarChart as H,CartesianGrid as Y,XAxis as Q,YAxis as X,Tooltip as J,Bar as Z,PieChart as ee,Pie as se,Cell as te,LineChart as ae,Legend as ie,Line as le}from"./charts-vendor-EG81evMP.js";import{A as re,M as ne}from"./private-analysis-heavy-DbRFEumZ.js";import{m as ce}from"./financial-engines-B7TnAHCU.js";let oe={CLS:null,FID:null,FCP:null,LCP:null,TTFB:null,INP:null};function de(){!function(){let e=0,s=[];new PerformanceObserver(t=>{for(const a of t.getEntries())a.hadRecentInput||(e+=a.value,s.push(a));oe.CLS=e,me("CLS",e,s)}).observe({type:"layout-shift",buffered:!0}),new PerformanceObserver(e=>{for(const s of e.getEntries())if("first-input-delay"===s.name&&(oe.FID=s.processingStart-s.startTime,me("FID",oe.FID,[s])),s.interactionId){const e=s.processingEnd-s.startTime;(!oe.INP||e>oe.INP)&&(oe.INP=e,me("INP",e,[s]))}}).observe({type:"event",buffered:!0}),new PerformanceObserver(e=>{for(const s of e.getEntries())"first-contentful-paint"===s.name&&(oe.FCP=s.startTime,me("FCP",s.startTime,[s]))}).observe({type:"paint",buffered:!0}),new PerformanceObserver(e=>{const s=e.getEntries(),t=s[s.length-1];oe.LCP=t.startTime,me("LCP",t.startTime,[t])}).observe({type:"largest-contentful-paint",buffered:!0});const t=performance.getEntriesByType("navigation")[0];t&&(oe.TTFB=t.responseStart-t.requestStart,me("TTFB",oe.TTFB,[t]))}(),["financial-spreadsheet","dcf-calculator","chart-rendering","market-data-fetch"].forEach(e=>{performance.mark(`${e}-start`)}),window.trackComponentRender=(e,s)=>{performance.mark(`${e}-end`),performance.measure(`${e}-render`,`${e}-start`,`${e}-end`),xe("component-render",{component:e,renderTime:s,timestamp:Date.now()})},window.trackCalculationPerformance=(e,s,t)=>{xe("financial-calculation",{type:e,duration:s,complexity:t,timestamp:Date.now()})},window.addEventListener("load",()=>{setTimeout(()=>{const e=performance.getEntriesByType("navigation")[0];var s;e&&(s={dns:e.domainLookupEnd-e.domainLookupStart,tcp:e.connectEnd-e.connectStart,ssl:e.secureConnectionStart>0?e.connectEnd-e.secureConnectionStart:0,ttfb:e.responseStart-e.requestStart,download:e.responseEnd-e.responseStart,domProcessing:e.domComplete-e.domLoading,totalLoadTime:e.loadEventEnd-e.fetchStart},pe("navigation-timing",{...s,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:ge()}))},0)}),new PerformanceObserver(e=>{for(const s of e.getEntries())if("script"===s.initiatorType||"css"===s.initiatorType||"img"===s.initiatorType||"fetch"===s.initiatorType){const e={name:s.name,type:s.initiatorType,size:s.transferSize||s.encodedBodySize,duration:s.duration,cached:0===s.transferSize&&s.encodedBodySize>0,timestamp:Date.now()};(e.size>5e4||e.duration>1e3)&&ue(e)}}).observe({entryTypes:["resource"]}),function(){let e=0,s=0;["click","keydown","touchstart"].forEach(t=>{document.addEventListener(t,a=>{const i=performance.now();requestAnimationFrame(()=>{const l=performance.now()-i;e++,s+=l,l>100&&pe("slow-interaction",{type:t,target:a.target.tagName,duration:l,timestamp:Date.now()})})},{passive:!0})}),setInterval(()=>{e>0&&(pe("interaction-summary",{count:e,averageTime:s/e,timestamp:Date.now()}),e=0,s=0)},3e4)}()}function me(e,s,t){pe("web-vital",{metric:e,value:Math.round(s),entries:t.map(e=>({startTime:e.startTime,duration:e.duration||0})),url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent,connection:ge()})}function xe(e,s){pe("custom-metric",{type:e,...s,url:window.location.href,userAgent:navigator.userAgent})}function ue(e){pe("resource-timing",e)}function he(){const e=[];return Object.entries({LCP:2500,FID:100,CLS:.1,FCP:1800,TTFB:800}).forEach(([s,t])=>{const a=oe[s];null!==a&&a>t&&e.push({metric:s,value:a,budget:t,overBy:a-t})}),e.length>0&&pe("budget-violations",{violations:e,timestamp:Date.now(),url:window.location.href}),e}function ge(){return"connection"in navigator?{effectiveType:navigator.connection.effectiveType,downlink:navigator.connection.downlink,rtt:navigator.connection.rtt}:null}function pe(e,s){try{const t={type:e,data:s,sessionId:fe(),userId:ye()},a=JSON.parse(localStorage.getItem("analytics-queue")||"[]");a.push(t),a.length>100&&a.splice(0,a.length-100),localStorage.setItem("analytics-queue",JSON.stringify(a)),a.length>=10&&be()}catch(t){}}function be(){try{const e=JSON.parse(localStorage.getItem("analytics-queue")||"[]");if(0===e.length)return;window.gtag&&e.forEach(e=>{window.gtag("event",e.type,{custom_parameter:JSON.stringify(e.data)})}),localStorage.removeItem("analytics-queue")}catch(e){}}function fe(){let e=sessionStorage.getItem("session-id");return e||(e=Date.now()+"-"+Math.random().toString(36).substr(2,9),sessionStorage.setItem("session-id",e)),e}function ye(){let e=localStorage.getItem("user-id");return e||(e="anonymous-"+Date.now()+"-"+Math.random().toString(36).substr(2,9),localStorage.setItem("user-id",e)),e}function ve(e,s){pe("performance-metric",{type:e,...s,url:window.location.href,userAgent:navigator.userAgent,timestamp:Date.now()})}function je(e,s){pe("financial-component-performance",{component:e,...s,url:window.location.href,timestamp:Date.now(),userAgent:navigator.userAgent})}function Ne(){const e=JSON.parse(localStorage.getItem("accessibility-history")||"[]"),s=JSON.parse(localStorage.getItem("analytics-queue")||"[]"),t=e.slice(-10),a=t.reduce((e,s)=>e+s.score,0)/t.length||0,i=t.reduce((e,s)=>e+s.violations,0)/t.length||0,l=s.filter(e=>"performance-metric"===e.type).slice(-20).map(e=>e.data),r=s.filter(e=>"web-vital"===e.type).slice(-10).map(e=>e.data);return{webVitals:oe,budgetViolations:he(),accessibility:{currentScore:t[t.length-1]?.score||0,averageScore:Math.round(a),averageViolations:Math.round(i),history:t,trends:{scoreImproving:t.length>=2&&t[t.length-1].score>t[t.length-2].score}},performance:{recentMetrics:l,webVitalHistory:r},timestamp:Date.now()}}setInterval(be,6e4),window.addEventListener("beforeunload",()=>{be()});const we=new class{constructor(e={}){this.options={rules:{"color-contrast":{enabled:!0},"keyboard-navigation":{enabled:!0},"focus-management":{enabled:!0},"aria-labels":{enabled:!0},"heading-order":{enabled:!0},"landmark-one-main":{enabled:!0},"skip-link":{enabled:!0},"nested-interactive":{enabled:!1},...e.rules},tags:["wcag2a","wcag2aa","wcag21aa","best-practice"],runOnly:e.runOnly||null,reporter:e.reporter||"v2",...e},this.violations=[],this.lastTestResults=null}async runTests(e=document,s={}){const t={...this.options,...s};try{const s=await W.run(e,t);return this.lastTestResults=s,this.violations=s.violations,this.logResults(s),this.storeResults(s),s}catch(a){throw a}}async testFinancialComponent(e,s="generic"){const t=document.querySelector(e);if(!t)throw new Error(`Element not found: ${e}`);const a={spreadsheet:{rules:{"table-header":{enabled:!0},"th-has-data-cells":{enabled:!0},"table-duplicate-name":{enabled:!0},"scope-attr-valid":{enabled:!0}},tags:["wcag2aa","section508"]},chart:{rules:{"image-alt":{enabled:!0},"svg-img-alt":{enabled:!0},"aria-hidden-focus":{enabled:!0}},tags:["wcag2aa"]},calculator:{rules:{label:{enabled:!0},"form-field-multiple-labels":{enabled:!0},"duplicate-id":{enabled:!0}},tags:["wcag2aa","section508"]},modal:{rules:{"focus-trap":{enabled:!0},"aria-dialog-name":{enabled:!0},"keyboard-navigation":{enabled:!0}},tags:["wcag2aa","best-practice"]}}[s]||{};return await this.runTests(t,a)}async testKeyboardNavigation(){const e=this.getFocusableElements(),s=[];let t=-1;e.forEach((e,a)=>{const i=e.tabIndex||0;i>0&&i<=t&&s.push({element:e.tagName,id:e.id,tabIndex:i,position:a,issue:"Tab order not sequential"}),t=i});const a=[];return e.forEach(e=>{const s=window.getComputedStyle(e,":focus"),t="none"!==s.outline&&"0px"!==s.outline,i="none"!==s.boxShadow,l="transparent"!==s.backgroundColor;t||i||l||a.push({element:e.tagName,id:e.id,className:e.className,issue:"No visible focus indicator"})}),{focusableElementsCount:e.length,tabOrderIssues:s,focusVisibilityIssues:a,passed:0===s.length&&0===a.length}}async testColorContrast(){const e=document.querySelectorAll("p, span, div, td, th, label, button, a, h1, h2, h3, h4, h5, h6"),s=[];return e.forEach(e=>{const t=window.getComputedStyle(e),a=t.color,i=t.backgroundColor;if("transparent"===i||"rgba(0, 0, 0, 0)"===i)return;const l=this.calculateContrastRatio(a,i),r=parseInt(t.fontSize),n=t.fontWeight,c=r>=18||r>=14&&("bold"===n||n>=700)?3:4.5;l<c&&s.push({element:e.tagName,id:e.id,className:e.className,textColor:a,backgroundColor:i,contrast:l.toFixed(2),required:c,fontSize:r,fontWeight:n,text:e.textContent?.substring(0,50)+"..."})}),{totalElements:e.length,contrastIssues:s,passed:0===s.length}}async testFormAccessibility(){const e=document.querySelectorAll("form"),s=[];return e.forEach((e,t)=>{e.querySelectorAll("input, select, textarea").forEach(e=>{const a=[];this.hasAssociatedLabel(e)||a.push("Missing label"),e.required&&!this.hasRequiredIndication(e)&&a.push("Required field not clearly indicated"),"true"!==e.getAttribute("aria-invalid")||this.hasErrorMessage(e)||a.push("Error state without error message"),this.isFinancialInput(e)&&!e.autocomplete&&a.push("Financial input missing autocomplete attribute"),a.length>0&&s.push({formIndex:t,inputType:e.type,inputId:e.id,inputName:e.name,issues:a})})}),{totalForms:e.length,formIssues:s,passed:0===s.length}}generateReport(){if(!this.lastTestResults)throw new Error("No test results available. Run tests first.");const{violations:e,passes:s,incomplete:t,inapplicable:a}=this.lastTestResults;return{summary:{timestamp:(new Date).toISOString(),totalChecks:e.length+s.length+t.length+a.length,violations:e.length,passes:s.length,incomplete:t.length,inapplicable:a.length,score:this.calculateAccessibilityScore()},violations:e.map(e=>({id:e.id,impact:e.impact,description:e.description,help:e.help,helpUrl:e.helpUrl,nodes:e.nodes.length,tags:e.tags})),recommendations:this.generateRecommendations(e),financialSpecific:this.getFinancialAccessibilityInsights()}}calculateAccessibilityScore(){if(!this.lastTestResults)return 0;const{violations:e,passes:s}=this.lastTestResults,t=e.length+s.length;if(0===t)return 100;const a={critical:4,serious:3,moderate:2,minor:1},i=e.reduce((e,s)=>e+(a[s.impact]||1),0),l=4*t;return Math.max(0,100-i/l*100)}generateRecommendations(e){const s=[];return e.forEach(e=>{switch(e.id){case"color-contrast":s.push({category:"Visual Design",priority:"High",issue:"Insufficient color contrast",solution:"Ensure text colors meet WCAG AA standards (4.5:1 for normal text, 3:1 for large text)",financialContext:"Critical for reading financial data and avoiding misinterpretation of numbers"});break;case"keyboard-navigation":s.push({category:"Keyboard Access",priority:"High",issue:"Keyboard navigation issues",solution:"Ensure all interactive elements are keyboard accessible with visible focus indicators",financialContext:"Essential for users who rely on keyboard navigation to access financial tools"});break;case"label":s.push({category:"Form Controls",priority:"High",issue:"Missing form labels",solution:"Add proper labels to all form controls, especially financial input fields",financialContext:"Critical for screen readers to understand financial input requirements"});break;case"aria-hidden-focus":s.push({category:"ARIA Usage",priority:"Medium",issue:"Focusable elements hidden from screen readers",solution:"Review aria-hidden usage on interactive elements",financialContext:"May hide important financial controls from assistive technology users"})}}),s}getFinancialAccessibilityInsights(){const e=[];return document.querySelectorAll("table").length>0&&e.push({component:"Data Tables",recommendation:"Ensure financial data tables have proper headers and scope attributes for screen reader navigation"}),document.querySelectorAll("[data-chart], .recharts-wrapper, canvas").length>0&&e.push({component:"Charts and Graphs",recommendation:"Provide alternative text descriptions and data tables for financial charts"}),document.querySelectorAll("[data-calculator], .calculator").length>0&&e.push({component:"Financial Calculators",recommendation:"Ensure calculator inputs have clear labels and results are announced to screen readers"}),e}getFocusableElements(){return Array.from(document.querySelectorAll(["a[href]","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",")))}hasAssociatedLabel(e){const s=e.id,t=e.getAttribute("aria-label"),a=e.getAttribute("aria-labelledby");return!(!t&&!a)||(!(!s||!document.querySelector(`label[for="${s}"]`))||!!e.closest("label"))}hasRequiredIndication(e){const s=e.getAttribute("aria-required"),t=e.hasAttribute("required"),a=this.hasRequiredTextIndicator(e);return"true"===s||t||a}hasRequiredTextIndicator(e){const s=this.getAssociatedLabel(e);if(!s)return!1;const t=s.textContent||"";return t.includes("*")||t.toLowerCase().includes("required")}hasErrorMessage(e){const s=e.getAttribute("aria-describedby");if(s){const e=document.getElementById(s);return e&&e.textContent}return!1}isFinancialInput(e){return["number","email","tel"].includes(e.type)||["amount","price","rate","percent","currency","value"].some(s=>e.name?.toLowerCase().includes(s))}getAssociatedLabel(e){const s=e.id;if(s){const e=document.querySelector(`label[for="${s}"]`);if(e)return e}return e.closest("label")}calculateContrastRatio(e,s){const t=this.parseColor(e),a=this.parseColor(s),i=this.getLuminance(t),l=this.getLuminance(a);return(Math.max(i,l)+.05)/(Math.min(i,l)+.05)}parseColor(e){const s=e.match(/rgb\((\d+),\s*(\d+),\s*(\d+)\)/);return s?[parseInt(s[1]),parseInt(s[2]),parseInt(s[3])]:[0,0,0]}getLuminance([e,s,t]){const[a,i,l]=[e,s,t].map(e=>(e/=255)<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4));return.2126*a+.7152*i+.0722*l}logResults(e){e.violations.length>0&&e.violations.forEach(e=>{})}reportViolations(e){e.forEach(e=>{e.nodes.forEach(e=>{})})}storeResults(e){try{const s={timestamp:Date.now(),url:window.location.href,violations:e.violations.length,passes:e.passes.length,score:this.calculateAccessibilityScore()},t=JSON.parse(localStorage.getItem("accessibility-reports")||"[]");t.push(s),t.length>10&&t.splice(0,t.length-10),localStorage.setItem("accessibility-reports",JSON.stringify(t))}catch(s){}}};function Ce(s){const t=function(s={}){const{enabled:t=!1,autoTest:a=!1,testInterval:i=null,componentType:l="generic",onViolations:r=null,onSuccess:n=null}=s,[c,o]=e.useState(null),[d,m]=e.useState(!1),[x,u]=e.useState([]),[h,g]=e.useState(null),[p,b]=e.useState(null),f=e.useRef(null),y=e.useRef(null),v=e.useCallback(async(e=null,s={})=>{if(!t)return null;const a=e||f.current||document;m(!0);try{const e=await we.runTests(a,s);return o(e),u(e.violations||[]),g(we.calculateAccessibilityScore()),b(Date.now()),ve("accessibility_test",{violations:e.violations?.length||0,score:we.calculateAccessibilityScore(),componentType:l,timestamp:Date.now()}),e.violations?.length>0?r?.(e.violations):n?.(e),e}catch(i){return null}finally{m(!1)}},[t,l,r,n]),j=e.useCallback(async(e,s=l)=>{if(!t)return null;m(!0);try{const t=await we.testFinancialComponent(e,s);return o(t),u(t.violations||[]),g(we.calculateAccessibilityScore()),b(Date.now()),ve("financial_component_accessibility",{componentType:s,violations:t.violations?.length||0,score:we.calculateAccessibilityScore(),timestamp:Date.now()}),t}catch(a){return null}finally{m(!1)}},[t,l]),N=e.useCallback(async()=>{if(!t)return null;try{const e=await we.testKeyboardNavigation();return ve("keyboard_navigation_test",{focusableElements:e.focusableElementsCount,tabOrderIssues:e.tabOrderIssues?.length||0,focusVisibilityIssues:e.focusVisibilityIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),w=e.useCallback(async()=>{if(!t)return null;try{const e=await we.testColorContrast();return ve("color_contrast_test",{totalElements:e.totalElements,contrastIssues:e.contrastIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),C=e.useCallback(async()=>{if(!t)return null;try{const e=await we.testFormAccessibility();return ve("form_accessibility_test",{totalForms:e.totalForms,formIssues:e.formIssues?.length||0,passed:e.passed,timestamp:Date.now()}),e}catch(e){return null}},[t]),k=e.useCallback(()=>{if(!c)return null;try{const e=we.generateReport();return ve("accessibility_report_generated",{score:e.summary.score,violations:e.summary.violations,totalChecks:e.summary.totalChecks,timestamp:Date.now()}),e}catch(e){return null}},[c]);return e.useEffect(()=>{if(!t||!a)return;const e=()=>{v()};return e(),i&&(y.current=setInterval(e,i)),()=>{y.current&&clearInterval(y.current)}},[t,a,i,v]),e.useEffect(()=>()=>{y.current&&clearInterval(y.current)},[]),{results:c,violations:x,score:h,isLoading:d,lastTestTime:p,runTests:v,testFinancialComponent:j,testKeyboardNavigation:N,testColorContrast:w,testFormAccessibility:C,generateReport:k,elementRef:f}}({componentType:s,autoTest:!0,testInterval:3e4,onViolations:e=>{}}),a=e.useCallback(async()=>{const e={};try{return e.keyboardNav=await t.testKeyboardNavigation(),e.colorContrast=await t.testColorContrast(),e.formAccessibility=await t.testFormAccessibility(),e.report=t.generateReport(),e}catch(s){return null}},[t,s]);return{...t,testFinancialFeatures:a}}function ke(s={}){const{threshold:t=80,alertOnViolations:a=!0,monitorInterval:i=6e4}=s,[l,r]=e.useState(!1),[n,c]=e.useState([]),o=e.useRef(null),d=e.useCallback(()=>{if(l)return;r(!0);const e=async()=>{try{const e=await we.runTests(document),s=we.calculateAccessibilityScore();if(s<t){const a={id:Date.now(),type:"low_score",message:`Accessibility score (${s}) is below threshold (${t})`,score:s,violations:e.violations?.length||0,timestamp:Date.now()};c(e=>[...e,a])}const i=e.violations?.filter(e=>"critical"===e.impact)||[];if(i.length>0&&a){const e={id:Date.now(),type:"critical_violations",message:`${i.length} critical accessibility violations found`,violations:i,timestamp:Date.now()};c(s=>[...s,e])}ve("accessibility_monitoring",{score:s,violations:e.violations?.length||0,criticalViolations:i.length,timestamp:Date.now()})}catch(e){}};e(),o.current=setInterval(e,i)},[l,t,a,i]),m=e.useCallback(()=>{r(!1),o.current&&(clearInterval(o.current),o.current=null)},[]),x=e.useCallback(()=>{c([])},[]);return e.useEffect(()=>()=>{o.current&&clearInterval(o.current)},[]),{isMonitoring:l,alerts:n,startMonitoring:d,stopMonitoring:m,clearAlerts:x}}const Se=({data:d,onDataChange:m,onAdjustedValuesChange:x})=>{const[u,h]=e.useState("incomeStatement"),[g,p]=e.useState({}),b=s.useMemo(()=>({periods:Array.isArray(d?.periods)?d.periods:[],statements:{incomeStatement:d?.statements?.incomeStatement||{},balanceSheet:d?.statements?.balanceSheet||{},cashFlow:d?.statements?.cashFlow||{}}}),[d]),{elementRef:f}=Ce("spreadsheet"),[y,v]=e.useState({revenue:!0,costOfGoodsSold:!0,operatingExpenses:!0,salariesBenefits:!0,grossProfit:!0,operatingIncome:!0,incomeBeforeTax:!0,otherIncomeExpense:!0,currentAssets:!0,nonCurrentAssets:!0,currentLiabilities:!0,nonCurrentLiabilities:!0,equity:!0,operatingActivities:!0,investingActivities:!0,financingActivities:!0}),[j,N]=e.useState(null),[w,C]=e.useState(""),k=e.useRef(null);e.useEffect(()=>{if(0===Object.keys(g).length){const e=b?.statements?.[u];if(e){const s={},t=Math.max(0,(b?.periods?.length||0)-1);Object.keys(e).forEach(a=>{const i=e[a]?.[t];void 0!==i&&(s[a]=i)}),p(s),x&&x(s)}}},[b,u,g,x]);const S={revenue:{title:"Revenue",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"energyDevices",label:"Energy Devices",level:1},{key:"injectables",label:"Injectables",level:1},{key:"wellness",label:"Wellness",level:1},{key:"weightloss",label:"Weightloss",level:1},{key:"retailSales",label:"Retail Sales",level:1},{key:"surgery",label:"Surgery",level:1},{key:"totalRevenue",label:"Total Revenue",level:0,bold:!0,formula:!0}]},costOfGoodsSold:{title:"Cost of Goods Sold",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"energyDeviceSupplies",label:"Energy Device Supplies",level:1},{key:"injectablesCogs",label:"Injectables",level:1},{key:"wellnessCogs",label:"Wellness",level:1},{key:"weightlossCogs",label:"Weightloss",level:1},{key:"retailProducts",label:"Retail Products",level:1},{key:"surgicalSupplies",label:"Surgical Supplies",level:1},{key:"totalCostOfGoodsSold",label:"Total Cost of Goods Sold",level:0,bold:!0,formula:!0}]},grossProfit:{title:"Gross Profit",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"grossProfit",label:"Gross Profit",level:0,bold:!0,formula:!0}]},salariesBenefits:{title:"Salaries & Benefits",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"employeeBenefits",label:"Employee Benefits",level:1},{key:"payroll",label:"Payroll",level:1},{key:"payrollTaxes",label:"Payroll Taxes",level:1},{key:"totalSalariesBenefits",label:"Total Salaries & Benefits",level:0,bold:!0,formula:!0}]},operatingExpenses:{title:"Operating Expenses",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"marketing",label:"Marketing",level:1},{key:"automobile",label:"Automobile",level:1},{key:"creditCardBankCharges",label:"Credit Card and Bank Charges",level:1},{key:"donations",label:"Donations",level:1},{key:"computerTelephoneUtilities",label:"Computer, Telephone, and Utilities",level:1},{key:"depreciation",label:"Depreciation",level:1},{key:"duesSubscriptions",label:"Dues & Subscriptions",level:1},{key:"education",label:"Education",level:1},{key:"equipmentRental",label:"Equipment Rental",level:1},{key:"insurance",label:"Insurance",level:1},{key:"interestExpense",label:"Interest Expense",level:1},{key:"travelMealsEntertainment",label:"Travel, Meals, and Entertainment",level:1},{key:"rent",label:"Rent",level:1},{key:"officeExpenses",label:"Office Expenses",level:1},{key:"professionalFees",label:"Professional Fees",level:1},{key:"repairsMaintenance",label:"Repairs & Maintenance",level:1},{key:"localTax",label:"Local Tax",level:1},{key:"stateTax",label:"State Tax",level:1},{key:"totalOperatingExpense",label:"Total Operating Expense",level:0,bold:!0,formula:!0}]},operatingIncome:{title:"Operating Income",color:"bg-teal-50 border-teal-300",headerBg:"bg-teal-600",textColor:"text-teal-900",items:[{key:"operatingIncome",label:"Operating Income",level:0,bold:!0}]},otherIncomeExpense:{title:"Other Income / (Expense)",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-600",textColor:"text-slate-900",items:[{key:"gainOnAssetSale",label:"Gain (Loss) On Asset Sale",level:1},{key:"interestIncome",label:"Interest Income",level:1},{key:"otherExpenses",label:"Other Expenses",level:1},{key:"totalOtherIncomeExpense",label:"Total Other Income / (Expenses)",level:0,bold:!0,formula:!0}]},incomeBeforeTax:{title:"Net Income Before Taxes",color:"bg-amber-50 border-amber-300",headerBg:"bg-amber-600",textColor:"text-amber-900",items:[{key:"incomeBeforeTax",label:"Net Income Before Taxes",level:0,bold:!0}]}},F={currentAssets:{title:"Current Assets",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"cash",label:"Cash and Cash Equivalents",level:1},{key:"receivables",label:"Accounts Receivable",level:1},{key:"inventory",label:"Inventory",level:1},{key:"prepaidExpenses",label:"Prepaid Expenses",level:1},{key:"otherCurrentAssets",label:"Other Current Assets",level:1},{key:"totalCurrentAssets",label:"Total Current Assets",level:0,formula:!0,bold:!0}]},nonCurrentAssets:{title:"Non-Current Assets",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"ppe",label:"Property, Plant & Equipment",level:1},{key:"accumulatedDepreciation",label:"Less: Accumulated Depreciation",level:1},{key:"netPPE",label:"Net Property, Plant & Equipment",level:1,formula:!0},{key:"intangibleAssets",label:"Intangible Assets",level:1},{key:"goodwill",label:"Goodwill",level:1},{key:"otherNonCurrentAssets",label:"Other Non-Current Assets",level:1},{key:"totalNonCurrentAssets",label:"Total Non-Current Assets",level:0,formula:!0,bold:!0}]},totalAssets:{title:"Total Assets",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalAssets",label:"Total Assets",level:0,formula:!0,bold:!0}]},currentLiabilities:{title:"Current Liabilities",color:"bg-red-50 border-red-300",headerBg:"bg-red-600",textColor:"text-red-900",items:[{key:"accountsPayable",label:"Accounts Payable",level:1},{key:"accruedExpenses",label:"Accrued Expenses",level:1},{key:"shortTermDebt",label:"Short-term Debt",level:1},{key:"currentPortionLongTermDebt",label:"Current Portion of Long-term Debt",level:1},{key:"otherCurrentLiabilities",label:"Other Current Liabilities",level:1},{key:"totalCurrentLiabilities",label:"Total Current Liabilities",level:0,formula:!0,bold:!0}]},nonCurrentLiabilities:{title:"Non-Current Liabilities",color:"bg-orange-50 border-orange-300",headerBg:"bg-orange-600",textColor:"text-orange-900",items:[{key:"longTermDebt",label:"Long-term Debt",level:1},{key:"deferredTaxLiabilities",label:"Deferred Tax Liabilities",level:1},{key:"otherNonCurrentLiabilities",label:"Other Non-Current Liabilities",level:1},{key:"totalNonCurrentLiabilities",label:"Total Non-Current Liabilities",level:0,formula:!0,bold:!0}]},totalLiabilities:{title:"Total Liabilities",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilities",label:"Total Liabilities",level:0,formula:!0,bold:!0}]},equity:{title:"Shareholders' Equity",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"commonStock",label:"Common Stock",level:1},{key:"retainedEarnings",label:"Retained Earnings",level:1},{key:"otherEquity",label:"Other Comprehensive Income",level:1},{key:"totalEquity",label:"Total Shareholders' Equity",level:0,formula:!0,bold:!0}]},totalLiabilitiesEquity:{title:"Total Liabilities and Equity",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"totalLiabilitiesEquity",label:"Total Liabilities and Shareholders' Equity",level:0,formula:!0,bold:!0}]}},R={operatingActivities:{title:"Operating Activities",color:"bg-emerald-50 border-emerald-300",headerBg:"bg-emerald-600",textColor:"text-emerald-900",items:[{key:"netIncome",label:"Net Income",level:1},{key:"depreciation",label:"Depreciation and Amortization",level:1},{key:"receivablesChange",label:"Change in Accounts Receivable",level:1},{key:"inventoryChange",label:"Change in Inventory",level:1},{key:"payablesChange",label:"Change in Accounts Payable",level:1},{key:"otherOperatingChanges",label:"Other Operating Changes",level:1},{key:"netCashFromOperating",label:"Net Cash from Operating Activities",level:0,formula:!0,bold:!0}]},investingActivities:{title:"Investing Activities",color:"bg-blue-50 border-blue-300",headerBg:"bg-blue-600",textColor:"text-blue-900",items:[{key:"capex",label:"Capital Expenditures",level:1},{key:"acquisitions",label:"Acquisitions",level:1},{key:"assetSales",label:"Asset Sales",level:1},{key:"otherInvestingActivities",label:"Other Investing Activities",level:1},{key:"netCashFromInvesting",label:"Net Cash from Investing Activities",level:0,formula:!0,bold:!0}]},financingActivities:{title:"Financing Activities",color:"bg-purple-50 border-purple-300",headerBg:"bg-purple-600",textColor:"text-purple-900",items:[{key:"debtIssuance",label:"Debt Issuance",level:1},{key:"debtRepayment",label:"Debt Repayment",level:1},{key:"equityIssuance",label:"Equity Issuance",level:1},{key:"dividends",label:"Dividends Paid",level:1},{key:"otherFinancingActivities",label:"Other Financing Activities",level:1},{key:"netCashFromFinancing",label:"Net Cash from Financing Activities",level:0,formula:!0,bold:!0}]},netCashFlow:{title:"Net Cash Flow",color:"bg-slate-50 border-slate-300",headerBg:"bg-slate-700",textColor:"text-slate-900",items:[{key:"netCashFlow",label:"Net Change in Cash",level:0,formula:!0,bold:!0},{key:"beginningCash",label:"Cash at Beginning of Period",level:1},{key:"endingCash",label:"Cash at End of Period",level:0,formula:!0,bold:!0}]}},M=(()=>{switch(u){case"balanceSheet":return F;case"cashFlow":return R;default:return S}})(),A=b.statements[u]||{},I=(e,s,t=!1)=>{N({rowKey:e,periodIndex:s,isAdjusted:t});let a="";a=t?g[e]||"":A[e]?.[s]||"",C(a.toString())},E=()=>{if(j){const{rowKey:e,periodIndex:s,isAdjusted:t}=j,a=parseFloat(w),i=isNaN(a)?0:a;if(t){const s={...g,[e]:i};p(s),x&&x(s)}else{const t={...d};t.statements={...t.statements||{}};const a=u||"incomeStatement";t.statements[a]={...t.statements[a]||{}};const l=t.statements[a][e]||{};t.statements[a][e]={...l,[s]:i},m(t)}N(null),C("")}},P=e=>{"Enter"===e.key?(e.preventDefault(),E()):"Escape"===e.key?(e.preventDefault(),N(null),C("")):"Tab"===e.key&&(e.preventDefault(),E())},D=e=>/^-?\d*\.?\d*$/.test(e)||""===e,T=e=>{if(!e&&0!==e)return"";const s="string"==typeof e?parseFloat(e):e;if(isNaN(s))return"";const t=Math.abs(s);let a;return t>=1e6?(a=new Intl.NumberFormat("en-US",{minimumFractionDigits:1,maximumFractionDigits:1}).format(s/1e6),a+="M"):a=t>=1e3?new Intl.NumberFormat("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}).format(s):new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(s),a};return e.useEffect(()=>{j&&k.current&&(k.current.focus(),k.current.select())},[j]),t.jsxs("div",{ref:f,role:"main",className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 pb-8",children:[t.jsx("div",{className:"bg-white border-b border-slate-200 shadow-sm",children:t.jsx("div",{className:"max-w-full mx-auto px-8 py-6",children:t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:t.jsx(a,{className:"w-6 h-6 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-2xl font-bold text-slate-900",children:"Financial Spreadsheet"}),t.jsx("p",{className:"text-sm text-slate-600 mt-1",children:"Professional financial modeling workspace"})]})]}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>{const e=prompt('Enter period label (e.g., "Year 5"):');if(e){const s={...d};s.periods=[...s.periods||[],e],m(s)}},className:"px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center gap-2 transition-all duration-200 shadow-sm hover:shadow-md font-medium",children:[t.jsx(i,{size:16}),"Add Period"]}),t.jsxs("select",{value:u,onChange:e=>h(e.target.value),className:"px-4 py-2.5 bg-white border border-slate-300 rounded-lg text-slate-900 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 font-medium shadow-sm",children:[t.jsx("option",{value:"incomeStatement",children:"Income Statement"}),t.jsx("option",{value:"balanceSheet",children:"Balance Sheet"}),t.jsx("option",{value:"cashFlow",children:"Cash Flow Statement"})]})]})]})})}),t.jsxs("div",{className:"max-w-full mx-auto p-8",children:[t.jsx("div",{className:"bg-white rounded-xl border border-slate-200 shadow-lg",children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{className:"bg-gradient-to-r from-slate-800 to-slate-900 text-white",children:t.jsxs("tr",{children:[t.jsx("th",{className:"min-w-[320px] px-6 py-4 text-left text-sm font-semibold tracking-wider",children:t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(l,{size:16,className:"text-slate-300"}),"Account Description"]})}),t.jsx("th",{className:"w-20 px-4 py-4 text-center text-sm font-semibold",children:"Units"}),b.periods.map((e,s)=>t.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:e}),t.jsx("span",{className:"text-xs text-slate-300 font-normal",children:"Actual"})]})},s)),t.jsx("th",{className:"min-w-[140px] px-4 py-4 text-center text-sm font-semibold bg-gradient-to-r from-amber-600 to-yellow-600 border-l-2 border-amber-400",children:t.jsxs("div",{className:"flex flex-col",children:[t.jsx("span",{children:"Adjusted"}),t.jsx("span",{className:"text-xs text-amber-100 font-normal",children:"Modified"})]})}),t.jsx("th",{className:"w-28 px-4 py-4 text-center text-sm font-semibold",children:t.jsxs("div",{className:"flex items-center justify-center gap-1",children:[t.jsx(r,{size:14}),"Type"]})})]})}),t.jsx("tbody",{className:"divide-y divide-slate-100",children:Object.entries(M).map(([e,a])=>t.jsxs(s.Fragment,{children:[t.jsx("tr",{className:`${a.headerBg||"bg-slate-600"} border-b-2 border-slate-300`,children:t.jsx("td",{colSpan:b.periods.length+4,className:"py-4 px-6",children:t.jsxs("div",{className:"flex items-center gap-3 text-white w-full text-left group",children:[t.jsxs("button",{onClick:()=>(e=>{v(s=>({...s,[e]:!s[e]}))})(e),className:"flex items-center gap-3 text-white hover:text-slate-200 transition-colors flex-1",children:[t.jsx("div",{className:"flex items-center justify-center w-6 h-6 rounded-full bg-white/20 group-hover:bg-white/30 transition-colors",children:y[e]?t.jsx(n,{size:14}):t.jsx(c,{size:14})}),t.jsx("span",{className:"font-bold text-lg",children:a.title})]}),t.jsx("button",{onClick:e=>{e.stopPropagation(),(()=>{if(prompt("Enter row label:")){const e={...d};m(e)}})()},className:"p-1.5 hover:bg-white/20 rounded-lg transition-colors opacity-0 group-hover:opacity-100",title:"Add custom row",children:t.jsx(i,{size:16})})]})})}),y[e]&&a.items.map(e=>(e=>{const{key:s,label:a,level:i,formula:l,bold:n}=e,c=1===i?"pl-8":2===i?"pl-12":"pl-4",d=n?"font-bold":0===i?"font-semibold":"font-medium",m=0===i?"text-slate-900":"text-slate-700",x=0===i?"bg-slate-50/70":"bg-white",u=0===i?"border-slate-200":"border-slate-100";return t.jsxs("tr",{className:`${x} border-b ${u} hover:bg-slate-50 transition-all duration-150 group`,children:[t.jsx("td",{className:`px-6 py-4 ${c} ${d} text-sm ${m}`,children:t.jsxs("div",{className:"flex items-center gap-3",children:[0===i&&t.jsx("div",{className:"w-1.5 h-4 bg-gradient-to-b from-blue-500 to-blue-600 rounded-full flex-shrink-0 shadow-sm"}),t.jsx("span",{className:"leading-tight",children:a}),l&&t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx(r,{size:14,className:"text-blue-500/80 flex-shrink-0"}),t.jsx("span",{className:"text-xs text-blue-600 font-medium px-1.5 py-0.5 bg-blue-50 rounded-md",children:"AUTO"})]})]})}),t.jsx("td",{className:"px-4 py-4 text-center",children:t.jsx("span",{className:"text-xs font-medium text-slate-500 uppercase tracking-wide bg-slate-100 px-2 py-1 rounded-md",children:"$ 000s"})}),b.periods.map((e,a)=>t.jsx("td",{className:"px-4 py-4 text-right",children:j?.rowKey!==s||j?.periodIndex!==a||j?.isAdjusted?t.jsxs("div",{onClick:()=>!l&&I(s,a),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(l?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),children:[t.jsx("span",{className:l?"text-blue-900":"text-slate-700",children:T(A[s]?.[a])||"—"}),!l&&t.jsx(o,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-slate-400 transition-opacity"})]}):t.jsxs("div",{className:"relative",children:[t.jsx("input",{ref:k,type:"text",value:w,onChange:e=>{const s=e.target.value;D(s)&&C(s)},onBlur:E,onKeyDown:P,className:"w-full px-3 py-2.5 bg-white border-2 border-blue-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-blue-100 focus:border-blue-500 shadow-lg",placeholder:"0.00"}),t.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[t.jsx("button",{onClick:E,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),t.jsx("button",{onClick:()=>{N(null),C("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]})},a)),t.jsx("td",{className:"px-4 py-4 text-right bg-gradient-to-r from-amber-50 to-yellow-50 border-l-2 border-amber-300",children:j?.rowKey===s&&j?.isAdjusted?t.jsxs("div",{className:"relative","data-testid":`adjusted-cell-${s}`,children:[t.jsx("input",{ref:k,type:"text",value:w,"data-testid":`adjusted-input-${s}`,onChange:e=>{const s=e.target.value;D(s)&&C(s)},onBlur:E,onKeyDown:P,className:"w-full px-3 py-2.5 bg-white border-2 border-amber-400 rounded-lg text-slate-900 text-right font-mono text-sm focus:outline-none focus:ring-4 focus:ring-amber-100 focus:border-amber-500 shadow-lg",placeholder:"0.00"}),t.jsxs("div",{className:"absolute -top-2 -right-2 flex gap-1",children:[t.jsx("button",{onClick:E,className:"w-5 h-5 bg-emerald-500 hover:bg-emerald-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"✓"}),t.jsx("button",{onClick:()=>{N(null),C("")},className:"w-5 h-5 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center text-xs transition-colors",children:"×"})]})]}):t.jsxs("div",{onClick:()=>!l&&I(s,null,!0),className:"px-3 py-2.5 rounded-lg font-mono text-sm transition-all duration-200 min-h-[40px] flex items-center justify-end "+(l?"bg-gradient-to-r from-blue-50 to-blue-100 text-blue-800 font-semibold border border-blue-200 shadow-sm":"hover:bg-slate-100 text-slate-800 cursor-pointer border border-transparent hover:border-slate-200 hover:shadow-sm group-hover:bg-slate-50"),"data-testid":`adjusted-cell-${s}`,children:[t.jsx("span",{className:l?"text-amber-900":"text-slate-700",children:T(g[s])||"—"}),!l&&t.jsx(o,{size:12,className:"ml-2 opacity-0 group-hover:opacity-40 text-amber-500 transition-opacity"})]})}),t.jsx("td",{className:"px-4 py-4 text-center",children:t.jsx("span",{className:"inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium "+(l?"bg-blue-100 text-blue-800 border border-blue-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:l?t.jsxs(t.Fragment,{children:[t.jsx(r,{size:10,className:"mr-1"}),"Auto"]}):t.jsxs(t.Fragment,{children:[t.jsx(o,{size:10,className:"mr-1"}),"Manual"]})})})]},s)})(e))]},e))})]})})}),t.jsxs("div",{className:"mt-8 grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:t.jsx(r,{className:"w-5 h-5 text-blue-600"})}),t.jsx("h3",{className:"font-bold text-slate-900",children:"How to Use"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Click any editable cell to modify values with enhanced input controls"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Use Enter to save changes or Escape to cancel editing"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Expand/collapse sections using the arrow controls"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-blue-500 font-bold",children:"•"}),"Formula cells automatically calculate based on inputs"]})]})]}),t.jsxs("div",{className:"bg-white rounded-xl p-6 border border-slate-200 shadow-sm",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:t.jsx(a,{className:"w-5 h-5 text-green-600"})}),t.jsx("h3",{className:"font-bold text-slate-900",children:"Professional Features"})]}),t.jsxs("ul",{className:"space-y-2 text-sm text-slate-700",children:[t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Color-coded sections for easy visual navigation"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Adjusted column for scenario analysis and modifications"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Professional number formatting with proper alignment"]}),t.jsxs("li",{className:"flex items-start gap-2",children:[t.jsx("span",{className:"text-green-500 font-bold",children:"•"}),"Enhanced editing experience with save/cancel controls"]})]})]})]})]})]})},Fe=({data:s,modelInputs:l,onModelInputChange:r,calculateDCF:n,formatCurrency:c,formatPercent:o})=>{const[h,g]=e.useState(!1),p=l.scenario?.scenarios||[],b=e.useMemo(()=>p.map(e=>{try{const t={...s.statements.incomeStatement},a=t.totalRevenue||{},i={};Object.keys(a).forEach(s=>{const t=parseInt(s);if(0===t)i[s]=a[s];else{const l=1+e.revenueGrowth/100;i[s]=a[0]*Math.pow(l,t)}});const l=t.operatingIncome||{},r={};Object.keys(l).forEach(s=>{if(0===parseInt(s))r[s]=l[s];else{const t=a[s]||0,n=i[s]||0,c=l[s]||0;if(t>0){const a=c/t+e.marginImprovement/100;r[s]=n*a}else r[s]=c}});const c={...s,statements:{...s.statements,incomeStatement:{...t,totalRevenue:i,operatingIncome:r}}},o=n(c);return{...e,...o,weightedValue:o.enterpriseValue*(e.probability/100)}}catch(t){return{...e,enterpriseValue:0,equityValue:0,weightedValue:0}}}),[p,s,n]),f=b.reduce((e,s)=>e+s.weightedValue,0),y=(e,s,t)=>{const a=p.map((a,i)=>i===e?{...a,[s]:t}:a);r("scenario","scenarios",a)},v=({scenario:e,index:s})=>t.jsxs("div",{className:"border rounded-lg p-4 bg-white",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Scenario Name"}),t.jsx("input",{type:"text",value:e.name,onChange:e=>y(s,"name",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter scenario name"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Probability (%)"}),t.jsx("input",{type:"number",min:"0",max:"100",value:e.probability,onChange:e=>y(s,"probability",parseInt(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue Growth (%)"}),t.jsx("input",{type:"number",step:"0.1",value:e.revenueGrowth,onChange:e=>y(s,"revenueGrowth",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margin Change (%)"}),t.jsx("input",{type:"number",step:"0.1",value:e.marginImprovement,onChange:e=>y(s,"marginImprovement",parseFloat(e.target.value)||0),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsx("div",{className:"flex justify-end mt-4 gap-2",children:t.jsxs("button",{onClick:()=>(e=>{const s=p.filter((s,t)=>t!==e);r("scenario","scenarios",s)})(s),className:"px-3 py-1 text-red-600 hover:bg-red-50 rounded-lg transition-colors flex items-center gap-1",children:[t.jsx(u,{size:16}),"Delete"]})})]});return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("div",{children:t.jsx("p",{className:"text-gray-600",children:"Create and compare multiple financial scenarios with different assumptions and probabilities."})}),t.jsxs("button",{onClick:()=>g(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2",children:[t.jsx(i,{size:16}),"Add Scenario"]})]}),t.jsxs("div",{className:"space-y-4",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Assumptions"}),p.map((e,s)=>t.jsx(v,{scenario:e,index:s},s)),h&&t.jsx("div",{className:"border-2 border-dashed border-blue-300 rounded-lg p-4",children:t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h5",{className:"font-medium",children:"Add New Scenario"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{const e={name:`Scenario ${p.length+1}`,probability:Math.max(0,100-p.reduce((e,s)=>e+s.probability,0)),revenueGrowth:10,marginImprovement:0};r("scenario","scenarios",[...p,e]),g(!1)},className:"px-3 py-1 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Add"}),t.jsx("button",{onClick:()=>g(!1),className:"px-3 py-1 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"Cancel"})]})]})})]}),b.length>0&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Scenario Analysis Results"}),t.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-6 border border-blue-200",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(d,{size:20,className:"text-blue-600"}),t.jsx("h5",{className:"font-semibold text-blue-800",children:"Probability-Weighted Valuation"})]}),t.jsx("div",{className:"text-3xl font-bold text-blue-800",children:c(f)}),t.jsx("p",{className:"text-sm text-blue-600 mt-2",children:"Expected value based on scenario probabilities"})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:b.map((e,s)=>t.jsxs(_.div,{className:"bg-white rounded-lg border p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[t.jsx("div",{className:"flex items-start justify-between mb-3",children:t.jsxs("div",{children:[t.jsx("h6",{className:"font-semibold text-gray-800",children:e.name}),t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsxs("span",{children:[e.probability,"% probability"]}),e.revenueGrowth>15?t.jsx(a,{size:14,className:"text-green-500"}):e.revenueGrowth<5?t.jsx(m,{size:14,className:"text-red-500"}):t.jsx(x,{size:14,className:"text-gray-500"})]})]})}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600",children:"Enterprise Value"}),t.jsx("div",{className:"text-xl font-bold text-gray-800",children:c(e.enterpriseValue)})]}),t.jsxs("div",{className:"text-xs space-y-1 text-gray-600",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Revenue Growth:"}),t.jsx("span",{className:"font-medium",children:o(e.revenueGrowth)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Margin Change:"}),t.jsxs("span",{className:"font-medium "+(e.marginImprovement>=0?"text-green-600":"text-red-600"),children:[e.marginImprovement>=0?"+":"",o(e.marginImprovement)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Weighted Value:"}),t.jsx("span",{className:"font-medium",children:c(e.weightedValue)})]})]})]})]},s))}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsx("h5",{className:"font-semibold mb-4",children:"Scenario Statistics"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:c(Math.max(...b.map(e=>e.enterpriseValue)))}),t.jsx("div",{className:"text-sm text-gray-600",children:"Best Case"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-red-600",children:c(Math.min(...b.map(e=>e.enterpriseValue)))}),t.jsx("div",{className:"text-sm text-gray-600",children:"Worst Case"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:c(f)}),t.jsx("div",{className:"text-sm text-gray-600",children:"Expected Value"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-800",children:c(Math.max(...b.map(e=>e.enterpriseValue))-Math.min(...b.map(e=>e.enterpriseValue)))}),t.jsx("div",{className:"text-sm text-gray-600",children:"Value Range"})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t",children:t.jsxs("div",{className:"text-sm text-gray-600",children:[t.jsx("strong",{children:"Total Probability:"})," ",p.reduce((e,s)=>e+s.probability,0),"%",100!==p.reduce((e,s)=>e+s.probability,0)&&t.jsx("span",{className:"text-orange-600 ml-2",children:"⚠ Probabilities should sum to 100%"})]})})]})]}),0===p.length&&t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx(d,{size:48,className:"mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"No scenarios created yet."}),t.jsx("p",{className:"text-sm mt-2",children:'Click "Add Scenario" to get started with scenario modeling.'})]})]})},Re=({data:s,modelInputs:a,onModelInputChange:l,calculateDCF:r,formatCurrency:n,formatPercent:c})=>{const[o,m]=e.useState(null),u=a.sensitivity||{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},p={revenue:{name:"Revenue Growth",unit:"%",description:"Annual revenue growth rate",baseValue:15,isPercentage:!0},grossMargin:{name:"Gross Margin",unit:"%",description:"Gross profit margin improvement",baseValue:45,isPercentage:!0},discountRate:{name:"Discount Rate (WACC)",unit:"%",description:"Weighted average cost of capital",baseValue:a.dcf?.discountRate||10,isPercentage:!0},terminalGrowthRate:{name:"Terminal Growth Rate",unit:"%",description:"Long-term growth rate assumption",baseValue:a.dcf?.terminalGrowthRate||2.5,isPercentage:!0},taxRate:{name:"Tax Rate",unit:"%",description:"Corporate tax rate",baseValue:a.dcf?.taxRate||25,isPercentage:!0}},b=e.useMemo(()=>r(),[s,a,r]),f=e.useMemo(()=>{const e={};return u.variables.forEach(t=>{const i=u.ranges[t],l=p[t];if(!i||!l)return;const r=(i.max-i.min)/8,n=[];for(let e=0;e<9;e++){const c=i.min+r*e;let o={...s},d={...a.dcf,[t]:(l.isPercentage,c)};if("revenue"===t||"grossMargin"===t){const e={...s.statements.incomeStatement};if("revenue"===t){const s=e.totalRevenue||{},t={};Object.keys(s).forEach(e=>{const a=parseInt(e);if(0===a)t[e]=s[e];else{const i=1+c/100;t[e]=s[0]*Math.pow(i,a)}}),e.totalRevenue=t}if("grossMargin"===t){const s=e.operatingIncome||{},t=e.totalRevenue||{},a={};Object.keys(s).forEach(e=>{const i=t[e]||0,l=s[e]||0;if(i>0){const s=l/i+c/100;a[e]=i*s}else a[e]=l}),e.operatingIncome=a}o={...s,statements:{...s.statements,incomeStatement:e}}}const m=(()=>{try{const e={discountRate:d.discountRate||10,terminalGrowthRate:d.terminalGrowthRate||2.5,projectionYears:d.projectionYears||5,taxRate:d.taxRate||25},s=o.statements.incomeStatement.operatingIncome||{};let t=[];if(Object.keys(s).forEach(e=>{parseInt(e)>=0&&t.push(s[e]||0)}),0===t.length)return{enterpriseValue:0,equityValue:0};let a=0;const i=1+e.discountRate/100;t.forEach((s,t)=>{if(t>0&&t<=e.projectionYears){const l=s*(1-e.taxRate/100)/Math.pow(i,t);a+=l}});const l=(t[t.length-1]||0)*(1+e.terminalGrowthRate/100)*(1-e.taxRate/100)/((e.discountRate-e.terminalGrowthRate)/100),r=l/Math.pow(i,e.projectionYears),n=a+r;return{enterpriseValue:n,equityValue:n,presentValueOperations:a,presentValueTerminal:r,terminalValue:l}}catch(e){return{enterpriseValue:0,equityValue:0}}})();n.push({variable:c,valuation:m.enterpriseValue,changeFromBase:(m.enterpriseValue-b.enterpriseValue)/b.enterpriseValue*100})}e[t]={definition:l,range:i,dataPoints:n}}),e},[s,a,u,b,r]),y=e.useMemo(()=>Object.entries(f).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>Math.abs(e.changeFromBase)));return{variable:e,definition:s.definition,maxImpact:t,positiveImpact:Math.max(...s.dataPoints.map(e=>e.changeFromBase)),negativeImpact:Math.min(...s.dataPoints.map(e=>e.changeFromBase))}}).sort((e,s)=>s.maxImpact-e.maxImpact),[f]),v=(e,s,t)=>{const a={...u.ranges,[e]:{...u.ranges[e],[s]:parseFloat(t)}};l("sensitivity","ranges",a)};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-gray-600 mb-4",children:"Analyze how changes in key variables impact enterprise valuation. Higher sensitivity indicates greater risk and importance for due diligence."}),t.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-3 h-3 bg-blue-500 rounded"}),t.jsxs("span",{children:["Base Case: ",n(b.enterpriseValue)]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(h,{size:14}),t.jsxs("span",{children:[u.variables.length," variables analyzed"]})]})]})]}),t.jsxs("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors flex items-center gap-2",children:[t.jsx(g,{size:16}),"Configure"]})]}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsxs("h4",{className:"font-semibold text-lg mb-4 flex items-center gap-2",children:[t.jsx(d,{size:20}),"Impact Ranking (Tornado Chart)"]}),t.jsx("div",{className:"space-y-3",children:y.map((e,s)=>t.jsxs("div",{className:"relative",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsxs("span",{className:"text-sm font-medium",children:[s+1,". ",e.definition.name]}),t.jsxs("span",{className:"text-xs text-gray-500",children:["±",e.maxImpact.toFixed(1),"%"]})]}),t.jsxs("div",{className:"relative h-8 bg-gray-100 rounded",children:[t.jsx("div",{className:"absolute left-1/2 h-full bg-red-400 rounded-l",style:{width:Math.abs(e.negativeImpact)/Math.max(Math.abs(e.negativeImpact),e.positiveImpact)*50+"%",transform:"translateX(-100%)"}}),t.jsx("div",{className:"absolute left-1/2 h-full bg-green-400 rounded-r",style:{width:e.positiveImpact/Math.max(Math.abs(e.negativeImpact),e.positiveImpact)*50+"%"}}),t.jsx("div",{className:"absolute left-1/2 top-0 bottom-0 w-0.5 bg-gray-400 transform -translate-x-0.5"}),t.jsxs("div",{className:"absolute inset-0 flex items-center justify-between px-2 text-xs font-medium text-white",children:[t.jsxs("span",{children:[e.negativeImpact.toFixed(1),"%"]}),t.jsxs("span",{children:["+",e.positiveImpact.toFixed(1),"%"]})]})]})]},e.variable))})]}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Variable Configuration"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[u.variables.map(e=>{const s=f[e];return s?t.jsxs("div",{className:"border rounded-lg p-4",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium",children:s.definition.name}),t.jsx("p",{className:"text-xs text-gray-500",children:s.definition.description})]}),t.jsx("button",{onClick:()=>(e=>{const s=u.variables.filter(s=>s!==e),{[e]:t,...a}=u.ranges;l("sensitivity","variables",s),l("sensitivity","ranges",a)})(e),className:"text-red-500 hover:bg-red-50 p-1 rounded",children:t.jsx(x,{size:16})})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-3",children:[t.jsxs("div",{children:[t.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Min Value (",s.definition.unit,")"]}),t.jsx("input",{type:"number",step:"0.1",value:s.range.min,onChange:s=>v(e,"min",s.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:["Max Value (",s.definition.unit,")"]}),t.jsx("input",{type:"number",step:"0.1",value:s.range.max,onChange:s=>v(e,"max",s.target.value),className:"w-full px-2 py-1 border rounded text-sm focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),t.jsxs("div",{className:"h-16 bg-gray-50 rounded p-2",children:[t.jsx("div",{className:"text-xs text-gray-500 mb-1",children:"Valuation Sensitivity"}),t.jsx("div",{className:"flex items-end justify-between h-8",children:s.dataPoints.map((e,a)=>t.jsx("div",{className:"w-1 rounded-t "+(e.changeFromBase>0?"bg-green-400":e.changeFromBase<0?"bg-red-400":"bg-blue-400"),style:{height:Math.abs(e.changeFromBase)/50*100+"%",minHeight:"2px"},title:`${e.variable}${s.definition.unit}: ${n(e.valuation)}`},a))})]})]},e):null}),t.jsx("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 flex items-center justify-center",children:t.jsxs("div",{className:"text-center",children:[t.jsx(i,{size:24,className:"mx-auto mb-2 text-gray-400"}),t.jsx("p",{className:"text-sm text-gray-500 mb-3",children:"Add Variable"}),t.jsx("div",{className:"space-y-2",children:Object.keys(p).filter(e=>!u.variables.includes(e)).map(e=>t.jsx("button",{onClick:()=>(e=>{if(!u.variables.includes(e)&&p[e]){const s=[...u.variables,e],t={...u.ranges,[e]:{min:-10,max:10}};l("sensitivity","variables",s),l("sensitivity","ranges",t)}})(e),className:"block w-full px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors",children:p[e].name},e))})]})})]})]}),o&&f[o]&&t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsxs("h4",{className:"font-semibold text-lg mb-4",children:["Detailed Analysis: ",f[o].definition.name]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium mb-3",children:"Data Points"}),t.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:f[o].dataPoints.map((e,s)=>t.jsxs("div",{className:"flex justify-between items-center text-sm p-2 bg-gray-50 rounded",children:[t.jsxs("span",{children:[e.variable,f[o].definition.unit]}),t.jsx("span",{className:"font-medium",children:n(e.valuation)}),t.jsxs("span",{className:"font-medium "+(e.changeFromBase>0?"text-green-600":e.changeFromBase<0?"text-red-600":"text-gray-600"),children:[e.changeFromBase>0?"+":"",e.changeFromBase.toFixed(1),"%"]})]},s))})]}),t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Range Impact:"}),t.jsxs("span",{className:"font-medium",children:["±",Math.max(...f[o].dataPoints.map(e=>Math.abs(e.changeFromBase))).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Max Upside:"}),t.jsxs("span",{className:"font-medium text-green-600",children:["+",Math.max(...f[o].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{className:"text-sm text-gray-600",children:"Max Downside:"}),t.jsxs("span",{className:"font-medium text-red-600",children:[Math.min(...f[o].dataPoints.map(e=>e.changeFromBase)).toFixed(1),"%"]})]})]})]})]})]})]})},Me=({dcfData:s,sensitivityData:i,scenarioData:l,formatCurrency:r,formatPercent:n})=>{const[c,o]=e.useState("dcf-waterfall"),[m,x]=e.useState(!0),u=[{id:"dcf-waterfall",label:"DCF Waterfall",icon:d,category:"dcf"},{id:"cashflow-trend",label:"Cash Flow Trend",icon:a,category:"dcf"},{id:"sensitivity-tornado",label:"Sensitivity Tornado",icon:h,category:"sensitivity"},{id:"scenario-distribution",label:"Scenario Distribution",icon:f,category:"scenario"},{id:"valuation-bridge",label:"Valuation Bridge",icon:d,category:"combined"}],g=e.useMemo(()=>{if(!s?.years)return[];let e=0;const t=[];s.years.forEach((s,a)=>{const i=e;e+=s.presentValue,t.push({name:`Year ${s.year}`,value:s.presentValue,cumulative:e,start:i,freeCashFlow:s.freeCashFlow,category:"operations"})});const a=e;return e+=s.presentValueTerminal,t.push({name:"Terminal Value",value:s.presentValueTerminal,cumulative:e,start:a,category:"terminal"}),t},[s]),y=e.useMemo(()=>s?.years?s.years.map((e,s)=>({year:`Year ${e.year}`,freeCashFlow:e.freeCashFlow,presentValue:e.presentValue,revenue:e.revenue,operatingIncome:e.operatingIncome,workingCapitalChange:e.workingCapitalChange,capex:Math.abs(e.capex)})):[],[s]),v=e.useMemo(()=>i?Object.entries(i).map(([e,s])=>{const t=Math.max(...s.dataPoints.map(e=>e.changeFromBase)),a=Math.min(...s.dataPoints.map(e=>e.changeFromBase));return{variable:s.definition.name,upside:t,downside:Math.abs(a),range:t-a}}).sort((e,s)=>s.range-e.range):[],[i]),j=e.useMemo(()=>l?.length?l.map((e,s)=>({name:e.name,value:e.enterpriseValue,probability:e.probability,weightedValue:e.weightedValue,fill:`hsl(${137.5*s%360}, 70%, 50%)`})):[],[l]),N=({active:e,payload:s,label:a,chartType:i})=>e&&s&&s.length?t.jsxs("div",{className:"bg-white p-3 border rounded-lg shadow-lg",children:[t.jsx("p",{className:"font-medium text-gray-800",children:a}),s.map((e,s)=>{return t.jsx("p",{style:{color:e.color},className:"text-sm",children:`${e.dataKey}: ${a=e.value,i=e.dataKey,i?.includes("Percent")||i?.includes("Rate")?n(a):r(a)}`},s);var a,i})]}):null,w=()=>t.jsx(K,{width:"100%",height:400,children:t.jsxs(H,{data:g,margin:{top:20,right:30,left:20,bottom:5},children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{dataKey:"name"}),t.jsx(X,{tickFormatter:e=>r(e)}),t.jsx(J,{content:t.jsx(N,{chartType:"waterfall"})}),t.jsx(Z,{dataKey:"value",fill:"#3B82F6"})]})}),C=()=>t.jsx(K,{width:"100%",height:400,children:t.jsxs(ae,{data:y,margin:{top:20,right:30,left:20,bottom:5},children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{dataKey:"year"}),t.jsx(X,{tickFormatter:e=>r(e)}),t.jsx(J,{content:t.jsx(N,{chartType:"trend"})}),t.jsx(ie,{}),t.jsx(le,{type:"monotone",dataKey:"freeCashFlow",stroke:"#10B981",strokeWidth:3,name:"Free Cash Flow"}),t.jsx(le,{type:"monotone",dataKey:"presentValue",stroke:"#3B82F6",strokeWidth:2,name:"Present Value"}),t.jsx(le,{type:"monotone",dataKey:"revenue",stroke:"#8B5CF6",strokeWidth:2,name:"Revenue"})]})}),k=()=>t.jsx(K,{width:"100%",height:400,children:t.jsxs(H,{data:v,layout:"horizontal",margin:{top:20,right:30,left:100,bottom:5},children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{type:"number",tickFormatter:e=>`${e.toFixed(1)}%`}),t.jsx(X,{type:"category",dataKey:"variable"}),t.jsx(J,{formatter:(e,s)=>[`${e.toFixed(1)}%`,s],labelFormatter:e=>`Variable: ${e}`}),t.jsx(Z,{dataKey:"upside",fill:"#10B981",name:"Upside Impact"}),t.jsx(Z,{dataKey:"downside",fill:"#EF4444",name:"Downside Impact"})]})}),S=()=>t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsx(K,{width:"100%",height:300,children:t.jsxs(ee,{children:[t.jsx(se,{data:j,cx:"50%",cy:"50%",outerRadius:80,dataKey:"probability",label:({name:e,probability:s})=>`${e}: ${s}%`,children:j.map((e,s)=>t.jsx(te,{fill:e.fill},`cell-${s}`))}),t.jsx(J,{formatter:e=>`${e}%`})]})}),t.jsx(K,{width:"100%",height:300,children:t.jsxs(H,{data:j,children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{dataKey:"name"}),t.jsx(X,{tickFormatter:e=>r(e)}),t.jsx(J,{content:t.jsx(N,{chartType:"scenario"})}),t.jsx(Z,{dataKey:"value",fill:"#8B5CF6",name:"Enterprise Value"})]})})]}),F=()=>{const e=[{name:"PV of Operations",value:s?.cumulativePV||0,type:"positive"},{name:"PV of Terminal",value:s?.presentValueTerminal||0,type:"positive"},{name:"Enterprise Value",value:s?.enterpriseValue||0,type:"total"}];return t.jsx(K,{width:"100%",height:400,children:t.jsxs(H,{data:e,margin:{top:20,right:30,left:20,bottom:5},children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{dataKey:"name"}),t.jsx(X,{tickFormatter:e=>r(e)}),t.jsx(J,{content:t.jsx(N,{chartType:"bridge"})}),t.jsx(Z,{dataKey:"value",fill:e=>"total"===e.type?"#1F2937":"#3B82F6"})]})})};return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[t.jsx(d,{size:20}),"Data Visualization"]}),t.jsx("p",{className:"text-gray-600",children:"Interactive charts and graphs to visualize valuation results and sensitivity analysis."})]}),t.jsxs("button",{onClick:()=>x(!m),className:"px-3 py-2 rounded-lg text-sm transition-colors flex items-center gap-2 "+(m?"bg-blue-100 text-blue-700":"bg-gray-100 text-gray-700"),children:[m?t.jsx(p,{size:14}):t.jsx(b,{size:14}),m?"Hide Details":"Show Details"]})]}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-3",children:u.map(e=>{const s=e.icon;return t.jsxs(_.button,{onClick:()=>o(e.id),className:"p-3 rounded-lg border-2 transition-all text-center "+(c===e.id?"border-blue-500 bg-blue-50 text-blue-700":"border-gray-200 bg-white hover:border-gray-300 text-gray-700"),whileHover:{scale:1.02},whileTap:{scale:.98},children:[t.jsx(s,{size:20,className:"mx-auto mb-2"}),t.jsx("div",{className:"text-xs font-medium",children:e.label})]},e.id)})}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsxs("div",{className:"flex justify-between items-center mb-4",children:[t.jsx("h4",{className:"font-semibold text-lg",children:u.find(e=>e.id===c)?.label}),m&&t.jsx("span",{className:"text-sm text-gray-500",children:(()=>{switch(c){case"dcf-waterfall":return"Shows the contribution of each year's cash flows and terminal value to total enterprise value.";case"cashflow-trend":return"Displays the trend of free cash flows, present values, and key financial metrics over time.";case"sensitivity-tornado":return"Illustrates how changes in key variables impact enterprise value, ranked by sensitivity.";case"scenario-distribution":return"Compares different scenarios by probability weights and resulting enterprise values.";case"valuation-bridge":return"Breaks down enterprise value into operating value and terminal value components.";default:return""}})()})]}),t.jsx("div",{className:"min-h-[400px]",children:(()=>{switch(c){case"dcf-waterfall":default:return t.jsx(w,{});case"cashflow-trend":return t.jsx(C,{});case"sensitivity-tornado":return t.jsx(k,{});case"scenario-distribution":return t.jsx(S,{});case"valuation-bridge":return t.jsx(F,{})}})()})]}),m&&t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[t.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Key Insights"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:["dcf-waterfall"===c&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-blue-600 font-medium",children:"Operations Contribution"}),t.jsx("div",{className:"text-lg font-bold text-blue-800",children:s?.cumulativePV?`${(s.cumulativePV/s.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),t.jsxs("div",{className:"p-4 bg-purple-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-purple-600 font-medium",children:"Terminal Contribution"}),t.jsx("div",{className:"text-lg font-bold text-purple-800",children:s?.presentValueTerminal?`${(s.presentValueTerminal/s.enterpriseValue*100).toFixed(1)}%`:"N/A"})]}),t.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Avg. Annual FCF"}),t.jsx("div",{className:"text-lg font-bold text-green-800",children:s?.freeCashFlows?r(s.freeCashFlows.reduce((e,s)=>e+s,0)/s.freeCashFlows.length):"N/A"})]})]}),"sensitivity-tornado"===c&&v.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"p-4 bg-red-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-red-600 font-medium",children:"Highest Risk Variable"}),t.jsx("div",{className:"text-lg font-bold text-red-800",children:v[0]?.variable}),t.jsxs("div",{className:"text-sm text-red-600",children:["±",v[0]?.range.toFixed(1),"% impact"]})]}),t.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-yellow-600 font-medium",children:"Medium Risk Variables"}),t.jsx("div",{className:"text-lg font-bold text-yellow-800",children:v.slice(1,3).map(e=>e.variable).join(", ")})]}),t.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[t.jsx("div",{className:"text-sm text-green-600 font-medium",children:"Lowest Risk Variable"}),t.jsx("div",{className:"text-lg font-bold text-green-800",children:v[v.length-1]?.variable})]})]})]})]})]})},Ae=({modelInputs:s,onModelInputChange:i,formatPercent:l})=>{const[n,c]=e.useState(!0),[o,d]=e.useState("inputs"),m=s.dcf.wacc||{riskFreeRate:4.5,marketRiskPremium:6,beta:1.2,smallCompanyPremium:3,companySpecificRisk:2,debtInterestRate:6.5,taxRate:25,marketValueEquity:1e5,marketValueDebt:3e4,buildUpMethod:{riskFreeRate:4.5,equityRiskPremium:6,sizeRiskPremium:3,industryRiskPremium:2,companySpecificRisk:2},industryWACC:10.5,industryBeta:1.1,industryDebtEquityRatio:.3},x=e.useMemo(()=>{const e={...m,...s.dcf.wacc},t=e.riskFreeRate+e.beta*e.marketRiskPremium+e.smallCompanyPremium+e.companySpecificRisk,a=e.buildUpMethod.riskFreeRate+e.buildUpMethod.equityRiskPremium+e.buildUpMethod.sizeRiskPremium+e.buildUpMethod.industryRiskPremium+e.buildUpMethod.companySpecificRisk,i=e.debtInterestRate*(1-e.taxRate/100),l=e.marketValueEquity+e.marketValueDebt,r=e.marketValueEquity/l,n=e.marketValueDebt/l,c=t/100*r+i/100*n,o=a/100*r+i/100*n;return{costOfEquityCAPM:t,costOfEquityBuildUp:a,costOfDebtAfterTax:i,equityWeight:100*r,debtWeight:100*n,waccCAPM:100*c,waccBuildUp:100*o,finalWACC:(c+o)/2*100,totalCapital:l,debtToEquityRatio:e.marketValueDebt/e.marketValueEquity}},[m,s.dcf.wacc]),u=(e,t)=>{const a={...m,...s.dcf.wacc,[e]:parseFloat(t)||0};i("dcf","wacc",a)},h=[{id:"inputs",label:"Inputs",icon:g},{id:"calculation",label:"Calculation",icon:r},{id:"benchmarks",label:"Benchmarks",icon:a}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[t.jsx(r,{size:20}),"WACC Calculator"]}),t.jsx("p",{className:"text-gray-600",children:"Professional weighted average cost of capital calculation using CAPM and build-up methods."})]}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx("button",{onClick:()=>{return e=x.finalWACC,void i("dcf","discountRate",e);var e},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm",children:"Apply to DCF"}),t.jsx("button",{onClick:()=>c(!n),className:"px-3 py-2 rounded-lg text-sm transition-colors "+(n?"bg-gray-200 text-gray-700":"bg-gray-100 text-gray-600"),children:n?"Hide Details":"Show Details"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(_.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(y,{size:20,className:"text-blue-600"}),t.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"FINAL WACC"})]}),t.jsx("div",{className:"text-2xl font-bold text-blue-800",children:l(x.finalWACC)}),t.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Risk-adjusted average"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(a,{size:20,className:"text-green-600"}),t.jsx("span",{className:"text-xs text-green-600 font-medium",children:"COST OF EQUITY"})]}),t.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(x.costOfEquityCAPM)}),t.jsx("div",{className:"text-sm text-green-600 mt-1",children:"CAPM method"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(v,{size:20,className:"text-purple-600"}),t.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"COST OF DEBT"})]}),t.jsx("div",{className:"text-2xl font-bold text-purple-800",children:l(x.costOfDebtAfterTax)}),t.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"After-tax"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(j,{size:20,className:"text-orange-600"}),t.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"DEBT/EQUITY"})]}),t.jsxs("div",{className:"text-2xl font-bold text-orange-800",children:[x.debtToEquityRatio.toFixed(2),"x"]}),t.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Capital structure"})]})]}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:h.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>d(e.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(o===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[t.jsx(s,{size:16}),e.label]},e.id)})}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["inputs"===o&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"WACC Input Parameters"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"Cost of Equity (CAPM Method)"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Risk-Free Rate (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.riskFreeRate||m.riskFreeRate,onChange:e=>u("riskFreeRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"10-year Treasury rate"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Risk Premium (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.marketRiskPremium||m.marketRiskPremium,onChange:e=>u("marketRiskPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Expected market return - risk-free rate"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Beta (β)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.beta||m.beta,onChange:e=>u("beta",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Systematic risk relative to market"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Small Company Premium (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium,onChange:e=>u("smallCompanyPremium",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Size-related risk premium"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company-Specific Risk (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.companySpecificRisk||m.companySpecificRisk,onChange:e=>u("companySpecificRisk",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Unsystematic risk premium"})]})]})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium mb-4 text-purple-800",children:"Capital Structure & Cost of Debt"}),t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Equity ($000s)"}),t.jsx("input",{type:"number",value:s.dcf.wacc?.marketValueEquity||m.marketValueEquity,onChange:e=>u("marketValueEquity",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Value of Debt ($000s)"}),t.jsx("input",{type:"number",value:s.dcf.wacc?.marketValueDebt||m.marketValueDebt,onChange:e=>u("marketValueDebt",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Pre-Tax Cost of Debt (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.debtInterestRate||m.debtInterestRate,onChange:e=>u("debtInterestRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Interest rate on debt"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tax Rate (%)"}),t.jsx("input",{type:"number",step:"0.1",value:s.dcf.wacc?.taxRate||s.dcf.taxRate,onChange:e=>u("taxRate",e.target.value),className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"}),t.jsx("span",{className:"text-xs text-gray-500",children:"Corporate tax rate"})]}),t.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium mb-2",children:"Capital Structure"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Equity Weight:"}),t.jsx("span",{className:"font-medium",children:l(x.equityWeight)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Debt Weight:"}),t.jsx("span",{className:"font-medium",children:l(x.debtWeight)})]}),t.jsxs("div",{className:"flex justify-between border-t pt-2",children:[t.jsx("span",{children:"Total Capital:"}),t.jsxs("span",{className:"font-medium",children:["$",(x.totalCapital/1e3).toFixed(0),"M"]})]})]})]})]})]})]})]}),"calculation"===o&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"WACC Calculation Breakdown"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[t.jsxs("div",{className:"p-6 bg-blue-50 rounded-lg border border-blue-200",children:[t.jsx("h5",{className:"font-medium mb-4 text-blue-800",children:"CAPM Method"}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Risk-Free Rate:"}),t.jsx("span",{className:"font-medium",children:l(s.dcf.wacc?.riskFreeRate||m.riskFreeRate)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Beta × Market Risk Premium:"}),t.jsx("span",{className:"font-medium",children:l((s.dcf.wacc?.beta||m.beta)*(s.dcf.wacc?.marketRiskPremium||m.marketRiskPremium))})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Small Company Premium:"}),t.jsx("span",{className:"font-medium",children:l(s.dcf.wacc?.smallCompanyPremium||m.smallCompanyPremium)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Company-Specific Risk:"}),t.jsx("span",{className:"font-medium",children:l(s.dcf.wacc?.companySpecificRisk||m.companySpecificRisk)})]}),t.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[t.jsx("span",{children:"Cost of Equity (CAPM):"}),t.jsx("span",{children:l(x.costOfEquityCAPM)})]})]})]}),t.jsxs("div",{className:"p-6 bg-green-50 rounded-lg border border-green-200",children:[t.jsx("h5",{className:"font-medium mb-4 text-green-800",children:"Build-up Method"}),t.jsxs("div",{className:"space-y-3 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Risk-Free Rate:"}),t.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.riskFreeRate)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Equity Risk Premium:"}),t.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.equityRiskPremium)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Size Risk Premium:"}),t.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.sizeRiskPremium)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Industry Risk Premium:"}),t.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.industryRiskPremium)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Company-Specific Risk:"}),t.jsx("span",{className:"font-medium",children:l(m.buildUpMethod.companySpecificRisk)})]}),t.jsxs("div",{className:"flex justify-between border-t pt-2 font-semibold",children:[t.jsx("span",{children:"Cost of Equity (Build-up):"}),t.jsx("span",{children:l(x.costOfEquityBuildUp)})]})]})]})]}),t.jsxs("div",{className:"p-6 bg-gray-50 rounded-lg border",children:[t.jsx("h5",{className:"font-medium mb-4",children:"Final WACC Calculation"}),t.jsxs("div",{className:"space-y-4 text-sm",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{children:"WACC (CAPM Method):"}),t.jsx("span",{className:"font-medium",children:l(x.waccCAPM)})]}),t.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityCAPM)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]}),t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between mb-2",children:[t.jsx("span",{children:"WACC (Build-up Method):"}),t.jsx("span",{className:"font-medium",children:l(x.waccBuildUp)})]}),t.jsxs("div",{className:"text-xs text-gray-600",children:["[",l(x.costOfEquityBuildUp)," × ",l(x.equityWeight),"] + [",l(x.costOfDebtAfterTax)," × ",l(x.debtWeight),"]"]})]})]}),t.jsxs("div",{className:"border-t pt-4",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-lg font-semibold",children:"Risk-Adjusted WACC:"}),t.jsx("span",{className:"text-2xl font-bold text-blue-600",children:l(x.finalWACC)})]}),t.jsx("div",{className:"text-xs text-gray-600 mt-1",children:"Average of CAPM and Build-up methods"})]})]})]})]}),"benchmarks"===o&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Industry Benchmarks & Validation"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Your Company"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"WACC:"}),t.jsx("span",{className:"font-semibold",children:l(x.finalWACC)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Beta:"}),t.jsx("span",{className:"font-semibold",children:(s.dcf.wacc?.beta||m.beta).toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"D/E Ratio:"}),t.jsxs("span",{className:"font-semibold",children:[x.debtToEquityRatio.toFixed(2),"x"]})]})]})]}),t.jsxs("div",{className:"p-4 bg-green-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium text-green-800 mb-2",children:"Industry Average"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"WACC:"}),t.jsx("span",{className:"font-semibold",children:l(m.industryWACC)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Beta:"}),t.jsx("span",{className:"font-semibold",children:m.industryBeta.toFixed(2)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"D/E Ratio:"}),t.jsxs("span",{className:"font-semibold",children:[m.industryDebtEquityRatio.toFixed(2),"x"]})]})]})]}),t.jsxs("div",{className:"p-4 bg-yellow-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium text-yellow-800 mb-2",children:"Variance"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"WACC Diff:"}),t.jsxs("span",{className:"font-semibold "+(x.finalWACC>m.industryWACC?"text-red-600":"text-green-600"),children:[x.finalWACC>m.industryWACC?"+":"",l(x.finalWACC-m.industryWACC)]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Beta Diff:"}),t.jsxs("span",{className:"font-semibold "+((s.dcf.wacc?.beta||m.beta)>m.industryBeta?"text-red-600":"text-green-600"),children:[(s.dcf.wacc?.beta||m.beta)>m.industryBeta?"+":"",((s.dcf.wacc?.beta||m.beta)-m.industryBeta).toFixed(2)]})]})]})]})]}),t.jsx("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(N,{size:16,className:"text-blue-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium text-blue-800 mb-2",children:"Validation Guidelines"}),t.jsxs("ul",{className:"text-sm text-blue-700 space-y-1",children:[t.jsx("li",{children:"• WACC should be within ±2% of industry average for similar companies"}),t.jsx("li",{children:"• Beta should reflect business risk relative to market (typically 0.8-1.5 for most companies)"}),t.jsx("li",{children:"• Cost of equity should exceed risk-free rate by at least 4-6% for private companies"}),t.jsx("li",{children:"• Debt/equity ratio should align with industry norms and company strategy"}),t.jsx("li",{children:"• Consider economic conditions and company-specific factors"})]})]})]})})]})]})]})},Ie=({data:s,formatCurrency:l,formatPercent:r})=>{const[n,c]=e.useState("multiples"),[o,m]=e.useState("ev_revenue"),[x,u]=e.useState(!1),[h,g]=e.useState([{id:1,name:"MedSpa Corp",ticker:"MSPA",marketCap:45e4,enterpriseValue:52e4,revenue:18e4,ebitda:45e3,netIncome:28e3,employees:1200,founded:2015,geography:"US",businessModel:"B2C Medical Spa Chain"},{id:2,name:"Wellness Holdings",ticker:"WELL",marketCap:68e4,enterpriseValue:75e4,revenue:22e4,ebitda:55e3,netIncome:35e3,employees:1800,founded:2012,geography:"US",businessModel:"Integrated Wellness Platform"},{id:3,name:"Aesthetic Solutions Inc",ticker:"AEST",marketCap:32e4,enterpriseValue:38e4,revenue:125e3,ebitda:32e3,netIncome:18e3,employees:850,founded:2018,geography:"US",businessModel:"Medical Device & Services"},{id:4,name:"Premium Health Group",ticker:"PHG",marketCap:92e4,enterpriseValue:105e4,revenue:31e4,ebitda:78e3,netIncome:48e3,employees:2500,founded:2010,geography:"US",businessModel:"Premium Healthcare Services"}]),p=e.useMemo(()=>h.map(e=>({...e,multiples:{ev_revenue:e.enterpriseValue/e.revenue,ev_ebitda:e.enterpriseValue/e.ebitda,pe_ratio:e.marketCap/e.netIncome,revenue_per_employee:e.revenue/e.employees,market_cap_revenue:e.marketCap/e.revenue}})),[h]),b=e.useMemo(()=>{const e=p.map(e=>e.multiples),s=e=>({mean:e.reduce((e,s)=>e+s,0)/e.length,median:e.sort((e,s)=>e-s)[Math.floor(e.length/2)],min:Math.min(...e),max:Math.max(...e),p25:e.sort((e,s)=>e-s)[Math.floor(.25*e.length)],p75:e.sort((e,s)=>e-s)[Math.floor(.75*e.length)]});return{ev_revenue:s(e.map(e=>e.ev_revenue)),ev_ebitda:s(e.map(e=>e.ev_ebitda)),pe_ratio:s(e.map(e=>e.pe_ratio)),revenue_per_employee:s(e.map(e=>e.revenue_per_employee)),market_cap_revenue:s(e.map(e=>e.market_cap_revenue))}},[p]),f=e.useMemo(()=>{const e=s.statements.incomeStatement.totalRevenue?.[1]||1e5,t=1.15*(s.statements.incomeStatement.operatingIncome?.[1]||5e4),a=.7*(s.statements.incomeStatement.operatingIncome?.[1]||5e4);return{ev_revenue:{mean:e*b.ev_revenue.mean,median:e*b.ev_revenue.median,p25:e*b.ev_revenue.p25,p75:e*b.ev_revenue.p75},ev_ebitda:{mean:t*b.ev_ebitda.mean,median:t*b.ev_ebitda.median,p25:t*b.ev_ebitda.p25,p75:t*b.ev_ebitda.p75},pe_ratio:{mean:a*b.pe_ratio.mean,median:a*b.pe_ratio.median,p25:a*b.pe_ratio.p25,p75:a*b.pe_ratio.p75}}},[s,b]),y={ev_revenue:{name:"EV/Revenue",description:"Enterprise Value / Annual Revenue"},ev_ebitda:{name:"EV/EBITDA",description:"Enterprise Value / EBITDA"},pe_ratio:{name:"P/E Ratio",description:"Market Cap / Net Income"},revenue_per_employee:{name:"Revenue/Employee",description:"Revenue per Employee"},market_cap_revenue:{name:"Market Cap/Revenue",description:"Market Cap / Revenue"}},j=[{id:"multiples",label:"Trading Multiples",icon:d},{id:"analysis",label:"Valuation Analysis",icon:C},{id:"companies",label:"Comparable Set",icon:w}];return t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-start",children:[t.jsxs("div",{children:[t.jsxs("h3",{className:"text-xl font-semibold mb-2 flex items-center gap-2",children:[t.jsx(w,{size:20}),"Comparable Company Analysis"]}),t.jsx("p",{className:"text-gray-600",children:"Market-based valuation using trading multiples from similar public companies."})]}),t.jsx("div",{className:"flex gap-2",children:t.jsxs("button",{onClick:()=>u(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm",children:[t.jsx(i,{size:16}),"Add Comparable"]})})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[t.jsxs(_.div,{className:"bg-gradient-to-r from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(d,{size:20,className:"text-blue-600"}),t.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"EV/REVENUE"})]}),t.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[b.ev_revenue.median.toFixed(1),"x"]}),t.jsx("div",{className:"text-sm text-blue-600 mt-1",children:"Median multiple"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-green-50 to-green-100 rounded-lg p-4 border border-green-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(a,{size:20,className:"text-green-600"}),t.jsx("span",{className:"text-xs text-green-600 font-medium",children:"IMPLIED VALUE"})]}),t.jsx("div",{className:"text-2xl font-bold text-green-800",children:l(f.ev_revenue.median)}),t.jsx("div",{className:"text-sm text-green-600 mt-1",children:"EV/Revenue basis"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(v,{size:20,className:"text-purple-600"}),t.jsx("span",{className:"text-xs text-purple-600 font-medium",children:"VALUATION RANGE"})]}),t.jsxs("div",{className:"text-lg font-bold text-purple-800",children:[l(f.ev_revenue.p25)," - ",l(f.ev_revenue.p75)]}),t.jsx("div",{className:"text-sm text-purple-600 mt-1",children:"25th - 75th percentile"})]}),t.jsxs(_.div,{className:"bg-gradient-to-r from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx(w,{size:20,className:"text-orange-600"}),t.jsx("span",{className:"text-xs text-orange-600 font-medium",children:"PEER COUNT"})]}),t.jsx("div",{className:"text-2xl font-bold text-orange-800",children:h.length}),t.jsx("div",{className:"text-sm text-orange-600 mt-1",children:"Comparable companies"})]})]}),t.jsx("div",{className:"flex space-x-1 bg-gray-100 p-1 rounded-lg",children:j.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>c(e.id),className:"flex-1 flex items-center justify-center gap-2 py-2 px-4 rounded-md transition-all "+(n===e.id?"bg-white text-blue-600 shadow-sm":"text-gray-600 hover:text-gray-800"),children:[t.jsx(s,{size:16}),e.label]},e.id)})}),t.jsxs("div",{className:"bg-white rounded-lg border p-6",children:["multiples"===n&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Trading Multiples Analysis"}),t.jsx("select",{value:o,onChange:e=>m(e.target.value),className:"px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:Object.entries(y).map(([e,s])=>t.jsx("option",{value:e,children:s.name},e))})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full text-sm",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b bg-gray-50",children:[t.jsx("th",{className:"text-left p-3 font-medium",children:"Company"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"Market Cap"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"Enterprise Value"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"Revenue"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"EV/Revenue"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"EV/EBITDA"}),t.jsx("th",{className:"text-right p-3 font-medium",children:"P/E Ratio"})]})}),t.jsxs("tbody",{children:[p.map((e,s)=>t.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[t.jsx("td",{className:"p-3",children:t.jsxs("div",{children:[t.jsx("div",{className:"font-medium",children:e.name}),t.jsx("div",{className:"text-xs text-gray-500",children:e.ticker})]})}),t.jsx("td",{className:"p-3 text-right",children:l(e.marketCap)}),t.jsx("td",{className:"p-3 text-right",children:l(e.enterpriseValue)}),t.jsx("td",{className:"p-3 text-right",children:l(e.revenue)}),t.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.ev_revenue.toFixed(1),"x"]}),t.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.ev_ebitda.toFixed(1),"x"]}),t.jsxs("td",{className:"p-3 text-right font-medium",children:[e.multiples.pe_ratio.toFixed(1),"x"]})]},e.id)),t.jsxs("tr",{className:"border-t-2 border-gray-300 bg-blue-50 font-semibold",children:[t.jsx("td",{className:"p-3",children:"Market Statistics"}),t.jsx("td",{className:"p-3"}),t.jsx("td",{className:"p-3"}),t.jsx("td",{className:"p-3"}),t.jsxs("td",{className:"p-3 text-right",children:[b.ev_revenue.median.toFixed(1),"x"]}),t.jsxs("td",{className:"p-3 text-right",children:[b.ev_ebitda.median.toFixed(1),"x"]}),t.jsxs("td",{className:"p-3 text-right",children:[b.pe_ratio.median.toFixed(1),"x"]})]})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium mb-3",children:"Multiple Distribution"}),t.jsx("div",{className:"space-y-3",children:Object.entries(b).slice(0,3).map(([e,s])=>t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between text-sm mb-1",children:[t.jsx("span",{children:y[e].name}),t.jsxs("span",{className:"font-medium",children:[s.median.toFixed(1),"x"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:(s.median-s.min)/(s.max-s.min)*100+"%"}})}),t.jsxs("div",{className:"flex justify-between text-xs text-gray-500 mt-1",children:[t.jsxs("span",{children:[s.min.toFixed(1),"x"]}),t.jsxs("span",{children:[s.max.toFixed(1),"x"]})]})]},e))})]}),t.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[t.jsx("h6",{className:"font-medium mb-3",children:"Key Statistics"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Companies Analyzed:"}),t.jsx("span",{className:"font-medium",children:h.length})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Median Market Cap:"}),t.jsx("span",{className:"font-medium",children:l(h.sort((e,s)=>e.marketCap-s.marketCap)[Math.floor(h.length/2)]?.marketCap||0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Median Revenue:"}),t.jsx("span",{className:"font-medium",children:l(h.sort((e,s)=>e.revenue-s.revenue)[Math.floor(h.length/2)]?.revenue||0)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Avg Founded Year:"}),t.jsx("span",{className:"font-medium",children:Math.round(h.reduce((e,s)=>e+s.founded,0)/h.length)})]})]})]})]})]}),"analysis"===n&&t.jsxs("div",{className:"space-y-6",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Valuation Analysis"}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium mb-4",children:"Implied Valuation by Multiple"}),t.jsx("div",{className:"space-y-4",children:Object.entries(f).map(([e,s])=>t.jsxs("div",{className:"p-4 border rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"font-medium",children:y[e].name}),t.jsxs("span",{className:"text-sm text-gray-500",children:[b[e].median.toFixed(1),"x median"]})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"25th Percentile:"}),t.jsx("span",{className:"font-medium",children:l(s.p25)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Median:"}),t.jsx("span",{className:"font-bold text-blue-600",children:l(s.median)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"75th Percentile:"}),t.jsx("span",{className:"font-medium",children:l(s.p75)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Mean:"}),t.jsx("span",{className:"font-medium",children:l(s.mean)})]})]})]},e))})]}),t.jsxs("div",{children:[t.jsx("h5",{className:"font-medium mb-4",children:"Valuation Summary"}),t.jsx("div",{className:"p-6 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-200",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Recommended Range"}),t.jsxs("div",{className:"text-2xl font-bold text-blue-800",children:[l((f.ev_revenue.p25+f.ev_ebitda.p25)/2)," -",l((f.ev_revenue.p75+f.ev_ebitda.p75)/2)]}),t.jsx("div",{className:"text-sm text-blue-600",children:"Blended 25th-75th percentile"})]}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm text-blue-600 font-medium mb-1",children:"Midpoint Valuation"}),t.jsx("div",{className:"text-xl font-bold text-blue-800",children:l((f.ev_revenue.median+f.ev_ebitda.median)/2)}),t.jsx("div",{className:"text-sm text-blue-600",children:"Average of median multiples"})]})]})}),t.jsx("div",{className:"mt-4 p-4 bg-yellow-50 rounded-lg border border-yellow-200",children:t.jsxs("div",{className:"flex items-start gap-2",children:[t.jsx(C,{size:16,className:"text-yellow-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("h6",{className:"font-medium text-yellow-800 mb-1",children:"Valuation Considerations"}),t.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[t.jsx("li",{children:"• Consider company-specific growth and margin profiles"}),t.jsx("li",{children:"• Adjust for differences in business model and scale"}),t.jsx("li",{children:"• Factor in market conditions and sector trends"}),t.jsx("li",{children:"• Apply appropriate discount for private company liquidity"})]})]})]})})]})]})]}),"companies"===n&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("h4",{className:"font-semibold text-lg",children:"Comparable Company Set"}),t.jsxs("div",{className:"flex gap-2",children:[t.jsxs("div",{className:"relative",children:[t.jsx(k,{size:16,className:"absolute left-3 top-3 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search companies...",className:"pl-10 pr-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("button",{className:"px-3 py-2 border rounded-lg hover:bg-gray-50 flex items-center gap-2",children:[t.jsx(S,{size:16}),"Filter"]})]})]}),t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:h.map(e=>t.jsxs(_.div,{className:"border rounded-lg p-4 hover:shadow-lg transition-shadow",whileHover:{y:-2},children:[t.jsxs("div",{className:"flex justify-between items-start mb-3",children:[t.jsxs("div",{children:[t.jsx("h6",{className:"font-semibold text-gray-800",children:e.name}),t.jsxs("div",{className:"text-sm text-gray-500",children:[e.ticker," • ",e.geography]})]}),t.jsx("button",{onClick:()=>{return s=e.id,void g(h.filter(e=>e.id!==s));var s},className:"text-red-500 hover:bg-red-50 p-1 rounded",children:"×"})]}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Market Cap:"}),t.jsx("span",{className:"font-medium",children:l(e.marketCap)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Revenue:"}),t.jsx("span",{className:"font-medium",children:l(e.revenue)})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"EV/Revenue:"}),t.jsxs("span",{className:"font-medium",children:[(e.enterpriseValue/e.revenue).toFixed(1),"x"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Founded:"}),t.jsx("span",{className:"font-medium",children:e.founded})]})]}),t.jsx("div",{className:"mt-3 pt-3 border-t",children:t.jsx("div",{className:"text-xs text-gray-600",children:e.businessModel})})]},e.id))})]})]}),x&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:t.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[t.jsx("h4",{className:"font-semibold text-lg mb-4",children:"Add Comparable Company"}),t.jsxs("form",{onSubmit:e=>{e.preventDefault();const s=new FormData(e.target);(e=>{const s={id:Date.now(),...e,marketCap:parseFloat(e.marketCap)||0,enterpriseValue:parseFloat(e.enterpriseValue)||0,revenue:parseFloat(e.revenue)||0,ebitda:parseFloat(e.ebitda)||0,netIncome:parseFloat(e.netIncome)||0,employees:parseInt(e.employees)||0,founded:parseInt(e.founded)||(new Date).getFullYear()};g([...h,s]),u(!1)})(Object.fromEntries(s))},children:[t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Company Name"}),t.jsx("input",{name:"name",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Ticker"}),t.jsx("input",{name:"ticker",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Market Cap ($000s)"}),t.jsx("input",{name:"marketCap",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Enterprise Value ($000s)"}),t.jsx("input",{name:"enterpriseValue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Revenue ($000s)"}),t.jsx("input",{name:"revenue",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EBITDA ($000s)"}),t.jsx("input",{name:"ebitda",type:"number",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Business Model"}),t.jsx("input",{name:"businessModel",type:"text",required:!0,className:"w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]}),t.jsxs("div",{className:"flex gap-3 mt-6",children:[t.jsx("button",{type:"submit",className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add Company"}),t.jsx("button",{type:"button",onClick:()=>u(!1),className:"flex-1 px-4 py-2 border rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"})]})]})]})})]})},Ee=({data:a,adjustedValues:i,onDataChange:l})=>{const[r,n]=e.useState("dcf"),[c,o]=e.useState({dcf:{discountRate:10,terminalGrowthRate:2.5,projectionYears:5,terminalValueMultiple:10,taxRate:25,sharesOutstanding:1e3,workingCapital:{receivablesDays:45,inventoryDays:60,payablesDays:30,receivablesGrowth:2,inventoryGrowth:1.5,payablesGrowth:1.8},capex:{capexAsPercentOfRevenue:3.5,depreciationRate:7,maintenanceCapex:2}},ratios:{compareToIndustry:!0,industryAverages:{grossMargin:45,operatingMargin:15,netMargin:8,currentRatio:2.1,debtToEquity:.5}},sensitivity:{variables:["revenue","grossMargin","discountRate"],ranges:{revenue:{min:-20,max:20},grossMargin:{min:-5,max:5},discountRate:{min:8,max:15}}},scenario:{scenarios:[{name:"Base Case",probability:50,revenueGrowth:15,marginImprovement:0},{name:"Bull Case",probability:25,revenueGrowth:25,marginImprovement:2},{name:"Bear Case",probability:25,revenueGrowth:5,marginImprovement:-2}]}}),m=e.useMemo(()=>{const e=a.statements.incomeStatement,s=a.periods,t={revenue:[],grossProfit:[],operatingIncome:[],margins:{gross:[],operating:[],net:[]},growth:{revenue:[],operating:[]}};return s.forEach((a,l)=>{const r=l===s.length-1,n=r&&i?.totalRevenue?i.totalRevenue:e.totalRevenue?.[l]||0,c=r&&i?.totalCostOfGoodsSold?i.totalCostOfGoodsSold:e.totalCostOfGoodsSold?.[l]||0,o=r&&i?.grossProfit?i.grossProfit:e.grossProfit?.[l]||n-c,d=r&&i?.operatingIncome?i.operatingIncome:e.operatingIncome?.[l]||0;if(t.revenue.push(n),t.grossProfit.push(o),t.operatingIncome.push(d),t.margins.gross.push(n?o/n*100:0),t.margins.operating.push(n?d/n*100:0),l>0){const s=e.totalRevenue?.[l-1]||0,a=e.operatingIncome?.[l-1]||0;t.growth.revenue.push(s?(n-s)/s*100:0),t.growth.operating.push(a?(d-a)/a*100:0)}}),t},[a]),x=(e=null)=>{const{discountRate:s,terminalGrowthRate:t,projectionYears:i,taxRate:l}=c.dcf,r=e||a;let n;if(e?(n=[],r.periods.forEach((e,s)=>{s>0&&s<=i&&n.push(r.statements.incomeStatement.operatingIncome?.[s]||0)})):n=m.operatingIncome.slice(1,i+1),0===n.length)return{enterpriseValue:0,equityValue:0,sharePrice:0};let o=0;const d=1+s/100;n.forEach((e,s)=>{const t=e*(1-l/100)/Math.pow(d,s+1);o+=t});const x=(n[n.length-1]||0)*(1+t/100)*(1-l/100)/((s-t)/100),u=x/Math.pow(d,i),h=o+u;return{enterpriseValue:h,equityValue:h,presentValueOperations:o,presentValueTerminal:u,terminalValue:x}};x();const u=[{id:"dcf",label:"DCF Valuation",icon:v,description:"Discounted Cash Flow analysis"},{id:"ratios",label:"Ratio Analysis",icon:d,description:"Financial ratio comparison"},{id:"sensitivity",label:"Sensitivity Analysis",icon:h,description:"Variable impact analysis"},{id:"scenario",label:"Scenario Modeling",icon:C,description:"Multi-scenario projections"},{id:"comparable",label:"Comparable Analysis",icon:w,description:"Market-based valuation"},{id:"montecarlo",label:"Monte Carlo",icon:F,description:"Probabilistic risk analysis"}],g=(e,s,t)=>{o(a=>({...a,[e]:{...a[e],[s]:t}}))},p=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e),b=e=>`${e.toFixed(1)}%`;return t.jsxs("div",{className:"h-full bg-gray-900 text-white p-6",children:[t.jsxs("div",{className:"mb-8",children:[t.jsx("div",{className:"flex items-center justify-between mb-6",children:t.jsxs("div",{children:[t.jsx("h2",{className:"text-xl font-semibold text-white",children:"Financial Modeling"}),t.jsx("p",{className:"text-gray-400 text-sm mt-1",children:"Select a modeling approach to analyze your financial data"})]})}),t.jsx("div",{className:"flex flex-wrap gap-2 mb-6",children:u.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>n(e.id),className:(r===e.id?"bg-blue-600 text-white border-blue-500 shadow-lg":"bg-gray-800 text-gray-300 border-gray-700 hover:bg-gray-700 hover:text-white hover:border-gray-600")+" flex items-center gap-3 px-4 py-3 rounded-lg border transition-all duration-200",children:[t.jsx(s,{size:18,className:r===e.id?"text-white":"text-blue-400"}),t.jsx("span",{className:"font-medium",children:e.label})]},e.id)})}),t.jsx("div",{className:"bg-gray-800 border border-gray-700 rounded-lg p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[s.createElement(u.find(e=>e.id===r)?.icon,{size:20,className:"text-blue-400"}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-medium text-white",children:u.find(e=>e.id===r)?.label}),t.jsx("p",{className:"text-gray-400 text-sm",children:u.find(e=>e.id===r)?.description})]})]})})]}),t.jsxs("div",{children:["dcf"===r&&t.jsxs("div",{className:"p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[t.jsx(v,{size:20,className:"text-blue-400"}),"DCF Valuation Model"]}),t.jsx(re,{data:a,modelInputs:c,onModelInputChange:g,formatCurrency:p,formatPercent:b})]}),"ratios"===r&&t.jsxs("div",{className:"p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[t.jsx(d,{size:20}),"Financial Ratio Analysis"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Profitability Ratios"}),t.jsxs("div",{className:"space-y-3",children:[m.margins.gross.map((e,s)=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm",children:[a.periods[s+1]," Gross Margin:"]}),t.jsx("span",{className:"font-medium",children:b(e)})]},s)),m.margins.operating.map((e,s)=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm",children:[a.periods[s+1]," Operating Margin:"]}),t.jsx("span",{className:"font-medium",children:b(e)})]},s))]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Growth Rates"}),t.jsxs("div",{className:"space-y-3",children:[m.growth.revenue.map((e,s)=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm",children:[a.periods[s+1]," Revenue Growth:"]}),t.jsx("span",{className:"font-medium "+(e>=0?"text-green-600":"text-red-600"),children:b(e)})]},s)),m.growth.operating.map((e,s)=>t.jsxs("div",{className:"flex justify-between",children:[t.jsxs("span",{className:"text-sm",children:[a.periods[s+1]," Operating Growth:"]}),t.jsx("span",{className:"font-medium "+(e>=0?"text-green-600":"text-red-600"),children:b(e)})]},s))]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold mb-3 text-gray-200",children:"Industry Comparison"}),t.jsx("div",{className:"space-y-3",children:t.jsxs("div",{className:"p-3 bg-gray-700 rounded-lg",children:[t.jsx("div",{className:"text-xs text-gray-400 uppercase tracking-wide",children:"Industry Avg"}),t.jsxs("div",{className:"text-sm",children:["Gross Margin: ",b(c.ratios.industryAverages.grossMargin)]}),t.jsxs("div",{className:"text-sm",children:["Operating Margin: ",b(c.ratios.industryAverages.operatingMargin)]}),t.jsxs("div",{className:"text-sm",children:["Net Margin: ",b(c.ratios.industryAverages.netMargin)]})]})})]})]})]}),"sensitivity"===r&&t.jsxs("div",{className:"p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[t.jsx(h,{size:20}),"Sensitivity Analysis"]}),t.jsx(Re,{data:a,modelInputs:c,onModelInputChange:g,calculateDCF:x,formatCurrency:p,formatPercent:b})]}),"scenario"===r&&t.jsxs("div",{className:"p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2 text-white",children:[t.jsx(C,{size:20}),"Scenario Modeling"]}),t.jsx(Fe,{data:a,modelInputs:c,onModelInputChange:g,calculateDCF:x,formatCurrency:p,formatPercent:b})]}),"comparable"===r&&t.jsx("div",{className:"p-6",children:t.jsx(Ie,{data:a,formatCurrency:p,formatPercent:b})}),"montecarlo"===r&&t.jsxs("div",{className:"p-6",children:[t.jsxs("h3",{className:"text-xl font-semibold mb-4 flex items-center gap-2",children:[t.jsx(F,{size:20}),"Monte Carlo Simulation"]}),t.jsx(ne,{data:a,onDataChange:l})]})]})]})},Pe=({data:s,adjustedValues:i,modelInputs:l,calculateDCF:r,formatCurrency:n,formatPercentage:c})=>{const o=e.useMemo(()=>{try{if(!s?.statements?.incomeStatement)return null;const t=s.statements.incomeStatement,l=Object.keys(t.totalRevenue||{}).sort((e,s)=>parseInt(e)-parseInt(s));if(l.length<2)return null;const c=l[l.length-1],o=l[l.length-2],m=l[0],x=i?.totalRevenue||t.totalRevenue?.[c]||0,u=t.totalRevenue?.[o]||0,h=t.totalRevenue?.[m]||0,g=i?.grossProfit||t.grossProfit?.[c]||0,p=t.grossProfit?.[o]||0,b=i?.operatingIncome||t.operatingIncome?.[c]||0,f=t.operatingIncome?.[o]||0,v=(i?.totalCostOfGoodsSold||t.totalCostOfGoodsSold,t.totalCostOfGoodsSold,u?(x-u)/u*100:0),j=h&&l.length>2?100*(Math.pow(x/h,1/(l.length-1))-1):0,N=f?(b-f)/f*100:0,w=x&&0!==x?g/x*100:0,k=u&&0!==u?p/u*100:0,S=x&&0!==x?b/x*100:0,I=u&&0!==u?f/u*100:0,E=isFinite(w)&&isFinite(k)?w-k:0,P=isFinite(S)&&isFinite(I)?S-I:0;let D=null;if(r)try{D=r(s)}catch(e){}const T=[{name:"Energy Devices",value:Number(t.energyDevices?.[c])||0},{name:"Injectables",value:Number(t.injectables?.[c])||0},{name:"Wellness",value:Number(t.wellness?.[c])||0},{name:"Weightloss",value:Number(t.weightloss?.[c])||0},{name:"Retail Sales",value:Number(t.retailSales?.[c])||0},{name:"Surgery",value:Number(t.surgery?.[c])||0}].filter(e=>e.value>0&&isFinite(e.value)),V=t.totalAssets?.[c]||1.2*x,O=t.totalEquity?.[c]||.6*V,q=t.totalDebt?.[c]||.3*V,B=t.currentAssets?.[c]||.4*V,L=t.currentLiabilities?.[c]||.2*V,z=t.inventory?.[c]||.15*x,G=t.accountsReceivable?.[c]||.1*x,$=t.cashAndEquivalents?.[c]||.1*V,W=V&&0!==V?b/V*100:0,_=O&&0!==O?b/O*100:0,U=O&&0!==O?q/O:0,K=L&&0!==L?B/L:0,H=L&&0!==L?(B-z)/L:0,Y=V&&0!==V?x/V:0,Q=z&&0!==z?.7*x/z:0,X=G&&0!==G?x/G:0,J=L&&0!==L?$/L:0,Z=B-L,ee=x&&0!==x?Z/x:0,se=Q>0&&X>0?365/Q+365/X:0,te=se>0?se-30:0,ae=0!==p?N/v:0,ie=100*(S-I),le=O&&0!==O?V/O:0,re=t.interestExpense?.[c]?b/t.interestExpense[c]:0,ne=t.debtService?.[c]?b/t.debtService[c]:0,ce=t.employeeCount?.[c]?x/t.employeeCount[c]:0,oe=t.sharesOutstanding?.[c]?x/t.sharesOutstanding[c]:0,de=t.sharesOutstanding?.[c]&&O?O/t.sharesOutstanding[c]:0,me={grossMargin:65,operatingMargin:18,returnOnAssets:8,returnOnEquity:15,currentRatio:2.5,debtToEquity:.4,assetTurnover:.8,revenueGrowth:8},xe={grossMargin:w-me.grossMargin,operatingMargin:S-me.operatingMargin,returnOnAssets:W-me.returnOnAssets,returnOnEquity:_-me.returnOnEquity,currentRatio:K-me.currentRatio,debtToEquity:me.debtToEquity-U,assetTurnover:Y-me.assetTurnover,revenueGrowth:v-me.revenueGrowth},ue=[{title:"Revenue Growth",value:`${v>0?"+":""}${isFinite(v)?v.toFixed(1):"0.0"}%`,trend:v>0?"up":"down",description:"Year-over-year revenue growth rate",icon:a,benchmark:me.revenueGrowth,performance:xe.revenueGrowth},{title:"Gross Margin",value:`${isFinite(w)?w.toFixed(1):"0.0"}%`,trend:E>0?"up":"down",description:`${E>0?"+":""}${isFinite(E)?E.toFixed(1):"0.0"}% vs prior year`,icon:y,benchmark:me.grossMargin,performance:xe.grossMargin},{title:"Operating Margin",value:`${isFinite(S)?S.toFixed(1):"0.0"}%`,trend:P>0?"up":"down",description:`${P>0?"+":""}${isFinite(P)?P.toFixed(1):"0.0"}% vs prior year`,icon:d,benchmark:me.operatingMargin,performance:xe.operatingMargin},{title:"Return on Assets",value:`${isFinite(W)?W.toFixed(1):"0.0"}%`,trend:W>me.returnOnAssets?"up":"down",description:"Asset utilization efficiency",icon:C,benchmark:me.returnOnAssets,performance:xe.returnOnAssets},{title:"Return on Equity",value:`${isFinite(_)?_.toFixed(1):"0.0"}%`,trend:_>me.returnOnEquity?"up":"down",description:"Shareholder value generation",icon:R,benchmark:me.returnOnEquity,performance:xe.returnOnEquity},{title:"Current Ratio",value:`${isFinite(K)?K.toFixed(1):"0.0"}x`,trend:K>2?"up":K>1.5?"neutral":"down",description:"Short-term liquidity strength",icon:M,benchmark:me.currentRatio,performance:xe.currentRatio},{title:"Asset Turnover",value:`${isFinite(Y)?Y.toFixed(1):"0.0"}x`,trend:Y>me.assetTurnover?"up":"down",description:"Revenue per dollar of assets",icon:F,benchmark:me.assetTurnover,performance:xe.assetTurnover},{title:"Debt-to-Equity",value:`${isFinite(U)?U.toFixed(1):"0.0"}x`,trend:U<me.debtToEquity?"up":"down",description:"Financial leverage position",icon:A,benchmark:me.debtToEquity,performance:xe.debtToEquity}],he=[{name:"Current Ratio",value:K,formatted:`${K.toFixed(2)}x`,benchmark:2.5,status:K>=2.5?"excellent":K>=2?"good":K>=1.5?"fair":"poor"},{name:"Quick Ratio",value:H,formatted:`${H.toFixed(2)}x`,benchmark:1.5,status:H>=1.5?"excellent":H>=1?"good":H>=.8?"fair":"poor"},{name:"Cash Ratio",value:J,formatted:`${J.toFixed(2)}x`,benchmark:.5,status:J>=.5?"excellent":J>=.3?"good":J>=.2?"fair":"poor"},{name:"Working Capital",value:Z,formatted:n(Z),benchmark:.15*x,status:Z>=.15*x?"excellent":Z>=0?"good":"poor"}],ge=[{name:"Asset Turnover",value:Y,formatted:`${Y.toFixed(2)}x`,description:"Revenue generation per asset dollar"},{name:"Inventory Turnover",value:Q,formatted:`${Q.toFixed(1)}x`,description:"Inventory management efficiency"},{name:"Receivables Turnover",value:X,formatted:`${X.toFixed(1)}x`,description:"Collection efficiency"},{name:"Operating Cycle",value:se,formatted:`${se.toFixed(0)} days`,description:"Cash-to-cash cycle duration"}],pe=[{name:"Financial Leverage",value:le,formatted:`${le.toFixed(1)}x`,level:le<2?"low":le<3?"moderate":"high"},{name:"Debt-to-Equity",value:U,formatted:`${U.toFixed(2)}x`,level:U<.3?"low":U<.6?"moderate":"high"},{name:"Interest Coverage",value:re,formatted:`${re.toFixed(1)}x`,level:re>10?"low":re>5?"moderate":"high"}];return{periods:l,latest:c,previous:o,revenue:{latest:x,previous:u,growth:v,cagr:j},profitability:{grossMargin:w,grossMarginChange:E,operatingMargin:S,operatingMarginChange:P,operatingLeverage:ae,profitabilityTrend:ie},financial:{returnOnAssets:W,returnOnEquity:_,assetTurnover:Y,totalAssets:V,totalEquity:O,totalDebt:q,workingCapital:Z,workingCapitalRatio:ee},liquidity:{currentRatio:K,quickRatio:H,cashRatio:J,cashAndEquivalents:$,currentAssets:B,currentLiabilities:L},efficiency:{inventoryTurnover:Q,receivablesTurnover:X,operatingCycle:se,cashConversionCycle:te},risk:{debtToEquity:U,financialLeverage:le,interestCoverage:re,debtServiceCoverage:ne},market:{revenuePerEmployee:ce,revenuePerShare:oe,bookValuePerShare:de},benchmarks:{industry:me,comparison:xe},dcf:D,revenueBreakdown:T,kpis:ue,liquidityMetrics:he,efficiencyMetrics:ge,riskMetrics:pe}}catch(e){return null}},[s,r]);if(!o)return t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(I,{className:"mx-auto h-12 w-12 text-yellow-400 mb-4"}),t.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Insufficient Data"}),t.jsx("p",{className:"text-gray-500",children:"Please ensure financial data is loaded to generate analysis results."})]})});const x=({title:e,value:s,trend:i,description:l,icon:r,benchmark:n,performance:c})=>t.jsxs("div",{className:"bg-gray-800 rounded-xl p-6 border border-gray-700 hover:border-gray-600 transition-all duration-200",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg "+("up"===i?"bg-green-900/30 text-green-400":"down"===i?"bg-red-900/30 text-red-400":"bg-gray-700 text-gray-400"),children:t.jsx(r,{className:"h-5 w-5"})}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-gray-300",children:e}),t.jsx("div",{className:"text-xs text-gray-500 mt-1",children:l})]})]}),"up"===i&&t.jsx(a,{className:"h-5 w-5 text-green-400 flex-shrink-0"}),"down"===i&&t.jsx(m,{className:"h-5 w-5 text-red-400 flex-shrink-0"})]}),t.jsx("div",{className:"text-3xl font-bold text-white mb-2",children:s}),n&&t.jsxs("div",{className:"border-t border-gray-700 pt-3 mt-3",children:[t.jsxs("div",{className:"flex justify-between text-xs",children:[t.jsx("span",{className:"text-gray-400",children:"Industry Avg:"}),t.jsx("span",{className:"text-gray-300",children:"number"==typeof n?n.toFixed(1)+(e.includes("%")?"%":e.includes("x")?"x":""):n})]}),t.jsxs("div",{className:"flex justify-between text-xs mt-1",children:[t.jsx("span",{className:"text-gray-400",children:"vs Industry:"}),t.jsxs("span",{className:"font-medium "+(c>0?"text-green-400":c<0?"text-red-400":"text-gray-300"),children:[c>0?"+":"",c?.toFixed(1)||"0.0"]})]})]})]});return t.jsxs("div",{className:"space-y-6 p-6 bg-gray-900 text-white h-full",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("h2",{className:"text-2xl font-bold text-white mb-6 flex items-center",children:[t.jsx(d,{className:"h-6 w-6 text-blue-400 mr-3"}),"Financial Analysis Results"]}),t.jsx("p",{className:"text-gray-400",children:"Comprehensive analysis of your company's financial performance and valuation"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.kpis.map((e,s)=>t.jsx(x,{...e},s))}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 overflow-hidden",children:[t.jsxs("div",{className:"flex border-b border-gray-700",children:[t.jsx("button",{className:"px-6 py-3 text-sm font-medium text-white bg-blue-600 border-r border-gray-700",children:"Liquidity Analysis"}),t.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Efficiency Metrics"}),t.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white border-r border-gray-700",children:"Risk Assessment"}),t.jsx("button",{className:"px-6 py-3 text-sm font-medium text-gray-400 hover:text-white",children:"Benchmarking"})]}),t.jsxs("div",{className:"p-6",children:[t.jsxs("div",{className:"flex items-center mb-4",children:[t.jsx(M,{className:"h-5 w-5 text-blue-400 mr-2"}),t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Liquidity Position Analysis"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.liquidityMetrics.map((e,s)=>t.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-200",children:e.name}),t.jsx("span",{className:"px-2 py-1 rounded text-xs font-medium "+("excellent"===e.status?"bg-green-900/30 text-green-400":"good"===e.status?"bg-blue-900/30 text-blue-400":"fair"===e.status?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:e.status})]}),t.jsx("div",{className:"text-xl font-bold text-white mb-1",children:e.formatted}),t.jsxs("div",{className:"text-xs text-gray-400",children:["Benchmark: ","number"==typeof e.benchmark?e.benchmark.toFixed(1)+"x":n(e.benchmark)]})]},s))}),t.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[t.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[t.jsx(b,{className:"h-4 w-4 text-blue-400 mr-2"}),"Liquidity Analysis Summary"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Working Capital:"}),t.jsx("span",{className:"text-white ml-2 font-medium",children:n(o.financial.workingCapital)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Cash Position:"}),t.jsx("span",{className:"text-white ml-2 font-medium",children:n(o.liquidity.cashAndEquivalents)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Current Assets:"}),t.jsx("span",{className:"text-white ml-2 font-medium",children:n(o.liquidity.currentAssets)})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Current Liabilities:"}),t.jsx("span",{className:"text-white ml-2 font-medium",children:n(o.liquidity.currentLiabilities)})]})]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("div",{className:"flex items-center mb-6",children:[t.jsx(F,{className:"h-5 w-5 text-orange-400 mr-2"}),t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Operational Efficiency Metrics"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:o.efficiencyMetrics.map((e,s)=>t.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[t.jsx("div",{className:"text-sm font-medium text-gray-200 mb-2",children:e.name}),t.jsx("div",{className:"text-xl font-bold text-white mb-1",children:e.formatted}),t.jsx("div",{className:"text-xs text-gray-400",children:e.description})]},s))}),t.jsxs("div",{className:"mt-6 grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(E,{className:"h-4 w-4 text-orange-400 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Cash Conversion"})]}),t.jsxs("div",{className:"text-lg font-bold text-white",children:[o.efficiency.cashConversionCycle.toFixed(0)," days"]}),t.jsx("div",{className:"text-xs text-gray-400",children:"Time to convert inventory to cash"})]}),t.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(P,{className:"h-4 w-4 text-orange-400 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Asset Productivity"})]}),t.jsxs("div",{className:"text-lg font-bold text-white",children:[o.financial.assetTurnover.toFixed(2),"x"]}),t.jsx("div",{className:"text-xs text-gray-400",children:"Revenue per dollar of assets"})]}),t.jsxs("div",{className:"bg-gray-750 rounded-lg p-4 border border-gray-600",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(w,{className:"h-4 w-4 text-orange-400 mr-2"}),t.jsx("span",{className:"text-sm font-medium text-gray-200",children:"Revenue/Employee"})]}),t.jsx("div",{className:"text-lg font-bold text-white",children:o.market.revenuePerEmployee>0?n(o.market.revenuePerEmployee):"N/A"}),t.jsx("div",{className:"text-xs text-gray-400",children:"Productivity per employee"})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("div",{className:"flex items-center mb-6",children:[t.jsx(I,{className:"h-5 w-5 text-red-400 mr-2"}),t.jsx("h3",{className:"text-lg font-semibold text-white",children:"Financial Risk Assessment"})]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:o.riskMetrics.map((e,s)=>t.jsxs("div",{className:"bg-gray-700 rounded-lg p-4 border border-gray-600",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-200",children:e.name}),t.jsxs("span",{className:"px-2 py-1 rounded text-xs font-medium "+("low"===e.level?"bg-green-900/30 text-green-400":"moderate"===e.level?"bg-yellow-900/30 text-yellow-400":"bg-red-900/30 text-red-400"),children:[e.level," risk"]})]}),t.jsx("div",{className:"text-xl font-bold text-white",children:e.formatted})]},s))}),t.jsxs("div",{className:"mt-6 p-4 bg-gray-750 rounded-lg border border-gray-600",children:[t.jsxs("h4",{className:"font-medium text-gray-200 mb-3 flex items-center",children:[t.jsx(M,{className:"h-4 w-4 text-red-400 mr-2"}),"Risk Analysis Summary"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Financial Leverage:"}),t.jsxs("span",{className:"ml-2 font-medium "+(o.risk.financialLeverage<2?"text-green-400":o.risk.financialLeverage<3?"text-yellow-400":"text-red-400"),children:[o.risk.financialLeverage.toFixed(1),"x"]})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-400",children:"Interest Coverage:"}),t.jsxs("span",{className:"ml-2 font-medium "+(o.risk.interestCoverage>10?"text-green-400":o.risk.interestCoverage>5?"text-yellow-400":"text-red-400"),children:[o.risk.interestCoverage.toFixed(1),"x"]})]})]})]})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[t.jsx(h,{className:"h-5 w-5 text-purple-400 mr-2"}),"Performance Trends"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Revenue Analysis"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"Latest Period:"}),t.jsx("span",{className:"font-semibold text-white",children:n(o.revenue.latest)})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"YoY Growth:"}),t.jsxs("span",{className:"font-semibold "+(o.revenue.growth>0?"text-green-400":"text-red-400"),children:[o.revenue.growth>0?"+":"",o.revenue.growth.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"CAGR:"}),t.jsxs("span",{className:"font-semibold text-gray-200",children:[o.revenue.cagr.toFixed(1),"%"]})]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-200 mb-3",children:"Profitability Margins"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"Gross Margin:"}),t.jsxs("span",{className:"font-semibold text-white",children:[o.profitability.grossMargin.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"Operating Margin:"}),t.jsxs("span",{className:"font-semibold text-white",children:[o.profitability.operatingMargin.toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsx("span",{className:"text-sm text-gray-400",children:"Margin Change:"}),t.jsxs("span",{className:"font-semibold "+(o.profitability.grossMarginChange>0?"text-green-400":"text-red-400"),children:[o.profitability.grossMarginChange>0?"+":"",o.profitability.grossMarginChange.toFixed(1),"pp"]})]})]})]})]})]}),o.dcf&&t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[t.jsx(v,{className:"h-5 w-5 text-green-400 mr-2"}),"DCF Valuation Summary"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"text-center p-4 bg-green-900/30 border border-green-700 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-green-400",children:n(o.dcf.enterpriseValue)}),t.jsx("div",{className:"text-sm text-green-300",children:"Enterprise Value"})]}),t.jsxs("div",{className:"text-center p-4 bg-blue-900/30 border border-blue-700 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-400",children:n(o.dcf.sharePrice)}),t.jsx("div",{className:"text-sm text-blue-300",children:"Price per Share"})]}),t.jsxs("div",{className:"text-center p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[t.jsx("div",{className:"text-2xl font-bold text-gray-300",children:n(o.dcf.terminalValue)}),t.jsx("div",{className:"text-sm text-gray-400",children:"Terminal Value"})]})]})]})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[t.jsx(f,{className:"h-5 w-5 text-orange-400 mr-2"}),"Business Unit Performance"]}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:o.revenueBreakdown.map((e,s)=>{const a=o.revenue.latest?e.value/o.revenue.latest*100:0;return t.jsxs("div",{className:"p-4 bg-gray-700 border border-gray-600 rounded-lg",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"font-medium text-gray-200",children:e.name}),t.jsxs("span",{className:"text-sm text-gray-400",children:[a.toFixed(1),"%"]})]}),t.jsx("div",{className:"text-lg font-semibold text-white mb-1",children:n(e.value)}),t.jsx("div",{className:"w-full bg-gray-600 rounded-full h-2",children:t.jsx("div",{className:"bg-blue-500 h-2 rounded-full",style:{width:`${Math.min(a,100)}%`}})})]},s)})})]}),t.jsxs("div",{className:"bg-gray-800 rounded-lg border border-gray-700 p-6",children:[t.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center text-white",children:[t.jsx(D,{className:"h-5 w-5 text-green-400 mr-2"}),"Key Financial Insights"]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Strengths"}),t.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[o.revenue.growth>0&&t.jsxs("li",{className:"flex items-center",children:[t.jsx(D,{className:"h-4 w-4 text-green-500 mr-2"}),"Positive revenue growth trajectory"]}),o.profitability.grossMargin>60&&t.jsxs("li",{className:"flex items-center",children:[t.jsx(D,{className:"h-4 w-4 text-green-500 mr-2"}),"Strong gross margin above 60%"]}),o.profitability.grossMarginChange>0&&t.jsxs("li",{className:"flex items-center",children:[t.jsx(D,{className:"h-4 w-4 text-green-500 mr-2"}),"Improving profitability margins"]}),t.jsxs("li",{className:"flex items-center",children:[t.jsx(D,{className:"h-4 w-4 text-green-500 mr-2"}),"Diversified healthcare revenue streams"]})]})]}),t.jsxs("div",{children:[t.jsx("h4",{className:"font-medium text-gray-200 mb-2",children:"Areas for Focus"}),t.jsxs("ul",{className:"space-y-1 text-sm text-gray-400",children:[o.revenue.growth<5&&t.jsxs("li",{className:"flex items-center",children:[t.jsx(I,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Revenue growth below industry benchmarks"]}),o.profitability.operatingMargin<20&&t.jsxs("li",{className:"flex items-center",children:[t.jsx(I,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Operating margin optimization opportunities"]}),t.jsxs("li",{className:"flex items-center",children:[t.jsx(I,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Monitor competitive positioning in key segments"]}),t.jsxs("li",{className:"flex items-center",children:[t.jsx(I,{className:"h-4 w-4 text-yellow-500 mr-2"}),"Consider strategic initiatives for growth acceleration"]})]})]})]})]})]})},De=({data:s,onDataChange:i})=>{const[n,c]=e.useState("income"),[o,d]=e.useState({revenue:[1e5,105e3,110250,115763,121551],costOfGoodsSold:[6e4,63e3,66150,69458,72931],grossProfit:[4e4,42e3,44100,46305,48620],operatingExpenses:[25e3,26250,27563,28941,30388],ebitda:[15e3,15750,16538,17364,18232],depreciation:[3e3,3150,3308,3473,3647],ebit:[12e3,12600,13230,13891,14585],interestExpense:[2e3,1800,1580,1340,1080],ebt:[1e4,10800,11650,12551,13505],taxes:[2100,2268,2447,2636,2836],netIncome:[7900,8532,9203,9915,10669],cash:[5e3,8532,12735,17650,23319],accountsReceivable:[8333,8750,9188,9647,10129],inventory:[1e4,10500,11025,11576,12155],totalCurrentAssets:[23333,27782,32948,38873,45603],ppe:[5e4,51850,53543,55070,56423],totalAssets:[73333,79632,86491,93943,102026],accountsPayable:[5e3,5250,5513,5789,6078],shortTermDebt:[3e3,2e3,1e3,0,0],totalCurrentLiabilities:[8e3,7250,6513,5789,6078],longTermDebt:[25e3,23e3,21e3,19e3,17e3],totalLiabilities:[33e3,30250,27513,24789,23078],shareholderEquity:[40333,49382,58978,69154,78948],totalLiabilitiesEquity:[73333,79632,86491,93943,102026],operatingCashFlow:[8567,10233,11345,12464,13584],capex:[-5e3,-4850,-5e3,-5e3,-5e3],investingCashFlow:[-5e3,-4850,-5e3,-5e3,-5e3],debtRepayment:[-2e3,-2e3,-2e3,-2e3,-2e3],financingCashFlow:[-2e3,-2e3,-2e3,-2e3,-2e3],netCashFlow:[1567,3383,4345,5464,6584],endingCash:[5e3,8383,12728,18192,24776]}),[m,x]=e.useState({revenueGrowthRate:.05,cogsPercentOfRevenue:.6,opexGrowthRate:.05,taxRate:.21,depreciationRate:.06,capexPercentOfRevenue:.05,debtPaydown:2e3}),[u,g]=e.useState([]),p=["Year 1","Year 2","Year 3","Year 4","Year 5"],b=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(1e3*e):"$0",[]),f=e.useCallback(()=>{const e={...o};for(let t=1;t<5;t++){e.revenue[t]=e.revenue[t-1]*(1+m.revenueGrowthRate),e.costOfGoodsSold[t]=e.revenue[t]*m.cogsPercentOfRevenue,e.grossProfit[t]=e.revenue[t]-e.costOfGoodsSold[t],e.operatingExpenses[t]=e.operatingExpenses[t-1]*(1+m.opexGrowthRate),e.ebitda[t]=e.grossProfit[t]-e.operatingExpenses[t],e.depreciation[t]=e.ppe[t-1]*m.depreciationRate,e.ebit[t]=e.ebitda[t]-e.depreciation[t],e.interestExpense[t]=.06*e.longTermDebt[t-1],e.ebt[t]=e.ebit[t]-e.interestExpense[t],e.taxes[t]=Math.max(0,e.ebt[t]*m.taxRate),e.netIncome[t]=e.ebt[t]-e.taxes[t];const s=e.revenue[t]*m.capexPercentOfRevenue;e.ppe[t]=e.ppe[t-1]+s-e.depreciation[t],e.longTermDebt[t]=Math.max(0,e.longTermDebt[t-1]-m.debtPaydown),e.shortTermDebt[t]=Math.max(0,e.shortTermDebt[t-1]-1e3),e.accountsReceivable[t]=.083*e.revenue[t],e.inventory[t]=.1*e.costOfGoodsSold[t],e.accountsPayable[t]=.05*e.costOfGoodsSold[t];const a=e.accountsReceivable[t]-e.accountsReceivable[t-1]+(e.inventory[t]-e.inventory[t-1])-(e.accountsPayable[t]-e.accountsPayable[t-1]);e.operatingCashFlow[t]=e.netIncome[t]+e.depreciation[t]-a,e.capex[t]=-s,e.investingCashFlow[t]=e.capex[t],e.debtRepayment[t]=-m.debtPaydown,e.financingCashFlow[t]=e.debtRepayment[t],e.netCashFlow[t]=e.operatingCashFlow[t]+e.investingCashFlow[t]+e.financingCashFlow[t],e.endingCash[t]=e.cash[t-1]+e.netCashFlow[t],e.cash[t]=e.endingCash[t],e.totalCurrentAssets[t]=e.cash[t]+e.accountsReceivable[t]+e.inventory[t],e.totalAssets[t]=e.totalCurrentAssets[t]+e.ppe[t],e.totalCurrentLiabilities[t]=e.accountsPayable[t]+e.shortTermDebt[t],e.totalLiabilities[t]=e.totalCurrentLiabilities[t]+e.longTermDebt[t],e.shareholderEquity[t]=e.totalAssets[t]-e.totalLiabilities[t],e.totalLiabilitiesEquity[t]=e.totalLiabilities[t]+e.shareholderEquity[t]}d(e);const s=[];for(let t=0;t<5;t++)Math.abs(e.totalAssets[t]-e.totalLiabilitiesEquity[t])>1&&s.push(`Balance sheet doesn't balance in ${p[t]}`);g(s)},[o,m,p]),y=e.useCallback((e,s)=>{x(t=>({...t,[e]:parseFloat(s)||0}))},[]),v=[{id:"income",label:"Income Statement",icon:a},{id:"balance",label:"Balance Sheet",icon:O},{id:"cashflow",label:"Cash Flow",icon:h},{id:"assumptions",label:"Assumptions",icon:r}];return t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(l,{className:"text-green-600",size:28}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"3-Statement Financial Model"}),t.jsx("p",{className:"text-gray-600",children:"Integrated Income Statement, Balance Sheet & Cash Flow"})]})]}),t.jsxs(_.button,{onClick:f,className:"px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[t.jsx(T,{size:16}),t.jsx("span",{children:"Recalculate"})]})]}),0===u.length?t.jsxs("div",{className:"mb-6 p-3 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[t.jsx(D,{className:"text-green-500 mr-2",size:20}),t.jsx("span",{className:"text-green-800 font-medium",children:"Model is balanced and consistent"})]}):t.jsxs("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(V,{className:"text-red-500 mr-2",size:20}),t.jsx("h3",{className:"font-semibold text-red-800",children:"Validation Errors"})]}),t.jsx("ul",{className:"text-sm text-red-700",children:u.map((e,s)=>t.jsxs("li",{children:["• ",e]},s))})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsx("nav",{className:"-mb-px flex space-x-8",children:v.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>c(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(n===e.id?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[t.jsx(s,{size:16}),t.jsx("span",{children:e.label})]},e.id)})})}),"income"===n&&t.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-gray-300",children:[t.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Income Statement ($000s)"}),p.map(e=>t.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),t.jsx("tbody",{children:[{label:"Revenue",key:"revenue"},{label:"Cost of Goods Sold",key:"costOfGoodsSold"},{label:"Gross Profit",key:"grossProfit"},{label:"Operating Expenses",key:"operatingExpenses"},{label:"EBITDA",key:"ebitda"},{label:"Depreciation",key:"depreciation"},{label:"EBIT",key:"ebit"},{label:"Interest Expense",key:"interestExpense"},{label:"EBT",key:"ebt"},{label:"Taxes",key:"taxes"},{label:"Net Income",key:"netIncome"}].map(e=>t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("td",{className:"py-2 px-4 font-medium",children:e.label}),o[e.key]?.map((e,s)=>t.jsx("td",{className:"text-right py-2 px-4",children:b(e)},s))]},e.key))})]})})}),"balance"===n&&t.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-gray-300",children:[t.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Balance Sheet ($000s)"}),p.map(e=>t.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),t.jsxs("tbody",{children:[t.jsx("tr",{className:"bg-gray-100",children:t.jsx("td",{colSpan:6,className:"py-2 px-4 font-semibold",children:"ASSETS"})}),[{label:"Cash",key:"cash"},{label:"Accounts Receivable",key:"accountsReceivable"},{label:"Inventory",key:"inventory"},{label:"Total Current Assets",key:"totalCurrentAssets"},{label:"PP&E",key:"ppe"},{label:"Total Assets",key:"totalAssets"}].map(e=>t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("td",{className:"py-2 px-4",children:e.label}),o[e.key]?.map((e,s)=>t.jsx("td",{className:"text-right py-2 px-4",children:b(e)},s))]},e.key)),t.jsx("tr",{className:"bg-gray-100",children:t.jsx("td",{colSpan:6,className:"py-2 px-4 font-semibold",children:"LIABILITIES & EQUITY"})}),[{label:"Accounts Payable",key:"accountsPayable"},{label:"Short-term Debt",key:"shortTermDebt"},{label:"Total Current Liabilities",key:"totalCurrentLiabilities"},{label:"Long-term Debt",key:"longTermDebt"},{label:"Total Liabilities",key:"totalLiabilities"},{label:"Shareholder Equity",key:"shareholderEquity"},{label:"Total Liab. & Equity",key:"totalLiabilitiesEquity"}].map(e=>t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("td",{className:"py-2 px-4",children:e.label}),o[e.key]?.map((e,s)=>t.jsx("td",{className:"text-right py-2 px-4",children:b(e)},s))]},e.key))]})]})})}),"cashflow"===n&&t.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-gray-300",children:[t.jsx("th",{className:"text-left py-3 px-4 font-semibold",children:"Cash Flow Statement ($000s)"}),p.map(e=>t.jsx("th",{className:"text-right py-3 px-4 font-semibold",children:e},e))]})}),t.jsx("tbody",{children:[{label:"Operating Cash Flow",key:"operatingCashFlow"},{label:"CapEx",key:"capex"},{label:"Investing Cash Flow",key:"investingCashFlow"},{label:"Debt Repayment",key:"debtRepayment"},{label:"Financing Cash Flow",key:"financingCashFlow"},{label:"Net Cash Flow",key:"netCashFlow"},{label:"Ending Cash",key:"endingCash"}].map(e=>t.jsxs("tr",{className:"border-b border-gray-200",children:[t.jsx("td",{className:"py-2 px-4",children:e.label}),o[e.key]?.map((e,s)=>t.jsx("td",{className:"text-right py-2 px-4",children:b(e)},s))]},e.key))})]})})}),"assumptions"===n&&t.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Key Assumptions"}),t.jsx("div",{className:"space-y-3",children:[{label:"Revenue Growth Rate (%)",key:"revenueGrowthRate",isPercent:!0},{label:"COGS % of Revenue",key:"cogsPercentOfRevenue",isPercent:!0},{label:"OpEx Growth Rate (%)",key:"opexGrowthRate",isPercent:!0},{label:"Tax Rate (%)",key:"taxRate",isPercent:!0},{label:"CapEx % of Revenue",key:"capexPercentOfRevenue",isPercent:!0},{label:"Annual Debt Paydown ($000s)",key:"debtPaydown",isPercent:!1}].map(e=>t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:e.label}),t.jsx("input",{type:"number",step:"0.01",value:e.isPercent?100*m[e.key]:m[e.key],onChange:s=>y(e.key,e.isPercent?(s.target.value||0)/100:s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]},e.key))})]}),t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-4",children:"Model Metrics"}),t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"5-Year Revenue CAGR:"}),t.jsxs("span",{className:"font-medium",children:[(100*(Math.pow(o.revenue[4]/o.revenue[0],1/4)-1)).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"5-Year EBITDA CAGR:"}),t.jsxs("span",{className:"font-medium",children:[(100*(Math.pow(o.ebitda[4]/o.ebitda[0],1/4)-1)).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Exit EBITDA Margin:"}),t.jsxs("span",{className:"font-medium",children:[(o.ebitda[4]/o.revenue[4]*100).toFixed(1),"%"]})]}),t.jsxs("div",{className:"flex justify-between",children:[t.jsx("span",{children:"Exit Debt/EBITDA:"}),t.jsxs("span",{className:"font-medium",children:[(o.longTermDebt[4]/o.ebitda[4]).toFixed(1),"x"]})]})]})]})]})})]})},Te=({data:s,onDataChange:l})=>{const[r,n]=e.useState("overview"),[c,o]=e.useState([{symbol:"SPY",name:"SPDR S&P 500 ETF",price:445.67,change:2.34,changePercent:.53,category:"index"},{symbol:"QQQ",name:"Invesco QQQ Trust",price:378.91,change:-1.45,changePercent:-.38,category:"index"},{symbol:"VIX",name:"CBOE Volatility Index",price:18.45,change:.87,changePercent:4.95,category:"volatility"},{symbol:"DXY",name:"US Dollar Index",price:102.45,change:-.23,changePercent:-.22,category:"currency"},{symbol:"^TNX",name:"10-Year Treasury Yield",price:4.25,change:.05,changePercent:1.19,category:"rates"}]),[u,p]=e.useState({indices:{"S&P 500":{value:4456.78,change:23.45,changePercent:.53},NASDAQ:{value:13789.45,change:-45.67,changePercent:-.33},DOW:{value:34567.89,change:156.78,changePercent:.46},"Russell 2000":{value:1987.65,change:12.34,changePercent:.63}},sectors:[{name:"Technology",change:1.2,weight:23.5},{name:"Healthcare",change:.8,weight:13.2},{name:"Financial",change:-.4,weight:12.8},{name:"Consumer Disc.",change:.6,weight:10.9},{name:"Communication",change:-.2,weight:9.1},{name:"Industrials",change:.9,weight:8.7}],economicIndicators:{"Fed Funds Rate":{value:5.25,change:0,unit:"%"},"10Y Treasury":{value:4.25,change:.05,unit:"%"},"Inflation (CPI)":{value:3.1,change:-.2,unit:"%"},Unemployment:{value:3.8,change:.1,unit:"%"},"GDP Growth":{value:2.4,change:.1,unit:"%"}}}),[b,f]=e.useState([{id:1,type:"price",symbol:"SPY",condition:"above",value:450,active:!0},{id:2,type:"volatility",symbol:"VIX",condition:"above",value:20,active:!0}]),[y,v]=e.useState(""),[j,N]=e.useState(!1),w=e.useCallback(e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:2,maximumFractionDigits:2}).format(e),[]),C=e.useCallback(e=>`${e>=0?"+":""}${e.toFixed(2)}%`,[]),k=e.useCallback(e=>e>0?"text-green-600":e<0?"text-red-600":"text-gray-600",[]),S=e.useCallback(e=>e>0?a:e<0?m:x,[]);e.useEffect(()=>{const e=setInterval(()=>{o(e=>e.map(e=>({...e,price:e.price+2*(Math.random()-.5),change:e.change+.5*(Math.random()-.5),changePercent:e.changePercent+.1*(Math.random()-.5)})))},5e3);return()=>clearInterval(e)},[]);const F=e.useCallback(async()=>{if(y.trim()){N(!0);try{await new Promise(e=>setTimeout(e,1e3));const e={symbol:y.toUpperCase(),name:`${y.toUpperCase()} Inc.`,price:200*Math.random()+50,change:10*(Math.random()-.5),changePercent:5*(Math.random()-.5),category:"stock"};o(s=>[...s,e]),v("")}catch(e){}finally{N(!1)}}},[y]),R=e.useCallback(e=>{o(s=>s.filter(s=>s.symbol!==e))},[]),M=e.useMemo(()=>{const e=new Date;return Array.from({length:30},(s,t)=>({time:new Date(e.getTime()-24*(29-t)*60*60*1e3).toLocaleDateString(),SPY:440+10*Math.sin(.2*t)+5*Math.random(),QQQ:370+15*Math.sin(.25*t)+8*Math.random(),VIX:20+5*Math.sin(.3*t)+3*Math.random()}))},[]),A=e.useMemo(()=>[{pair:"SPY vs QQQ",correlation:.85,strength:"Strong Positive"},{pair:"SPY vs VIX",correlation:-.72,strength:"Strong Negative"},{pair:"QQQ vs VIX",correlation:-.68,strength:"Moderate Negative"},{pair:"SPY vs DXY",correlation:-.45,strength:"Moderate Negative"}],[]);return t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(h,{className:"text-blue-600",size:28}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Enhanced Market Data Dashboard"}),t.jsx("p",{className:"text-gray-600",children:"Real-time market insights & valuation integration"})]})]}),t.jsxs("div",{className:"flex space-x-3",children:[t.jsxs(_.button,{className:"px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[t.jsx(T,{size:16}),t.jsx("span",{children:"Sync Data"})]}),t.jsxs(_.button,{className:"px-4 py-2 bg-gray-600 hover:bg-gray-700 text-white rounded-lg flex items-center space-x-2",whileHover:{scale:1.02},children:[t.jsx(g,{size:16}),t.jsx("span",{children:"Settings"})]})]})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsx("nav",{className:"-mb-px flex space-x-8",children:[{id:"overview",label:"Market Overview",icon:q},{id:"watchlist",label:"Watchlist",icon:d},{id:"charts",label:"Charts & Analysis",icon:B},{id:"alerts",label:"Alerts",icon:L}].map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>n(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(r===e.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[t.jsx(s,{size:16}),t.jsx("span",{children:e.label})]},e.id)})})}),"overview"===r&&t.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Major Indices"}),t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:Object.entries(u.indices).map(([e,s])=>{const a=S(s.change);return t.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e}),t.jsx("div",{className:"text-xl font-bold text-gray-800",children:s.value.toLocaleString()}),t.jsxs("div",{className:`flex items-center space-x-1 text-sm ${k(s.change)}`,children:[t.jsx(a,{size:14}),t.jsxs("span",{children:[s.change>0?"+":"",s.change.toFixed(2)]}),t.jsxs("span",{children:["(",C(s.changePercent),")"]})]})]},e)})})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Sector Performance"}),t.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:t.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:u.sectors.map(e=>t.jsxs("div",{className:"flex justify-between items-center",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:e.name}),t.jsxs("div",{className:"text-sm text-gray-600",children:[e.weight,"% weight"]})]}),t.jsx("div",{className:`font-semibold ${k(e.change)}`,children:C(e.change)})]},e.name))})})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Economic Indicators"}),t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:Object.entries(u.economicIndicators).map(([e,s])=>t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-sm text-gray-600 mb-1",children:e}),t.jsxs("div",{className:"text-lg font-bold text-gray-800",children:[s.value,s.unit]}),t.jsxs("div",{className:`text-sm ${k(s.change)}`,children:[s.change>0?"+":"",s.change,s.unit]})]},e))})]})]}),"watchlist"===r&&t.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{className:"flex space-x-3",children:[t.jsx("div",{className:"flex-1",children:t.jsx("input",{type:"text",placeholder:"Enter symbol (e.g., AAPL, MSFT)",value:y,onChange:e=>v(e.target.value.toUpperCase()),onKeyPress:e=>"Enter"===e.key&&F(),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),t.jsxs(_.button,{onClick:F,disabled:j||!y.trim(),className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(j||!y.trim()?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"),whileHover:!j&&y.trim()?{scale:1.02}:{},children:[t.jsx(i,{size:16}),t.jsx("span",{children:j?"Adding...":"Add"})]})]}),t.jsx("div",{className:"overflow-x-auto",children:t.jsxs("table",{className:"w-full",children:[t.jsx("thead",{children:t.jsxs("tr",{className:"border-b-2 border-gray-300",children:[t.jsx("th",{className:"text-left py-3 px-4",children:"Symbol"}),t.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Price"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Change"}),t.jsx("th",{className:"text-right py-3 px-4",children:"Change %"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Category"}),t.jsx("th",{className:"text-center py-3 px-4",children:"Actions"})]})}),t.jsx("tbody",{children:c.map(e=>{const s=S(e.change);return t.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50",children:[t.jsx("td",{className:"py-3 px-4 font-medium text-gray-800",children:e.symbol}),t.jsx("td",{className:"py-3 px-4 text-gray-600",children:e.name}),t.jsx("td",{className:"text-right py-3 px-4 font-medium",children:w(e.price)}),t.jsx("td",{className:`text-right py-3 px-4 ${k(e.change)}`,children:t.jsxs("div",{className:"flex items-center justify-end space-x-1",children:[t.jsx(s,{size:14}),t.jsxs("span",{children:[e.change>0?"+":"",e.change.toFixed(2)]})]})}),t.jsx("td",{className:`text-right py-3 px-4 font-medium ${k(e.changePercent)}`,children:C(e.changePercent)}),t.jsx("td",{className:"text-center py-3 px-4",children:t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+("index"===e.category?"bg-blue-100 text-blue-800":"stock"===e.category?"bg-green-100 text-green-800":"volatility"===e.category?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:e.category})}),t.jsx("td",{className:"text-center py-3 px-4",children:t.jsx("button",{onClick:()=>R(e.symbol),className:"text-red-600 hover:text-red-800",children:t.jsx(x,{size:16})})})]},e.symbol)})})]})})]}),"charts"===r&&t.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"30-Day Price Performance"}),t.jsx("div",{className:"h-80",children:t.jsx(K,{width:"100%",height:"100%",children:t.jsxs(ae,{data:M,children:[t.jsx(Y,{strokeDasharray:"3 3"}),t.jsx(Q,{dataKey:"time"}),t.jsx(X,{}),t.jsx(J,{}),t.jsx(le,{type:"monotone",dataKey:"SPY",stroke:"#3B82F6",strokeWidth:2,name:"S&P 500"}),t.jsx(le,{type:"monotone",dataKey:"QQQ",stroke:"#10B981",strokeWidth:2,name:"NASDAQ"}),t.jsx(le,{type:"monotone",dataKey:"VIX",stroke:"#EF4444",strokeWidth:2,name:"VIX"})]})})})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Correlation Analysis"}),t.jsx("div",{className:"space-y-3",children:A.map((e,s)=>t.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg",children:[t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:e.pair}),t.jsx("div",{className:"text-sm text-gray-600",children:e.strength})]}),t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx("div",{className:"text-lg font-bold "+(Math.abs(e.correlation)>.7?"text-red-600":Math.abs(e.correlation)>.4?"text-yellow-600":"text-green-600"),children:e.correlation.toFixed(2)}),t.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"h-2 rounded-full "+(Math.abs(e.correlation)>.7?"bg-red-600":Math.abs(e.correlation)>.4?"bg-yellow-600":"bg-green-600"),style:{width:100*Math.abs(e.correlation)+"%"}})})]})]},s))})]})]}),"alerts"===r&&t.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Active Alerts"}),t.jsx("div",{className:"space-y-3",children:b.map(e=>t.jsxs("div",{className:"flex items-center justify-between p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(L,{className:"text-yellow-600",size:20}),t.jsxs("div",{children:[t.jsxs("div",{className:"font-medium text-gray-800",children:[e.symbol," ",e.type," alert"]}),t.jsxs("div",{className:"text-sm text-gray-600",children:["Notify when ",e.type," goes ",e.condition," ",e.value]})]})]}),t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium "+(e.active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.active?"Active":"Inactive"}),t.jsx("button",{className:"text-red-600 hover:text-red-800",children:t.jsx(x,{size:16})})]})]},e.id))})]}),t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Market Status"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[t.jsx(D,{className:"text-green-600",size:20}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:"US Markets"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Open (6h 23m remaining)"})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[t.jsx(V,{className:"text-yellow-600",size:20}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:"European Markets"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Closed"})]})]}),t.jsxs("div",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg",children:[t.jsx(V,{className:"text-red-600",size:20}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-800",children:"Asian Markets"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Closed"})]})]})]})]})]})]})},Ve=({data:s,dcfResults:i,lboResults:l,financialModel:r,scenarioResults:n,onDataChange:c})=>{const[o,d]=e.useState("unified"),[m,x]=e.useState({iterations:1e4,confidenceLevel:.95,correlationsEnabled:!0,crossModelAnalysis:!0,riskMetrics:["var","cvar","downside"]}),[u,g]=e.useState(null),[p,b]=e.useState(!1),[f,y]=e.useState(0),v=e.useCallback(e=>e||0===e?new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e):"$0",[]),j=e.useCallback(e=>`${(100*e).toFixed(1)}%`,[]),N=e.useCallback(async()=>{b(!0),y(0);try{const e={dcf:null,lbo:null,correlation:null,portfolio:null,riskMetrics:null};if(i&&m.crossModelAnalysis){const t={revenueGrowthRate:{type:"normal",parameters:{mean:.05,stdDev:.02},enabled:!0},fcfMargin:{type:"triangular",parameters:{min:.1,mode:.15,max:.2},enabled:!0},wacc:{type:"normal",parameters:{mean:.1,stdDev:.015},enabled:!0},terminalGrowthRate:{type:"uniform",parameters:{min:.02,max:.03},enabled:!0}},a={currentRevenue:1e3*s?.statements?.incomeStatement?.totalRevenue?.[0]||1e6,currentPrice:100,sharesOutstanding:1e6,...i};y(25),e.dcf=await ce.runDCFSimulation(a,t,{iterations:m.iterations,confidenceLevel:m.confidenceLevel,onProgress:e=>y(25+.25*e)})}if(l&&m.crossModelAnalysis){const s={ebitdaGrowthRate:{type:"normal",parameters:{mean:.06,stdDev:.02},enabled:!0},exitMultiple:{type:"triangular",parameters:{min:8,mode:10,max:12},enabled:!0},leverageRatio:{type:"normal",parameters:{mean:5.5,stdDev:.5},enabled:!0}};y(50),e.lbo=await ce.runLBOSimulation(l.inputs||{},s,{iterations:m.iterations,confidenceLevel:m.confidenceLevel,onProgress:e=>y(50+.25*e)})}e.dcf&&e.lbo&&m.correlationsEnabled&&(y(75),e.correlation=w(e.dcf,e.lbo)),y(90),e.riskMetrics=S(e),n&&n.scenarios&&(e.portfolio=R(e,n)),y(100),g(e),c&&c({monteCarloIntegrated:{settings:m,results:e,timestamp:(new Date).toISOString()}})}catch(e){alert(`Simulation error: ${e.message}`)}finally{b(!1),y(0)}},[i,l,n,m,s,c]),w=e.useCallback((e,s)=>{const t=e.simulations?.map(e=>e.pricePerShare)||[],a=s.simulations?.map(e=>e.irr)||[];if(0===t.length||0===a.length)return null;const i=k(t,a);return{dcfLboCorrelation:i,interpretation:Math.abs(i)>.7?"Strong":Math.abs(i)>.4?"Moderate":"Weak",riskImplication:i>0?"Aligned Risk":"Hedged Risk"}},[]),k=(e,s)=>{const t=Math.min(e.length,s.length);if(0===t)return 0;const a=e.slice(0,t).reduce((e,s)=>e+s,0),i=s.slice(0,t).reduce((e,s)=>e+s,0),l=e.slice(0,t).reduce((e,t,a)=>e+t*s[a],0),r=e.slice(0,t).reduce((e,s)=>e+s*s,0),n=s.slice(0,t).reduce((e,s)=>e+s*s,0),c=t*l-a*i,o=Math.sqrt((t*r-a*a)*(t*n-i*i));return 0===o?0:c/o},S=e.useCallback(e=>{const s={};return e.dcf?.analysis&&(s.dcf={var95:e.dcf.analysis.percentiles?.pricePerShare?.p5||0,expectedValue:e.dcf.analysis.summary?.mean||0,volatility:e.dcf.analysis.summary?.standardDeviation||0}),e.lbo?.analysis&&(s.lbo={var95:e.lbo.analysis.percentiles?.irr?.p5||0,expectedValue:e.lbo.analysis.summary?.mean||0,volatility:e.lbo.analysis.summary?.standardDeviation||0}),s},[]),R=e.useCallback((e,s)=>s.scenarios.reduce((s,t)=>{const a=t.probability/100;return e.dcf&&(s.dcfWeighted=(s.dcfWeighted||0)+(e.dcf.analysis?.summary?.mean||0)*a),e.lbo&&(s.lboWeighted=(s.lboWeighted||0)+(e.lbo.analysis?.summary?.mean||0)*a),s},{}),[]),M=[{id:"unified",label:"Unified Analysis",icon:F},{id:"dcf",label:"DCF Monte Carlo",icon:a},{id:"lbo",label:"LBO Monte Carlo",icon:C},{id:"correlation",label:"Cross-Model Risk",icon:h}];return t.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-6",children:[t.jsxs("div",{className:"flex items-center space-x-3",children:[t.jsx(F,{className:"text-purple-600",size:28}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Monte Carlo Integration Hub"}),t.jsx("p",{className:"text-gray-600",children:"Cross-model risk analysis & unified simulations"})]})]}),t.jsx("div",{className:"flex space-x-3",children:t.jsxs(_.button,{onClick:N,disabled:p,className:"px-6 py-2 rounded-lg font-medium flex items-center space-x-2 "+(p?"bg-gray-300 text-gray-500 cursor-not-allowed":"bg-purple-600 hover:bg-purple-700 text-white"),whileHover:p?{}:{scale:1.02},whileTap:p?{}:{scale:.98},children:[t.jsx(z,{size:18}),t.jsx("span",{children:p?"Running...":"Run Integrated Simulation"})]})})]}),p&&t.jsxs("div",{className:"mb-6",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Simulation Progress"}),t.jsxs("span",{className:"text-sm text-gray-500",children:[f.toFixed(0),"%"]})]}),t.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:t.jsx("div",{className:"bg-purple-600 h-2 rounded-full transition-all duration-300",style:{width:`${f}%`}})})]}),t.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[t.jsx("h3",{className:"font-semibold mb-3",children:"Simulation Settings"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Iterations"}),t.jsx("input",{type:"number",value:m.iterations,onChange:e=>x(s=>({...s,iterations:parseInt(e.target.value)||1e4})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Confidence Level"}),t.jsxs("select",{value:m.confidenceLevel,onChange:e=>x(s=>({...s,confidenceLevel:parseFloat(e.target.value)})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",children:[t.jsx("option",{value:.9,children:"90%"}),t.jsx("option",{value:.95,children:"95%"}),t.jsx("option",{value:.99,children:"99%"})]})]}),t.jsx("div",{className:"flex items-end",children:t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:m.correlationsEnabled,onChange:e=>x(s=>({...s,correlationsEnabled:e.target.checked})),className:"mr-2"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Correlations"})]})}),t.jsx("div",{className:"flex items-end",children:t.jsxs("label",{className:"flex items-center",children:[t.jsx("input",{type:"checkbox",checked:m.crossModelAnalysis,onChange:e=>x(s=>({...s,crossModelAnalysis:e.target.checked})),className:"mr-2"}),t.jsx("span",{className:"text-sm text-gray-700",children:"Cross-Model Analysis"})]})})]})]}),t.jsx("div",{className:"border-b border-gray-200 mb-6",children:t.jsx("nav",{className:"-mb-px flex space-x-8",children:M.map(e=>{const s=e.icon;return t.jsxs("button",{onClick:()=>d(e.id),className:"py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 "+(o===e.id?"border-purple-500 text-purple-600":"border-transparent text-gray-500 hover:text-gray-700"),children:[t.jsx(s,{size:16}),t.jsx("span",{children:e.label})]},e.id)})})}),u?t.jsxs(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"space-y-6",children:["unified"===o&&t.jsxs("div",{className:"space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[u.dcf&&t.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:v(u.dcf.analysis?.summary?.mean||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"DCF Expected Value"})]}),u.lbo&&t.jsxs("div",{className:"bg-green-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:j(u.lbo.analysis?.summary?.mean||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"LBO Expected IRR"})]}),u.correlation&&t.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:(u.correlation.dcfLboCorrelation||0).toFixed(2)}),t.jsx("div",{className:"text-sm text-gray-600",children:"DCF-LBO Correlation"})]}),t.jsxs("div",{className:"bg-orange-50 p-4 rounded-lg text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:m.iterations.toLocaleString()}),t.jsx("div",{className:"text-sm text-gray-600",children:"Simulations Run"})]})]}),u.correlation&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Cross-Model Risk Analysis"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[t.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Correlation Strength"}),t.jsx("div",{className:"text-2xl font-bold text-purple-600",children:u.correlation.interpretation}),t.jsx("div",{className:"text-sm text-gray-600",children:u.correlation.riskImplication})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[t.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Risk Diversification"}),t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Math.abs(u.correlation.dcfLboCorrelation)<.5?"High":"Low"}),t.jsx("div",{className:"text-sm text-gray-600",children:"Portfolio benefit"})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[t.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Confidence Level"}),t.jsx("div",{className:"text-2xl font-bold text-green-600",children:j(m.confidenceLevel)}),t.jsx("div",{className:"text-sm text-gray-600",children:"Statistical confidence"})]})]})]}),u.portfolio&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Portfolio-Weighted Analysis"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[t.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted DCF"}),t.jsx("div",{className:"text-xl font-bold text-blue-600",children:v(u.portfolio.dcfWeighted||0)})]}),t.jsxs("div",{className:"bg-white p-4 rounded-lg",children:[t.jsx("div",{className:"font-medium text-gray-800 mb-2",children:"Scenario-Weighted LBO IRR"}),t.jsx("div",{className:"text-xl font-bold text-green-600",children:j(u.portfolio.lboWeighted||0)})]})]})]})]}),"dcf"===o&&u.dcf&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"DCF Monte Carlo Results"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:v(u.dcf.analysis?.summary?.mean||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"Mean Value"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-green-600",children:v(u.dcf.analysis?.percentiles?.pricePerShare?.p95||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-red-600",children:v(u.dcf.analysis?.percentiles?.pricePerShare?.p5||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-purple-600",children:v(u.dcf.analysis?.summary?.standardDeviation||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"Std Deviation"})]})]})]}),"lbo"===o&&u.lbo&&t.jsxs("div",{className:"bg-gray-50 rounded-lg p-6",children:[t.jsx("h3",{className:"text-lg font-semibold mb-4",children:"LBO Monte Carlo Results"}),t.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-green-600",children:j(u.lbo.analysis?.summary?.mean||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"Mean IRR"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-blue-600",children:j(u.lbo.analysis?.percentiles?.irr?.p95||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"95th Percentile IRR"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-lg font-bold text-red-600",children:j(u.lbo.analysis?.percentiles?.irr?.p5||0)}),t.jsx("div",{className:"text-sm text-gray-600",children:"5th Percentile IRR"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[((u.lbo.analysis?.percentiles?.moic?.p95||0)+(u.lbo.analysis?.percentiles?.moic?.p5||0))/2,"x"]}),t.jsx("div",{className:"text-sm text-gray-600",children:"Avg MOIC"})]})]})]})]}):t.jsxs("div",{className:"text-center py-12 text-gray-500",children:[t.jsx(F,{size:48,className:"mx-auto mb-4 opacity-50"}),t.jsx("p",{children:"Configure settings and run integrated simulation to see cross-model analysis"}),t.jsx("p",{className:"text-sm mt-2",children:i||l?"Ready to run comprehensive Monte Carlo analysis":"Run DCF and/or LBO analysis first to enable Monte Carlo integration"})]})]})},Oe=({financialData:s,currentMetric:i,analysisContext:l="general",onInsightClick:r,isVisible:o=!0,onToggle:m})=>{const[x,u]=e.useState({assumptions:!0,benchmarks:!0,insights:!0,suggestions:!1});e.useMemo(()=>({healthcare:{revenueGrowth:{min:8,median:15,max:25,unit:"%"},ebitdaMargin:{min:18,median:28,max:40,unit:"%"},grossMargin:{min:65,median:75,max:85,unit:"%"},roe:{min:12,median:18,max:25,unit:"%"}},technology:{revenueGrowth:{min:15,median:25,max:50,unit:"%"},ebitdaMargin:{min:20,median:35,max:50,unit:"%"},grossMargin:{min:70,median:80,max:90,unit:"%"},roe:{min:15,median:22,max:35,unit:"%"}},manufacturing:{revenueGrowth:{min:3,median:8,max:15,unit:"%"},ebitdaMargin:{min:10,median:18,max:25,unit:"%"},grossMargin:{min:25,median:35,max:45,unit:"%"},roe:{min:8,median:15,max:22,unit:"%"}}}),[]);const h=(()=>{const e=[];if(!s?.statements?.incomeStatement)return[{type:"info",title:"Getting Started",content:"Import financial data to see contextual insights and benchmarks.",action:"Import Data"}];const t=s.statements.incomeStatement,a=t.totalRevenue?.[2]||0,r=t.operatingIncome?.[2]||0;if(a>0){const s=r/a*100;e.push({type:"benchmark",title:"Operating Margin Analysis",content:`Current operating margin of ${s.toFixed(1)}% compares to healthcare industry median of 28%.`,metric:s,benchmark:28,status:s>=28?"above":s>=20?"within":"below"})}return"dcf"===l&&e.push({type:"assumption",title:"DCF Model Assumptions",content:"Consider industry-specific discount rates and terminal growth assumptions.",suggestions:["Healthcare companies typically use 8-12% WACC","Terminal growth rates should reflect long-term GDP growth (2-3%)","Consider regulatory risks in discount rate adjustments"]}),i?.includes("revenue")&&e.push({type:"insight",title:"Revenue Growth Drivers",content:"Analyze revenue composition and growth sustainability.",suggestions:["Break down revenue by service line","Assess recurring vs. one-time revenue","Evaluate market expansion opportunities"]}),e})(),g=e=>{u(s=>({...s,[e]:!s[e]}))},p=(e,s,a,i)=>{const l=i-a,r=Math.max(0,Math.min(100,(e-a)/l*100)),n=Math.max(0,Math.min(100,(s-a)/l*100));return t.jsxs("div",{className:"relative h-2 bg-slate-200 rounded-full overflow-hidden",children:[t.jsx("div",{className:"absolute top-0 h-full bg-blue-200 rounded-full",style:{width:`${n}%`}}),t.jsx("div",{className:"absolute top-0 h-full w-1 bg-blue-600 rounded-full",style:{left:`${n}%`}}),t.jsx("div",{className:"absolute top-0 h-full w-1 bg-amber-500 rounded-full",style:{left:`${r}%`}})]})};return o?t.jsxs(_.div,{initial:{x:320,opacity:0},animate:{x:0,opacity:1},exit:{x:320,opacity:0},className:"fixed right-0 top-16 bottom-0 w-80 bg-slate-50 border-l border-slate-200 shadow-xl z-40 overflow-hidden flex flex-col",children:[t.jsxs("div",{className:"flex items-center justify-between p-4 bg-white border-b border-slate-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"p-1.5 bg-blue-100 rounded-lg",children:t.jsx(d,{size:16,className:"text-blue-600"})}),t.jsx("h3",{className:"font-semibold text-slate-900",children:"Contextual Insights"})]}),m&&t.jsx("button",{onClick:m,className:"p-1.5 hover:bg-slate-100 rounded-lg transition-colors",children:t.jsx(G,{size:16,className:"text-slate-500"})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[t.jsxs("button",{onClick:()=>g("assumptions"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(C,{size:16,className:"text-amber-600"}),t.jsx("span",{className:"font-medium text-slate-900",children:"Key Assumptions"})]}),x.assumptions?t.jsx(n,{size:16,className:"text-slate-400"}):t.jsx(c,{size:16,className:"text-slate-400"})]}),t.jsx(U,{children:x.assumptions&&t.jsx(_.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-slate-600",children:"Discount Rate"}),t.jsx("span",{className:"font-mono text-slate-900",children:"10.0%"})]}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-slate-600",children:"Terminal Growth"}),t.jsx("span",{className:"font-mono text-slate-900",children:"2.5%"})]}),t.jsxs("div",{className:"flex justify-between items-center text-sm",children:[t.jsx("span",{className:"text-slate-600",children:"Tax Rate"}),t.jsx("span",{className:"font-mono text-slate-900",children:"25.0%"})]})]})})})]}),t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[t.jsxs("button",{onClick:()=>g("benchmarks"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(w,{size:16,className:"text-emerald-600"}),t.jsx("span",{className:"font-medium text-slate-900",children:"Industry Benchmarks"})]}),x.benchmarks?t.jsx(n,{size:16,className:"text-slate-400"}):t.jsx(c,{size:16,className:"text-slate-400"})]}),t.jsx(U,{children:x.benchmarks&&t.jsx(_.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:t.jsxs("div",{className:"p-4 space-y-4",children:[t.jsxs("div",{className:"text-sm",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-slate-600",children:"Revenue Growth"}),t.jsx("span",{className:"text-xs text-slate-500",children:"Healthcare Industry"})]}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[t.jsx("span",{children:"8%"}),t.jsx("span",{className:"font-medium",children:"15% (median)"}),t.jsx("span",{children:"25%"})]}),p(12,15,8,25)]}),t.jsxs("div",{className:"text-sm",children:[t.jsxs("div",{className:"flex justify-between items-center mb-2",children:[t.jsx("span",{className:"text-slate-600",children:"EBITDA Margin"}),t.jsx("span",{className:"text-xs text-slate-500",children:"Healthcare Industry"})]}),t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[t.jsx("span",{children:"18%"}),t.jsx("span",{className:"font-medium",children:"28% (median)"}),t.jsx("span",{children:"40%"})]}),p(24,28,18,40)]})]})})})]}),t.jsx("div",{className:"space-y-3",children:h.map((e,s)=>((e,s)=>{const a={info:"text-blue-500 bg-blue-50",benchmark:"text-emerald-500 bg-emerald-50",assumption:"text-amber-500 bg-amber-50",insight:"text-purple-500 bg-purple-50"},i={info:j,benchmark:C,assumption:I,insight:$}[e.type]||j,l=a[e.type]||a.info;return t.jsx(_.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.1*s},className:"p-4 bg-white rounded-lg border border-slate-200 hover:border-slate-300 transition-colors",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:`p-2 rounded-lg ${l}`,children:t.jsx(i,{size:16})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-semibold text-slate-900 text-sm mb-2",children:e.title}),t.jsx("p",{className:"text-sm text-slate-600 mb-3",children:e.content}),void 0!==e.metric&&void 0!==e.benchmark&&t.jsxs("div",{className:"mb-3",children:[t.jsxs("div",{className:"flex justify-between text-xs text-slate-500 mb-1",children:[t.jsxs("span",{children:["Current: ",e.metric.toFixed(1),"%"]}),t.jsxs("span",{children:["Benchmark: ",e.benchmark,"%"]})]}),p(e.metric,e.benchmark,0,Math.max(1.5*e.benchmark,1.2*e.metric))]}),e.suggestions&&t.jsx("div",{className:"mt-3",children:t.jsx("div",{className:"space-y-1",children:e.suggestions.map((e,s)=>t.jsxs("div",{className:"flex items-start gap-2 text-xs text-slate-600",children:[t.jsx(c,{size:12,className:"text-slate-400 mt-0.5 flex-shrink-0"}),t.jsx("span",{children:e})]},s))})}),e.action&&t.jsx("button",{onClick:()=>r?.(e),className:"mt-3 px-3 py-1.5 bg-blue-50 hover:bg-blue-100 text-blue-700 text-xs font-medium rounded-md transition-colors",children:e.action})]})]})},s)})(e,s))}),t.jsxs("div",{className:"bg-white rounded-lg border border-slate-200",children:[t.jsxs("button",{onClick:()=>g("suggestions"),className:"w-full flex items-center justify-between p-4 text-left hover:bg-slate-50 transition-colors",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx($,{size:16,className:"text-purple-600"}),t.jsx("span",{className:"font-medium text-slate-900",children:"Smart Suggestions"})]}),x.suggestions?t.jsx(n,{size:16,className:"text-slate-400"}):t.jsx(c,{size:16,className:"text-slate-400"})]}),t.jsx(U,{children:x.suggestions&&t.jsx(_.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t border-slate-100",children:t.jsxs("div",{className:"p-4 space-y-3",children:[t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-blue-50 rounded-lg",children:[t.jsx(d,{size:14,className:"text-blue-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-blue-900 mb-1",children:"Create Revenue vs CapEx Chart"}),t.jsx("div",{className:"text-xs text-blue-700",children:"Visualize the relationship between revenue growth and capital expenditure"})]})]}),t.jsxs("div",{className:"flex items-start gap-3 p-3 bg-emerald-50 rounded-lg",children:[t.jsx(a,{size:14,className:"text-emerald-600 mt-0.5"}),t.jsxs("div",{children:[t.jsx("div",{className:"text-sm font-medium text-emerald-900 mb-1",children:"Add Sensitivity Analysis"}),t.jsx("div",{className:"text-xs text-emerald-700",children:"Test how valuation changes with different assumptions"})]})]})]})})})]})]})})]}):null};export{Pe as A,Oe as C,Me as D,Te as E,Se as F,Ee as M,Ae as W,ke as a,De as b,Ve as c,Ne as g,de as i,je as t,Ce as u};
//# sourceMappingURL=private-analysis-CULRlbZQ.js.map
