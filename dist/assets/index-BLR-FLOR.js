import{r as e,j as s}from"./react-DbKEDq5F.js";import{I as t,B as a,H as r,c as n}from"./ui-components-DUPitwH-.js";import{S as i}from"./valuation-tools-CH5aoDQV.js";import{p as o}from"./persistence-DNoCNU4C.js";import{d as l}from"./dataFetching-Mx-_xloD.js";import"./ui-charts-CcCRCYtT.js";import"./utils-vendor-DofaKlSJ.js";import"./react-router-CGJIHeCu.js";import"./vendor-DYwn_Zoo.js";import"./animations-DmEkbmfl.js";import"./recharts-vendor-CMq9LHd_.js";import"./d3-vendor-C2v6EsNF.js";import"./seo-vendor-85CQXWAt.js";import"./data-vendor-D1oVvdCb.js";import"./financial-engines-DJoNW2Bz.js";const c=({calculations:r,errors:n,warnings:i})=>{const[o,l]=e.useState("calculations"),[c,d]=e.useState(new Set);e.useState("all");const m={calculations:[{id:1,timestamp:new Date(Date.now()-3e5),type:"calculation",operation:"DCF Valuation",formula:"NPV(FCFF_2024:2028, WACC)",result:2547.5,inputs:{FCFF_2024:187.5,FCFF_2025:206.3,FCFF_2026:226.9,FCFF_2027:249.6,FCFF_2028:274.6,WACC:.098},executionTime:.045,status:"success"},{id:2,timestamp:new Date(Date.now()-6e5),type:"calculation",operation:"WACC Calculation",formula:"WACC(cost_equity, cost_debt, tax_rate, debt_ratio)",result:.098,inputs:{cost_equity:.123,cost_debt:.045,tax_rate:.25,debt_ratio:.4},executionTime:.012,status:"success"},{id:3,timestamp:new Date(Date.now()-9e5),type:"calculation",operation:"Terminal Value",formula:"TERMINAL_VALUE(FCF_final, terminal_growth, WACC)",result:1247.3,inputs:{FCF_final:274.6,terminal_growth:.025,WACC:.098},executionTime:.008,status:"success"}],errors:[{id:1,timestamp:new Date(Date.now()-12e5),type:"error",severity:"high",message:"Division by zero in WACC calculation",formula:"WACC(cost_equity, cost_debt, tax_rate, debt_ratio)",location:"Cell B15",suggestion:"Ensure debt_ratio is not equal to 1.0",resolved:!0}],warnings:[{id:1,timestamp:new Date(Date.now()-18e4),type:"warning",severity:"medium",message:"Beta coefficient (1.15) is above industry average (0.95)",formula:"CAPM(risk_free, beta, market_premium)",location:"Assumptions",suggestion:"Consider reviewing beta calculation or using industry average",acknowledged:!1},{id:2,timestamp:new Date(Date.now()-42e4),type:"warning",severity:"low",message:"Terminal growth rate (2.5%) close to discount rate component",formula:"TERMINAL_VALUE(FCF_final, terminal_growth, WACC)",location:"Terminal Value",suggestion:"Ensure terminal growth rate is reasonable for long-term GDP growth",acknowledged:!0}],validations:[{id:1,timestamp:new Date(Date.now()-6e4),type:"validation",check:"Circular Reference Check",status:"passed",details:"No circular references detected in model"},{id:2,timestamp:new Date(Date.now()-12e4),type:"validation",check:"Balance Sheet Check",status:"passed",details:"Assets = Liabilities + Equity for all projection years"},{id:3,timestamp:new Date(Date.now()-24e4),type:"validation",check:"Cash Flow Consistency",status:"warning",details:"Minor rounding differences in cash flow statements (<$0.1M)"}]},u=[{id:"calculations",label:"Calculations",icon:"Calculator",count:m.calculations.length},{id:"errors",label:"Errors",icon:"XCircle",count:m.errors.length},{id:"warnings",label:"Warnings",icon:"AlertTriangle",count:m.warnings.length},{id:"validations",label:"Validations",icon:"CheckCircle",count:m.validations.length}],x=e=>{switch(e){case"success":case"passed":return{icon:"CheckCircle",color:"text-success"};case"error":return{icon:"XCircle",color:"text-destructive"};case"warning":return{icon:"AlertTriangle",color:"text-warning"};default:return{icon:"Info",color:"text-muted-foreground"}}},p=e=>{switch(e){case"high":return"text-destructive bg-destructive/10";case"medium":return"text-warning bg-warning/10";default:return"text-muted-foreground bg-muted"}};return s.jsxs("div",{className:"flex flex-col h-full bg-card",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"FileText",size:20,className:"text-primary"}),s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Audit Trail"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:"Download",children:"Export Log"}),s.jsx(a,{variant:"outline",size:"sm",iconName:"RefreshCw",children:"Refresh"})]})]}),s.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:u.map(e=>s.jsxs("button",{onClick:()=>l(e.id),className:"flex items-center space-x-2 px-4 py-3 text-sm font-medium whitespace-nowrap transition-smooth "+(o===e.id?"bg-primary text-primary-foreground border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[s.jsx(t,{name:e.icon,size:16}),s.jsx("span",{children:e.label}),e.count>0&&s.jsx("span",{className:"px-2 py-1 bg-current/20 rounded-full text-xs",children:e.count})]},e.id))}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:(()=>{switch(o){case"calculations":default:return s.jsx("div",{className:"space-y-3",children:m.calculations.map(e=>{return s.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg",children:[s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx(t,{name:"Calculator",size:16,className:"text-primary"}),s.jsx("span",{className:"font-medium text-foreground",children:e.operation}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${x(e.status).color} bg-current/10`,children:e.status})]}),s.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded font-mono text-foreground block mb-2",children:e.formula}),s.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[s.jsx("span",{children:e.timestamp.toLocaleTimeString()}),s.jsxs("span",{children:["Execution: ",(r=e.executionTime,r<.001?"<1ms":r<1?`${(1e3*r).toFixed(0)}ms`:`${r.toFixed(2)}s`)]}),s.jsxs("span",{children:["Result: $",e.result.toFixed(2),"M"]})]})]}),s.jsx(a,{variant:"ghost",size:"sm",iconName:c.has(e.id)?"ChevronUp":"ChevronDown",onClick:()=>(e=>{const s=new Set(c);s.has(e)?s.delete(e):s.add(e),d(s)})(e.id)})]}),c.has(e.id)&&s.jsxs("div",{className:"mt-4 pt-4 border-t border-border",children:[s.jsx("h5",{className:"text-sm font-medium text-foreground mb-2",children:"Input Values"}),s.jsx("div",{className:"grid grid-cols-2 gap-2",children:Object.entries(e.inputs).map(([e,t])=>s.jsxs("div",{className:"flex justify-between text-sm",children:[s.jsxs("span",{className:"text-muted-foreground",children:[e,":"]}),s.jsx("span",{className:"text-foreground font-mono",children:"number"==typeof t?t.toFixed(3):t})]},e))})]})]},e.id);var r})});case"errors":return s.jsx("div",{className:"space-y-3",children:m.errors.map(e=>s.jsx("div",{className:"p-4 bg-background border border-destructive/20 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(t,{name:"XCircle",size:16,className:"text-destructive mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("span",{className:"font-medium text-foreground",children:e.message}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p(e.severity)}`,children:e.severity}),e.resolved&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs text-success bg-success/10",children:"Resolved"})]}),s.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded font-mono text-foreground block mb-2",children:e.formula}),s.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Location: ",e.location]}),s.jsxs("div",{className:"text-sm text-foreground bg-muted/50 p-2 rounded",children:[s.jsx("strong",{children:"Suggestion:"})," ",e.suggestion]}),s.jsx("div",{className:"text-xs text-muted-foreground mt-2",children:e.timestamp.toLocaleString()})]})]})},e.id))});case"warnings":return s.jsx("div",{className:"space-y-3",children:m.warnings.map(e=>s.jsx("div",{className:"p-4 bg-background border border-warning/20 rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(t,{name:"AlertTriangle",size:16,className:"text-warning mt-0.5"}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("span",{className:"font-medium text-foreground",children:e.message}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${p(e.severity)}`,children:e.severity}),e.acknowledged&&s.jsx("span",{className:"px-2 py-1 rounded-full text-xs text-muted-foreground bg-muted",children:"Acknowledged"})]}),s.jsx("code",{className:"text-sm bg-muted px-2 py-1 rounded font-mono text-foreground block mb-2",children:e.formula}),s.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Location: ",e.location]}),s.jsxs("div",{className:"text-sm text-foreground bg-muted/50 p-2 rounded",children:[s.jsx("strong",{children:"Suggestion:"})," ",e.suggestion]}),s.jsxs("div",{className:"flex items-center justify-between mt-3",children:[s.jsx("div",{className:"text-xs text-muted-foreground",children:e.timestamp.toLocaleString()}),!e.acknowledged&&s.jsx(a,{variant:"outline",size:"sm",children:"Acknowledge"})]})]})]})},e.id))});case"validations":return s.jsx("div",{className:"space-y-3",children:m.validations.map(e=>s.jsx("div",{className:"p-4 bg-background border border-border rounded-lg",children:s.jsxs("div",{className:"flex items-start space-x-3",children:[s.jsx(t,{name:x(e.status).icon,size:16,className:`${x(e.status).color} mt-0.5`}),s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[s.jsx("span",{className:"font-medium text-foreground",children:e.check}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${x(e.status).color} bg-current/10`,children:e.status})]}),s.jsx("div",{className:"text-sm text-muted-foreground mb-2",children:e.details}),s.jsx("div",{className:"text-xs text-muted-foreground",children:e.timestamp.toLocaleString()})]})]})},e.id))})}})()}),s.jsx("div",{className:"p-4 border-t border-border bg-muted/50",children:s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{children:["Last updated: ",(new Date).toLocaleTimeString()]}),s.jsx("span",{children:"â€¢"}),s.jsx("span",{children:"Auto-refresh: ON"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-success rounded-full"}),s.jsx("span",{children:"Audit logging active"})]})]})})]})},d=({results:r,onExport:n})=>{const[i,o]=e.useState("summary");e.useState(new Set(["valuation"]));const l={summary:{enterpriseValue:2847.5,equityValue:2547.5,sharePrice:127.38,impliedReturn:.156,confidence:.87},cashFlows:[{year:2024,revenue:1250,ebitda:312.5,fcf:187.5,pv:170.5},{year:2025,revenue:1375,ebitda:343.8,fcf:206.3,pv:172.8},{year:2026,revenue:1513,ebitda:378.2,fcf:226.9,pv:175.2},{year:2027,revenue:1664,ebitda:416,fcf:249.6,pv:177.7},{year:2028,revenue:1830,ebitda:457.6,fcf:274.6,pv:180.3}],sensitivity:{wacc:[.08,.09,.1,.11,.12],growth:[.015,.02,.025,.03,.035],matrix:[[145.2,138.7,132.8,127.4,122.5],[152.1,144.9,138.2,132.1,126.4],[159.8,151.9,144.6,137.8,131.6],[168.4,159.7,151.8,144.4,137.6],[178.1,168.4,159.7,151.8,144.4]]},scenarios:[{name:"Base Case",probability:.6,sharePrice:127.38,irr:.156},{name:"Bull Case",probability:.25,sharePrice:145.67,irr:.189},{name:"Bear Case",probability:.15,sharePrice:98.42,irr:.087}],multiples:[{metric:"EV/Revenue",current:2.3,peer_avg:2.8,premium:-17.9},{metric:"EV/EBITDA",current:9.1,peer_avg:11.2,premium:-18.8},{metric:"P/E Ratio",current:18.5,peer_avg:22.1,premium:-16.3},{metric:"P/B Ratio",current:2.1,peer_avg:2.6,premium:-19.2}]},c=(e,s=2)=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:s,maximumFractionDigits:s}).format(e),d=(e,s=1)=>`${(100*e).toFixed(s)}%`;return s.jsxs("div",{className:"flex flex-col h-full bg-card",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"Calculator",size:20,className:"text-primary"}),s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Calculation Results"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:"Download",onClick:()=>n&&n("excel"),children:"Export"}),s.jsx(a,{variant:"outline",size:"sm",iconName:"Share2",children:"Share"})]})]}),s.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:[{id:"summary",label:"Summary",icon:"BarChart3"},{id:"cashflows",label:"Cash Flows",icon:"TrendingUp"},{id:"sensitivity",label:"Sensitivity",icon:"Target"},{id:"scenarios",label:"Scenarios",icon:"GitBranch"},{id:"multiples",label:"Multiples",icon:"Layers"}].map(e=>s.jsxs("button",{onClick:()=>o(e.id),className:"flex items-center space-x-2 px-4 py-3 text-sm font-medium whitespace-nowrap transition-smooth "+(i===e.id?"bg-primary text-primary-foreground border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[s.jsx(t,{name:e.icon,size:16}),s.jsx("span",{children:e.label})]},e.id))}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:(()=>{switch(i){case"summary":default:return s.jsxs("div",{className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Enterprise Value"}),s.jsx(t,{name:"Building",size:16,className:"text-muted-foreground"})]}),s.jsx("div",{className:"mt-2",children:s.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[c(l.summary.enterpriseValue,1),"M"]})})]}),s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Equity Value"}),s.jsx(t,{name:"PieChart",size:16,className:"text-muted-foreground"})]}),s.jsx("div",{className:"mt-2",children:s.jsxs("span",{className:"text-2xl font-bold text-foreground",children:[c(l.summary.equityValue,1),"M"]})})]}),s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Share Price"}),s.jsx(t,{name:"DollarSign",size:16,className:"text-muted-foreground"})]}),s.jsx("div",{className:"mt-2",children:s.jsx("span",{className:"text-2xl font-bold text-foreground",children:c(l.summary.sharePrice)})})]}),s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm text-muted-foreground",children:"Implied Return"}),s.jsx(t,{name:"TrendingUp",size:16,className:"text-success"})]}),s.jsx("div",{className:"mt-2",children:s.jsx("span",{className:"text-2xl font-bold text-success",children:d(l.summary.impliedReturn)})})]})]}),s.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Model Confidence"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:d(l.summary.confidence)})]}),s.jsx("div",{className:"w-full bg-muted rounded-full h-2",children:s.jsx("div",{className:"bg-success h-2 rounded-full transition-all duration-300",style:{width:100*l.summary.confidence+"%"}})}),s.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Based on data quality, assumption validity, and sensitivity analysis"})]})]});case"cashflows":return s.jsxs("div",{className:"space-y-4",children:[s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-border",children:[s.jsx("th",{className:"text-left py-2 text-muted-foreground font-medium",children:"Year"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"Revenue"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"EBITDA"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"FCF"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"Present Value"})]})}),s.jsx("tbody",{children:l.cashFlows.map((e,t)=>s.jsxs("tr",{className:"border-b border-border/50",children:[s.jsx("td",{className:"py-3 text-foreground font-medium",children:e.year}),s.jsxs("td",{className:"py-3 text-right text-foreground",children:[c(e.revenue,0),"M"]}),s.jsxs("td",{className:"py-3 text-right text-foreground",children:[c(e.ebitda,1),"M"]}),s.jsxs("td",{className:"py-3 text-right text-foreground",children:[c(e.fcf,1),"M"]}),s.jsxs("td",{className:"py-3 text-right text-success font-medium",children:[c(e.pv,1),"M"]})]},t))})]})}),s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"text-sm font-medium text-foreground",children:"Terminal Value"}),s.jsxs("span",{className:"text-lg font-bold text-foreground",children:[c(1247.3,1),"M"]})]}),s.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"2.5% perpetual growth rate applied to 2028 FCF"})]})]});case"sensitivity":return s.jsxs("div",{className:"space-y-4",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("h4",{className:"text-sm font-medium text-foreground mb-2",children:"Share Price Sensitivity Analysis"}),s.jsx("p",{className:"text-xs text-muted-foreground",children:"WACC vs Terminal Growth Rate"})]}),s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-xs",children:[s.jsx("thead",{children:s.jsxs("tr",{children:[s.jsx("th",{className:"p-2 text-left text-muted-foreground",children:"WACC \\ Growth"}),l.sensitivity.growth.map((e,t)=>s.jsx("th",{className:"p-2 text-center text-muted-foreground",children:d(e)},t))]})}),s.jsx("tbody",{children:l.sensitivity.wacc.map((e,t)=>s.jsxs("tr",{className:"border-t border-border/50",children:[s.jsx("td",{className:"p-2 text-muted-foreground font-medium",children:d(e)}),l.sensitivity.matrix[t].map((e,t)=>s.jsx("td",{className:"p-2 text-center font-medium "+(Math.abs(e-127.38)<5?"bg-primary/20 text-primary":"text-foreground"),children:c(e)},t))]},t))})]})})]});case"scenarios":return s.jsx("div",{className:"space-y-4",children:l.scenarios.map((e,t)=>s.jsxs("div",{className:"p-4 bg-muted rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("span",{className:"font-medium text-foreground",children:e.name}),s.jsxs("span",{className:"text-xs bg-background px-2 py-1 rounded text-muted-foreground",children:[d(e.probability)," probability"]})]}),s.jsxs("div",{className:"text-right",children:[s.jsx("div",{className:"text-lg font-bold text-foreground",children:c(e.sharePrice)}),s.jsxs("div",{className:"text-sm text-muted-foreground",children:[d(e.irr)," IRR"]})]})]}),s.jsx("div",{className:"w-full bg-background rounded-full h-1",children:s.jsx("div",{className:"bg-primary h-1 rounded-full",style:{width:100*e.probability+"%"}})})]},t))});case"multiples":return s.jsx("div",{className:"space-y-4",children:s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full text-sm",children:[s.jsx("thead",{children:s.jsxs("tr",{className:"border-b border-border",children:[s.jsx("th",{className:"text-left py-2 text-muted-foreground font-medium",children:"Multiple"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"Current"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"Peer Avg"}),s.jsx("th",{className:"text-right py-2 text-muted-foreground font-medium",children:"Premium/Discount"})]})}),s.jsx("tbody",{children:l.multiples.map((e,t)=>s.jsxs("tr",{className:"border-b border-border/50",children:[s.jsx("td",{className:"py-3 text-foreground font-medium",children:e.metric}),s.jsxs("td",{className:"py-3 text-right text-foreground",children:[e.current,"x"]}),s.jsxs("td",{className:"py-3 text-right text-foreground",children:[e.peer_avg,"x"]}),s.jsxs("td",{className:"py-3 text-right font-medium "+(e.premium>0?"text-success":"text-destructive"),children:[e.premium>0?"+":"",e.premium.toFixed(1),"%"]})]},t))})]})})})}})()}),s.jsx("div",{className:"p-4 border-t border-border bg-muted/50",children:s.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center space-x-4",children:[s.jsxs("span",{children:["Last Updated: ",(new Date).toLocaleTimeString()]}),s.jsx("span",{children:"â€¢"}),s.jsx("span",{children:"Auto-refresh: ON"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-success rounded-full"}),s.jsx("span",{children:"Calculations current"})]})]})})]})},m=({onFormulaCreate:r,variables:n})=>{const[i,o]=e.useState("valuation"),[l,c]=e.useState(null),[d,m]=e.useState(""),[u,x]=e.useState(""),[p,h]=e.useState(!1),g=e.useRef(null),f={valuation:{name:"Valuation",icon:"TrendingUp",functions:[{name:"DCF",syntax:"DCF(fcf_array, discount_rate, terminal_growth)",description:"Discounted Cash Flow valuation"},{name:"NPV",syntax:"NPV(cash_flows, discount_rate)",description:"Net Present Value calculation"},{name:"IRR",syntax:"IRR(cash_flows)",description:"Internal Rate of Return"},{name:"TERMINAL_VALUE",syntax:"TERMINAL_VALUE(final_fcf, growth_rate, discount_rate)",description:"Terminal value calculation"},{name:"WACC",syntax:"WACC(cost_equity, cost_debt, tax_rate, debt_ratio)",description:"Weighted Average Cost of Capital"}]},financial:{name:"Financial Ratios",icon:"Calculator",functions:[{name:"ROE",syntax:"ROE(net_income, shareholders_equity)",description:"Return on Equity"},{name:"ROA",syntax:"ROA(net_income, total_assets)",description:"Return on Assets"},{name:"DEBT_TO_EQUITY",syntax:"DEBT_TO_EQUITY(total_debt, total_equity)",description:"Debt to Equity ratio"},{name:"CURRENT_RATIO",syntax:"CURRENT_RATIO(current_assets, current_liabilities)",description:"Current ratio calculation"},{name:"QUICK_RATIO",syntax:"QUICK_RATIO(quick_assets, current_liabilities)",description:"Quick ratio calculation"}]},statistical:{name:"Statistical",icon:"BarChart3",functions:[{name:"CORRELATION",syntax:"CORRELATION(dataset1, dataset2)",description:"Correlation coefficient"},{name:"REGRESSION",syntax:"REGRESSION(dependent_var, independent_var)",description:"Linear regression analysis"},{name:"VOLATILITY",syntax:"VOLATILITY(returns, period)",description:"Historical volatility"},{name:"BETA",syntax:"BETA(stock_returns, market_returns)",description:"Beta coefficient calculation"},{name:"SHARPE_RATIO",syntax:"SHARPE_RATIO(returns, risk_free_rate)",description:"Risk-adjusted return metric"}]},mathematical:{name:"Mathematical",icon:"Sigma",functions:[{name:"SUM",syntax:"SUM(range)",description:"Sum of values"},{name:"AVERAGE",syntax:"AVERAGE(range)",description:"Average of values"},{name:"MEDIAN",syntax:"MEDIAN(range)",description:"Median value"},{name:"STDEV",syntax:"STDEV(range)",description:"Standard deviation"},{name:"PERCENTILE",syntax:"PERCENTILE(range, percentile)",description:"Percentile calculation"}]}},b=()=>(d.match(/\(/g)||[]).length===(d.match(/\)/g)||[]).length;return s.jsxs("div",{className:"flex flex-col h-full bg-card",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"Wrench",size:20,className:"text-primary"}),s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Formula Builder"})]}),s.jsx("div",{className:"flex items-center space-x-2",children:s.jsx(a,{variant:"outline",size:"sm",iconName:"Plus",onClick:()=>h(!p),children:"New Formula"})})]}),s.jsx("div",{className:"flex border-b border-border",children:Object.entries(f).map(([e,a])=>s.jsxs("button",{onClick:()=>o(e),className:"flex items-center space-x-2 px-4 py-3 text-sm font-medium transition-smooth "+(i===e?"bg-primary text-primary-foreground border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[s.jsx(t,{name:a.icon,size:16}),s.jsx("span",{children:a.name})]},e))}),s.jsxs("div",{className:"flex-1 overflow-y-auto",children:[s.jsx("div",{className:"p-4 space-y-3",children:f[i].functions.map((e,r)=>s.jsx("div",{draggable:!0,onDragStart:s=>((e,s)=>{c(s),e.dataTransfer.effectAllowed="copy"})(s,e),className:"p-3 bg-muted rounded-lg border border-border cursor-move hover:bg-muted/80 transition-smooth group",children:s.jsxs("div",{className:"flex items-start justify-between",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"Move",size:14,className:"text-muted-foreground group-hover:text-foreground"}),s.jsx("span",{className:"font-medium text-foreground",children:e.name})]}),s.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:e.description}),s.jsx("code",{className:"text-xs bg-background px-2 py-1 rounded mt-2 block font-mono text-foreground",children:e.syntax})]}),s.jsx(a,{variant:"ghost",size:"sm",iconName:"Plus",onClick:()=>(e=>{const s=d+(d?" + ":"")+e.syntax;m(s)})(e),className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})},r))}),s.jsxs("div",{className:"border-t border-border p-4",children:[s.jsxs("h4",{className:"text-sm font-medium text-foreground mb-3 flex items-center space-x-2",children:[s.jsx(t,{name:"BookOpen",size:16}),s.jsx("span",{children:"Saved Formulas"})]}),s.jsx("div",{className:"space-y-2",children:[{name:"Custom_DCF_Tech",formula:"DCF(FCFF_PROJECTIONS, WACC(0.12, 0.04, 0.25, 0.3), 0.025)",category:"Custom"},{name:"LBO_Returns",formula:"IRR([INITIAL_INVESTMENT * -1, EXIT_VALUE])",category:"Custom"},{name:"Comp_Multiple",formula:"AVERAGE(PEER_EV_REVENUE) * TARGET_REVENUE",category:"Custom"}].map((e,t)=>s.jsxs("div",{className:"p-3 bg-background rounded-lg border border-border hover:bg-muted/50 transition-smooth cursor-pointer",onClick:()=>m(e.formula),children:[s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx("span",{className:"font-medium text-foreground",children:e.name}),s.jsx("span",{className:"text-xs text-muted-foreground bg-muted px-2 py-1 rounded",children:e.category})]}),s.jsx("code",{className:"text-xs text-muted-foreground mt-1 block font-mono",children:e.formula})]},t))})]})]}),p&&s.jsx("div",{className:"border-t border-border bg-background",children:s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Formula Name"}),s.jsx("input",{type:"text",value:u,onChange:e=>x(e.target.value),placeholder:"Enter formula name...",className:"w-full px-3 py-2 bg-input border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Formula Expression"}),s.jsx("div",{ref:g,onDragOver:e=>{e.preventDefault(),e.dataTransfer.dropEffect="copy"},onDrop:e=>{if(e.preventDefault(),l){const e=d+(d?" + ":"")+l.syntax;m(e),c(null)}},className:"min-h-[100px] p-3 bg-input border-2 border-dashed border-border rounded-lg focus-within:border-ring transition-colors",children:s.jsx("textarea",{value:d,onChange:e=>m(e.target.value),placeholder:"Drag functions here or type formula manually...",className:"w-full h-20 bg-transparent text-foreground placeholder-muted-foreground resize-none outline-none font-mono text-sm"})}),s.jsxs("div",{className:"flex items-center justify-between mt-2",children:[s.jsx("div",{className:"flex items-center space-x-2",children:b()?s.jsxs("div",{className:"flex items-center space-x-1 text-success",children:[s.jsx(t,{name:"CheckCircle",size:14}),s.jsx("span",{className:"text-xs",children:"Valid syntax"})]}):s.jsxs("div",{className:"flex items-center space-x-1 text-destructive",children:[s.jsx(t,{name:"XCircle",size:14}),s.jsx("span",{className:"text-xs",children:"Invalid syntax"})]})}),s.jsxs("span",{className:"text-xs text-muted-foreground",children:[d.length," characters"]})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:"Trash2",onClick:()=>{m(""),x("")},children:"Clear"}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:"Eye",disabled:!b(),children:"Preview"}),s.jsx(a,{variant:"default",size:"sm",iconName:"Save",onClick:()=>{u&&d&&(r&&r({name:u,formula:d,timestamp:new Date}),x(""),m(""),h(!1))},disabled:!u||!d||!b(),children:"Save Formula"})]})]})]})})]})},u=({onTemplateSelect:r,onTemplateCreate:n})=>{const[i,o]=e.useState("valuation"),[l,c]=e.useState(""),[d,m]=e.useState(!1),u={valuation:{name:"Valuation Models",icon:"TrendingUp",templates:[{id:"dcf_standard",name:"DCF - Standard",description:"Traditional discounted cash flow model with 5-year projections and terminal value",complexity:"Intermediate",timeToComplete:"45 min",lastUsed:"2024-07-10",popularity:95,features:["5-year projections","Terminal value","Sensitivity analysis","WACC calculation"]},{id:"dcf_tech",name:"DCF - Technology",description:"Specialized DCF for high-growth technology companies with adjusted metrics",complexity:"Advanced",timeToComplete:"60 min",lastUsed:"2024-07-08",popularity:87,features:["SaaS metrics","User-based projections","Churn analysis","Rule of 40"]},{id:"sum_of_parts",name:"Sum-of-the-Parts",description:"Multi-business valuation with segment-specific assumptions and multiples",complexity:"Advanced",timeToComplete:"90 min",lastUsed:"2024-07-05",popularity:73,features:["Segment analysis","Multiple approaches","Holding company discount","Synergy modeling"]}]},lbo:{name:"LBO Models",icon:"Layers",templates:[{id:"lbo_standard",name:"LBO - Standard",description:"Complete leveraged buyout model with debt sizing and returns analysis",complexity:"Advanced",timeToComplete:"120 min",lastUsed:"2024-07-09",popularity:91,features:["Debt capacity","Returns waterfall","Management rollover","Exit scenarios"]},{id:"lbo_growth",name:"LBO - Growth Equity",description:"Growth-focused LBO with minority investment and expansion capital",complexity:"Advanced",timeToComplete:"100 min",lastUsed:"2024-07-06",popularity:68,features:["Growth capital","Minority stake","Management incentives","Expansion modeling"]}]},comps:{name:"Comparable Analysis",icon:"BarChart3",templates:[{id:"trading_comps",name:"Trading Comparables",description:"Public company multiple analysis with statistical benchmarking",complexity:"Beginner",timeToComplete:"30 min",lastUsed:"2024-07-11",popularity:98,features:["Multiple analysis","Statistical metrics","Peer screening","Premium/discount analysis"]},{id:"transaction_comps",name:"Transaction Comparables",description:"M&A transaction analysis with control premiums and synergies",complexity:"Intermediate",timeToComplete:"45 min",lastUsed:"2024-07-07",popularity:82,features:["M&A multiples","Control premiums","Synergy analysis","Transaction screening"]}]},merger:{name:"M&A Models",icon:"GitMerge",templates:[{id:"merger_model",name:"Merger Model",description:"Comprehensive merger analysis with accretion/dilution and pro forma statements",complexity:"Expert",timeToComplete:"180 min",lastUsed:"2024-07-04",popularity:76,features:["Accretion/dilution","Pro forma statements","Synergy modeling","Financing structure"]},{id:"acquisition_model",name:"Acquisition Model",description:"Strategic acquisition analysis with integration costs and value creation",complexity:"Expert",timeToComplete:"150 min",lastUsed:"2024-07-03",popularity:71,features:["Integration costs","Value creation","Financing options","Risk analysis"]}]}},x=e=>{switch(e){case"Beginner":return"text-success bg-success/10";case"Intermediate":return"text-warning bg-warning/10";case"Advanced":return"text-accent bg-accent/10";case"Expert":return"text-destructive bg-destructive/10";default:return"text-muted-foreground bg-muted"}},p=()=>{const e=u[i]?.templates||[];return l?e.filter(e=>e.name.toLowerCase().includes(l.toLowerCase())||e.description.toLowerCase().includes(l.toLowerCase())):e},h=e=>{r&&r(e)};return s.jsxs("div",{className:"flex flex-col h-full bg-card",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"FileTemplate",size:20,className:"text-primary"}),s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Model Templates"})]}),s.jsx(a,{variant:"outline",size:"sm",iconName:"Plus",onClick:()=>m(!0),children:"Create Template"})]}),s.jsx("div",{className:"p-4 border-b border-border",children:s.jsxs("div",{className:"relative",children:[s.jsx(t,{name:"Search",size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),s.jsx("input",{type:"text",value:l,onChange:e=>c(e.target.value),placeholder:"Search templates...",className:"w-full pl-10 pr-4 py-2 bg-input border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]})}),s.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:Object.entries(u).map(([e,a])=>s.jsxs("button",{onClick:()=>o(e),className:"flex items-center space-x-2 px-4 py-3 text-sm font-medium whitespace-nowrap transition-smooth "+(i===e?"bg-primary text-primary-foreground border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[s.jsx(t,{name:a.icon,size:16}),s.jsx("span",{children:a.name})]},e))}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[!l&&s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-medium text-foreground mb-3 flex items-center space-x-2",children:[s.jsx(t,{name:"Clock",size:16}),s.jsx("span",{children:"Recently Used"})]}),s.jsx("div",{className:"grid grid-cols-1 gap-2",children:[{id:"dcf_standard",name:"DCF - Standard",lastUsed:"2024-07-11 14:30"},{id:"trading_comps",name:"Trading Comparables",lastUsed:"2024-07-11 09:15"},{id:"lbo_standard",name:"LBO - Standard",lastUsed:"2024-07-10 16:45"}].map(e=>s.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg hover:bg-muted/80 transition-smooth cursor-pointer",onClick:()=>h(e),children:[s.jsxs("div",{children:[s.jsx("span",{className:"font-medium text-foreground",children:e.name}),s.jsxs("p",{className:"text-xs text-muted-foreground",children:["Last used: ",e.lastUsed]})]}),s.jsx(t,{name:"ChevronRight",size:16,className:"text-muted-foreground"})]},e.id))})]}),s.jsx("div",{className:"space-y-4",children:p().map(e=>s.jsxs("div",{className:"p-4 bg-background border border-border rounded-lg hover:border-primary/50 transition-smooth cursor-pointer group",onClick:()=>h(e),children:[s.jsxs("div",{className:"flex items-start justify-between mb-3",children:[s.jsxs("div",{className:"flex-1",children:[s.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[s.jsx("h5",{className:"font-semibold text-foreground group-hover:text-primary transition-colors",children:e.name}),s.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${x(e.complexity)}`,children:e.complexity})]}),s.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]}),s.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[s.jsxs("div",{className:"flex items-center space-x-1 text-xs text-muted-foreground",children:[s.jsx(t,{name:"Star",size:12}),s.jsxs("span",{children:[e.popularity,"%"]})]}),s.jsx(t,{name:"ChevronRight",size:16,className:"text-muted-foreground group-hover:text-primary transition-colors"})]})]}),s.jsx("div",{className:"flex items-center justify-between mb-3",children:s.jsxs("div",{className:"flex items-center space-x-4 text-xs text-muted-foreground",children:[s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(t,{name:"Clock",size:12}),s.jsx("span",{children:e.timeToComplete})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx(t,{name:"Calendar",size:12}),s.jsxs("span",{children:["Last used: ",e.lastUsed]})]})]})}),s.jsx("div",{className:"flex flex-wrap gap-2",children:e.features.map((e,t)=>s.jsx("span",{className:"px-2 py-1 bg-muted text-xs text-muted-foreground rounded",children:e},t))})]},e.id))}),0===p().length&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(t,{name:"FileX",size:48,className:"text-muted-foreground mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-medium text-foreground mb-2",children:"No templates found"}),s.jsx("p",{className:"text-muted-foreground",children:l?"Try adjusting your search terms":"No templates available in this category"})]})]}),d&&s.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:s.jsxs("div",{className:"bg-card border border-border rounded-lg shadow-elevation-2 w-full max-w-md mx-4",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Create New Template"}),s.jsx(a,{variant:"ghost",size:"sm",iconName:"X",onClick:()=>m(!1)})]}),s.jsxs("div",{className:"p-4 space-y-4",children:[s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Template Name"}),s.jsx("input",{type:"text",placeholder:"Enter template name...",className:"w-full px-3 py-2 bg-input border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Description"}),s.jsx("textarea",{placeholder:"Describe your template...",rows:3,className:"w-full px-3 py-2 bg-input border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring resize-none"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"text-sm font-medium text-foreground mb-2 block",children:"Category"}),s.jsxs("select",{className:"w-full px-3 py-2 bg-input border border-border rounded-lg text-foreground focus:outline-none focus:ring-2 focus:ring-ring",children:[s.jsx("option",{value:"valuation",children:"Valuation Models"}),s.jsx("option",{value:"lbo",children:"LBO Models"}),s.jsx("option",{value:"comps",children:"Comparable Analysis"}),s.jsx("option",{value:"merger",children:"M&A Models"})]})]})]}),s.jsxs("div",{className:"flex items-center justify-end space-x-2 p-4 border-t border-border",children:[s.jsx(a,{variant:"outline",size:"sm",onClick:()=>m(!1),children:"Cancel"}),s.jsx(a,{variant:"default",size:"sm",onClick:()=>{m(!1),n&&n()},children:"Create Template"})]})]})})]})},x=new class{constructor(){this.commands=new Map,this.categories=new Map,this.aliases=new Map,this.initializeCategories()}initializeCategories(){this.categories.set("CORE",{name:"Core Analysis",description:"Fundamental financial analysis commands",icon:"ðŸ“Š",commands:[]}),this.categories.set("PORTFOLIO",{name:"Portfolio & Risk",description:"Portfolio analysis and risk management",icon:"ðŸŽ¯",commands:[]}),this.categories.set("VALUATION",{name:"Advanced Valuation",description:"Sophisticated valuation models",icon:"ðŸ“ˆ",commands:[]}),this.categories.set("TECHNICAL",{name:"Technical Analysis",description:"Technical analysis and market intelligence",icon:"ðŸ“Š",commands:[]}),this.categories.set("FIXED_INCOME",{name:"Fixed Income & Derivatives",description:"Bond analysis and derivatives pricing",icon:"ðŸ¦",commands:[]}),this.categories.set("ESG",{name:"ESG & Alternative Data",description:"Environmental, social, governance metrics",icon:"ðŸŒ±",commands:[]}),this.categories.set("AUTOMATION",{name:"Automation & Workflows",description:"Automated analysis and workflows",icon:"ðŸ¤–",commands:[]}),this.categories.set("DATA",{name:"Data Management",description:"Data import, export, and management",icon:"ðŸ’¾",commands:[]}),this.categories.set("REPORTING",{name:"Reporting & Visualization",description:"Reports, charts, and visualizations",icon:"ðŸ“‹",commands:[]}),this.categories.set("SYSTEM",{name:"System & Performance",description:"System monitoring and configuration",icon:"ðŸ”§",commands:[]}),this.categories.set("ANALYTICS",{name:"Advanced Analytics",description:"Machine learning and advanced analytics",icon:"ðŸ’¡",commands:[]}),this.categories.set("MARKET_DATA",{name:"Market Data Extensions",description:"Extended market data and economic indicators",icon:"ðŸŒ",commands:[]}),this.categories.set("UTILITY",{name:"Utility Commands",description:"General utility and helper commands",icon:"ðŸ› ï¸",commands:[]})}register(e,s,t={}){const a=e.toUpperCase(),r={name:a,handler:s,category:t.category||"UTILITY",description:t.description||"No description available",usage:t.usage||`${a}()`,examples:t.examples||[],parameterSchema:t.parameterSchema||null,aliases:t.aliases||[],tags:t.tags||[],version:t.version||"1.0.0",deprecated:t.deprecated||!1,experimental:t.experimental||!1};this.commands.set(a,r),t.aliases&&t.aliases.forEach(e=>{this.aliases.set(e.toUpperCase(),a)});const n=this.categories.get(r.category);return n&&n.commands.push(a),this}getHandler(e){const s=e.toUpperCase(),t=this.commands.get(s);if(t)return t.handler;const a=this.aliases.get(s);if(a){const e=this.commands.get(a);return e?e.handler:null}return null}getCommandInfo(e){const s=e.toUpperCase(),t=this.commands.get(s);if(t)return t;const a=this.aliases.get(s);return a?this.commands.get(a):null}getCommandsByCategory(e){const s=this.categories.get(e.toUpperCase());return s?s.commands.map(e=>this.commands.get(e)):[]}getAllCommands(){return Array.from(this.commands.keys())}getAllCategories(){return Array.from(this.categories.entries()).map(([e,s])=>({key:e,...s}))}searchCommands(e){const s=e.toLowerCase(),t=[];for(const[a,r]of this.commands){const e=this.calculateSearchScore(r,s);e>0&&t.push({...r,score:e})}return t.sort((e,s)=>s.score-e.score)}calculateSearchScore(e,s){let t=0;return e.name.toLowerCase()===s&&(t+=100),e.name.toLowerCase().includes(s)&&(t+=50),e.description.toLowerCase().includes(s)&&(t+=25),e.tags.some(e=>e.toLowerCase().includes(s))&&(t+=15),e.aliases.some(e=>e.toLowerCase().includes(s))&&(t+=10),t}getSuggestions(e){const s=e.toLowerCase(),t=[];for(const[a,r]of this.commands)a.toLowerCase().startsWith(s)&&t.push({name:r.name,description:r.description,usage:r.usage,category:r.category});return t.sort((e,s)=>e.name.localeCompare(s.name))}hasCommand(e){const s=e.toUpperCase();return this.commands.has(s)||this.aliases.has(s)}getCommandStats(){const e={};for(const[s,t]of this.categories)e[s]={name:t.name,count:t.commands.length,icon:t.icon};return e}},p=new class{constructor(){this.commandHistory=[],this.variables=new Map,this.settings={currency:"USD",precision:2,dateFormat:"YYYY-MM-DD"},this.persistenceInitialized=!1,this.maxHistorySize=1e3}async initializePersistence(){if(!this.persistenceInitialized)try{await o.initialize(),await this.loadPersistedData(),this.persistenceInitialized=!0}catch(e){}}async loadPersistedData(){try{const e=await o.retrieve("command_history");e&&Array.isArray(e)&&(this.commandHistory=e.slice(-this.maxHistorySize));const s=await o.retrieve("user_variables");s&&"object"==typeof s&&(this.variables=new Map(Object.entries(s)));const t=await o.retrieve("user_preferences");t&&"object"==typeof t&&(this.settings={...this.settings,...t})}catch(e){}}async saveData(){if(this.persistenceInitialized)try{await o.store("command_history",this.commandHistory,{storage:"indexedDB"});const e=Object.fromEntries(this.variables);await o.store("user_variables",e,{storage:"localStorage"}),await o.store("user_preferences",this.settings,{storage:"localStorage"})}catch(e){}}async processCommand(e,s={}){const t=Date.now();try{this.persistenceInitialized||await this.initializePersistence();const a=this.parseCommand(e),r={input:e,timestamp:new Date,success:!1,...a};this.commandHistory.push(r),this.commandHistory.length>this.maxHistorySize&&(this.commandHistory=this.commandHistory.slice(-this.maxHistorySize));const n=x.getHandler(a.command);if(!n)return this.createErrorResponse(`Unknown command: "${a.command}"`,e);const i=this.validateParameters(n,a);if(!i.valid)return this.createErrorResponse(i.error,e);const o=await n.execute(a,s,this);return r.success="error"!==o.type,r.executionTime=Date.now()-t,o.executionTime=Date.now()-t,o.timestamp=new Date,this.saveData().catch(e=>{}),o}catch(a){return this.createErrorResponse(`Command execution failed: ${a.message}`,e)}}parseCommand(e){const s=e.trim(),t=s.match(/^([A-Z_]+)\s*\(\s*([^)]*)\s*\)$/i);if(t){const[,e,a]=t,r=this.parseParameters(a);return{command:e.toUpperCase(),parameters:r,rawInput:s,style:"function"}}const a=s.split(/\s+/);return{command:a[0].toUpperCase(),parameters:a.slice(1),rawInput:s,style:"space-separated"}}parseParameters(e){if(!e.trim())return[];const s=[];let t="",a=!1,r=0,n="";for(let i=0;i<e.length;i++){const o=e[i];if('"'!==o&&"'"!==o||a)if(o===n&&a)a=!1,n="";else if("["!==o||a)if("]"!==o||a){if(","===o&&!a&&0===r){s.push(this.parseParameterValue(t.trim())),t="";continue}t+=o}else r--,t+=o;else r++,t+=o;else a=!0,n=o}return t.trim()&&s.push(this.parseParameterValue(t.trim())),s}parseParameterValue(e){if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.slice(1,-1);if(e.startsWith("[")&&e.endsWith("]")){const s=e.slice(1,-1);return s.trim()?s.split(",").map(e=>this.parseParameterValue(e.trim())):[]}return/^-?\d+\.?\d*$/.test(e)?parseFloat(e):"true"===e.toLowerCase()||"false"!==e.toLowerCase()&&e}validateParameters(e,s){if(!e.parameterSchema)return{valid:!0};const{required:t=[],optional:a=[]}=e.parameterSchema,{parameters:r}=s;if(r.length<t.length)return{valid:!1,error:`Missing required parameters. Expected: ${t.join(", ")}`};const n=t.length+a.length;return r.length>n?{valid:!1,error:`Too many parameters. Maximum: ${n}`}:{valid:!0}}createErrorResponse(e,s){return{type:"error",content:e,suggestions:this.getSuggestions(s),timestamp:new Date}}getSuggestions(e){const s=e.split(/[\s(]/)[0].toUpperCase();return x.getAllCommands().filter(e=>e.includes(s.substring(0,3))||e.toLowerCase().includes(s.toLowerCase())).slice(0,5)}getHistory(e=10){return this.commandHistory.slice(-e)}clearHistory(){this.commandHistory=[]}setVariable(e,s){this.variables.set(e,s),this.persistenceInitialized&&this.saveData().catch(e=>{})}getVariable(e){return this.variables.get(e)}getAllVariables(){return Object.fromEntries(this.variables)}updateSetting(e,s){this.settings[e]=s,this.persistenceInitialized&&this.saveData().catch(e=>{})}getSetting(e){return this.settings[e]}getAllSettings(){return{...this.settings}}},h=({onCommandExecute:a,calculationResults:r})=>{const[n,i]=e.useState([{id:1,type:"system",content:"FinanceAnalyst Pro Terminal v2.4.0 - Enhanced Command Suite Ready",timestamp:new Date},{id:2,type:"system",content:'Type "HELP()" for available commands or start with DCF(AAPL), PORTFOLIO([AAPL,MSFT], [0.5,0.5])',timestamp:new Date}]),[c,d]=e.useState(""),[m,u]=e.useState([]),[h,g]=e.useState(!1),[f,b]=e.useState(0),[j,y]=e.useState(!1),v=e.useRef(null),N=e.useRef(null),w=e.useRef(p);return e.useEffect(()=>{v.current&&(v.current.scrollTop=v.current.scrollHeight)},[n]),e.useEffect(()=>{N.current&&N.current.focus(),(async()=>{try{await o.initialize()}catch(e){}})()},[]),s.jsxs("div",{className:"flex flex-col h-full bg-gray-900 text-green-400 font-mono text-sm",children:[s.jsxs("div",{className:"flex items-center justify-between px-4 py-2 bg-gray-800 border-b border-gray-700",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"Terminal",size:16,className:"text-green-400"}),s.jsx("span",{className:"text-green-400 font-medium",children:"Financial Terminal"}),s.jsx("span",{className:"text-xs text-blue-400",children:"â€¢ Enhanced Command Suite"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 rounded-full "+(j?"bg-yellow-400 animate-pulse":"bg-green-400")}),s.jsx("span",{className:"text-xs text-gray-400",children:j?"Processing...":"Connected"})]})]}),s.jsxs("div",{ref:v,className:"flex-1 overflow-y-auto p-4 space-y-2",onClick:()=>N.current?.focus(),children:[n.map(e=>s.jsx("div",{className:"space-y-1",children:s.jsxs("div",{className:"flex items-start space-x-2",children:["user"===e.type&&s.jsx("span",{className:"text-blue-400 shrink-0",children:"analyst@finpro:~$"}),"system"===e.type&&s.jsx(t,{name:"Info",size:14,className:"text-yellow-400 mt-0.5 shrink-0"}),"success"===e.type&&s.jsx(t,{name:"CheckCircle",size:14,className:"text-green-400 mt-0.5 shrink-0"}),"error"===e.type&&s.jsx(t,{name:"XCircle",size:14,className:"text-red-400 mt-0.5 shrink-0"}),"warning"===e.type&&s.jsx(t,{name:"AlertTriangle",size:14,className:"text-yellow-400 mt-0.5 shrink-0"}),"info"===e.type&&s.jsx(t,{name:"Info",size:14,className:"text-blue-400 mt-0.5 shrink-0"}),s.jsxs("div",{className:"flex-1",children:[s.jsx("pre",{className:"whitespace-pre-wrap break-words",children:e.content}),e.data&&s.jsx("div",{className:"mt-2 p-2 bg-gray-800 rounded border border-gray-700",children:s.jsxs("div",{className:"text-xs text-gray-400",children:["Real-time calculation data available â€¢ Analysis:"," ",e.data.analysis||"financial"]})})]})]})},e.id)),j&&s.jsxs("div",{className:"flex items-center space-x-2 text-yellow-400",children:[s.jsx("div",{className:"animate-spin w-4 h-4 border-2 border-yellow-400 border-t-transparent rounded-full"}),s.jsx("span",{children:"Processing command..."})]}),s.jsxs("div",{className:"flex items-center space-x-2 relative",children:[s.jsx("span",{className:"text-blue-400 shrink-0",children:"analyst@finpro:~$"}),s.jsxs("div",{className:"flex-1 relative",children:[s.jsx("input",{ref:N,type:"text",value:c,onChange:e=>{const s=e.target.value;if(d(s),s.length>0){const e=x.getAllCommands().map(e=>{const s=x.getCommandInfo(e);return s?s.usage:e}),t=x.getSuggestions(s).map(e=>e.usage),a=e.filter(e=>e.toLowerCase().includes(s.toLowerCase())&&!t.includes(e)),r=[...t,...a];u(r.slice(0,8)),g(r.length>0),b(0)}else g(!1)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),(async()=>{if(!c.trim())return;const e={id:n.length+1,type:"user",content:c,timestamp:new Date};i(s=>[...s,e]),y(!0),d(""),g(!1);try{const e={demoMode:l.demoMode,showLoading:e=>{const s={id:n.length+2,type:"info",content:e,timestamp:new Date};i(e=>[...e,s])}},s=await w.current.processCommand(c,e);if("clear"===s.action)return void i([{id:1,type:"system",content:"Terminal cleared",timestamp:new Date}]);const t={id:n.length+2,type:s.type,content:s.content,timestamp:new Date,data:s.data};i(e=>[...e,t]),a&&a(c,s)}catch(s){const e={id:n.length+2,type:"error",content:`Error: ${s.message}`,timestamp:new Date};i(s=>[...s,e])}finally{y(!1)}})()):"ArrowUp"===e.key&&h?(e.preventDefault(),b(e=>Math.max(0,e-1))):"ArrowDown"===e.key&&h?(e.preventDefault(),b(e=>Math.min(m.length-1,e+1))):"Tab"===e.key&&h?(e.preventDefault(),d(m[f]),g(!1)):"Escape"===e.key&&g(!1)},className:"w-full bg-transparent text-green-400 outline-none border-none",placeholder:"Enter command (e.g., DCF(AAPL), PORTFOLIO([AAPL,MSFT], [0.5,0.5]))...",autoComplete:"off",disabled:j}),h&&s.jsx("div",{className:"absolute top-full left-0 right-0 mt-1 bg-gray-800 border border-gray-600 rounded-md shadow-lg z-10 max-h-48 overflow-y-auto",children:m.map((e,t)=>s.jsx("div",{className:"px-3 py-2 cursor-pointer text-sm "+(t===f?"bg-gray-700 text-green-400":"text-gray-300 hover:bg-gray-700"),onClick:()=>(e=>{d(e),g(!1),N.current?.focus()})(e),children:e},t))})]})]})]})]})},g=({onVariableChange:r,onBulkEdit:n})=>{const[i,o]=e.useState("assumptions"),[l,c]=e.useState(!1),[d,m]=e.useState(""),[u,x]=e.useState({assumptions:{revenue_growth:{value:.052,unit:"%",description:"Annual revenue growth rate",category:"Growth"},ebitda_margin:{value:.235,unit:"%",description:"EBITDA as % of revenue",category:"Profitability"},tax_rate:{value:.25,unit:"%",description:"Corporate tax rate",category:"Tax"},capex_revenue:{value:.035,unit:"%",description:"CapEx as % of revenue",category:"Investment"},working_capital_revenue:{value:.02,unit:"%",description:"Working capital as % of revenue",category:"Working Capital"},terminal_growth:{value:.025,unit:"%",description:"Long-term growth rate",category:"Terminal"}},cost_of_capital:{risk_free_rate:{value:.032,unit:"%",description:"Risk-free rate (10Y Treasury)",category:"Market"},market_premium:{value:.065,unit:"%",description:"Equity risk premium",category:"Market"},beta:{value:1.15,unit:"x",description:"Asset beta coefficient",category:"Risk"},cost_of_debt:{value:.045,unit:"%",description:"Pre-tax cost of debt",category:"Debt"},debt_equity_ratio:{value:.4,unit:"x",description:"Target debt-to-equity ratio",category:"Capital Structure"}},market_data:{current_share_price:{value:125.5,unit:"$",description:"Current trading price",category:"Market"},shares_outstanding:{value:20,unit:"M",description:"Shares outstanding",category:"Equity"},market_cap:{value:2510,unit:"$M",description:"Current market capitalization",category:"Valuation"},enterprise_value:{value:2810,unit:"$M",description:"Current enterprise value",category:"Valuation"},net_debt:{value:300,unit:"$M",description:"Net debt position",category:"Debt"}}}),p=(e,s)=>"%"===s?(100*e).toFixed(1):"$"===s||"$M"===s?e.toFixed(2):e.toFixed(3),h=e=>{if(!d)return e;const s={};return Object.entries(e).forEach(([e,t])=>{(e.toLowerCase().includes(d.toLowerCase())||t.description.toLowerCase().includes(d.toLowerCase()))&&(s[e]=t)}),s};return s.jsxs("div",{className:"flex flex-col h-full bg-card",children:[s.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-border",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"Sliders",size:20,className:"text-primary"}),s.jsx("h3",{className:"text-lg font-semibold text-foreground",children:"Variable Inputs"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:l?"Check":"Edit",onClick:()=>c(!l),children:l?"Done":"Edit"}),s.jsx(a,{variant:"outline",size:"sm",iconName:"Download",onClick:()=>{const e=JSON.stringify(u,null,2),s=new Blob([e],{type:"application/json"}),t=URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download="model_variables.json",a.click(),URL.revokeObjectURL(t)},children:"Export"})]})]}),s.jsx("div",{className:"p-4 border-b border-border",children:s.jsxs("div",{className:"relative",children:[s.jsx(t,{name:"Search",size:16,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),s.jsx("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Search variables...",className:"w-full pl-10 pr-4 py-2 bg-input border border-border rounded-lg text-foreground placeholder-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring"})]})}),s.jsx("div",{className:"flex border-b border-border overflow-x-auto",children:[{id:"assumptions",label:"Key Assumptions",icon:"Settings"},{id:"cost_of_capital",label:"Cost of Capital",icon:"Percent"},{id:"market_data",label:"Market Data",icon:"TrendingUp"}].map(e=>s.jsxs("button",{onClick:()=>o(e.id),className:"flex items-center space-x-2 px-4 py-3 text-sm font-medium whitespace-nowrap transition-smooth "+(i===e.id?"bg-primary text-primary-foreground border-b-2 border-primary":"text-muted-foreground hover:text-foreground hover:bg-muted"),children:[s.jsx(t,{name:e.icon,size:16}),s.jsx("span",{children:e.label})]},e.id))}),s.jsxs("div",{className:"flex-1 overflow-y-auto p-4",children:[Object.entries((e=>{const s={};return Object.entries(e).forEach(([e,t])=>{const a=t.category||"Other";s[a]||(s[a]=[]),s[a].push({key:e,...t})}),s})(h(u[i]))).map(([e,a])=>s.jsxs("div",{className:"mb-6",children:[s.jsxs("h4",{className:"text-sm font-medium text-foreground mb-3 flex items-center space-x-2",children:[s.jsx(t,{name:"Folder",size:16}),s.jsx("span",{children:e})]}),s.jsx("div",{className:"space-y-3",children:a.map(e=>s.jsxs("div",{className:"p-3 bg-background border border-border rounded-lg",children:[s.jsxs("div",{className:"flex items-center justify-between mb-2",children:[s.jsxs("div",{className:"flex-1",children:[s.jsx("label",{className:"text-sm font-medium text-foreground capitalize",children:e.key.replace(/_/g," ")}),s.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]}),s.jsx("div",{className:"flex items-center space-x-2 ml-4",children:l?s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsx("input",{type:"number",value:p(e.value,e.unit),onChange:s=>((e,s,t)=>{const a={...u,[e]:{...u[e],[s]:{...u[e][s],value:parseFloat(t)||0}}};x(a),r&&r(e,s,t)})(i,e.key,s.target.value),step:"%"===e.unit?"0.1":"0.01",className:"w-20 px-2 py-1 text-sm bg-input border border-border rounded text-foreground focus:outline-none focus:ring-1 focus:ring-ring"}),s.jsx("span",{className:"text-sm text-muted-foreground",children:e.unit})]}):s.jsxs("div",{className:"text-right",children:[s.jsx("span",{className:"text-lg font-semibold text-foreground",children:p(e.value,e.unit)}),s.jsx("span",{className:"text-sm text-muted-foreground ml-1",children:e.unit})]})})]}),s.jsxs("div",{className:"flex items-center justify-between text-xs",children:[s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx("div",{className:"w-2 h-2 bg-success rounded-full"}),s.jsx("span",{className:"text-muted-foreground",children:"Within range"})]}),s.jsxs("div",{className:"flex items-center space-x-1 text-muted-foreground",children:[s.jsx(t,{name:"TrendingUp",size:12}),s.jsx("span",{children:"High impact"})]})]})]},e.key))})]},e)),0===Object.keys(h(u[i])).length&&s.jsxs("div",{className:"text-center py-12",children:[s.jsx(t,{name:"Search",size:48,className:"text-muted-foreground mx-auto mb-4"}),s.jsx("h4",{className:"text-lg font-medium text-foreground mb-2",children:"No variables found"}),s.jsx("p",{className:"text-muted-foreground",children:"Try adjusting your search terms"})]})]}),s.jsx("div",{className:"p-4 border-t border-border bg-muted/50",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[s.jsx(t,{name:"Info",size:12}),s.jsx("span",{children:"Changes auto-save every 30 seconds"})]}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(a,{variant:"outline",size:"sm",iconName:"RotateCcw",onClick:()=>{const e={...u};x(e)},children:"Reset"}),s.jsx(a,{variant:"outline",size:"sm",iconName:"Grid",onClick:()=>n&&n(),children:"Bulk Edit"})]})]})})]})},f=()=>{const[l,x]=e.useState("dual-pane"),[p,f]=e.useState("terminal"),[b,j]=e.useState("results"),[y,v]=e.useState(50),[N,w]=e.useState(!1),C=e.useRef(null),k=e.useRef(null),[S]=e.useState({name:"DCF_Analysis_v2.3",saved:!0,calculating:!1,lastSaved:new Date}),[_,E]=e.useState(null),T=(e,s)=>{E(s)};e.useEffect(()=>{let e=!0;return async function(){try{const s=await o.retrieve("ui_state",{storage:"localStorage"});e&&s&&(s.workspace?.layout&&x(s.workspace.layout),"number"==typeof s.workspace?.leftWidthPct&&v(s.workspace.leftWidthPct),s.workspace?.leftPanelContent&&f(s.workspace.leftPanelContent),s.workspace?.rightPanelContent&&j(s.workspace.rightPanelContent))}catch(s){}}(),()=>{e=!1}},[]),e.useEffect(()=>{const e=setTimeout(()=>{const e={workspace:{layout:l,leftWidthPct:y,leftPanelContent:p,rightPanelContent:b}};o.store("ui_state",e,{storage:"localStorage"})},250);return()=>clearTimeout(e)},[l,p,b,y]);const A=e.useCallback(e=>{if(!N||!C.current)return;const s=C.current.getBoundingClientRect(),t=e.clientX-s.left,a=Math.max(20,Math.min(80,t/s.width*100));v(a)},[N]),D=e.useCallback(e=>{N&&(w(!1),v(s=>e.altKey?s:(e=>{const s=[30,50,70];let t=s[0],a=Math.abs(e-s[0]);for(let r=1;r<s.length;r++){const n=Math.abs(e-s[r]);n<a&&(a=n,t=s[r])}return t})(s)),window.removeEventListener("mousemove",A),window.removeEventListener("mouseup",D))},[N,A]),R=e.useCallback(()=>{w(!0),window.addEventListener("mousemove",A),window.addEventListener("mouseup",D)},[A,D]),L=e.useCallback(()=>{v(50)},[]);return e.useEffect(()=>{const e=e=>{if(e.altKey&&("ArrowLeft"===e.key||"ArrowRight"===e.key)){e.preventDefault();const s=e.shiftKey?10:2;v(t=>{const a="ArrowLeft"===e.key?t-s:t+s;return Math.max(20,Math.min(80,a))})}(e.ctrlKey||e.metaKey)&&e.shiftKey&&"d"===e.key.toLowerCase()&&(e.preventDefault(),x(e=>"dual-pane"===e?"single-pane":"dual-pane")),!e.ctrlKey&&!e.metaKey||e.shiftKey||"1"!==e.key&&"2"!==e.key||(e.preventDefault(),"1"===e.key?C.current?.querySelector('[data-pane="left"]').focus():"2"===e.key&&C.current?.querySelector('[data-pane="right"]').focus())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[]),s.jsxs("div",{className:"min-h-screen bg-gray-900 text-white",children:[s.jsx(i,{title:"Financial Model Workspace | Valor-IVX",description:"Professional financial modeling workspace with advanced DCF analysis, LBO tools, and real-time collaboration features for finance professionals.",canonical:"/",keywords:"financial modeling, DCF analysis, LBO modeling, financial workspace, valuation tools, Excel alternative"}),s.jsx(r,{}),s.jsxs("main",{id:"main-content",className:"flex flex-col h-screen pt-16",role:"main",children:[s.jsxs("div",{className:"px-4 py-2 bg-gray-900 border-b border-gray-800",children:[s.jsx("h1",{className:"sr-only",children:"Financial Model Workspace"}),s.jsx(n,{})]}),s.jsxs("div",{className:"bg-gray-800 border-b border-gray-700 px-4 py-2 flex items-center justify-between",children:[s.jsx("div",{className:"flex items-center space-x-4",children:s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsx(t,{name:"FileText",className:"w-5 h-5 text-blue-400"}),s.jsx("span",{className:"font-medium",children:S.name}),s.jsx("span",{className:"text-xs px-2 py-1 rounded "+(S.saved?"bg-green-900 text-green-300":"bg-yellow-900 text-yellow-300"),children:S.saved?"Saved":"Unsaved"})]})}),s.jsxs("div",{className:"flex items-center space-x-2",children:[s.jsxs("div",{className:"flex items-center space-x-1 bg-gray-700 rounded-lg p-1",children:[s.jsx(a,{variant:"single-pane"===l?"primary":"ghost",size:"sm",onClick:()=>x("single-pane"),"aria-label":"Single-pane layout",children:s.jsx(t,{name:"Square",className:"w-4 h-4"})}),s.jsx(a,{variant:"dual-pane"===l?"primary":"ghost",size:"sm",onClick:()=>x("dual-pane"),"aria-label":"Dual-pane layout",children:s.jsx(t,{name:"Columns",className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center space-x-1",children:[s.jsxs("select",{value:p,onChange:e=>f(e.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm","aria-label":"Select left panel content",children:[s.jsx("option",{value:"terminal",children:"Terminal"}),s.jsx("option",{value:"variables",children:"Variables"}),s.jsx("option",{value:"formulas",children:"Formulas"}),s.jsx("option",{value:"templates",children:"Templates"})]}),"dual-pane"===l&&s.jsxs("select",{value:b,onChange:e=>j(e.target.value),className:"bg-gray-700 border border-gray-600 rounded px-2 py-1 text-sm","aria-label":"Select right panel content",children:[s.jsx("option",{value:"results",children:"Results"}),s.jsx("option",{value:"audit",children:"Audit Trail"})]})]})]})]}),s.jsxs("div",{ref:C,className:"flex-1 flex overflow-hidden "+(N?"select-none":""),children:[s.jsx("div",{"data-pane":"left",tabIndex:0,className:"border-r border-gray-700 overflow-hidden focus:outline-none focus:ring-2 focus:ring-blue-500",style:{flexBasis:"dual-pane"===l?`${y}%`:"100%"},"aria-label":"Left panel",children:(()=>{switch(p){case"terminal":default:return s.jsx(h,{onCommandExecute:T,calculationResults:_});case"variables":return s.jsx(g,{});case"formulas":return s.jsx(m,{});case"templates":return s.jsx(u,{})}})()}),"dual-pane"===l&&s.jsx("div",{ref:k,role:"separator","aria-orientation":"vertical","aria-valuemin":20,"aria-valuemax":80,"aria-valuenow":Math.round(y),tabIndex:0,onMouseDown:R,onDoubleClick:L,className:"w-1.5 bg-gray-800 hover:bg-gray-700 cursor-col-resize "+(N?"bg-blue-700":""),title:"Drag to resize â€¢ Doubleâ€‘click to reset â€¢ Alt+â†/â†’ fine resize â€¢ Shift accelerates"}),"dual-pane"===l&&s.jsx("div",{"data-pane":"right",tabIndex:0,className:"overflow-hidden focus:outline-none focus:ring-2 focus:ring-blue-500",style:{flexBasis:100-y+"%"},"aria-label":"Right panel",children:(()=>{switch(b){case"results":default:return s.jsx(d,{results:_});case"audit":return s.jsx(c,{})}})()})]})]})]})};export{f as default};
//# sourceMappingURL=index-BLR-FLOR.js.map
